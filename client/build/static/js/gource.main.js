var gource=function(t){function e(r){if(n[r])return n[r].exports;var i=n[r]={i:r,l:!1,exports:{}};return t[r].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var n={};return e.m=t,e.c=n,e.d=function(t,n,r){e.o(t,n)||Object.defineProperty(t,n,{configurable:!1,enumerable:!0,get:r})},e.n=function(t){var n=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(n,"a",n),n},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="/",e(e.s=15)}([function(t,e,n){"use strict";function r(){}function i(t,e){this.x=t||0,this.y=e||0}function o(){this.elements=[1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix4: the constructor no longer reads arguments. use .set() instead.")}function a(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._w=void 0!==r?r:1}function s(t,e,n){this.x=t||0,this.y=e||0,this.z=n||0}function u(){this.elements=[1,0,0,0,1,0,0,0,1],arguments.length>0&&console.error("THREE.Matrix3: the constructor no longer reads arguments. use .set() instead.")}function c(t,e,n,r,o,a,s,l,h,f){Object.defineProperty(this,"id",{value:Iu++}),this.uuid=Au.generateUUID(),this.name="",this.image=void 0!==t?t:c.DEFAULT_IMAGE,this.mipmaps=[],this.mapping=void 0!==e?e:c.DEFAULT_MAPPING,this.wrapS=void 0!==n?n:cs,this.wrapT=void 0!==r?r:cs,this.magFilter=void 0!==o?o:ps,this.minFilter=void 0!==a?a:gs,this.anisotropy=void 0!==h?h:1,this.format=void 0!==s?s:Ps,this.type=void 0!==l?l:vs,this.offset=new i(0,0),this.repeat=new i(1,1),this.center=new i(0,0),this.rotation=0,this.matrixAutoUpdate=!0,this.matrix=new u,this.generateMipmaps=!0,this.premultiplyAlpha=!1,this.flipY=!0,this.unpackAlignment=4,this.encoding=void 0!==f?f:yu,this.version=0,this.onUpdate=null}function l(t,e,n,r){this.x=t||0,this.y=e||0,this.z=n||0,this.w=void 0!==r?r:1}function h(t,e,n){this.width=t,this.height=e,this.scissor=new l(0,0,t,e),this.scissorTest=!1,this.viewport=new l(0,0,t,e),n=n||{},void 0===n.minFilter&&(n.minFilter=ps),this.texture=new c(void 0,void 0,n.wrapS,n.wrapT,n.magFilter,n.minFilter,n.format,n.type,n.anisotropy,n.encoding),this.depthBuffer=void 0===n.depthBuffer||n.depthBuffer,this.stencilBuffer=void 0===n.stencilBuffer||n.stencilBuffer,this.depthTexture=void 0!==n.depthTexture?n.depthTexture:null}function f(t,e,n){h.call(this,t,e,n),this.activeCubeFace=0,this.activeMipMapLevel=0}function d(t,e,n,r,i,o,a,s,u,l,h,f){c.call(this,null,o,a,s,u,l,r,i,h,f),this.image={data:t,width:e,height:n},this.magFilter=void 0!==u?u:hs,this.minFilter=void 0!==l?l:hs,this.generateMipmaps=!1,this.flipY=!1,this.unpackAlignment=1}function p(t,e){this.min=void 0!==t?t:new s(1/0,1/0,1/0),this.max=void 0!==e?e:new s(-1/0,-1/0,-1/0)}function m(t,e){this.center=void 0!==t?t:new s,this.radius=void 0!==e?e:0}function g(t,e){this.normal=void 0!==t?t:new s(1,0,0),this.constant=void 0!==e?e:0}function v(t,e,n,r,i,o){this.planes=[void 0!==t?t:new g,void 0!==e?e:new g,void 0!==n?n:new g,void 0!==r?r:new g,void 0!==i?i:new g,void 0!==o?o:new g]}function y(t,e,n){return void 0===e&&void 0===n?this.set(t):this.setRGB(t,e,n)}function _(t){function e(e,n){var r=e.array,i=e.dynamic?t.DYNAMIC_DRAW:t.STATIC_DRAW,o=t.createBuffer();t.bindBuffer(n,o),t.bufferData(n,r,i),e.onUploadCallback();var a=t.FLOAT;return r instanceof Float32Array?a=t.FLOAT:r instanceof Float64Array?console.warn("THREE.WebGLAttributes: Unsupported data buffer format: Float64Array."):r instanceof Uint16Array?a=t.UNSIGNED_SHORT:r instanceof Int16Array?a=t.SHORT:r instanceof Uint32Array?a=t.UNSIGNED_INT:r instanceof Int32Array?a=t.INT:r instanceof Int8Array?a=t.BYTE:r instanceof Uint8Array&&(a=t.UNSIGNED_BYTE),{buffer:o,type:a,bytesPerElement:r.BYTES_PER_ELEMENT,version:e.version}}function n(e,n,r){var i=n.array,o=n.updateRange;t.bindBuffer(r,e),!1===n.dynamic?t.bufferData(r,i,t.STATIC_DRAW):-1===o.count?t.bufferSubData(r,0,i):0===o.count?console.error("THREE.WebGLObjects.updateBuffer: dynamic THREE.BufferAttribute marked as needsUpdate but updateRange.count is 0, ensure you are using set methods or updating manually."):(t.bufferSubData(r,o.offset*i.BYTES_PER_ELEMENT,i.subarray(o.offset,o.offset+o.count)),o.count=-1)}function r(t){return t.isInterleavedBufferAttribute&&(t=t.data),a.get(t)}function i(e){e.isInterleavedBufferAttribute&&(e=e.data);var n=a.get(e);n&&(t.deleteBuffer(n.buffer),a.delete(e))}function o(t,r){t.isInterleavedBufferAttribute&&(t=t.data);var i=a.get(t);void 0===i?a.set(t,e(t,r)):i.version<t.version&&(n(i.buffer,t,r),i.version=t.version)}var a=new WeakMap;return{get:r,remove:i,update:o}}function b(t,e,n,r){this._x=t||0,this._y=e||0,this._z=n||0,this._order=r||b.DefaultOrder}function w(){this.mask=1}function E(){function t(){i.setFromEuler(r,!1)}function e(){r.setFromQuaternion(i,void 0,!1)}Object.defineProperty(this,"id",{value:ku++}),this.uuid=Au.generateUUID(),this.name="",this.type="Object3D",this.parent=null,this.children=[],this.up=E.DefaultUp.clone();var n=new s,r=new b,i=new a,c=new s(1,1,1);r.onChange(t),i.onChange(e),Object.defineProperties(this,{position:{enumerable:!0,value:n},rotation:{enumerable:!0,value:r},quaternion:{enumerable:!0,value:i},scale:{enumerable:!0,value:c},modelViewMatrix:{value:new o},normalMatrix:{value:new u}}),this.matrix=new o,this.matrixWorld=new o,this.matrixAutoUpdate=E.DefaultMatrixAutoUpdate,this.matrixWorldNeedsUpdate=!1,this.layers=new w,this.visible=!0,this.castShadow=!1,this.receiveShadow=!1,this.frustumCulled=!0,this.renderOrder=0,this.userData={}}function x(){E.call(this),this.type="Camera",this.matrixWorldInverse=new o,this.projectionMatrix=new o}function T(t,e,n,r,i,o){x.call(this),this.type="OrthographicCamera",this.zoom=1,this.view=null,this.left=t,this.right=e,this.top=n,this.bottom=r,this.near=void 0!==i?i:.1,this.far=void 0!==o?o:2e3,this.updateProjectionMatrix()}function S(t,e,n,r,i,o){this.a=t,this.b=e,this.c=n,this.normal=r&&r.isVector3?r:new s,this.vertexNormals=Array.isArray(r)?r:[],this.color=i&&i.isColor?i:new y,this.vertexColors=Array.isArray(i)?i:[],this.materialIndex=void 0!==o?o:0}function C(){Object.defineProperty(this,"id",{value:Lu+=2}),this.uuid=Au.generateUUID(),this.name="",this.type="Geometry",this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.elementsNeedUpdate=!1,this.verticesNeedUpdate=!1,this.uvsNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.lineDistancesNeedUpdate=!1,this.groupsNeedUpdate=!1}function M(t,e,n){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");this.name="",this.array=t,this.itemSize=e,this.count=void 0!==t?t.length/e:0,this.normalized=!0===n,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function A(t,e,n){M.call(this,new Int8Array(t),e,n)}function I(t,e,n){M.call(this,new Uint8Array(t),e,n)}function R(t,e,n){M.call(this,new Uint8ClampedArray(t),e,n)}function P(t,e,n){M.call(this,new Int16Array(t),e,n)}function N(t,e,n){M.call(this,new Uint16Array(t),e,n)}function D(t,e,n){M.call(this,new Int32Array(t),e,n)}function O(t,e,n){M.call(this,new Uint32Array(t),e,n)}function k(t,e,n){M.call(this,new Float32Array(t),e,n)}function L(t,e,n){M.call(this,new Float64Array(t),e,n)}function U(){this.vertices=[],this.normals=[],this.colors=[],this.uvs=[],this.uvs2=[],this.groups=[],this.morphTargets={},this.skinWeights=[],this.skinIndices=[],this.boundingBox=null,this.boundingSphere=null,this.verticesNeedUpdate=!1,this.normalsNeedUpdate=!1,this.colorsNeedUpdate=!1,this.uvsNeedUpdate=!1,this.groupsNeedUpdate=!1}function F(t){if(0===t.length)return-1/0;for(var e=t[0],n=1,r=t.length;n<r;++n)t[n]>e&&(e=t[n]);return e}function B(){Object.defineProperty(this,"id",{value:Uu+=2}),this.uuid=Au.generateUUID(),this.name="",this.type="BufferGeometry",this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.drawRange={start:0,count:1/0}}function V(t,e,n,r,i,o){C.call(this),this.type="BoxGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o},this.fromBufferGeometry(new j(t,e,n,r,i,o)),this.mergeVertices()}function j(t,e,n,r,i,o){function a(t,e,n,r,i,o,a,m,g,v,y){var _,b,w=o/g,E=a/v,x=o/2,T=a/2,S=m/2,C=g+1,M=v+1,A=0,I=0,R=new s;for(b=0;b<M;b++){var P=b*E-T;for(_=0;_<C;_++){var N=_*w-x;R[t]=N*r,R[e]=P*i,R[n]=S,l.push(R.x,R.y,R.z),R[t]=0,R[e]=0,R[n]=m>0?1:-1,h.push(R.x,R.y,R.z),f.push(_/g),f.push(1-b/v),A+=1}}for(b=0;b<v;b++)for(_=0;_<g;_++){var D=d+_+C*b,O=d+_+C*(b+1),k=d+(_+1)+C*(b+1),L=d+(_+1)+C*b;c.push(D,O,L),c.push(O,k,L),I+=6}u.addGroup(p,I,y),p+=I,d+=A}B.call(this),this.type="BoxBufferGeometry",this.parameters={width:t,height:e,depth:n,widthSegments:r,heightSegments:i,depthSegments:o};var u=this;t=t||1,e=e||1,n=n||1,r=Math.floor(r)||1,i=Math.floor(i)||1,o=Math.floor(o)||1;var c=[],l=[],h=[],f=[],d=0,p=0;a("z","y","x",-1,-1,n,e,t,o,i,0),a("z","y","x",1,-1,n,e,-t,o,i,1),a("x","z","y",1,1,t,n,e,r,o,2),a("x","z","y",1,-1,t,n,-e,r,o,3),a("x","y","z",1,-1,t,e,n,r,i,4),a("x","y","z",-1,-1,t,e,-n,r,i,5),this.setIndex(c),this.addAttribute("position",new k(l,3)),this.addAttribute("normal",new k(h,3)),this.addAttribute("uv",new k(f,2))}function H(t,e,n,r){C.call(this),this.type="PlaneGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},this.fromBufferGeometry(new G(t,e,n,r)),this.mergeVertices()}function G(t,e,n,r){B.call(this),this.type="PlaneBufferGeometry",this.parameters={width:t,height:e,widthSegments:n,heightSegments:r},t=t||1,e=e||1;var i,o,a=t/2,s=e/2,u=Math.floor(n)||1,c=Math.floor(r)||1,l=u+1,h=c+1,f=t/u,d=e/c,p=[],m=[],g=[],v=[];for(o=0;o<h;o++){var y=o*d-s;for(i=0;i<l;i++){var _=i*f-a;m.push(_,-y,0),g.push(0,0,1),v.push(i/u),v.push(1-o/c)}}for(o=0;o<c;o++)for(i=0;i<u;i++){var b=i+l*o,w=i+l*(o+1),E=i+1+l*(o+1),x=i+1+l*o;p.push(b,w,x),p.push(w,E,x)}this.setIndex(p),this.addAttribute("position",new k(m,3)),this.addAttribute("normal",new k(g,3)),this.addAttribute("uv",new k(v,2))}function z(){Object.defineProperty(this,"id",{value:Fu++}),this.uuid=Au.generateUUID(),this.name="",this.type="Material",this.fog=!0,this.lights=!0,this.blending=va,this.side=ua,this.flatShading=!1,this.vertexColors=da,this.opacity=1,this.transparent=!1,this.blendSrc=Pa,this.blendDst=Na,this.blendEquation=Ea,this.blendSrcAlpha=null,this.blendDstAlpha=null,this.blendEquationAlpha=null,this.depthFunc=ja,this.depthTest=!0,this.depthWrite=!0,this.clippingPlanes=null,this.clipIntersection=!1,this.clipShadows=!1,this.shadowSide=null,this.colorWrite=!0,this.precision=null,this.polygonOffset=!1,this.polygonOffsetFactor=0,this.polygonOffsetUnits=0,this.dithering=!1,this.alphaTest=0,this.premultipliedAlpha=!1,this.overdraw=0,this.visible=!0,this.userData={},this.needsUpdate=!0}function W(t){z.call(this),this.type="MeshBasicMaterial",this.color=new y(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=qa,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.lights=!1,this.setValues(t)}function q(t){z.call(this),this.type="ShaderMaterial",this.defines={},this.uniforms={},this.vertexShader="void main() {\n\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}",this.fragmentShader="void main() {\n\tgl_FragColor = vec4( 1.0, 0.0, 0.0, 1.0 );\n}",this.linewidth=1,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.clipping=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.extensions={derivatives:!1,fragDepth:!1,drawBuffers:!1,shaderTextureLOD:!1},this.defaultAttributeValues={color:[1,1,1],uv:[0,0],uv2:[0,0]},this.index0AttributeName=void 0,this.uniformsNeedUpdate=!1,void 0!==t&&(void 0!==t.attributes&&console.error("THREE.ShaderMaterial: attributes should now be defined in THREE.BufferGeometry instead."),this.setValues(t))}function Y(t,e){this.origin=void 0!==t?t:new s,this.direction=void 0!==e?e:new s}function K(t,e){this.start=void 0!==t?t:new s,this.end=void 0!==e?e:new s}function Q(t,e,n){this.a=void 0!==t?t:new s,this.b=void 0!==e?e:new s,this.c=void 0!==n?n:new s}function X(t,e){E.call(this),this.type="Mesh",this.geometry=void 0!==t?t:new B,this.material=void 0!==e?e:new W({color:16777215*Math.random()}),this.drawMode=mu,this.updateMorphTargets()}function J(t,e,n,r){function i(e,r,i,h){var f=r.background;null===f?o(c,l):f&&f.isColor&&(o(f,1),h=!0),(t.autoClear||h)&&t.clear(t.autoClearColor,t.autoClearDepth,t.autoClearStencil),f&&f.isCubeTexture?(void 0===u&&(u=new X(new j(1,1,1),new q({uniforms:Ou.cube.uniforms,vertexShader:Ou.cube.vertexShader,fragmentShader:Ou.cube.fragmentShader,side:ca,depthTest:!0,depthWrite:!1,fog:!1})),u.geometry.removeAttribute("normal"),u.geometry.removeAttribute("uv"),u.onBeforeRender=function(t,e,n){this.matrixWorld.copyPosition(n.matrixWorld)},n.update(u.geometry)),u.material.uniforms.tCube.value=f,e.push(u,u.geometry,u.material,0,null)):f&&f.isTexture&&(void 0===a&&(a=new T(-1,1,1,-1,0,1),s=new X(new G(2,2),new W({depthTest:!1,depthWrite:!1,fog:!1})),n.update(s.geometry)),s.material.map=f,t.renderBufferDirect(a,null,s.geometry,s.material,s,null))}function o(t,n){e.buffers.color.setClear(t.r,t.g,t.b,n,r)}var a,s,u,c=new y(0),l=0;return{getClearColor:function(){return c},setClearColor:function(t,e){c.set(t),l=void 0!==e?e:1,o(c,l)},getClearAlpha:function(){return l},setClearAlpha:function(t){l=t,o(c,l)},render:i}}function Z(t,e,n){function r(t){a=t}function i(e,r){t.drawArrays(a,e,r),n.update(r,a)}function o(t,r,i){var o=e.get("ANGLE_instanced_arrays");if(null===o)return void console.error("THREE.WebGLBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");var s=t.attributes.position;s.isInterleavedBufferAttribute?(i=s.data.count,o.drawArraysInstancedANGLE(a,0,i,t.maxInstancedCount)):o.drawArraysInstancedANGLE(a,r,i,t.maxInstancedCount),n.update(i,a,t.maxInstancedCount)}var a;this.setMode=r,this.render=i,this.renderInstances=o}function $(t,e,n){function r(){if(void 0!==o)return o;var n=e.get("EXT_texture_filter_anisotropic");return o=null!==n?t.getParameter(n.MAX_TEXTURE_MAX_ANISOTROPY_EXT):0}function i(e){if("highp"===e){if(t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.HIGH_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.HIGH_FLOAT).precision>0)return"highp";e="mediump"}return"mediump"===e&&t.getShaderPrecisionFormat(t.VERTEX_SHADER,t.MEDIUM_FLOAT).precision>0&&t.getShaderPrecisionFormat(t.FRAGMENT_SHADER,t.MEDIUM_FLOAT).precision>0?"mediump":"lowp"}var o,a=void 0!==n.precision?n.precision:"highp",s=i(a);s!==a&&(console.warn("THREE.WebGLRenderer:",a,"not supported, using",s,"instead."),a=s);var u=!0===n.logarithmicDepthBuffer,c=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS),l=t.getParameter(t.MAX_VERTEX_TEXTURE_IMAGE_UNITS),h=t.getParameter(t.MAX_TEXTURE_SIZE),f=t.getParameter(t.MAX_CUBE_MAP_TEXTURE_SIZE),d=t.getParameter(t.MAX_VERTEX_ATTRIBS),p=t.getParameter(t.MAX_VERTEX_UNIFORM_VECTORS),m=t.getParameter(t.MAX_VARYING_VECTORS),g=t.getParameter(t.MAX_FRAGMENT_UNIFORM_VECTORS),v=l>0,y=!!e.get("OES_texture_float");return{getMaxAnisotropy:r,getMaxPrecision:i,precision:a,logarithmicDepthBuffer:u,maxTextures:c,maxVertexTextures:l,maxTextureSize:h,maxCubemapSize:f,maxAttributes:d,maxVertexUniforms:p,maxVaryings:m,maxFragmentUniforms:g,vertexTextures:v,floatFragmentTextures:y,floatVertexTextures:v&&y}}function tt(){function t(){l.value!==r&&(l.value=r,l.needsUpdate=i>0),n.numPlanes=i,n.numIntersection=0}function e(t,e,r,i){var o=null!==t?t.length:0,a=null;if(0!==o){if(a=l.value,!0!==i||null===a){var u=r+4*o,h=e.matrixWorldInverse;c.getNormalMatrix(h),(null===a||a.length<u)&&(a=new Float32Array(u));for(var f=0,d=r;f!==o;++f,d+=4)s.copy(t[f]).applyMatrix4(h,c),s.normal.toArray(a,d),a[d+3]=s.constant}l.value=a,l.needsUpdate=!0}return n.numPlanes=o,a}var n=this,r=null,i=0,o=!1,a=!1,s=new g,c=new u,l={value:null,needsUpdate:!1};this.uniform=l,this.numPlanes=0,this.numIntersection=0,this.init=function(t,n,a){var s=0!==t.length||n||0!==i||o;return o=n,r=e(t,a,0),i=t.length,s},this.beginShadows=function(){a=!0,e(null)},this.endShadows=function(){a=!1,t()},this.setState=function(n,s,u,c,h,f){if(!o||null===n||0===n.length||a&&!u)a?e(null):t();else{var d=a?0:i,p=4*d,m=h.clippingState||null;l.value=m,m=e(n,c,p,f);for(var g=0;g!==p;++g)m[g]=r[g];h.clippingState=m,this.numIntersection=s?this.numPlanes:0,this.numPlanes+=d}}}function et(t){var e={};return{get:function(n){if(void 0!==e[n])return e[n];var r;switch(n){case"WEBGL_depth_texture":r=t.getExtension("WEBGL_depth_texture")||t.getExtension("MOZ_WEBGL_depth_texture")||t.getExtension("WEBKIT_WEBGL_depth_texture");break;case"EXT_texture_filter_anisotropic":r=t.getExtension("EXT_texture_filter_anisotropic")||t.getExtension("MOZ_EXT_texture_filter_anisotropic")||t.getExtension("WEBKIT_EXT_texture_filter_anisotropic");break;case"WEBGL_compressed_texture_s3tc":r=t.getExtension("WEBGL_compressed_texture_s3tc")||t.getExtension("MOZ_WEBGL_compressed_texture_s3tc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_s3tc");break;case"WEBGL_compressed_texture_pvrtc":r=t.getExtension("WEBGL_compressed_texture_pvrtc")||t.getExtension("WEBKIT_WEBGL_compressed_texture_pvrtc");break;default:r=t.getExtension(n)}return null===r&&console.warn("THREE.WebGLRenderer: "+n+" extension not supported."),e[n]=r,r}}}function nt(t,e,n){function r(t){var i=t.target,o=s[i.id];null!==o.index&&e.remove(o.index);for(var a in o.attributes)e.remove(o.attributes[a]);i.removeEventListener("dispose",r),delete s[i.id];var c=u[i.id];c&&(e.remove(c),delete u[i.id]),c=u[o.id],c&&(e.remove(c),delete u[o.id]),n.memory.geometries--}function i(t,e){var i=s[e.id];return i||(e.addEventListener("dispose",r),e.isBufferGeometry?i=e:e.isGeometry&&(void 0===e._bufferGeometry&&(e._bufferGeometry=(new B).setFromObject(t)),i=e._bufferGeometry),s[e.id]=i,n.memory.geometries++,i)}function o(n){var r=n.index,i=n.attributes;null!==r&&e.update(r,t.ELEMENT_ARRAY_BUFFER);for(var o in i)e.update(i[o],t.ARRAY_BUFFER);var a=n.morphAttributes;for(var o in a)for(var s=a[o],u=0,c=s.length;u<c;u++)e.update(s[u],t.ARRAY_BUFFER)}function a(n){var r=u[n.id];if(r)return r;var i=[],o=n.index,a=n.attributes;if(null!==o)for(var s=o.array,c=0,l=s.length;c<l;c+=3){var h=s[c+0],f=s[c+1],d=s[c+2];i.push(h,f,f,d,d,h)}else for(var s=a.position.array,c=0,l=s.length/3-1;c<l;c+=3){var h=c+0,f=c+1,d=c+2;i.push(h,f,f,d,d,h)}return r=new(F(i)>65535?O:N)(i,1),e.update(r,t.ELEMENT_ARRAY_BUFFER),u[n.id]=r,r}var s={},u={};return{get:i,update:o,getWireframeAttribute:a}}function rt(t,e,n){function r(t){s=t}function i(t){u=t.type,c=t.bytesPerElement}function o(e,r){t.drawElements(s,r,u,e*c),n.update(r,s)}function a(t,r,i){var o=e.get("ANGLE_instanced_arrays");if(null===o)return void console.error("THREE.WebGLIndexedBufferRenderer: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");o.drawElementsInstancedANGLE(s,i,u,r*c,t.maxInstancedCount),n.update(i,s,t.maxInstancedCount)}var s,u,c;this.setMode=r,this.setIndex=i,this.render=o,this.renderInstances=a}function it(t){function e(e,n,r){switch(r=r||1,i.calls++,n){case t.TRIANGLES:i.triangles+=r*(e/3);break;case t.TRIANGLE_STRIP:case t.TRIANGLE_FAN:i.triangles+=r*(e-2);break;case t.LINES:i.lines+=r*(e/2);break;case t.LINE_STRIP:i.lines+=r*(e-1);break;case t.LINE_LOOP:i.lines+=r*e;break;case t.POINTS:i.points+=r*e;break;default:console.error("THREE.WebGLInfo: Unknown draw mode:",n)}}function n(){i.frame++,i.calls=0,i.triangles=0,i.points=0,i.lines=0}var r={geometries:0,textures:0},i={frame:0,calls:0,triangles:0,points:0,lines:0};return{memory:r,render:i,programs:null,autoReset:!0,reset:n,update:e}}function ot(t,e){return Math.abs(e[1])-Math.abs(t[1])}function at(t){function e(e,i,o,a){var s=e.morphTargetInfluences,u=s.length,c=n[i.id];if(void 0===c){c=[];for(var l=0;l<u;l++)c[l]=[l,0];n[i.id]=c}for(var h=o.morphTargets&&i.morphAttributes.position,f=o.morphNormals&&i.morphAttributes.normal,l=0;l<u;l++){var d=c[l];0!==d[1]&&(h&&i.removeAttribute("morphTarget"+l),f&&i.removeAttribute("morphNormal"+l))}for(var l=0;l<u;l++){var d=c[l];d[0]=l,d[1]=s[l]}c.sort(ot);for(var l=0;l<8;l++){var d=c[l];if(d){var p=d[0],m=d[1];if(m){h&&i.addAttribute("morphTarget"+l,h[p]),f&&i.addAttribute("morphNormal"+l,f[p]),r[l]=m;continue}}r[l]=0}a.getUniforms().setValue(t,"morphTargetInfluences",r)}var n={},r=new Float32Array(8);return{update:e}}function st(t,e){function n(n){var r=e.render.frame,o=n.geometry,a=t.get(n,o);return i[a.id]!==r&&(o.isGeometry&&a.updateFromObject(n),t.update(a),i[a.id]=r),a}function r(){i={}}var i={};return{update:n,dispose:r}}function ut(t,e,n,r,i,o,a,s,u,l){t=void 0!==t?t:[],e=void 0!==e?e:es,c.call(this,t,e,n,r,i,o,a,s,u,l),this.flipY=!1}function ct(){this.seq=[],this.map={}}function lt(t,e,n){var r=t[0];if(r<=0||r>0)return t;var i=e*n,o=ju[i];if(void 0===o&&(o=new Float32Array(i),ju[i]=o),0!==e){r.toArray(o,0);for(var a=1,s=0;a!==e;++a)s+=n,t[a].toArray(o,s)}return o}function ht(t,e){var n=Hu[e];void 0===n&&(n=new Int32Array(e),Hu[e]=n);for(var r=0;r!==e;++r)n[r]=t.allocTextureUnit();return n}function ft(t,e){t.uniform1f(this.addr,e)}function dt(t,e){t.uniform1i(this.addr,e)}function pt(t,e){void 0===e.x?t.uniform2fv(this.addr,e):t.uniform2f(this.addr,e.x,e.y)}function mt(t,e){void 0!==e.x?t.uniform3f(this.addr,e.x,e.y,e.z):void 0!==e.r?t.uniform3f(this.addr,e.r,e.g,e.b):t.uniform3fv(this.addr,e)}function gt(t,e){void 0===e.x?t.uniform4fv(this.addr,e):t.uniform4f(this.addr,e.x,e.y,e.z,e.w)}function vt(t,e){t.uniformMatrix2fv(this.addr,!1,e.elements||e)}function yt(t,e){void 0===e.elements?t.uniformMatrix3fv(this.addr,!1,e):(zu.set(e.elements),t.uniformMatrix3fv(this.addr,!1,zu))}function _t(t,e){void 0===e.elements?t.uniformMatrix4fv(this.addr,!1,e):(Gu.set(e.elements),t.uniformMatrix4fv(this.addr,!1,Gu))}function bt(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTexture2D(e||Bu,r)}function wt(t,e,n){var r=n.allocTextureUnit();t.uniform1i(this.addr,r),n.setTextureCube(e||Vu,r)}function Et(t,e){t.uniform2iv(this.addr,e)}function xt(t,e){t.uniform3iv(this.addr,e)}function Tt(t,e){t.uniform4iv(this.addr,e)}function St(t){switch(t){case 5126:return ft;case 35664:return pt;case 35665:return mt;case 35666:return gt;case 35674:return vt;case 35675:return yt;case 35676:return _t;case 35678:case 36198:return bt;case 35680:return wt;case 5124:case 35670:return dt;case 35667:case 35671:return Et;case 35668:case 35672:return xt;case 35669:case 35673:return Tt}}function Ct(t,e){t.uniform1fv(this.addr,e)}function Mt(t,e){t.uniform1iv(this.addr,e)}function At(t,e){t.uniform2fv(this.addr,lt(e,this.size,2))}function It(t,e){t.uniform3fv(this.addr,lt(e,this.size,3))}function Rt(t,e){t.uniform4fv(this.addr,lt(e,this.size,4))}function Pt(t,e){t.uniformMatrix2fv(this.addr,!1,lt(e,this.size,4))}function Nt(t,e){t.uniformMatrix3fv(this.addr,!1,lt(e,this.size,9))}function Dt(t,e){t.uniformMatrix4fv(this.addr,!1,lt(e,this.size,16))}function Ot(t,e,n){var r=e.length,i=ht(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.setTexture2D(e[o]||Bu,i[o])}function kt(t,e,n){var r=e.length,i=ht(n,r);t.uniform1iv(this.addr,i);for(var o=0;o!==r;++o)n.setTextureCube(e[o]||Vu,i[o])}function Lt(t){switch(t){case 5126:return Ct;case 35664:return At;case 35665:return It;case 35666:return Rt;case 35674:return Pt;case 35675:return Nt;case 35676:return Dt;case 35678:return Ot;case 35680:return kt;case 5124:case 35670:return Mt;case 35667:case 35671:return Et;case 35668:case 35672:return xt;case 35669:case 35673:return Tt}}function Ut(t,e,n){this.id=t,this.addr=n,this.setValue=St(e.type)}function Ft(t,e,n){this.id=t,this.addr=n,this.size=e.size,this.setValue=Lt(e.type)}function Bt(t){this.id=t,ct.call(this)}function Vt(t,e){t.seq.push(e),t.map[e.id]=e}function jt(t,e,n){var r=t.name,i=r.length;for(Wu.lastIndex=0;;){var o=Wu.exec(r),a=Wu.lastIndex,s=o[1],u="]"===o[2],c=o[3];if(u&&(s|=0),void 0===c||"["===c&&a+2===i){Vt(n,void 0===c?new Ut(s,t,e):new Ft(s,t,e));break}var l=n.map,h=l[s];void 0===h&&(h=new Bt(s),Vt(n,h)),n=h}}function Ht(t,e,n){ct.call(this),this.renderer=n;for(var r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),i=0;i<r;++i){var o=t.getActiveUniform(e,i);jt(o,t.getUniformLocation(e,o.name),this)}}function Gt(t){for(var e=t.split("\n"),n=0;n<e.length;n++)e[n]=n+1+": "+e[n];return e.join("\n")}function zt(t,e,n){var r=t.createShader(e);return t.shaderSource(r,n),t.compileShader(r),!1===t.getShaderParameter(r,t.COMPILE_STATUS)&&console.error("THREE.WebGLShader: Shader couldn't compile."),""!==t.getShaderInfoLog(r)&&console.warn("THREE.WebGLShader: gl.getShaderInfoLog()",e===t.VERTEX_SHADER?"vertex":"fragment",t.getShaderInfoLog(r),Gt(n)),r}function Wt(t){switch(t){case yu:return["Linear","( value )"];case _u:return["sRGB","( value )"];case wu:return["RGBE","( value )"];case xu:return["RGBM","( value, 7.0 )"];case Tu:return["RGBM","( value, 16.0 )"];case Su:return["RGBD","( value, 256.0 )"];case bu:return["Gamma","( value, float( GAMMA_FACTOR ) )"];default:throw new Error("unsupported encoding: "+t)}}function qt(t,e){var n=Wt(e);return"vec4 "+t+"( vec4 value ) { return "+n[0]+"ToLinear"+n[1]+"; }"}function Yt(t,e){var n=Wt(e);return"vec4 "+t+"( vec4 value ) { return LinearTo"+n[0]+n[1]+"; }"}function Kt(t,e){var n;switch(e){case Xa:n="Linear";break;case Ja:n="Reinhard";break;case Za:n="Uncharted2";break;case $a:n="OptimizedCineon";break;default:throw new Error("unsupported toneMapping: "+e)}return"vec3 "+t+"( vec3 color ) { return "+n+"ToneMapping( color ); }"}function Qt(t,e,n){return t=t||{},[t.derivatives||e.envMapCubeUV||e.bumpMap||e.normalMap||e.flatShading?"#extension GL_OES_standard_derivatives : enable":"",(t.fragDepth||e.logarithmicDepthBuffer)&&n.get("EXT_frag_depth")?"#extension GL_EXT_frag_depth : enable":"",t.drawBuffers&&n.get("WEBGL_draw_buffers")?"#extension GL_EXT_draw_buffers : require":"",(t.shaderTextureLOD||e.envMap)&&n.get("EXT_shader_texture_lod")?"#extension GL_EXT_shader_texture_lod : enable":""].filter(Zt).join("\n")}function Xt(t){var e=[];for(var n in t){var r=t[n];!1!==r&&e.push("#define "+n+" "+r)}return e.join("\n")}function Jt(t,e){for(var n={},r=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<r;i++){var o=t.getActiveAttrib(e,i),a=o.name;n[a]=t.getAttribLocation(e,a)}return n}function Zt(t){return""!==t}function $t(t,e){return t.replace(/NUM_DIR_LIGHTS/g,e.numDirLights).replace(/NUM_SPOT_LIGHTS/g,e.numSpotLights).replace(/NUM_RECT_AREA_LIGHTS/g,e.numRectAreaLights).replace(/NUM_POINT_LIGHTS/g,e.numPointLights).replace(/NUM_HEMI_LIGHTS/g,e.numHemiLights)}function te(t,e){return t.replace(/NUM_CLIPPING_PLANES/g,e.numClippingPlanes).replace(/UNION_CLIPPING_PLANES/g,e.numClippingPlanes-e.numClipIntersection)}function ee(t){function e(t,e){var n=Ru[e];if(void 0===n)throw new Error("Can not resolve #include <"+e+">");return ee(n)}var n=/^[ \t]*#include +<([\w\d.]+)>/gm;return t.replace(n,e)}function ne(t){function e(t,e,n,r){for(var i="",o=parseInt(e);o<parseInt(n);o++)i+=r.replace(/\[ i \]/g,"[ "+o+" ]");return i}var n=/#pragma unroll_loop[\s]+?for \( int i \= (\d+)\; i < (\d+)\; i \+\+ \) \{([\s\S]+?)(?=\})\}/g;return t.replace(n,e)}function re(t,e,n,r,i,o){var a=t.context,s=r.defines,u=i.vertexShader,c=i.fragmentShader,l="SHADOWMAP_TYPE_BASIC";o.shadowMapType===aa?l="SHADOWMAP_TYPE_PCF":o.shadowMapType===sa&&(l="SHADOWMAP_TYPE_PCF_SOFT");var h="ENVMAP_TYPE_CUBE",f="ENVMAP_MODE_REFLECTION",d="ENVMAP_BLENDING_MULTIPLY";if(o.envMap){switch(r.envMap.mapping){case es:case ns:h="ENVMAP_TYPE_CUBE";break;case as:case ss:h="ENVMAP_TYPE_CUBE_UV";break;case rs:case is:h="ENVMAP_TYPE_EQUIREC";break;case os:h="ENVMAP_TYPE_SPHERE"}switch(r.envMap.mapping){case ns:case is:f="ENVMAP_MODE_REFRACTION"}switch(r.combine){case qa:d="ENVMAP_BLENDING_MULTIPLY";break;case Ya:d="ENVMAP_BLENDING_MIX";break;case Ka:d="ENVMAP_BLENDING_ADD"}}var p,m,g=t.gammaFactor>0?t.gammaFactor:1,v=Qt(r.extensions,o,e),y=Xt(s),_=a.createProgram();r.isRawShaderMaterial?(p=[y].filter(Zt).join("\n"),p.length>0&&(p+="\n"),m=[v,y].filter(Zt).join("\n"),m.length>0&&(m+="\n")):(p=["precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,y,o.supportsVertexTextures?"#define VERTEX_TEXTURES":"","#define GAMMA_FACTOR "+g,"#define MAX_BONES "+o.maxBones,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+f:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.displacementMap&&o.supportsVertexTextures?"#define USE_DISPLACEMENTMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.flatShading?"#define FLAT_SHADED":"",o.skinning?"#define USE_SKINNING":"",o.useVertexTexture?"#define BONE_TEXTURE":"",o.morphTargets?"#define USE_MORPHTARGETS":"",o.morphNormals&&!1===o.flatShading?"#define USE_MORPHNORMALS":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+l:"",o.sizeAttenuation?"#define USE_SIZEATTENUATION":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"","uniform mat4 modelMatrix;","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform mat4 viewMatrix;","uniform mat3 normalMatrix;","uniform vec3 cameraPosition;","attribute vec3 position;","attribute vec3 normal;","attribute vec2 uv;","#ifdef USE_COLOR","\tattribute vec3 color;","#endif","#ifdef USE_MORPHTARGETS","\tattribute vec3 morphTarget0;","\tattribute vec3 morphTarget1;","\tattribute vec3 morphTarget2;","\tattribute vec3 morphTarget3;","\t#ifdef USE_MORPHNORMALS","\t\tattribute vec3 morphNormal0;","\t\tattribute vec3 morphNormal1;","\t\tattribute vec3 morphNormal2;","\t\tattribute vec3 morphNormal3;","\t#else","\t\tattribute vec3 morphTarget4;","\t\tattribute vec3 morphTarget5;","\t\tattribute vec3 morphTarget6;","\t\tattribute vec3 morphTarget7;","\t#endif","#endif","#ifdef USE_SKINNING","\tattribute vec4 skinIndex;","\tattribute vec4 skinWeight;","#endif","\n"].filter(Zt).join("\n"),m=[v,"precision "+o.precision+" float;","precision "+o.precision+" int;","#define SHADER_NAME "+i.name,y,o.alphaTest?"#define ALPHATEST "+o.alphaTest:"","#define GAMMA_FACTOR "+g,o.useFog&&o.fog?"#define USE_FOG":"",o.useFog&&o.fogExp?"#define FOG_EXP2":"",o.map?"#define USE_MAP":"",o.envMap?"#define USE_ENVMAP":"",o.envMap?"#define "+h:"",o.envMap?"#define "+f:"",o.envMap?"#define "+d:"",o.lightMap?"#define USE_LIGHTMAP":"",o.aoMap?"#define USE_AOMAP":"",o.emissiveMap?"#define USE_EMISSIVEMAP":"",o.bumpMap?"#define USE_BUMPMAP":"",o.normalMap?"#define USE_NORMALMAP":"",o.specularMap?"#define USE_SPECULARMAP":"",o.roughnessMap?"#define USE_ROUGHNESSMAP":"",o.metalnessMap?"#define USE_METALNESSMAP":"",o.alphaMap?"#define USE_ALPHAMAP":"",o.vertexColors?"#define USE_COLOR":"",o.gradientMap?"#define USE_GRADIENTMAP":"",o.flatShading?"#define FLAT_SHADED":"",o.doubleSided?"#define DOUBLE_SIDED":"",o.flipSided?"#define FLIP_SIDED":"",o.shadowMapEnabled?"#define USE_SHADOWMAP":"",o.shadowMapEnabled?"#define "+l:"",o.premultipliedAlpha?"#define PREMULTIPLIED_ALPHA":"",o.physicallyCorrectLights?"#define PHYSICALLY_CORRECT_LIGHTS":"",o.logarithmicDepthBuffer?"#define USE_LOGDEPTHBUF":"",o.logarithmicDepthBuffer&&e.get("EXT_frag_depth")?"#define USE_LOGDEPTHBUF_EXT":"",o.envMap&&e.get("EXT_shader_texture_lod")?"#define TEXTURE_LOD_EXT":"","uniform mat4 viewMatrix;","uniform vec3 cameraPosition;",o.toneMapping!==Qa?"#define TONE_MAPPING":"",o.toneMapping!==Qa?Ru.tonemapping_pars_fragment:"",o.toneMapping!==Qa?Kt("toneMapping",o.toneMapping):"",o.dithering?"#define DITHERING":"",o.outputEncoding||o.mapEncoding||o.envMapEncoding||o.emissiveMapEncoding?Ru.encodings_pars_fragment:"",o.mapEncoding?qt("mapTexelToLinear",o.mapEncoding):"",o.envMapEncoding?qt("envMapTexelToLinear",o.envMapEncoding):"",o.emissiveMapEncoding?qt("emissiveMapTexelToLinear",o.emissiveMapEncoding):"",o.outputEncoding?Yt("linearToOutputTexel",o.outputEncoding):"",o.depthPacking?"#define DEPTH_PACKING "+r.depthPacking:"","\n"].filter(Zt).join("\n")),u=ee(u),u=$t(u,o),u=te(u,o),c=ee(c),c=$t(c,o),c=te(c,o),u=ne(u),c=ne(c);var b=p+u,w=m+c,E=zt(a,a.VERTEX_SHADER,b),x=zt(a,a.FRAGMENT_SHADER,w);a.attachShader(_,E),a.attachShader(_,x),void 0!==r.index0AttributeName?a.bindAttribLocation(_,0,r.index0AttributeName):!0===o.morphTargets&&a.bindAttribLocation(_,0,"position"),a.linkProgram(_);var T=a.getProgramInfoLog(_).trim(),S=a.getShaderInfoLog(E).trim(),C=a.getShaderInfoLog(x).trim(),M=!0,A=!0;!1===a.getProgramParameter(_,a.LINK_STATUS)?(M=!1,console.error("THREE.WebGLProgram: shader error: ",a.getError(),"gl.VALIDATE_STATUS",a.getProgramParameter(_,a.VALIDATE_STATUS),"gl.getProgramInfoLog",T,S,C)):""!==T?console.warn("THREE.WebGLProgram: gl.getProgramInfoLog()",T):""!==S&&""!==C||(A=!1),A&&(this.diagnostics={runnable:M,material:r,programLog:T,vertexShader:{log:S,prefix:p},fragmentShader:{log:C,prefix:m}}),a.deleteShader(E),a.deleteShader(x);var I;this.getUniforms=function(){return void 0===I&&(I=new Ht(a,_,t)),I};var R;return this.getAttributes=function(){return void 0===R&&(R=Jt(a,_)),R},this.destroy=function(){a.deleteProgram(_),this.program=void 0},Object.defineProperties(this,{uniforms:{get:function(){return console.warn("THREE.WebGLProgram: .uniforms is now .getUniforms()."),this.getUniforms()}},attributes:{get:function(){return console.warn("THREE.WebGLProgram: .attributes is now .getAttributes()."),this.getAttributes()}}}),this.name=i.name,this.id=qu++,this.code=n,this.usedTimes=1,this.program=_,this.vertexShader=E,this.fragmentShader=x,this}function ie(t,e,n){function r(t){var e=t.skeleton,r=e.bones;if(n.floatVertexTextures)return 1024;var i=n.maxVertexUniforms,o=Math.floor((i-20)/4),a=Math.min(o,r.length);return a<r.length?(console.warn("THREE.WebGLRenderer: Skeleton has "+r.length+" bones. This GPU supports "+a+"."),0):a}function i(t,e){var n;return t?t.isTexture?n=t.encoding:t.isWebGLRenderTarget&&(console.warn("THREE.WebGLPrograms.getTextureEncodingFromMap: don't use render targets as textures. Use their .texture property instead."),n=t.texture.encoding):n=yu,n===yu&&e&&(n=bu),n}var o=[],a={MeshDepthMaterial:"depth",MeshDistanceMaterial:"distanceRGBA",MeshNormalMaterial:"normal",MeshBasicMaterial:"basic",MeshLambertMaterial:"lambert",MeshPhongMaterial:"phong",MeshToonMaterial:"phong",MeshStandardMaterial:"physical",MeshPhysicalMaterial:"physical",LineBasicMaterial:"basic",LineDashedMaterial:"dashed",PointsMaterial:"points",ShadowMaterial:"shadow"},s=["precision","supportsVertexTextures","map","mapEncoding","envMap","envMapMode","envMapEncoding","lightMap","aoMap","emissiveMap","emissiveMapEncoding","bumpMap","normalMap","displacementMap","specularMap","roughnessMap","metalnessMap","gradientMap","alphaMap","combine","vertexColors","fog","useFog","fogExp","flatShading","sizeAttenuation","logarithmicDepthBuffer","skinning","maxBones","useVertexTexture","morphTargets","morphNormals","maxMorphTargets","maxMorphNormals","premultipliedAlpha","numDirLights","numPointLights","numSpotLights","numHemiLights","numRectAreaLights","shadowMapEnabled","shadowMapType","toneMapping","physicallyCorrectLights","alphaTest","doubleSided","flipSided","numClippingPlanes","numClipIntersection","depthPacking","dithering"];this.getParameters=function(e,o,s,u,c,l,h){var f=a[e.type],d=h.isSkinnedMesh?r(h):0,p=n.precision;null!==e.precision&&(p=n.getMaxPrecision(e.precision))!==e.precision&&console.warn("THREE.WebGLProgram.getParameters:",e.precision,"not supported, using",p,"instead.");var m=t.getRenderTarget();return{shaderID:f,precision:p,supportsVertexTextures:n.vertexTextures,outputEncoding:i(m?m.texture:null,t.gammaOutput),map:!!e.map,mapEncoding:i(e.map,t.gammaInput),envMap:!!e.envMap,envMapMode:e.envMap&&e.envMap.mapping,envMapEncoding:i(e.envMap,t.gammaInput),envMapCubeUV:!!e.envMap&&(e.envMap.mapping===as||e.envMap.mapping===ss),lightMap:!!e.lightMap,aoMap:!!e.aoMap,emissiveMap:!!e.emissiveMap,emissiveMapEncoding:i(e.emissiveMap,t.gammaInput),bumpMap:!!e.bumpMap,normalMap:!!e.normalMap,displacementMap:!!e.displacementMap,roughnessMap:!!e.roughnessMap,metalnessMap:!!e.metalnessMap,specularMap:!!e.specularMap,alphaMap:!!e.alphaMap,gradientMap:!!e.gradientMap,combine:e.combine,vertexColors:e.vertexColors,fog:!!u,useFog:e.fog,fogExp:u&&u.isFogExp2,flatShading:e.flatShading,sizeAttenuation:e.sizeAttenuation,logarithmicDepthBuffer:n.logarithmicDepthBuffer,skinning:e.skinning&&d>0,maxBones:d,useVertexTexture:n.floatVertexTextures,morphTargets:e.morphTargets,morphNormals:e.morphNormals,maxMorphTargets:t.maxMorphTargets,maxMorphNormals:t.maxMorphNormals,numDirLights:o.directional.length,numPointLights:o.point.length,numSpotLights:o.spot.length,numRectAreaLights:o.rectArea.length,numHemiLights:o.hemi.length,numClippingPlanes:c,numClipIntersection:l,dithering:e.dithering,shadowMapEnabled:t.shadowMap.enabled&&h.receiveShadow&&s.length>0,shadowMapType:t.shadowMap.type,toneMapping:t.toneMapping,physicallyCorrectLights:t.physicallyCorrectLights,premultipliedAlpha:e.premultipliedAlpha,alphaTest:e.alphaTest,doubleSided:e.side===la,flipSided:e.side===ca,depthPacking:void 0!==e.depthPacking&&e.depthPacking}},this.getProgramCode=function(e,n){var r=[];if(n.shaderID?r.push(n.shaderID):(r.push(e.fragmentShader),r.push(e.vertexShader)),void 0!==e.defines)for(var i in e.defines)r.push(i),r.push(e.defines[i]);for(var o=0;o<s.length;o++)r.push(n[s[o]]);return r.push(e.onBeforeCompile.toString()),r.push(t.gammaOutput),r.join()},this.acquireProgram=function(n,r,i,a){for(var s,u=0,c=o.length;u<c;u++){var l=o[u];if(l.code===a){s=l,++s.usedTimes;break}}return void 0===s&&(s=new re(t,e,a,n,r,i),o.push(s)),s},this.releaseProgram=function(t){if(0===--t.usedTimes){var e=o.indexOf(t);o[e]=o[o.length-1],o.pop(),t.destroy()}},this.programs=o}function oe(){function t(t){var e=i.get(t);return void 0===e&&(e={},i.set(t,e)),e}function e(t){i.delete(t)}function n(t,e,n){i.get(t)[e]=n}function r(){i=new WeakMap}var i=new WeakMap;return{get:t,remove:e,update:n,dispose:r}}function ae(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.program&&e.program&&t.program!==e.program?t.program.id-e.program.id:t.material.id!==e.material.id?t.material.id-e.material.id:t.z!==e.z?t.z-e.z:t.id-e.id}function se(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:t.id-e.id}function ue(){function t(){i=0,o.length=0,a.length=0}function e(t,e,n,s,u){var c=r[i];void 0===c?(c={id:t.id,object:t,geometry:e,material:n,program:n.program,renderOrder:t.renderOrder,z:s,group:u},r[i]=c):(c.id=t.id,c.object=t,c.geometry=e,c.material=n,c.program=n.program,c.renderOrder=t.renderOrder,c.z=s,c.group=u),(!0===n.transparent?a:o).push(c),i++}function n(){o.length>1&&o.sort(ae),a.length>1&&a.sort(se)}var r=[],i=0,o=[],a=[];return{opaque:o,transparent:a,init:t,push:e,sort:n}}function ce(){function t(t,e){var r=t.id+","+e.id,i=n[r];return void 0===i&&(i=new ue,n[r]=i),i}function e(){n={}}var n={};return{get:t,dispose:e}}function le(){var t={};return{get:function(e){if(void 0!==t[e.id])return t[e.id];var n;switch(e.type){case"DirectionalLight":n={direction:new s,color:new y,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"SpotLight":n={position:new s,direction:new s,color:new y,distance:0,coneCos:0,penumbraCos:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i};break;case"PointLight":n={position:new s,color:new y,distance:0,decay:0,shadow:!1,shadowBias:0,shadowRadius:1,shadowMapSize:new i,shadowCameraNear:1,shadowCameraFar:1e3};break;case"HemisphereLight":n={direction:new s,skyColor:new y,groundColor:new y};break;case"RectAreaLight":n={color:new y,position:new s,halfWidth:new s,halfHeight:new s}}return t[e.id]=n,n}}}function he(){function t(t,o,s){for(var u=0,c=0,l=0,h=0,f=0,d=0,p=0,m=0,g=s.matrixWorldInverse,v=0,y=t.length;v<y;v++){var _=t[v],b=_.color,w=_.intensity,E=_.distance,x=_.shadow&&_.shadow.map?_.shadow.map.texture:null;if(_.isAmbientLight)u+=b.r*w,c+=b.g*w,l+=b.b*w;else if(_.isDirectionalLight){var T=e.get(_);if(T.color.copy(_.color).multiplyScalar(_.intensity),T.direction.setFromMatrixPosition(_.matrixWorld),r.setFromMatrixPosition(_.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(g),T.shadow=_.castShadow,_.castShadow){var S=_.shadow;T.shadowBias=S.bias,T.shadowRadius=S.radius,T.shadowMapSize=S.mapSize}n.directionalShadowMap[h]=x,n.directionalShadowMatrix[h]=_.shadow.matrix,n.directional[h]=T,h++}else if(_.isSpotLight){var T=e.get(_);if(T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(g),T.color.copy(b).multiplyScalar(w),T.distance=E,T.direction.setFromMatrixPosition(_.matrixWorld),r.setFromMatrixPosition(_.target.matrixWorld),T.direction.sub(r),T.direction.transformDirection(g),T.coneCos=Math.cos(_.angle),T.penumbraCos=Math.cos(_.angle*(1-_.penumbra)),T.decay=0===_.distance?0:_.decay,T.shadow=_.castShadow,_.castShadow){var S=_.shadow;T.shadowBias=S.bias,T.shadowRadius=S.radius,T.shadowMapSize=S.mapSize}n.spotShadowMap[d]=x,n.spotShadowMatrix[d]=_.shadow.matrix,n.spot[d]=T,d++}else if(_.isRectAreaLight){var T=e.get(_);T.color.copy(b).multiplyScalar(w),T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(g),a.identity(),i.copy(_.matrixWorld),i.premultiply(g),a.extractRotation(i),T.halfWidth.set(.5*_.width,0,0),T.halfHeight.set(0,.5*_.height,0),T.halfWidth.applyMatrix4(a),T.halfHeight.applyMatrix4(a),n.rectArea[p]=T,p++}else if(_.isPointLight){var T=e.get(_);if(T.position.setFromMatrixPosition(_.matrixWorld),T.position.applyMatrix4(g),T.color.copy(_.color).multiplyScalar(_.intensity),T.distance=_.distance,T.decay=0===_.distance?0:_.decay,T.shadow=_.castShadow,_.castShadow){var S=_.shadow;T.shadowBias=S.bias,T.shadowRadius=S.radius,T.shadowMapSize=S.mapSize,T.shadowCameraNear=S.camera.near,T.shadowCameraFar=S.camera.far}n.pointShadowMap[f]=x,n.pointShadowMatrix[f]=_.shadow.matrix,n.point[f]=T,f++}else if(_.isHemisphereLight){var T=e.get(_);T.direction.setFromMatrixPosition(_.matrixWorld),T.direction.transformDirection(g),T.direction.normalize(),T.skyColor.copy(_.color).multiplyScalar(w),T.groundColor.copy(_.groundColor).multiplyScalar(w),n.hemi[m]=T,m++}}n.ambient[0]=u,n.ambient[1]=c,n.ambient[2]=l,n.directional.length=h,n.spot.length=d,n.rectArea.length=p,n.point.length=f,n.hemi.length=m,n.hash=n.id+","+h+","+f+","+d+","+p+","+m+","+o.length}var e=new le,n={id:Yu++,hash:"",ambient:[0,0,0],directional:[],directionalShadowMap:[],directionalShadowMatrix:[],spot:[],spotShadowMap:[],spotShadowMatrix:[],rectArea:[],point:[],pointShadowMap:[],pointShadowMatrix:[],hemi:[]},r=new s,i=new o,a=new o;return{setup:t,state:n}}function fe(){function t(){a.length=0,s.length=0,u.length=0}function e(t){a.push(t)}function n(t){s.push(t)}function r(t){u.push(t)}function i(t){o.setup(a,s,t)}var o=new he,a=[],s=[],u=[];return{init:t,state:{lightsArray:a,shadowsArray:s,spritesArray:u,lights:o},setupLights:i,pushLight:e,pushShadow:n,pushSprite:r}}function de(){function t(t,e){var r=t.id+","+e.id,i=n[r];return void 0===i&&(i=new fe,n[r]=i),i}function e(){n={}}var n={};return{get:t,dispose:e}}function pe(t){z.call(this),this.type="MeshDepthMaterial",this.depthPacking=Cu,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.setValues(t)}function me(t){z.call(this),this.type="MeshDistanceMaterial",this.referencePosition=new s,this.nearDistance=1,this.farDistance=1e3,this.skinning=!1,this.morphTargets=!1,this.map=null,this.alphaMap=null,this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.fog=!1,this.lights=!1,this.setValues(t)}function ge(t,e,n){function r(e,n,r,i,o,a){var s=e.geometry,u=null,c=b,l=e.customDepthMaterial;if(r&&(c=w,l=e.customDistanceMaterial),l)u=l;else{var h=!1;n.morphTargets&&(s&&s.isBufferGeometry?h=s.morphAttributes&&s.morphAttributes.position&&s.morphAttributes.position.length>0:s&&s.isGeometry&&(h=s.morphTargets&&s.morphTargets.length>0)),e.isSkinnedMesh&&!1===n.skinning&&console.warn("THREE.WebGLShadowMap: THREE.SkinnedMesh with material.skinning set to false:",e);var f=e.isSkinnedMesh&&n.skinning,d=0;h&&(d|=g),f&&(d|=y),u=c[d]}if(t.localClippingEnabled&&!0===n.clipShadows&&0!==n.clippingPlanes.length){var p=u.uuid,m=n.uuid,v=E[p];void 0===v&&(v={},E[p]=v);var _=v[m];void 0===_&&(_=u.clone(),v[m]=_),u=_}return u.visible=n.visible,u.wireframe=n.wireframe,u.side=null!=n.shadowSide?n.shadowSide:x[n.side],u.clipShadows=n.clipShadows,u.clippingPlanes=n.clippingPlanes,u.clipIntersection=n.clipIntersection,u.wireframeLinewidth=n.wireframeLinewidth,u.linewidth=n.linewidth,r&&u.isMeshDistanceMaterial&&(u.referencePosition.copy(i),u.nearDistance=o,u.farDistance=a),u}function a(n,i,o,s){if(!1!==n.visible){if(n.layers.test(i.layers)&&(n.isMesh||n.isLine||n.isPoints)&&n.castShadow&&(!n.frustumCulled||u.intersectsObject(n))){n.modelViewMatrix.multiplyMatrices(o.matrixWorldInverse,n.matrixWorld);var c=e.update(n),l=n.material;if(Array.isArray(l))for(var h=c.groups,f=0,d=h.length;f<d;f++){var p=h[f],g=l[p.materialIndex];if(g&&g.visible){var v=r(n,g,s,m,o.near,o.far);t.renderBufferDirect(o,null,c,v,n,p)}}else if(l.visible){var v=r(n,l,s,m,o.near,o.far);t.renderBufferDirect(o,null,c,v,n,null)}}for(var y=n.children,_=0,b=y.length;_<b;_++)a(y[_],i,o,s)}}for(var u=new v,c=new o,f=new i,d=new i(n,n),p=new s,m=new s,g=1,y=2,_=1+(g|y),b=new Array(_),w=new Array(_),E={},x={0:ca,1:ua,2:la},T=[new s(1,0,0),new s(-1,0,0),new s(0,0,1),new s(0,0,-1),new s(0,1,0),new s(0,-1,0)],S=[new s(0,1,0),new s(0,1,0),new s(0,1,0),new s(0,1,0),new s(0,0,1),new s(0,0,-1)],C=[new l,new l,new l,new l,new l,new l],M=0;M!==_;++M){var A=0!==(M&g),I=0!==(M&y),R=new pe({depthPacking:Mu,morphTargets:A,skinning:I});b[M]=R;var P=new me({morphTargets:A,skinning:I});w[M]=P}var N=this;this.enabled=!1,this.autoUpdate=!0,this.needsUpdate=!1,this.type=aa,this.render=function(e,n,r){if(!1!==N.enabled&&(!1!==N.autoUpdate||!1!==N.needsUpdate)&&0!==e.length){var i=t.context,o=t.state;o.disable(i.BLEND),o.buffers.color.setClear(1,1,1,1),o.buffers.depth.setTest(!0),o.setScissorTest(!1);for(var s,l=0,g=e.length;l<g;l++){var v=e[l],y=v.shadow,_=v&&v.isPointLight;if(void 0!==y){var b=y.camera;if(f.copy(y.mapSize),f.min(d),_){var w=f.x,E=f.y;C[0].set(2*w,E,w,E),C[1].set(0,E,w,E),C[2].set(3*w,E,w,E),C[3].set(w,E,w,E),C[4].set(3*w,0,w,E),C[5].set(w,0,w,E),f.x*=4,f.y*=2}if(null===y.map){var x={minFilter:hs,magFilter:hs,format:Ps};y.map=new h(f.x,f.y,x),y.map.texture.name=v.name+".shadowMap",b.updateProjectionMatrix()}y.isSpotLightShadow&&y.update(v);var M=y.map,A=y.matrix;m.setFromMatrixPosition(v.matrixWorld),b.position.copy(m),_?(s=6,A.makeTranslation(-m.x,-m.y,-m.z)):(s=1,p.setFromMatrixPosition(v.target.matrixWorld),b.lookAt(p),b.updateMatrixWorld(),A.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),A.multiply(b.projectionMatrix),A.multiply(b.matrixWorldInverse)),t.setRenderTarget(M),t.clear();for(var I=0;I<s;I++){if(_){p.copy(b.position),p.add(T[I]),b.up.copy(S[I]),b.lookAt(p),b.updateMatrixWorld();var R=C[I];o.viewport(R)}c.multiplyMatrices(b.projectionMatrix,b.matrixWorldInverse),u.setFromMatrix(c),a(n,r,b,_)}}else console.warn("THREE.WebGLShadowMap:",v,"has no shadow.")}N.needsUpdate=!1}}}function ve(t,e,n,r,i,o,a,s,u){c.call(this,t,e,n,r,i,o,a,s,u),this.needsUpdate=!0}function ye(t,e,n,r,i){function o(){var t=new Float32Array([-.5,-.5,0,0,.5,-.5,1,0,.5,.5,1,1,-.5,.5,0,1]),n=new Uint16Array([0,1,2,0,2,3]);l=e.createBuffer(),h=e.createBuffer(),e.bindBuffer(e.ARRAY_BUFFER,l),e.bufferData(e.ARRAY_BUFFER,t,e.STATIC_DRAW),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,h),e.bufferData(e.ELEMENT_ARRAY_BUFFER,n,e.STATIC_DRAW),f=u(),d={position:e.getAttribLocation(f,"position"),uv:e.getAttribLocation(f,"uv")},p={uvOffset:e.getUniformLocation(f,"uvOffset"),uvScale:e.getUniformLocation(f,"uvScale"),rotation:e.getUniformLocation(f,"rotation"),center:e.getUniformLocation(f,"center"),scale:e.getUniformLocation(f,"scale"),color:e.getUniformLocation(f,"color"),map:e.getUniformLocation(f,"map"),opacity:e.getUniformLocation(f,"opacity"),modelViewMatrix:e.getUniformLocation(f,"modelViewMatrix"),projectionMatrix:e.getUniformLocation(f,"projectionMatrix"),fogType:e.getUniformLocation(f,"fogType"),fogDensity:e.getUniformLocation(f,"fogDensity"),fogNear:e.getUniformLocation(f,"fogNear"),fogFar:e.getUniformLocation(f,"fogFar"),fogColor:e.getUniformLocation(f,"fogColor"),fogDepth:e.getUniformLocation(f,"fogDepth"),alphaTest:e.getUniformLocation(f,"alphaTest")};var r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");r.width=8,r.height=8;var i=r.getContext("2d");i.fillStyle="white",i.fillRect(0,0,8,8),m=new ve(r)}function u(){var t=e.createProgram(),n=e.createShader(e.VERTEX_SHADER),r=e.createShader(e.FRAGMENT_SHADER);return e.shaderSource(n,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform mat4 modelViewMatrix;","uniform mat4 projectionMatrix;","uniform float rotation;","uniform vec2 center;","uniform vec2 scale;","uniform vec2 uvOffset;","uniform vec2 uvScale;","attribute vec2 position;","attribute vec2 uv;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvUV = uvOffset + uv * uvScale;","\tvec2 alignedPosition = ( position - center ) * scale;","\tvec2 rotatedPosition;","\trotatedPosition.x = cos( rotation ) * alignedPosition.x - sin( rotation ) * alignedPosition.y;","\trotatedPosition.y = sin( rotation ) * alignedPosition.x + cos( rotation ) * alignedPosition.y;","\tvec4 mvPosition;","\tmvPosition = modelViewMatrix * vec4( 0.0, 0.0, 0.0, 1.0 );","\tmvPosition.xy += rotatedPosition;","\tgl_Position = projectionMatrix * mvPosition;","\tfogDepth = - mvPosition.z;","}"].join("\n")),e.shaderSource(r,["precision "+i.precision+" float;","#define SHADER_NAME SpriteMaterial","uniform vec3 color;","uniform sampler2D map;","uniform float opacity;","uniform int fogType;","uniform vec3 fogColor;","uniform float fogDensity;","uniform float fogNear;","uniform float fogFar;","uniform float alphaTest;","varying vec2 vUV;","varying float fogDepth;","void main() {","\tvec4 texture = texture2D( map, vUV );","\tgl_FragColor = vec4( color * texture.xyz, texture.a * opacity );","\tif ( gl_FragColor.a < alphaTest ) discard;","\tif ( fogType > 0 ) {","\t\tfloat fogFactor = 0.0;","\t\tif ( fogType == 1 ) {","\t\t\tfogFactor = smoothstep( fogNear, fogFar, fogDepth );","\t\t} else {","\t\t\tconst float LOG2 = 1.442695;","\t\t\tfogFactor = exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 );","\t\t\tfogFactor = 1.0 - clamp( fogFactor, 0.0, 1.0 );","\t\t}","\t\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );","\t}","}"].join("\n")),e.compileShader(n),e.compileShader(r),e.attachShader(t,n),e.attachShader(t,r),e.linkProgram(t),t}function c(t,e){return t.renderOrder!==e.renderOrder?t.renderOrder-e.renderOrder:t.z!==e.z?e.z-t.z:e.id-t.id}var l,h,f,d,p,m,g=new s,v=new a,y=new s;this.render=function(i,a,s){if(0!==i.length){void 0===f&&o(),n.useProgram(f),n.initAttributes(),n.enableAttribute(d.position),n.enableAttribute(d.uv),n.disableUnusedAttributes(),n.disable(e.CULL_FACE),n.enable(e.BLEND),e.bindBuffer(e.ARRAY_BUFFER,l),e.vertexAttribPointer(d.position,2,e.FLOAT,!1,16,0),e.vertexAttribPointer(d.uv,2,e.FLOAT,!1,16,8),e.bindBuffer(e.ELEMENT_ARRAY_BUFFER,h),e.uniformMatrix4fv(p.projectionMatrix,!1,s.projectionMatrix.elements),n.activeTexture(e.TEXTURE0),e.uniform1i(p.map,0);var u=0,_=0,b=a.fog;b?(e.uniform3f(p.fogColor,b.color.r,b.color.g,b.color.b),b.isFog?(e.uniform1f(p.fogNear,b.near),e.uniform1f(p.fogFar,b.far),e.uniform1i(p.fogType,1),u=1,_=1):b.isFogExp2&&(e.uniform1f(p.fogDensity,b.density),e.uniform1i(p.fogType,2),u=2,_=2)):(e.uniform1i(p.fogType,0),u=0,_=0);for(var w=0,E=i.length;w<E;w++){var x=i[w];x.modelViewMatrix.multiplyMatrices(s.matrixWorldInverse,x.matrixWorld),x.z=-x.modelViewMatrix.elements[14]}i.sort(c);for(var T=[],S=[],w=0,E=i.length;w<E;w++){var x=i[w],C=x.material;if(!1!==C.visible){x.onBeforeRender(t,a,s,void 0,C,void 0),e.uniform1f(p.alphaTest,C.alphaTest),e.uniformMatrix4fv(p.modelViewMatrix,!1,x.modelViewMatrix.elements),x.matrixWorld.decompose(g,v,y),T[0]=y.x,T[1]=y.y,S[0]=x.center.x-.5,S[1]=x.center.y-.5;var M=0;a.fog&&C.fog&&(M=_),u!==M&&(e.uniform1i(p.fogType,M),u=M),null!==C.map?(e.uniform2f(p.uvOffset,C.map.offset.x,C.map.offset.y),e.uniform2f(p.uvScale,C.map.repeat.x,C.map.repeat.y)):(e.uniform2f(p.uvOffset,0,0),e.uniform2f(p.uvScale,1,1)),e.uniform1f(p.opacity,C.opacity),e.uniform3f(p.color,C.color.r,C.color.g,C.color.b),e.uniform1f(p.rotation,C.rotation),e.uniform2fv(p.center,S),e.uniform2fv(p.scale,T),n.setBlending(C.blending,C.blendEquation,C.blendSrc,C.blendDst,C.blendEquationAlpha,C.blendSrcAlpha,C.blendDstAlpha,C.premultipliedAlpha),n.buffers.depth.setTest(C.depthTest),n.buffers.depth.setMask(C.depthWrite),n.buffers.color.setMask(C.colorWrite),r.setTexture2D(C.map||m,0),e.drawElements(e.TRIANGLES,6,e.UNSIGNED_SHORT,0),x.onAfterRender(t,a,s,void 0,C,void 0)}}n.enable(e.CULL_FACE),n.reset()}}}function _e(t,e,n){function r(){var e=!1,n=new l,r=null,i=new l(0,0,0,0);return{setMask:function(n){r===n||e||(t.colorMask(n,n,n,n),r=n)},setLocked:function(t){e=t},setClear:function(e,r,o,a,s){!0===s&&(e*=a,r*=a,o*=a),n.set(e,r,o,a),!1===i.equals(n)&&(t.clearColor(e,r,o,a),i.copy(n))},reset:function(){e=!1,r=null,i.set(-1,0,0,0)}}}function i(){var e=!1,n=null,r=null,i=null;return{setTest:function(e){e?f(t.DEPTH_TEST):d(t.DEPTH_TEST)},setMask:function(r){n===r||e||(t.depthMask(r),n=r)},setFunc:function(e){if(r!==e){if(e)switch(e){case Fa:t.depthFunc(t.NEVER);break;case Ba:t.depthFunc(t.ALWAYS);break;case Va:t.depthFunc(t.LESS);break;case ja:t.depthFunc(t.LEQUAL);break;case Ha:t.depthFunc(t.EQUAL);break;case Ga:t.depthFunc(t.GEQUAL);break;case za:t.depthFunc(t.GREATER);break;case Wa:t.depthFunc(t.NOTEQUAL);break;default:t.depthFunc(t.LEQUAL)}else t.depthFunc(t.LEQUAL);r=e}},setLocked:function(t){e=t},setClear:function(e){i!==e&&(t.clearDepth(e),i=e)},reset:function(){e=!1,n=null,r=null,i=null}}}function o(){var e=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,c=null;return{setTest:function(e){e?f(t.STENCIL_TEST):d(t.STENCIL_TEST)},setMask:function(r){n===r||e||(t.stencilMask(r),n=r)},setFunc:function(e,n,a){r===e&&i===n&&o===a||(t.stencilFunc(e,n,a),r=e,i=n,o=a)},setOp:function(e,n,r){a===e&&s===n&&u===r||(t.stencilOp(e,n,r),a=e,s=n,u=r)},setLocked:function(t){e=t},setClear:function(e){c!==e&&(t.clearStencil(e),c=e)},reset:function(){e=!1,n=null,r=null,i=null,o=null,a=null,s=null,u=null,c=null}}}function a(e,n,r){var i=new Uint8Array(4),o=t.createTexture();t.bindTexture(e,o),t.texParameteri(e,t.TEXTURE_MIN_FILTER,t.NEAREST),t.texParameteri(e,t.TEXTURE_MAG_FILTER,t.NEAREST);for(var a=0;a<r;a++)t.texImage2D(n+a,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,i);return o}function s(){for(var t=0,e=O.length;t<e;t++)O[t]=0}function u(n){if(O[n]=1,0===k[n]&&(t.enableVertexAttribArray(n),k[n]=1),0!==L[n]){e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,0),L[n]=0}}function c(n,r){if(O[n]=1,0===k[n]&&(t.enableVertexAttribArray(n),k[n]=1),L[n]!==r){e.get("ANGLE_instanced_arrays").vertexAttribDivisorANGLE(n,r),L[n]=r}}function h(){for(var e=0,n=k.length;e!==n;++e)k[e]!==O[e]&&(t.disableVertexAttribArray(e),k[e]=0)}function f(e){!0!==U[e]&&(t.enable(e),U[e]=!0)}function d(e){!1!==U[e]&&(t.disable(e),U[e]=!1)}function p(){if(null===F&&(F=[],e.get("WEBGL_compressed_texture_pvrtc")||e.get("WEBGL_compressed_texture_s3tc")||e.get("WEBGL_compressed_texture_etc1")||e.get("WEBGL_compressed_texture_astc")))for(var n=t.getParameter(t.COMPRESSED_TEXTURE_FORMATS),r=0;r<n.length;r++)F.push(n[r]);return F}function m(e){return B!==e&&(t.useProgram(e),B=e,!0)}function g(e,r,i,o,a,s,u,c){if(e!==ga?f(t.BLEND):d(t.BLEND),e!==wa){if(e!==V||c!==Y)switch(e){case ya:c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE,t.ONE,t.ONE)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.SRC_ALPHA,t.ONE));break;case _a:c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.ZERO,t.ONE_MINUS_SRC_COLOR,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.ONE_MINUS_SRC_COLOR));break;case ba:c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ZERO,t.SRC_COLOR,t.ZERO,t.SRC_ALPHA)):(t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ZERO,t.SRC_COLOR));break;default:c?(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.ONE,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA)):(t.blendEquationSeparate(t.FUNC_ADD,t.FUNC_ADD),t.blendFuncSeparate(t.SRC_ALPHA,t.ONE_MINUS_SRC_ALPHA,t.ONE,t.ONE_MINUS_SRC_ALPHA))}j=null,H=null,G=null,z=null,W=null,q=null}else a=a||r,s=s||i,u=u||o,r===j&&a===z||(t.blendEquationSeparate(n.convert(r),n.convert(a)),j=r,z=a),i===H&&o===G&&s===W&&u===q||(t.blendFuncSeparate(n.convert(i),n.convert(o),n.convert(s),n.convert(u)),H=i,G=o,W=s,q=u);V=e,Y=c}function v(e,n){e.side===la?d(t.CULL_FACE):f(t.CULL_FACE);var r=e.side===ca;n&&(r=!r),y(r),!0===e.transparent?g(e.blending,e.blendEquation,e.blendSrc,e.blendDst,e.blendEquationAlpha,e.blendSrcAlpha,e.blendDstAlpha,e.premultipliedAlpha):g(ga),P.setFunc(e.depthFunc),P.setTest(e.depthTest),P.setMask(e.depthWrite),R.setMask(e.colorWrite),w(e.polygonOffset,e.polygonOffsetFactor,e.polygonOffsetUnits)}function y(e){K!==e&&(e?t.frontFace(t.CW):t.frontFace(t.CCW),K=e)}function _(e){e!==$o?(f(t.CULL_FACE),e!==Q&&(e===ta?t.cullFace(t.BACK):e===ea?t.cullFace(t.FRONT):t.cullFace(t.FRONT_AND_BACK))):d(t.CULL_FACE),Q=e}function b(e){e!==X&&(tt&&t.lineWidth(e),X=e)}function w(e,n,r){e?(f(t.POLYGON_OFFSET_FILL),J===n&&Z===r||(t.polygonOffset(n,r),J=n,Z=r)):d(t.POLYGON_OFFSET_FILL)}function E(e){e?f(t.SCISSOR_TEST):d(t.SCISSOR_TEST)}function x(e){void 0===e&&(e=t.TEXTURE0+$-1),rt!==e&&(t.activeTexture(e),rt=e)}function T(e,n){null===rt&&x();var r=it[rt];void 0===r&&(r={type:void 0,texture:void 0},it[rt]=r),r.type===e&&r.texture===n||(t.bindTexture(e,n||st[e]),r.type=e,r.texture=n)}function S(){try{t.compressedTexImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}}function C(){try{t.texImage2D.apply(t,arguments)}catch(t){console.error("THREE.WebGLState:",t)}}function M(e){!1===ot.equals(e)&&(t.scissor(e.x,e.y,e.z,e.w),ot.copy(e))}function A(e){!1===at.equals(e)&&(t.viewport(e.x,e.y,e.z,e.w),at.copy(e))}function I(){for(var e=0;e<k.length;e++)1===k[e]&&(t.disableVertexAttribArray(e),k[e]=0);U={},F=null,rt=null,it={},B=null,V=null,K=null,Q=null,R.reset(),P.reset(),N.reset()}var R=new r,P=new i,N=new o,D=t.getParameter(t.MAX_VERTEX_ATTRIBS),O=new Uint8Array(D),k=new Uint8Array(D),L=new Uint8Array(D),U={},F=null,B=null,V=null,j=null,H=null,G=null,z=null,W=null,q=null,Y=!1,K=null,Q=null,X=null,J=null,Z=null,$=t.getParameter(t.MAX_COMBINED_TEXTURE_IMAGE_UNITS),tt=!1,et=0,nt=t.getParameter(t.VERSION);-1!==nt.indexOf("WebGL")?(et=parseFloat(/^WebGL\ ([0-9])/.exec(nt)[1]),tt=et>=1):-1!==nt.indexOf("OpenGL ES")&&(et=parseFloat(/^OpenGL\ ES\ ([0-9])/.exec(nt)[1]),tt=et>=2);var rt=null,it={},ot=new l,at=new l,st={};return st[t.TEXTURE_2D]=a(t.TEXTURE_2D,t.TEXTURE_2D,1),st[t.TEXTURE_CUBE_MAP]=a(t.TEXTURE_CUBE_MAP,t.TEXTURE_CUBE_MAP_POSITIVE_X,6),R.setClear(0,0,0,1),P.setClear(1),N.setClear(0),f(t.DEPTH_TEST),P.setFunc(ja),y(!1),_(ta),f(t.CULL_FACE),f(t.BLEND),g(va),{buffers:{color:R,depth:P,stencil:N},initAttributes:s,enableAttribute:u,enableAttributeAndDivisor:c,disableUnusedAttributes:h,enable:f,disable:d,getCompressedTextureFormats:p,useProgram:m,setBlending:g,setMaterial:v,setFlipSided:y,setCullFace:_,setLineWidth:b,setPolygonOffset:w,setScissorTest:E,activeTexture:x,bindTexture:T,compressedTexImage2D:S,texImage2D:C,scissor:M,viewport:A,reset:I}}function be(t,e,n,r,i,o,a){function s(t,e){if(t.width>e||t.height>e){if("data"in t)return void console.warn("THREE.WebGLRenderer: image in DataTexture is too big ("+t.width+"x"+t.height+").");var n=e/Math.max(t.width,t.height),r=document.createElementNS("http://www.w3.org/1999/xhtml","canvas");r.width=Math.floor(t.width*n),r.height=Math.floor(t.height*n);return r.getContext("2d").drawImage(t,0,0,t.width,t.height,0,0,r.width,r.height),console.warn("THREE.WebGLRenderer: image is too big ("+t.width+"x"+t.height+"). Resized to "+r.width+"x"+r.height,t),r}return t}function u(t){return Au.isPowerOfTwo(t.width)&&Au.isPowerOfTwo(t.height)}function c(t){if(t instanceof HTMLImageElement||t instanceof HTMLCanvasElement||t instanceof ImageBitmap){void 0===R&&(R=document.createElementNS("http://www.w3.org/1999/xhtml","canvas")),R.width=Au.floorPowerOfTwo(t.width),R.height=Au.floorPowerOfTwo(t.height);return R.getContext("2d").drawImage(t,0,0,R.width,R.height),console.warn("THREE.WebGLRenderer: image is not power of two ("+t.width+"x"+t.height+"). Resized to "+R.width+"x"+R.height,t),R}return t}function l(t){return t.wrapS!==cs||t.wrapT!==cs||t.minFilter!==hs&&t.minFilter!==ps}function h(t,e){return t.generateMipmaps&&e&&t.minFilter!==hs&&t.minFilter!==ps}function f(e,n,i,o){t.generateMipmap(e),r.get(n).__maxMipLevel=Math.log(Math.max(i,o))*Math.LOG2E}function d(e){return e===hs||e===fs||e===ds?t.NEAREST:t.LINEAR}function p(t){var e=t.target;e.removeEventListener("dispose",p),g(e),e.isVideoTexture&&delete N[e.id],a.memory.textures--}function m(t){var e=t.target;e.removeEventListener("dispose",m),v(e),a.memory.textures--}function g(e){var n=r.get(e);if(e.image&&n.__image__webglTextureCube)t.deleteTexture(n.__image__webglTextureCube);else{if(void 0===n.__webglInit)return;t.deleteTexture(n.__webglTexture)}r.remove(e)}function v(e){var n=r.get(e),i=r.get(e.texture);if(e){if(void 0!==i.__webglTexture&&t.deleteTexture(i.__webglTexture),e.depthTexture&&e.depthTexture.dispose(),e.isWebGLRenderTargetCube)for(var o=0;o<6;o++)t.deleteFramebuffer(n.__webglFramebuffer[o]),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer[o]);else t.deleteFramebuffer(n.__webglFramebuffer),n.__webglDepthbuffer&&t.deleteRenderbuffer(n.__webglDepthbuffer);r.remove(e.texture),r.remove(e)}}function y(e,i){var o=r.get(e);if(e.isVideoTexture&&I(e),e.version>0&&o.__version!==e.version){var a=e.image;if(void 0===a)console.warn("THREE.WebGLRenderer: Texture marked for update but image is undefined",e);else{if(!1!==a.complete)return void E(o,e,i);console.warn("THREE.WebGLRenderer: Texture marked for update but image is incomplete",e)}}n.activeTexture(t.TEXTURE0+i),n.bindTexture(t.TEXTURE_2D,o.__webglTexture)}function _(e,c){var l=r.get(e);if(6===e.image.length)if(e.version>0&&l.__version!==e.version){l.__image__webglTextureCube||(e.addEventListener("dispose",p),l.__image__webglTextureCube=t.createTexture(),a.memory.textures++),n.activeTexture(t.TEXTURE0+c),n.bindTexture(t.TEXTURE_CUBE_MAP,l.__image__webglTextureCube),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY);for(var d=e&&e.isCompressedTexture,m=e.image[0]&&e.image[0].isDataTexture,g=[],v=0;v<6;v++)g[v]=d||m?m?e.image[v].image:e.image[v]:s(e.image[v],i.maxCubemapSize);var y=g[0],_=u(y),b=o.convert(e.format),E=o.convert(e.type);w(t.TEXTURE_CUBE_MAP,e,_);for(var v=0;v<6;v++)if(d)for(var x,T=g[v].mipmaps,S=0,C=T.length;S<C;S++)x=T[S],e.format!==Ps&&e.format!==Rs?n.getCompressedTextureFormats().indexOf(b)>-1?n.compressedTexImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,S,b,x.width,x.height,0,x.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .setTextureCube()"):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,S,b,x.width,x.height,0,b,E,x.data);else m?n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,b,g[v].width,g[v].height,0,b,E,g[v].data):n.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+v,0,b,b,E,g[v]);l.__maxMipLevel=d?T.length-1:0,h(e,_)&&f(t.TEXTURE_CUBE_MAP,e,y.width,y.height),l.__version=e.version,e.onUpdate&&e.onUpdate(e)}else n.activeTexture(t.TEXTURE0+c),n.bindTexture(t.TEXTURE_CUBE_MAP,l.__image__webglTextureCube)}function b(e,i){n.activeTexture(t.TEXTURE0+i),n.bindTexture(t.TEXTURE_CUBE_MAP,r.get(e).__webglTexture)}function w(n,a,s){var u;if(s?(t.texParameteri(n,t.TEXTURE_WRAP_S,o.convert(a.wrapS)),t.texParameteri(n,t.TEXTURE_WRAP_T,o.convert(a.wrapT)),t.texParameteri(n,t.TEXTURE_MAG_FILTER,o.convert(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,o.convert(a.minFilter))):(t.texParameteri(n,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(n,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),a.wrapS===cs&&a.wrapT===cs||console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.wrapS and Texture.wrapT should be set to THREE.ClampToEdgeWrapping.",a),t.texParameteri(n,t.TEXTURE_MAG_FILTER,d(a.magFilter)),t.texParameteri(n,t.TEXTURE_MIN_FILTER,d(a.minFilter)),a.minFilter!==hs&&a.minFilter!==ps&&console.warn("THREE.WebGLRenderer: Texture is not power of two. Texture.minFilter should be set to THREE.NearestFilter or THREE.LinearFilter.",a)),u=e.get("EXT_texture_filter_anisotropic")){if(a.type===xs&&null===e.get("OES_texture_float_linear"))return;if(a.type===Ts&&null===e.get("OES_texture_half_float_linear"))return;(a.anisotropy>1||r.get(a).__currentAnisotropy)&&(t.texParameterf(n,u.TEXTURE_MAX_ANISOTROPY_EXT,Math.min(a.anisotropy,i.getMaxAnisotropy())),r.get(a).__currentAnisotropy=a.anisotropy)}}function E(e,r,d){void 0===e.__webglInit&&(e.__webglInit=!0,r.addEventListener("dispose",p),e.__webglTexture=t.createTexture(),a.memory.textures++),n.activeTexture(t.TEXTURE0+d),n.bindTexture(t.TEXTURE_2D,e.__webglTexture),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,r.flipY),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,r.premultiplyAlpha),t.pixelStorei(t.UNPACK_ALIGNMENT,r.unpackAlignment);var m=s(r.image,i.maxTextureSize);l(r)&&!1===u(m)&&(m=c(m));var g=u(m),v=o.convert(r.format),y=o.convert(r.type);w(t.TEXTURE_2D,r,g);var _,b=r.mipmaps;if(r.isDepthTexture){var E=t.DEPTH_COMPONENT;if(r.type===xs){if(!P)throw new Error("Float Depth Texture only supported in WebGL2.0");E=t.DEPTH_COMPONENT32F}else P&&(E=t.DEPTH_COMPONENT16);r.format===ks&&E===t.DEPTH_COMPONENT&&r.type!==bs&&r.type!==Es&&(console.warn("THREE.WebGLRenderer: Use UnsignedShortType or UnsignedIntType for DepthFormat DepthTexture."),r.type=bs,y=o.convert(r.type)),r.format===Ls&&(E=t.DEPTH_STENCIL,r.type!==As&&(console.warn("THREE.WebGLRenderer: Use UnsignedInt248Type for DepthStencilFormat DepthTexture."),r.type=As,y=o.convert(r.type))),n.texImage2D(t.TEXTURE_2D,0,E,m.width,m.height,0,v,y,null)}else if(r.isDataTexture)if(b.length>0&&g){for(var x=0,T=b.length;x<T;x++)_=b[x],n.texImage2D(t.TEXTURE_2D,x,v,_.width,_.height,0,v,y,_.data);r.generateMipmaps=!1,e.__maxMipLevel=b.length-1}else n.texImage2D(t.TEXTURE_2D,0,v,m.width,m.height,0,v,y,m.data),e.__maxMipLevel=0;else if(r.isCompressedTexture){for(var x=0,T=b.length;x<T;x++)_=b[x],r.format!==Ps&&r.format!==Rs?n.getCompressedTextureFormats().indexOf(v)>-1?n.compressedTexImage2D(t.TEXTURE_2D,x,v,_.width,_.height,0,_.data):console.warn("THREE.WebGLRenderer: Attempt to load unsupported compressed texture format in .uploadTexture()"):n.texImage2D(t.TEXTURE_2D,x,v,_.width,_.height,0,v,y,_.data);e.__maxMipLevel=b.length-1}else if(b.length>0&&g){for(var x=0,T=b.length;x<T;x++)_=b[x],n.texImage2D(t.TEXTURE_2D,x,v,v,y,_);r.generateMipmaps=!1,e.__maxMipLevel=b.length-1}else n.texImage2D(t.TEXTURE_2D,0,v,v,y,m),e.__maxMipLevel=0;h(r,g)&&f(t.TEXTURE_2D,r,m.width,m.height),e.__version=r.version,r.onUpdate&&r.onUpdate(r)}function x(e,i,a,s){var u=o.convert(i.texture.format),c=o.convert(i.texture.type);n.texImage2D(s,0,u,i.width,i.height,0,u,c,null),t.bindFramebuffer(t.FRAMEBUFFER,e),t.framebufferTexture2D(t.FRAMEBUFFER,a,s,r.get(i.texture).__webglTexture,0),t.bindFramebuffer(t.FRAMEBUFFER,null)}function T(e,n){t.bindRenderbuffer(t.RENDERBUFFER,e),n.depthBuffer&&!n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_COMPONENT16,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.RENDERBUFFER,e)):n.depthBuffer&&n.stencilBuffer?(t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,n.width,n.height),t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,e)):t.renderbufferStorage(t.RENDERBUFFER,t.RGBA4,n.width,n.height),t.bindRenderbuffer(t.RENDERBUFFER,null)}function S(e,n){if(n&&n.isWebGLRenderTargetCube)throw new Error("Depth Texture with cube render targets is not supported");if(t.bindFramebuffer(t.FRAMEBUFFER,e),!n.depthTexture||!n.depthTexture.isDepthTexture)throw new Error("renderTarget.depthTexture must be an instance of THREE.DepthTexture");r.get(n.depthTexture).__webglTexture&&n.depthTexture.image.width===n.width&&n.depthTexture.image.height===n.height||(n.depthTexture.image.width=n.width,n.depthTexture.image.height=n.height,n.depthTexture.needsUpdate=!0),y(n.depthTexture,0);var i=r.get(n.depthTexture).__webglTexture;if(n.depthTexture.format===ks)t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,i,0);else{if(n.depthTexture.format!==Ls)throw new Error("Unknown depthTexture format");t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.TEXTURE_2D,i,0)}}function C(e){var n=r.get(e),i=!0===e.isWebGLRenderTargetCube;if(e.depthTexture){if(i)throw new Error("target.depthTexture not supported in Cube render targets");S(n.__webglFramebuffer,e)}else if(i){n.__webglDepthbuffer=[];for(var o=0;o<6;o++)t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer[o]),n.__webglDepthbuffer[o]=t.createRenderbuffer(),T(n.__webglDepthbuffer[o],e)}else t.bindFramebuffer(t.FRAMEBUFFER,n.__webglFramebuffer),n.__webglDepthbuffer=t.createRenderbuffer(),T(n.__webglDepthbuffer,e);t.bindFramebuffer(t.FRAMEBUFFER,null)}function M(e){var i=r.get(e),o=r.get(e.texture);e.addEventListener("dispose",m),o.__webglTexture=t.createTexture(),a.memory.textures++;var s=!0===e.isWebGLRenderTargetCube,c=u(e);if(s){i.__webglFramebuffer=[];for(var l=0;l<6;l++)i.__webglFramebuffer[l]=t.createFramebuffer()}else i.__webglFramebuffer=t.createFramebuffer();if(s){n.bindTexture(t.TEXTURE_CUBE_MAP,o.__webglTexture),w(t.TEXTURE_CUBE_MAP,e.texture,c);for(var l=0;l<6;l++)x(i.__webglFramebuffer[l],e,t.COLOR_ATTACHMENT0,t.TEXTURE_CUBE_MAP_POSITIVE_X+l);h(e.texture,c)&&f(t.TEXTURE_CUBE_MAP,e.texture,e.width,e.height),n.bindTexture(t.TEXTURE_CUBE_MAP,null)}else n.bindTexture(t.TEXTURE_2D,o.__webglTexture),w(t.TEXTURE_2D,e.texture,c),x(i.__webglFramebuffer,e,t.COLOR_ATTACHMENT0,t.TEXTURE_2D),h(e.texture,c)&&f(t.TEXTURE_2D,e.texture,e.width,e.height),n.bindTexture(t.TEXTURE_2D,null);e.depthBuffer&&C(e)}function A(e){var i=e.texture;if(h(i,u(e))){var o=e.isWebGLRenderTargetCube?t.TEXTURE_CUBE_MAP:t.TEXTURE_2D,a=r.get(i).__webglTexture;n.bindTexture(o,a),f(o,i,e.width,e.height),n.bindTexture(o,null)}}function I(t){var e=t.id,n=a.render.frame;N[e]!==n&&(N[e]=n,t.update())}var R,P="undefined"!==typeof WebGL2RenderingContext&&t instanceof WebGL2RenderingContext,N={};this.setTexture2D=y,this.setTextureCube=_,this.setTextureCubeDynamic=b,this.setupRenderTarget=M,this.updateRenderTargetMipmap=A}function we(t,e){function n(n){var r;if(n===us)return t.REPEAT;if(n===cs)return t.CLAMP_TO_EDGE;if(n===ls)return t.MIRRORED_REPEAT;if(n===hs)return t.NEAREST;if(n===fs)return t.NEAREST_MIPMAP_NEAREST;if(n===ds)return t.NEAREST_MIPMAP_LINEAR;if(n===ps)return t.LINEAR;if(n===ms)return t.LINEAR_MIPMAP_NEAREST;if(n===gs)return t.LINEAR_MIPMAP_LINEAR;if(n===vs)return t.UNSIGNED_BYTE;if(n===Ss)return t.UNSIGNED_SHORT_4_4_4_4;if(n===Cs)return t.UNSIGNED_SHORT_5_5_5_1;if(n===Ms)return t.UNSIGNED_SHORT_5_6_5;if(n===ys)return t.BYTE;if(n===_s)return t.SHORT;if(n===bs)return t.UNSIGNED_SHORT;if(n===ws)return t.INT;if(n===Es)return t.UNSIGNED_INT;if(n===xs)return t.FLOAT;if(n===Ts&&null!==(r=e.get("OES_texture_half_float")))return r.HALF_FLOAT_OES;if(n===Is)return t.ALPHA;if(n===Rs)return t.RGB;if(n===Ps)return t.RGBA;if(n===Ns)return t.LUMINANCE;if(n===Ds)return t.LUMINANCE_ALPHA;if(n===ks)return t.DEPTH_COMPONENT;if(n===Ls)return t.DEPTH_STENCIL;if(n===Ea)return t.FUNC_ADD;if(n===xa)return t.FUNC_SUBTRACT;if(n===Ta)return t.FUNC_REVERSE_SUBTRACT;if(n===Ma)return t.ZERO;if(n===Aa)return t.ONE;if(n===Ia)return t.SRC_COLOR;if(n===Ra)return t.ONE_MINUS_SRC_COLOR;if(n===Pa)return t.SRC_ALPHA;if(n===Na)return t.ONE_MINUS_SRC_ALPHA;if(n===Da)return t.DST_ALPHA;if(n===Oa)return t.ONE_MINUS_DST_ALPHA;if(n===ka)return t.DST_COLOR;if(n===La)return t.ONE_MINUS_DST_COLOR;if(n===Ua)return t.SRC_ALPHA_SATURATE;if((n===Us||n===Fs||n===Bs||n===Vs)&&null!==(r=e.get("WEBGL_compressed_texture_s3tc"))){if(n===Us)return r.COMPRESSED_RGB_S3TC_DXT1_EXT;if(n===Fs)return r.COMPRESSED_RGBA_S3TC_DXT1_EXT;if(n===Bs)return r.COMPRESSED_RGBA_S3TC_DXT3_EXT;if(n===Vs)return r.COMPRESSED_RGBA_S3TC_DXT5_EXT}if((n===js||n===Hs||n===Gs||n===zs)&&null!==(r=e.get("WEBGL_compressed_texture_pvrtc"))){if(n===js)return r.COMPRESSED_RGB_PVRTC_4BPPV1_IMG;if(n===Hs)return r.COMPRESSED_RGB_PVRTC_2BPPV1_IMG;if(n===Gs)return r.COMPRESSED_RGBA_PVRTC_4BPPV1_IMG;if(n===zs)return r.COMPRESSED_RGBA_PVRTC_2BPPV1_IMG}if(n===Ws&&null!==(r=e.get("WEBGL_compressed_texture_etc1")))return r.COMPRESSED_RGB_ETC1_WEBGL;if((n===qs||n===Ys||n===Ks||n===Qs||n===Xs||n===Js||n===Zs||n===$s||n===tu||n===eu||n===nu||n===ru||n===iu||n===ou)&&null!==(r=e.get("WEBGL_compressed_texture_astc")))return n;if((n===Sa||n===Ca)&&null!==(r=e.get("EXT_blend_minmax"))){if(n===Sa)return r.MIN_EXT;if(n===Ca)return r.MAX_EXT}return n===As&&null!==(r=e.get("WEBGL_depth_texture"))?r.UNSIGNED_INT_24_8_WEBGL:0}return{convert:n}}function Ee(t,e,n,r){x.call(this),this.type="PerspectiveCamera",this.fov=void 0!==t?t:50,this.zoom=1,this.near=void 0!==n?n:.1,this.far=void 0!==r?r:2e3,this.focus=10,this.aspect=void 0!==e?e:1,this.view=null,this.filmGauge=35,this.filmOffset=0,this.updateProjectionMatrix()}function xe(t){Ee.call(this),this.cameras=t||[]}function Te(t){function e(){return null!==i&&!0===i.isPresenting}function n(){if(e()){var n=i.getEyeParameters("left"),o=n.renderWidth,a=n.renderHeight;b=t.getPixelRatio(),_=t.getSize(),t.setDrawingBufferSize(2*o,a,1)}else r.enabled&&t.setDrawingBufferSize(_.width,_.height,b)}var r=this,i=null,u=null,c=null,h=new o,f=new o;"undefined"!==typeof window&&"VRFrameData"in window&&(u=new window.VRFrameData,window.addEventListener("vrdisplaypresentchange",n,!1));var d=new o,p=new a,m=new s,g=new Ee;g.bounds=new l(0,0,.5,1),g.layers.enable(1);var v=new Ee;v.bounds=new l(.5,0,.5,1),v.layers.enable(2);var y=new xe([g,v]);y.layers.enable(1),y.layers.enable(2);var _,b;this.enabled=!1,this.userHeight=1.6,this.getDevice=function(){return i},this.setDevice=function(t){void 0!==t&&(i=t)},this.setPoseTarget=function(t){void 0!==t&&(c=t)},this.getCamera=function(t){if(null===i)return t;i.depthNear=t.near,i.depthFar=t.far,i.getFrameData(u);var e=i.stageParameters;e?h.fromArray(e.sittingToStandingTransform):h.makeTranslation(0,r.userHeight,0);var n=u.pose,o=null!==c?c:t;if(o.matrix.copy(h),o.matrix.decompose(o.position,o.quaternion,o.scale),null!==n.orientation&&(p.fromArray(n.orientation),o.quaternion.multiply(p)),null!==n.position&&(p.setFromRotationMatrix(h),m.fromArray(n.position),m.applyQuaternion(p),o.position.add(m)),o.updateMatrixWorld(),!1===i.isPresenting)return t;g.near=t.near,v.near=t.near,g.far=t.far,v.far=t.far,y.matrixWorld.copy(t.matrixWorld),y.matrixWorldInverse.copy(t.matrixWorldInverse),g.matrixWorldInverse.fromArray(u.leftViewMatrix),v.matrixWorldInverse.fromArray(u.rightViewMatrix),f.getInverse(h),g.matrixWorldInverse.multiply(f),v.matrixWorldInverse.multiply(f);var a=o.parent;null!==a&&(d.getInverse(a.matrixWorld),g.matrixWorldInverse.multiply(d),v.matrixWorldInverse.multiply(d)),g.matrixWorld.getInverse(g.matrixWorldInverse),v.matrixWorld.getInverse(v.matrixWorldInverse),g.projectionMatrix.fromArray(u.leftProjectionMatrix),v.projectionMatrix.fromArray(u.rightProjectionMatrix),y.projectionMatrix.copy(g.projectionMatrix);var s=i.getLayers();if(s.length){var l=s[0];null!==l.leftBounds&&4===l.leftBounds.length&&g.bounds.fromArray(l.leftBounds),null!==l.rightBounds&&4===l.rightBounds.length&&v.bounds.fromArray(l.rightBounds)}return y},this.getStandingMatrix=function(){return h},this.submitFrame=function(){e()&&i.submitFrame()},this.dispose=function(){"undefined"!==typeof window&&window.removeEventListener("vrdisplaypresentchange",n)}}function Se(t){function e(){return null===lt?Et:1}function n(){Dt=new et(ot),Dt.get("WEBGL_depth_texture"),Dt.get("OES_texture_float"),Dt.get("OES_texture_float_linear"),Dt.get("OES_texture_half_float"),Dt.get("OES_texture_half_float_linear"),Dt.get("OES_standard_derivatives"),Dt.get("OES_element_index_uint"),Dt.get("ANGLE_instanced_arrays"),Jt=new we(ot,Dt),Ot=new $(ot,Dt,t),kt=new _e(ot,Dt,Jt),kt.scissor(vt.copy(Tt).multiplyScalar(Et)),kt.viewport(gt.copy(xt).multiplyScalar(Et)),Lt=new it(ot),Ut=new oe,Ft=new be(ot,Dt,kt,Ut,Ot,Jt,Lt),Bt=new _(ot),Vt=new nt(ot,Bt,Lt),jt=new st(Vt,Lt),Yt=new at(ot),Gt=new ie(ut,Dt,Ot),zt=new ce,Wt=new de,qt=new J(ut,kt,Vt,q),Kt=new Z(ot,Dt,Lt),Qt=new rt(ot,Dt,Lt),Xt=new ye(ut,ot,kt,Ft,Ot),Lt.programs=Gt.programs,ut.context=ot,ut.capabilities=Ot,ut.extensions=Dt,ut.properties=Ut,ut.renderLists=zt,ut.state=kt,ut.info=Lt}function r(t){t.preventDefault(),console.log("THREE.WebGLRenderer: Context Lost."),ct=!0}function i(){console.log("THREE.WebGLRenderer: Context Restored."),ct=!1,n()}function a(t){var e=t.target;e.removeEventListener("dispose",a),u(e)}function u(t){c(t),Ut.remove(t)}function c(t){var e=Ut.get(t).program;t.program=void 0,void 0!==e&&Gt.releaseProgram(e)}function h(t,e,n){t.render(function(t){ut.renderBufferImmediate(t,e,n)})}function f(t,e,n){if(n&&n.isInstancedBufferGeometry&&null===Dt.get("ANGLE_instanced_arrays"))return void console.error("THREE.WebGLRenderer.setupVertexAttributes: using THREE.InstancedBufferGeometry but hardware does not support extension ANGLE_instanced_arrays.");kt.initAttributes();var r=n.attributes,i=e.getAttributes(),o=t.defaultAttributeValues;for(var a in i){var s=i[a];if(s>=0){var u=r[a];if(void 0!==u){var c=u.normalized,l=u.itemSize,h=Bt.get(u);if(void 0===h)continue;var f=h.buffer,d=h.type,p=h.bytesPerElement;if(u.isInterleavedBufferAttribute){var m=u.data,g=m.stride,v=u.offset;m&&m.isInstancedInterleavedBuffer?(kt.enableAttributeAndDivisor(s,m.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=m.meshPerAttribute*m.count)):kt.enableAttribute(s),ot.bindBuffer(ot.ARRAY_BUFFER,f),ot.vertexAttribPointer(s,l,d,c,g*p,v*p)}else u.isInstancedBufferAttribute?(kt.enableAttributeAndDivisor(s,u.meshPerAttribute),void 0===n.maxInstancedCount&&(n.maxInstancedCount=u.meshPerAttribute*u.count)):kt.enableAttribute(s),ot.bindBuffer(ot.ARRAY_BUFFER,f),ot.vertexAttribPointer(s,l,d,c,0,0)}else if(void 0!==o){var y=o[a];if(void 0!==y)switch(y.length){case 2:ot.vertexAttrib2fv(s,y);break;case 3:ot.vertexAttrib3fv(s,y);break;case 4:ot.vertexAttrib4fv(s,y);break;default:ot.vertexAttrib1fv(s,y)}}}}kt.disableUnusedAttributes()}function p(){te||(g(),te=!0)}function m(){te=!1}function g(){var t=Zt.getDevice();t&&t.isPresenting?t.requestAnimationFrame(y):window.requestAnimationFrame(y)}function y(t){!1!==te&&(ee(t),g())}function b(t,e,n){if(!1!==t.visible){if(t.layers.test(e.layers))if(t.isLight)X.pushLight(t),t.castShadow&&X.pushShadow(t);else if(t.isSprite)t.frustumCulled&&!Ct.intersectsSprite(t)||X.pushSprite(t);else if(t.isImmediateRenderObject)n&&Pt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Rt),Q.push(t,null,t.material,Pt.z,null);else if((t.isMesh||t.isLine||t.isPoints)&&(t.isSkinnedMesh&&t.skeleton.update(),!t.frustumCulled||Ct.intersectsObject(t))){n&&Pt.setFromMatrixPosition(t.matrixWorld).applyMatrix4(Rt);var r=jt.update(t),i=t.material;if(Array.isArray(i))for(var o=r.groups,a=0,s=o.length;a<s;a++){var u=o[a],c=i[u.materialIndex];c&&c.visible&&Q.push(t,r,c,Pt.z,u)}else i.visible&&Q.push(t,r,i,Pt.z,null)}for(var l=t.children,a=0,s=l.length;a<s;a++)b(l[a],e,n)}}function w(t,e,n,r){for(var i=0,o=t.length;i<o;i++){var a=t[i],s=a.object,u=a.geometry,c=void 0===r?a.material:r,l=a.group;if(n.isArrayCamera){mt=n;for(var h=n.cameras,f=0,d=h.length;f<d;f++){var p=h[f];if(s.layers.test(p.layers)){var m=p.bounds,g=m.x*bt,v=m.y*wt,y=m.z*bt,_=m.w*wt;kt.viewport(gt.set(g,v,y,_).multiplyScalar(Et)),E(s,e,p,u,c,l)}}}else mt=null,E(s,e,n,u,c,l)}}function E(t,e,n,r,i,o){if(t.onBeforeRender(ut,e,n,r,i,o),X=Wt.get(e,mt||n),t.modelViewMatrix.multiplyMatrices(n.matrixWorldInverse,t.matrixWorld),t.normalMatrix.getNormalMatrix(t.modelViewMatrix),t.isImmediateRenderObject){var a=t.isMesh&&t.matrixWorld.determinant()<0;kt.setMaterial(i,a);var s=T(n,e.fog,i,t);dt="",h(t,s,i)}else ut.renderBufferDirect(n,e.fog,r,i,t,o);t.onAfterRender(ut,e,n,r,i,o),X=Wt.get(e,mt||n)}function x(t,e,n){var r=Ut.get(t),i=X.state.lights,o=X.state.shadowsArray,s=Gt.getParameters(t,i.state,o,e,Mt.numPlanes,Mt.numIntersection,n),u=Gt.getProgramCode(t,s),l=r.program,h=!0;if(void 0===l)t.addEventListener("dispose",a);else if(l.code!==u)c(t);else if(r.lightsHash!==i.state.hash)Ut.update(t,"lightsHash",i.state.hash),h=!1;else{if(void 0!==s.shaderID)return;h=!1}if(h){if(s.shaderID){var f=Ou[s.shaderID];r.shader={name:t.type,uniforms:Pu.clone(f.uniforms),vertexShader:f.vertexShader,fragmentShader:f.fragmentShader}}else r.shader={name:t.type,uniforms:t.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader};t.onBeforeCompile(r.shader,ut),l=Gt.acquireProgram(t,r.shader,s,u),r.program=l,t.program=l}var d=l.getAttributes();if(t.morphTargets){t.numSupportedMorphTargets=0;for(var p=0;p<ut.maxMorphTargets;p++)d["morphTarget"+p]>=0&&t.numSupportedMorphTargets++}if(t.morphNormals){t.numSupportedMorphNormals=0;for(var p=0;p<ut.maxMorphNormals;p++)d["morphNormal"+p]>=0&&t.numSupportedMorphNormals++}var m=r.shader.uniforms;(t.isShaderMaterial||t.isRawShaderMaterial)&&!0!==t.clipping||(r.numClippingPlanes=Mt.numPlanes,r.numIntersection=Mt.numIntersection,m.clippingPlanes=Mt.uniform),r.fog=e,r.lightsHash=i.state.hash,t.lights&&(m.ambientLightColor.value=i.state.ambient,m.directionalLights.value=i.state.directional,m.spotLights.value=i.state.spot,m.rectAreaLights.value=i.state.rectArea,m.pointLights.value=i.state.point,m.hemisphereLights.value=i.state.hemi,m.directionalShadowMap.value=i.state.directionalShadowMap,m.directionalShadowMatrix.value=i.state.directionalShadowMatrix,m.spotShadowMap.value=i.state.spotShadowMap,m.spotShadowMatrix.value=i.state.spotShadowMatrix,m.pointShadowMap.value=i.state.pointShadowMap,m.pointShadowMatrix.value=i.state.pointShadowMatrix);var g=r.program.getUniforms(),v=Ht.seqWithValue(g.seq,m);r.uniformsList=v}function T(t,e,n,r){_t=0;var i=Ut.get(n),o=X.state.lights;if(At&&(It||t!==pt)){var a=t===pt&&n.id===ft;Mt.setState(n.clippingPlanes,n.clipIntersection,n.clipShadows,t,i,a)}!1===n.needsUpdate&&(void 0===i.program?n.needsUpdate=!0:n.fog&&i.fog!==e?n.needsUpdate=!0:n.lights&&i.lightsHash!==o.state.hash?n.needsUpdate=!0:void 0===i.numClippingPlanes||i.numClippingPlanes===Mt.numPlanes&&i.numIntersection===Mt.numIntersection||(n.needsUpdate=!0)),n.needsUpdate&&(x(n,e,r),n.needsUpdate=!1);var s=!1,u=!1,c=!1,l=i.program,h=l.getUniforms(),f=i.shader.uniforms;if(kt.useProgram(l.program)&&(s=!0,u=!0,c=!0),n.id!==ft&&(ft=n.id,u=!0),s||t!==pt){if(h.setValue(ot,"projectionMatrix",t.projectionMatrix),Ot.logarithmicDepthBuffer&&h.setValue(ot,"logDepthBufFC",2/(Math.log(t.far+1)/Math.LN2)),pt!==(mt||t)&&(pt=mt||t,u=!0,c=!0),n.isShaderMaterial||n.isMeshPhongMaterial||n.isMeshStandardMaterial||n.envMap){var p=h.map.cameraPosition;void 0!==p&&p.setValue(ot,Pt.setFromMatrixPosition(t.matrixWorld))}(n.isMeshPhongMaterial||n.isMeshLambertMaterial||n.isMeshBasicMaterial||n.isMeshStandardMaterial||n.isShaderMaterial||n.skinning)&&h.setValue(ot,"viewMatrix",t.matrixWorldInverse)}if(n.skinning){h.setOptional(ot,r,"bindMatrix"),h.setOptional(ot,r,"bindMatrixInverse");var m=r.skeleton;if(m){var g=m.bones;if(Ot.floatVertexTextures){if(void 0===m.boneTexture){var v=Math.sqrt(4*g.length);v=Au.ceilPowerOfTwo(v),v=Math.max(v,4);var y=new Float32Array(v*v*4);y.set(m.boneMatrices);var _=new d(y,v,v,Ps,xs);_.needsUpdate=!0,m.boneMatrices=y,m.boneTexture=_,m.boneTextureSize=v}h.setValue(ot,"boneTexture",m.boneTexture),h.setValue(ot,"boneTextureSize",m.boneTextureSize)}else h.setOptional(ot,m,"boneMatrices")}}return u&&(h.setValue(ot,"toneMappingExposure",ut.toneMappingExposure),h.setValue(ot,"toneMappingWhitePoint",ut.toneMappingWhitePoint),n.lights&&F(f,c),e&&n.fog&&I(f,e),n.isMeshBasicMaterial?S(f,n):n.isMeshLambertMaterial?(S(f,n),R(f,n)):n.isMeshPhongMaterial?(S(f,n),n.isMeshToonMaterial?N(f,n):P(f,n)):n.isMeshStandardMaterial?(S(f,n),n.isMeshPhysicalMaterial?O(f,n):D(f,n)):n.isMeshDepthMaterial?(S(f,n),k(f,n)):n.isMeshDistanceMaterial?(S(f,n),L(f,n)):n.isMeshNormalMaterial?(S(f,n),U(f,n)):n.isLineBasicMaterial?(C(f,n),n.isLineDashedMaterial&&M(f,n)):n.isPointsMaterial?A(f,n):n.isShadowMaterial&&(f.color.value=n.color,f.opacity.value=n.opacity),void 0!==f.ltc_1&&(f.ltc_1.value=Du.LTC_1),void 0!==f.ltc_2&&(f.ltc_2.value=Du.LTC_2),Ht.upload(ot,i.uniformsList,f,ut)),n.isShaderMaterial&&!0===n.uniformsNeedUpdate&&(Ht.upload(ot,i.uniformsList,f,ut),n.uniformsNeedUpdate=!1),h.setValue(ot,"modelViewMatrix",r.modelViewMatrix),h.setValue(ot,"normalMatrix",r.normalMatrix),h.setValue(ot,"modelMatrix",r.matrixWorld),l}function S(t,e){t.opacity.value=e.opacity,e.color&&(t.diffuse.value=e.color),e.emissive&&t.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),e.map&&(t.map.value=e.map),e.alphaMap&&(t.alphaMap.value=e.alphaMap),e.specularMap&&(t.specularMap.value=e.specularMap),e.envMap&&(t.envMap.value=e.envMap,t.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,t.reflectivity.value=e.reflectivity,t.refractionRatio.value=e.refractionRatio,t.maxMipLevel.value=Ut.get(e.envMap).__maxMipLevel),e.lightMap&&(t.lightMap.value=e.lightMap,t.lightMapIntensity.value=e.lightMapIntensity),e.aoMap&&(t.aoMap.value=e.aoMap,t.aoMapIntensity.value=e.aoMapIntensity);var n;e.map?n=e.map:e.specularMap?n=e.specularMap:e.displacementMap?n=e.displacementMap:e.normalMap?n=e.normalMap:e.bumpMap?n=e.bumpMap:e.roughnessMap?n=e.roughnessMap:e.metalnessMap?n=e.metalnessMap:e.alphaMap?n=e.alphaMap:e.emissiveMap&&(n=e.emissiveMap),void 0!==n&&(n.isWebGLRenderTarget&&(n=n.texture),!0===n.matrixAutoUpdate&&n.updateMatrix(),t.uvTransform.value.copy(n.matrix))}function C(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity}function M(t,e){t.dashSize.value=e.dashSize,t.totalSize.value=e.dashSize+e.gapSize,t.scale.value=e.scale}function A(t,e){t.diffuse.value=e.color,t.opacity.value=e.opacity,t.size.value=e.size*Et,t.scale.value=.5*wt,t.map.value=e.map,null!==e.map&&(!0===e.map.matrixAutoUpdate&&e.map.updateMatrix(),t.uvTransform.value.copy(e.map.matrix))}function I(t,e){t.fogColor.value=e.color,e.isFog?(t.fogNear.value=e.near,t.fogFar.value=e.far):e.isFogExp2&&(t.fogDensity.value=e.density)}function R(t,e){e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap)}function P(t,e){t.specular.value=e.specular,t.shininess.value=Math.max(e.shininess,1e-4),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function N(t,e){P(t,e),e.gradientMap&&(t.gradientMap.value=e.gradientMap)}function D(t,e){t.roughness.value=e.roughness,t.metalness.value=e.metalness,e.roughnessMap&&(t.roughnessMap.value=e.roughnessMap),e.metalnessMap&&(t.metalnessMap.value=e.metalnessMap),e.emissiveMap&&(t.emissiveMap.value=e.emissiveMap),e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),e.envMap&&(t.envMapIntensity.value=e.envMapIntensity)}function O(t,e){t.clearCoat.value=e.clearCoat,t.clearCoatRoughness.value=e.clearCoatRoughness,D(t,e)}function k(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function L(t,e){e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias),t.referencePosition.value.copy(e.referencePosition),t.nearDistance.value=e.nearDistance,t.farDistance.value=e.farDistance}function U(t,e){e.bumpMap&&(t.bumpMap.value=e.bumpMap,t.bumpScale.value=e.bumpScale),e.normalMap&&(t.normalMap.value=e.normalMap,t.normalScale.value.copy(e.normalScale)),e.displacementMap&&(t.displacementMap.value=e.displacementMap,t.displacementScale.value=e.displacementScale,t.displacementBias.value=e.displacementBias)}function F(t,e){t.ambientLightColor.needsUpdate=e,t.directionalLights.needsUpdate=e,t.pointLights.needsUpdate=e,t.spotLights.needsUpdate=e,t.rectAreaLights.needsUpdate=e,t.hemisphereLights.needsUpdate=e}function B(){var t=_t;return t>=Ot.maxTextures&&console.warn("THREE.WebGLRenderer: Trying to use "+t+" texture units while this GPU supports only "+Ot.maxTextures),_t+=1,t}console.log("THREE.WebGLRenderer",Jo),t=t||{};var V=void 0!==t.canvas?t.canvas:document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),j=void 0!==t.context?t.context:null,H=void 0!==t.alpha&&t.alpha,G=void 0===t.depth||t.depth,z=void 0===t.stencil||t.stencil,W=void 0!==t.antialias&&t.antialias,q=void 0===t.premultipliedAlpha||t.premultipliedAlpha,Y=void 0!==t.preserveDrawingBuffer&&t.preserveDrawingBuffer,K=void 0!==t.powerPreference?t.powerPreference:"default",Q=null,X=null;this.domElement=V,this.context=null,this.autoClear=!0,this.autoClearColor=!0,this.autoClearDepth=!0,this.autoClearStencil=!0,this.sortObjects=!0,this.clippingPlanes=[],this.localClippingEnabled=!1,this.gammaFactor=2,this.gammaInput=!1,this.gammaOutput=!1,this.physicallyCorrectLights=!1,this.toneMapping=Xa,this.toneMappingExposure=1,this.toneMappingWhitePoint=1,this.maxMorphTargets=8,this.maxMorphNormals=4;var ot,ut=this,ct=!1,lt=null,ht=null,ft=-1,dt="",pt=null,mt=null,gt=new l,vt=new l,yt=null,_t=0,bt=V.width,wt=V.height,Et=1,xt=new l(0,0,bt,wt),Tt=new l(0,0,bt,wt),St=!1,Ct=new v,Mt=new tt,At=!1,It=!1,Rt=new o,Pt=new s;try{var Nt={alpha:H,depth:G,stencil:z,antialias:W,premultipliedAlpha:q,preserveDrawingBuffer:Y,powerPreference:K};if(V.addEventListener("webglcontextlost",r,!1),V.addEventListener("webglcontextrestored",i,!1),null===(ot=j||V.getContext("webgl",Nt)||V.getContext("experimental-webgl",Nt)))throw null!==V.getContext("webgl")?new Error("Error creating WebGL context with your selected attributes."):new Error("Error creating WebGL context.");void 0===ot.getShaderPrecisionFormat&&(ot.getShaderPrecisionFormat=function(){return{rangeMin:1,rangeMax:1,precision:1}})}catch(t){console.error("THREE.WebGLRenderer: "+t.message)}var Dt,Ot,kt,Lt,Ut,Ft,Bt,Vt,jt,Gt,zt,Wt,qt,Yt,Kt,Qt,Xt,Jt;n();var Zt=new Te(ut);this.vr=Zt;var $t=new ge(ut,jt,Ot.maxTextureSize);this.shadowMap=$t,this.getContext=function(){return ot},this.getContextAttributes=function(){return ot.getContextAttributes()},this.forceContextLoss=function(){var t=Dt.get("WEBGL_lose_context");t&&t.loseContext()},this.forceContextRestore=function(){var t=Dt.get("WEBGL_lose_context");t&&t.restoreContext()},this.getPixelRatio=function(){return Et},this.setPixelRatio=function(t){void 0!==t&&(Et=t,this.setSize(bt,wt,!1))},this.getSize=function(){return{width:bt,height:wt}},this.setSize=function(t,e,n){var r=Zt.getDevice();if(r&&r.isPresenting)return void console.warn("THREE.WebGLRenderer: Can't change size while VR device is presenting.");bt=t,wt=e,V.width=t*Et,V.height=e*Et,!1!==n&&(V.style.width=t+"px",V.style.height=e+"px"),this.setViewport(0,0,t,e)},this.getDrawingBufferSize=function(){return{width:bt*Et,height:wt*Et}},this.setDrawingBufferSize=function(t,e,n){bt=t,wt=e,Et=n,V.width=t*n,V.height=e*n,this.setViewport(0,0,t,e)},this.getCurrentViewport=function(){return gt},this.setViewport=function(t,e,n,r){xt.set(t,wt-e-r,n,r),kt.viewport(gt.copy(xt).multiplyScalar(Et))},this.setScissor=function(t,e,n,r){Tt.set(t,wt-e-r,n,r),kt.scissor(vt.copy(Tt).multiplyScalar(Et))},this.setScissorTest=function(t){kt.setScissorTest(St=t)},this.getClearColor=function(){return qt.getClearColor()},this.setClearColor=function(){qt.setClearColor.apply(qt,arguments)},this.getClearAlpha=function(){return qt.getClearAlpha()},this.setClearAlpha=function(){qt.setClearAlpha.apply(qt,arguments)},this.clear=function(t,e,n){var r=0;(void 0===t||t)&&(r|=ot.COLOR_BUFFER_BIT),(void 0===e||e)&&(r|=ot.DEPTH_BUFFER_BIT),(void 0===n||n)&&(r|=ot.STENCIL_BUFFER_BIT),ot.clear(r)},this.clearColor=function(){this.clear(!0,!1,!1)},this.clearDepth=function(){this.clear(!1,!0,!1)},this.clearStencil=function(){this.clear(!1,!1,!0)},this.clearTarget=function(t,e,n,r){this.setRenderTarget(t),this.clear(e,n,r)},this.dispose=function(){V.removeEventListener("webglcontextlost",r,!1),V.removeEventListener("webglcontextrestored",i,!1),zt.dispose(),Wt.dispose(),Ut.dispose(),jt.dispose(),Zt.dispose(),m()},this.renderBufferImmediate=function(t,e,n){kt.initAttributes();var r=Ut.get(t);t.hasPositions&&!r.position&&(r.position=ot.createBuffer()),t.hasNormals&&!r.normal&&(r.normal=ot.createBuffer()),t.hasUvs&&!r.uv&&(r.uv=ot.createBuffer()),t.hasColors&&!r.color&&(r.color=ot.createBuffer());var i=e.getAttributes();if(t.hasPositions&&(ot.bindBuffer(ot.ARRAY_BUFFER,r.position),ot.bufferData(ot.ARRAY_BUFFER,t.positionArray,ot.DYNAMIC_DRAW),kt.enableAttribute(i.position),ot.vertexAttribPointer(i.position,3,ot.FLOAT,!1,0,0)),t.hasNormals){if(ot.bindBuffer(ot.ARRAY_BUFFER,r.normal),!n.isMeshPhongMaterial&&!n.isMeshStandardMaterial&&!n.isMeshNormalMaterial&&!0===n.flatShading)for(var o=0,a=3*t.count;o<a;o+=9){var s=t.normalArray,u=(s[o+0]+s[o+3]+s[o+6])/3,c=(s[o+1]+s[o+4]+s[o+7])/3,l=(s[o+2]+s[o+5]+s[o+8])/3;s[o+0]=u,s[o+1]=c,s[o+2]=l,s[o+3]=u,s[o+4]=c,s[o+5]=l,s[o+6]=u,s[o+7]=c,s[o+8]=l}ot.bufferData(ot.ARRAY_BUFFER,t.normalArray,ot.DYNAMIC_DRAW),kt.enableAttribute(i.normal),ot.vertexAttribPointer(i.normal,3,ot.FLOAT,!1,0,0)}t.hasUvs&&n.map&&(ot.bindBuffer(ot.ARRAY_BUFFER,r.uv),ot.bufferData(ot.ARRAY_BUFFER,t.uvArray,ot.DYNAMIC_DRAW),kt.enableAttribute(i.uv),ot.vertexAttribPointer(i.uv,2,ot.FLOAT,!1,0,0)),t.hasColors&&n.vertexColors!==da&&(ot.bindBuffer(ot.ARRAY_BUFFER,r.color),ot.bufferData(ot.ARRAY_BUFFER,t.colorArray,ot.DYNAMIC_DRAW),kt.enableAttribute(i.color),ot.vertexAttribPointer(i.color,3,ot.FLOAT,!1,0,0)),kt.disableUnusedAttributes(),ot.drawArrays(ot.TRIANGLES,0,t.count),t.count=0},this.renderBufferDirect=function(t,n,r,i,o,a){var s=o.isMesh&&o.matrixWorld.determinant()<0;kt.setMaterial(i,s);var u=T(t,n,i,o),c=r.id+"_"+u.id+"_"+(!0===i.wireframe),l=!1;c!==dt&&(dt=c,l=!0),o.morphTargetInfluences&&(Yt.update(o,r,i,u),l=!0);var h=r.index,d=r.attributes.position,p=1;!0===i.wireframe&&(h=Vt.getWireframeAttribute(r),p=2);var m,g=Kt;null!==h&&(m=Bt.get(h),g=Qt,g.setIndex(m)),l&&(f(i,u,r),null!==h&&ot.bindBuffer(ot.ELEMENT_ARRAY_BUFFER,m.buffer));var v=1/0;null!==h?v=h.count:void 0!==d&&(v=d.count);var y=r.drawRange.start*p,_=r.drawRange.count*p,b=null!==a?a.start*p:0,w=null!==a?a.count*p:1/0,E=Math.max(y,b),x=Math.min(v,y+_,b+w)-1,S=Math.max(0,x-E+1);if(0!==S){if(o.isMesh)if(!0===i.wireframe)kt.setLineWidth(i.wireframeLinewidth*e()),g.setMode(ot.LINES);else switch(o.drawMode){case mu:g.setMode(ot.TRIANGLES);break;case gu:g.setMode(ot.TRIANGLE_STRIP);break;case vu:g.setMode(ot.TRIANGLE_FAN)}else if(o.isLine){var C=i.linewidth;void 0===C&&(C=1),kt.setLineWidth(C*e()),o.isLineSegments?g.setMode(ot.LINES):o.isLineLoop?g.setMode(ot.LINE_LOOP):g.setMode(ot.LINE_STRIP)}else o.isPoints&&g.setMode(ot.POINTS);r&&r.isInstancedBufferGeometry?r.maxInstancedCount>0&&g.renderInstances(r,E,S):g.render(E,S)}},this.compile=function(t,e){X=Wt.get(t,e),X.init(),t.traverse(function(t){t.isLight&&(X.pushLight(t),t.castShadow&&X.pushShadow(t))}),X.setupLights(e),t.traverse(function(e){if(e.material)if(Array.isArray(e.material))for(var n=0;n<e.material.length;n++)x(e.material[n],t.fog,e);else x(e.material,t.fog,e)})};var te=!1,ee=null;this.animate=function(t){ee=t,null!==ee?p():m()},this.render=function(t,e,n,r){if(!e||!e.isCamera)return void console.error("THREE.WebGLRenderer.render: camera is not an instance of THREE.Camera.");if(!ct){dt="",ft=-1,pt=null,!0===t.autoUpdate&&t.updateMatrixWorld(),null===e.parent&&e.updateMatrixWorld(),Zt.enabled&&(e=Zt.getCamera(e)),X=Wt.get(t,e),X.init(),t.onBeforeRender(ut,t,e,n),Rt.multiplyMatrices(e.projectionMatrix,e.matrixWorldInverse),Ct.setFromMatrix(Rt),It=this.localClippingEnabled,At=Mt.init(this.clippingPlanes,It,e),Q=zt.get(t,e),Q.init(),b(t,e,ut.sortObjects),!0===ut.sortObjects&&Q.sort(),At&&Mt.beginShadows();var i=X.state.shadowsArray;$t.render(i,t,e),X.setupLights(e),At&&Mt.endShadows(),this.info.autoReset&&this.info.reset(),void 0===n&&(n=null),this.setRenderTarget(n),qt.render(Q,t,e,r);var o=Q.opaque,a=Q.transparent;if(t.overrideMaterial){var s=t.overrideMaterial;o.length&&w(o,t,e,s),a.length&&w(a,t,e,s)}else o.length&&w(o,t,e),a.length&&w(a,t,e);var u=X.state.spritesArray;Xt.render(u,t,e),n&&Ft.updateRenderTargetMipmap(n),kt.buffers.depth.setTest(!0),kt.buffers.depth.setMask(!0),kt.buffers.color.setMask(!0),kt.setPolygonOffset(!1),t.onAfterRender(ut,t,e),Zt.enabled&&Zt.submitFrame(),Q=null,X=null}},this.allocTextureUnit=B,this.setTexture2D=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTarget&&(t||(console.warn("THREE.WebGLRenderer.setTexture2D: don't use render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),Ft.setTexture2D(e,n)}}(),this.setTexture=function(){var t=!1;return function(e,n){t||(console.warn("THREE.WebGLRenderer: .setTexture is deprecated, use setTexture2D instead."),t=!0),Ft.setTexture2D(e,n)}}(),this.setTextureCube=function(){var t=!1;return function(e,n){e&&e.isWebGLRenderTargetCube&&(t||(console.warn("THREE.WebGLRenderer.setTextureCube: don't use cube render targets as textures. Use their .texture property instead."),t=!0),e=e.texture),e&&e.isCubeTexture||Array.isArray(e.image)&&6===e.image.length?Ft.setTextureCube(e,n):Ft.setTextureCubeDynamic(e,n)}}(),this.getRenderTarget=function(){return lt},this.setRenderTarget=function(t){lt=t,t&&void 0===Ut.get(t).__webglFramebuffer&&Ft.setupRenderTarget(t);var e=null,n=!1;if(t){var r=Ut.get(t).__webglFramebuffer;t.isWebGLRenderTargetCube?(e=r[t.activeCubeFace],n=!0):e=r,gt.copy(t.viewport),vt.copy(t.scissor),yt=t.scissorTest}else gt.copy(xt).multiplyScalar(Et),vt.copy(Tt).multiplyScalar(Et),yt=St;if(ht!==e&&(ot.bindFramebuffer(ot.FRAMEBUFFER,e),ht=e),kt.viewport(gt),kt.scissor(vt),kt.setScissorTest(yt),n){var i=Ut.get(t.texture);ot.framebufferTexture2D(ot.FRAMEBUFFER,ot.COLOR_ATTACHMENT0,ot.TEXTURE_CUBE_MAP_POSITIVE_X+t.activeCubeFace,i.__webglTexture,t.activeMipMapLevel)}},this.readRenderTargetPixels=function(t,e,n,r,i,o){if(!t||!t.isWebGLRenderTarget)return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not THREE.WebGLRenderTarget.");var a=Ut.get(t).__webglFramebuffer;if(a){var s=!1;a!==ht&&(ot.bindFramebuffer(ot.FRAMEBUFFER,a),s=!0);try{var u=t.texture,c=u.format,l=u.type;if(c!==Ps&&Jt.convert(c)!==ot.getParameter(ot.IMPLEMENTATION_COLOR_READ_FORMAT))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in RGBA or implementation defined format.");if(l!==vs&&Jt.convert(l)!==ot.getParameter(ot.IMPLEMENTATION_COLOR_READ_TYPE)&&(l!==xs||!Dt.get("OES_texture_float")&&!Dt.get("WEBGL_color_buffer_float"))&&(l!==Ts||!Dt.get("EXT_color_buffer_half_float")))return void console.error("THREE.WebGLRenderer.readRenderTargetPixels: renderTarget is not in UnsignedByteType or implementation defined type.");ot.checkFramebufferStatus(ot.FRAMEBUFFER)===ot.FRAMEBUFFER_COMPLETE?e>=0&&e<=t.width-r&&n>=0&&n<=t.height-i&&ot.readPixels(e,n,r,i,Jt.convert(c),Jt.convert(l),o):console.error("THREE.WebGLRenderer.readRenderTargetPixels: readPixels from renderTarget failed. Framebuffer not complete.")}finally{s&&ot.bindFramebuffer(ot.FRAMEBUFFER,ht)}}},this.copyFramebufferToTexture=function(t,e,n){var r=e.image.width,i=e.image.height,o=Jt.convert(e.format);this.setTexture2D(e,0),ot.copyTexImage2D(ot.TEXTURE_2D,n||0,o,t.x,t.y,r,i,0)},this.copyTextureToTexture=function(t,e,n,r){var i=e.image.width,o=e.image.height,a=Jt.convert(n.format),s=Jt.convert(n.type),u=e.isDataTexture?e.image.data:e.image;this.setTexture2D(n,0),ot.texSubImage2D(ot.TEXTURE_2D,r||0,t.x,t.y,i,o,a,s,u)}}function Ce(t,e){this.name="",this.color=new y(t),this.density=void 0!==e?e:25e-5}function Me(t,e,n){this.name="",this.color=new y(t),this.near=void 0!==e?e:1,this.far=void 0!==n?n:1e3}function Ae(){E.call(this),this.type="Scene",this.background=null,this.fog=null,this.overrideMaterial=null,this.autoUpdate=!0}function Ie(t){z.call(this),this.type="SpriteMaterial",this.color=new y(16777215),this.map=null,this.rotation=0,this.fog=!1,this.lights=!1,this.setValues(t)}function Re(t){E.call(this),this.type="Sprite",this.material=void 0!==t?t:new Ie,this.center=new i(.5,.5)}function Pe(){E.call(this),this.type="LOD",Object.defineProperties(this,{levels:{enumerable:!0,value:[]}})}function Ne(t,e){if(t=t||[],this.bones=t.slice(0),this.boneMatrices=new Float32Array(16*this.bones.length),void 0===e)this.calculateInverses();else if(this.bones.length===e.length)this.boneInverses=e.slice(0);else{console.warn("THREE.Skeleton boneInverses is the wrong length."),this.boneInverses=[];for(var n=0,r=this.bones.length;n<r;n++)this.boneInverses.push(new o)}}function De(){E.call(this),this.type="Bone"}function Oe(t,e){X.call(this,t,e),this.type="SkinnedMesh",this.bindMode="attached",this.bindMatrix=new o,this.bindMatrixInverse=new o;var n=this.initBones(),r=new Ne(n);this.bind(r,this.matrixWorld),this.normalizeSkinWeights()}function ke(t){z.call(this),this.type="LineBasicMaterial",this.color=new y(16777215),this.linewidth=1,this.linecap="round",this.linejoin="round",this.lights=!1,this.setValues(t)}function Le(t,e,n){if(1===n)return console.warn("THREE.Line: parameter THREE.LinePieces no longer supported. Created THREE.LineSegments instead."),new Ue(t,e);E.call(this),this.type="Line",this.geometry=void 0!==t?t:new B,this.material=void 0!==e?e:new ke({color:16777215*Math.random()})}function Ue(t,e){Le.call(this,t,e),this.type="LineSegments"}function Fe(t,e){Le.call(this,t,e),this.type="LineLoop"}function Be(t){z.call(this),this.type="PointsMaterial",this.color=new y(16777215),this.map=null,this.size=1,this.sizeAttenuation=!0,this.lights=!1,this.setValues(t)}function Ve(t,e){E.call(this),this.type="Points",this.geometry=void 0!==t?t:new B,this.material=void 0!==e?e:new Be({color:16777215*Math.random()})}function je(){E.call(this),this.type="Group"}function He(t,e,n,r,i,o,a,s,u){c.call(this,t,e,n,r,i,o,a,s,u),this.generateMipmaps=!1}function Ge(t,e,n,r,i,o,a,s,u,l,h,f){c.call(this,null,o,a,s,u,l,r,i,h,f),this.image={width:e,height:n},this.mipmaps=t,this.flipY=!1,this.generateMipmaps=!1}function ze(t,e,n,r,i,o,a,s,u,l){if((l=void 0!==l?l:ks)!==ks&&l!==Ls)throw new Error("DepthTexture format must be either THREE.DepthFormat or THREE.DepthStencilFormat");void 0===n&&l===ks&&(n=bs),void 0===n&&l===Ls&&(n=As),c.call(this,null,r,i,o,a,s,l,n,u),this.image={width:t,height:e},this.magFilter=void 0!==a?a:hs,this.minFilter=void 0!==s?s:hs,this.flipY=!1,this.generateMipmaps=!1}function We(t){B.call(this),this.type="WireframeGeometry";var e,n,r,i,o,a,u,c,l,h,f=[],d=[0,0],p={},m=["a","b","c"];if(t&&t.isGeometry){var g=t.faces;for(e=0,r=g.length;e<r;e++){var v=g[e];for(n=0;n<3;n++)u=v[m[n]],c=v[m[(n+1)%3]],d[0]=Math.min(u,c),d[1]=Math.max(u,c),l=d[0]+","+d[1],void 0===p[l]&&(p[l]={index1:d[0],index2:d[1]})}for(l in p)a=p[l],h=t.vertices[a.index1],f.push(h.x,h.y,h.z),h=t.vertices[a.index2],f.push(h.x,h.y,h.z)}else if(t&&t.isBufferGeometry){var y,_,b,w,E,x,T,S;if(h=new s,null!==t.index){for(y=t.attributes.position,_=t.index,b=t.groups,0===b.length&&(b=[{start:0,count:_.count,materialIndex:0}]),i=0,o=b.length;i<o;++i)for(w=b[i],E=w.start,x=w.count,e=E,r=E+x;e<r;e+=3)for(n=0;n<3;n++)u=_.getX(e+n),c=_.getX(e+(n+1)%3),d[0]=Math.min(u,c),d[1]=Math.max(u,c),l=d[0]+","+d[1],void 0===p[l]&&(p[l]={index1:d[0],index2:d[1]});for(l in p)a=p[l],h.fromBufferAttribute(y,a.index1),f.push(h.x,h.y,h.z),h.fromBufferAttribute(y,a.index2),f.push(h.x,h.y,h.z)}else for(y=t.attributes.position,e=0,r=y.count/3;e<r;e++)for(n=0;n<3;n++)T=3*e+n,h.fromBufferAttribute(y,T),f.push(h.x,h.y,h.z),S=3*e+(n+1)%3,h.fromBufferAttribute(y,S),f.push(h.x,h.y,h.z)}this.addAttribute("position",new k(f,3))}function qe(t,e,n){C.call(this),this.type="ParametricGeometry",this.parameters={func:t,slices:e,stacks:n},this.fromBufferGeometry(new Ye(t,e,n)),this.mergeVertices()}function Ye(t,e,n){B.call(this),this.type="ParametricBufferGeometry",this.parameters={func:t,slices:e,stacks:n};var r,i,o=[],a=[],u=[],c=[],l=new s,h=new s,f=new s,d=new s,p=new s,m=e+1;for(r=0;r<=n;r++){var g=r/n;for(i=0;i<=e;i++){var v=i/e;t(v,g,h),a.push(h.x,h.y,h.z),v-1e-5>=0?(t(v-1e-5,g,f),d.subVectors(h,f)):(t(v+1e-5,g,f),d.subVectors(f,h)),g-1e-5>=0?(t(v,g-1e-5,f),p.subVectors(h,f)):(t(v,g+1e-5,f),p.subVectors(f,h)),l.crossVectors(d,p).normalize(),u.push(l.x,l.y,l.z),c.push(v,g)}}for(r=0;r<n;r++)for(i=0;i<e;i++){var y=r*m+i,_=r*m+i+1,b=(r+1)*m+i+1,w=(r+1)*m+i;o.push(y,_,w),o.push(_,b,w)}this.setIndex(o),this.addAttribute("position",new k(a,3)),this.addAttribute("normal",new k(u,3)),this.addAttribute("uv",new k(c,2))}function Ke(t,e,n,r){C.call(this),this.type="PolyhedronGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},this.fromBufferGeometry(new Qe(t,e,n,r)),this.mergeVertices()}function Qe(t,e,n,r){function o(t,e,n,r){var i,o,a=Math.pow(2,r),s=[];for(i=0;i<=a;i++){s[i]=[];var c=t.clone().lerp(n,i/a),l=e.clone().lerp(n,i/a),h=a-i;for(o=0;o<=h;o++)s[i][o]=0===o&&i===a?c:c.clone().lerp(l,o/h)}for(i=0;i<a;i++)for(o=0;o<2*(a-i)-1;o++){var f=Math.floor(o/2);o%2===0?(u(s[i][f+1]),u(s[i+1][f]),u(s[i][f])):(u(s[i][f+1]),u(s[i+1][f+1]),u(s[i+1][f]))}}function a(){for(var t=0;t<m.length;t+=6){var e=m[t+0],n=m[t+2],r=m[t+4],i=Math.max(e,n,r),o=Math.min(e,n,r);i>.9&&o<.1&&(e<.2&&(m[t+0]+=1),n<.2&&(m[t+2]+=1),r<.2&&(m[t+4]+=1))}}function u(t){p.push(t.x,t.y,t.z)}function c(e,n){var r=3*e;n.x=t[r+0],n.y=t[r+1],n.z=t[r+2]}function l(){for(var t=new s,e=new s,n=new s,r=new s,o=new i,a=new i,u=new i,c=0,l=0;c<p.length;c+=9,l+=6){t.set(p[c+0],p[c+1],p[c+2]),e.set(p[c+3],p[c+4],p[c+5]),n.set(p[c+6],p[c+7],p[c+8]),o.set(m[l+0],m[l+1]),a.set(m[l+2],m[l+3]),u.set(m[l+4],m[l+5]),r.copy(t).add(e).add(n).divideScalar(3);var d=f(r);h(o,l+0,t,d),h(a,l+2,e,d),h(u,l+4,n,d)}}function h(t,e,n,r){r<0&&1===t.x&&(m[e]=t.x-1),0===n.x&&0===n.z&&(m[e]=r/2/Math.PI+.5)}function f(t){return Math.atan2(t.z,-t.x)}function d(t){return Math.atan2(-t.y,Math.sqrt(t.x*t.x+t.z*t.z))}B.call(this),this.type="PolyhedronBufferGeometry",this.parameters={vertices:t,indices:e,radius:n,detail:r},n=n||1,r=r||0;var p=[],m=[];!function(t){for(var n=new s,r=new s,i=new s,a=0;a<e.length;a+=3)c(e[a+0],n),c(e[a+1],r),c(e[a+2],i),o(n,r,i,t)}(r),function(t){for(var e=new s,n=0;n<p.length;n+=3)e.x=p[n+0],e.y=p[n+1],e.z=p[n+2],e.normalize().multiplyScalar(t),p[n+0]=e.x,p[n+1]=e.y,p[n+2]=e.z}(n),function(){for(var t=new s,e=0;e<p.length;e+=3){t.x=p[e+0],t.y=p[e+1],t.z=p[e+2];var n=f(t)/2/Math.PI+.5,r=d(t)/Math.PI+.5;m.push(n,1-r)}l(),a()}(),this.addAttribute("position",new k(p,3)),this.addAttribute("normal",new k(p.slice(),3)),this.addAttribute("uv",new k(m,2)),0===r?this.computeVertexNormals():this.normalizeNormals()}function Xe(t,e){C.call(this),this.type="TetrahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new Je(t,e)),this.mergeVertices()}function Je(t,e){var n=[1,1,1,-1,-1,1,-1,1,-1,1,-1,-1],r=[2,1,0,0,3,2,1,3,0,2,3,1];Qe.call(this,n,r,t,e),this.type="TetrahedronBufferGeometry",this.parameters={radius:t,detail:e}}function Ze(t,e){C.call(this),this.type="OctahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new $e(t,e)),this.mergeVertices()}function $e(t,e){var n=[1,0,0,-1,0,0,0,1,0,0,-1,0,0,0,1,0,0,-1],r=[0,2,4,0,4,3,0,3,5,0,5,2,1,2,5,1,5,3,1,3,4,1,4,2];Qe.call(this,n,r,t,e),this.type="OctahedronBufferGeometry",this.parameters={radius:t,detail:e}}function tn(t,e){C.call(this),this.type="IcosahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new en(t,e)),this.mergeVertices()}function en(t,e){var n=(1+Math.sqrt(5))/2,r=[-1,n,0,1,n,0,-1,-n,0,1,-n,0,0,-1,n,0,1,n,0,-1,-n,0,1,-n,n,0,-1,n,0,1,-n,0,-1,-n,0,1],i=[0,11,5,0,5,1,0,1,7,0,7,10,0,10,11,1,5,9,5,11,4,11,10,2,10,7,6,7,1,8,3,9,4,3,4,2,3,2,6,3,6,8,3,8,9,4,9,5,2,4,11,6,2,10,8,6,7,9,8,1];Qe.call(this,r,i,t,e),this.type="IcosahedronBufferGeometry",this.parameters={radius:t,detail:e}}function nn(t,e){C.call(this),this.type="DodecahedronGeometry",this.parameters={radius:t,detail:e},this.fromBufferGeometry(new rn(t,e)),this.mergeVertices()}function rn(t,e){var n=(1+Math.sqrt(5))/2,r=1/n,i=[-1,-1,-1,-1,-1,1,-1,1,-1,-1,1,1,1,-1,-1,1,-1,1,1,1,-1,1,1,1,0,-r,-n,0,-r,n,0,r,-n,0,r,n,-r,-n,0,-r,n,0,r,-n,0,r,n,0,-n,0,-r,n,0,-r,-n,0,r,n,0,r],o=[3,11,7,3,7,15,3,15,13,7,19,17,7,17,6,7,6,15,17,4,8,17,8,10,17,10,6,8,0,16,8,16,2,8,2,10,0,12,1,0,1,18,0,18,16,6,10,2,6,2,13,6,13,15,2,16,18,2,18,3,2,3,13,18,1,9,18,9,11,18,11,3,4,14,12,4,12,0,4,0,8,11,9,5,11,5,19,11,19,7,19,5,14,19,14,4,19,4,17,1,12,14,1,14,5,1,5,9];Qe.call(this,i,o,t,e),this.type="DodecahedronBufferGeometry",this.parameters={radius:t,detail:e}}function on(t,e,n,r,i,o){C.call(this),this.type="TubeGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:i},void 0!==o&&console.warn("THREE.TubeGeometry: taper has been removed.");var a=new an(t,e,n,r,i);this.tangents=a.tangents,this.normals=a.normals,this.binormals=a.binormals,this.fromBufferGeometry(a),this.mergeVertices()}function an(t,e,n,r,o){function a(i){g=t.getPointAt(i/e,g);var o=l.normals[i],a=l.binormals[i];for(f=0;f<=r;f++){var s=f/r*Math.PI*2,u=Math.sin(s),c=-Math.cos(s);p.x=c*o.x+u*a.x,p.y=c*o.y+u*a.y,p.z=c*o.z+u*a.z,p.normalize(),y.push(p.x,p.y,p.z),d.x=g.x+n*p.x,d.y=g.y+n*p.y,d.z=g.z+n*p.z,v.push(d.x,d.y,d.z)}}function u(){for(f=1;f<=e;f++)for(h=1;h<=r;h++){var t=(r+1)*(f-1)+(h-1),n=(r+1)*f+(h-1),i=(r+1)*f+h,o=(r+1)*(f-1)+h;b.push(t,n,o),b.push(n,i,o)}}function c(){for(h=0;h<=e;h++)for(f=0;f<=r;f++)m.x=h/e,m.y=f/r,_.push(m.x,m.y)}B.call(this),this.type="TubeBufferGeometry",this.parameters={path:t,tubularSegments:e,radius:n,radialSegments:r,closed:o},e=e||64,n=n||1,r=r||8,o=o||!1;var l=t.computeFrenetFrames(e,o);this.tangents=l.tangents,this.normals=l.normals,this.binormals=l.binormals;var h,f,d=new s,p=new s,m=new i,g=new s,v=[],y=[],_=[],b=[];!function(){for(h=0;h<e;h++)a(h);a(!1===o?e:0),c(),u()}(),this.setIndex(b),this.addAttribute("position",new k(v,3)),this.addAttribute("normal",new k(y,3)),this.addAttribute("uv",new k(_,2))}function sn(t,e,n,r,i,o,a){C.call(this),this.type="TorusKnotGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},void 0!==a&&console.warn("THREE.TorusKnotGeometry: heightScale has been deprecated. Use .scale( x, y, z ) instead."),this.fromBufferGeometry(new un(t,e,n,r,i,o)),this.mergeVertices()}function un(t,e,n,r,i,o){function a(t,e,n,r,i){var o=Math.cos(t),a=Math.sin(t),s=n/e*t,u=Math.cos(s);i.x=r*(2+u)*.5*o,i.y=r*(2+u)*a*.5,i.z=r*Math.sin(s)*.5}B.call(this),this.type="TorusKnotBufferGeometry",this.parameters={radius:t,tube:e,tubularSegments:n,radialSegments:r,p:i,q:o},t=t||1,e=e||.4,n=Math.floor(n)||64,r=Math.floor(r)||8,i=i||2,o=o||3;var u,c,l=[],h=[],f=[],d=[],p=new s,m=new s,g=new s,v=new s,y=new s,_=new s,b=new s;for(u=0;u<=n;++u){var w=u/n*i*Math.PI*2;for(a(w,i,o,t,g),a(w+.01,i,o,t,v),_.subVectors(v,g),b.addVectors(v,g),y.crossVectors(_,b),b.crossVectors(y,_),y.normalize(),b.normalize(),c=0;c<=r;++c){var E=c/r*Math.PI*2,x=-e*Math.cos(E),T=e*Math.sin(E);p.x=g.x+(x*b.x+T*y.x),p.y=g.y+(x*b.y+T*y.y),p.z=g.z+(x*b.z+T*y.z),h.push(p.x,p.y,p.z),m.subVectors(p,g).normalize(),f.push(m.x,m.y,m.z),d.push(u/n),d.push(c/r)}}for(c=1;c<=n;c++)for(u=1;u<=r;u++){var S=(r+1)*(c-1)+(u-1),C=(r+1)*c+(u-1),M=(r+1)*c+u,A=(r+1)*(c-1)+u;l.push(S,C,A),l.push(C,M,A)}this.setIndex(l),this.addAttribute("position",new k(h,3)),this.addAttribute("normal",new k(f,3)),this.addAttribute("uv",new k(d,2))}function cn(t,e,n,r,i){C.call(this),this.type="TorusGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},this.fromBufferGeometry(new ln(t,e,n,r,i)),this.mergeVertices()}function ln(t,e,n,r,i){B.call(this),this.type="TorusBufferGeometry",this.parameters={radius:t,tube:e,radialSegments:n,tubularSegments:r,arc:i},t=t||1,e=e||.4,n=Math.floor(n)||8,r=Math.floor(r)||6,i=i||2*Math.PI;var o,a,u=[],c=[],l=[],h=[],f=new s,d=new s,p=new s;for(o=0;o<=n;o++)for(a=0;a<=r;a++){var m=a/r*i,g=o/n*Math.PI*2;d.x=(t+e*Math.cos(g))*Math.cos(m),d.y=(t+e*Math.cos(g))*Math.sin(m),d.z=e*Math.sin(g),c.push(d.x,d.y,d.z),f.x=t*Math.cos(m),f.y=t*Math.sin(m),p.subVectors(d,f).normalize(),l.push(p.x,p.y,p.z),h.push(a/r),h.push(o/n)}for(o=1;o<=n;o++)for(a=1;a<=r;a++){var v=(r+1)*o+a-1,y=(r+1)*(o-1)+a-1,_=(r+1)*(o-1)+a,b=(r+1)*o+a;u.push(v,y,b),u.push(y,_,b)}this.setIndex(u),this.addAttribute("position",new k(c,3)),this.addAttribute("normal",new k(l,3)),this.addAttribute("uv",new k(h,2))}function hn(t,e,n,r,i){var o,a;if(i===Fn(t,e,n,r)>0)for(o=e;o<n;o+=r)a=kn(o,t[o],t[o+1],a);else for(o=n-r;o>=e;o-=r)a=kn(o,t[o],t[o+1],a);return a&&In(a,a.next)&&(Ln(a),a=a.next),a}function fn(t,e){if(!t)return t;e||(e=t);var n,r=t;do{if(n=!1,r.steiner||!In(r,r.next)&&0!==An(r.prev,r,r.next))r=r.next;else{if(Ln(r),(r=e=r.prev)===r.next)break;n=!0}}while(n||r!==e);return e}function dn(t,e,n,r,i,o,a){if(t){!a&&o&&En(t,r,i,o);for(var s,u,c=t;t.prev!==t.next;)if(s=t.prev,u=t.next,o?mn(t,r,i,o):pn(t))e.push(s.i/n),e.push(t.i/n),e.push(u.i/n),Ln(t),t=u.next,c=u.next;else if((t=u)===c){a?1===a?(t=gn(t,e,n),dn(t,e,n,r,i,o,2)):2===a&&vn(t,e,n,r,i,o):dn(fn(t),e,n,r,i,o,1);break}}}function pn(t){var e=t.prev,n=t,r=t.next;if(An(e,n,r)>=0)return!1;for(var i=t.next.next;i!==t.prev;){if(Cn(e.x,e.y,n.x,n.y,r.x,r.y,i.x,i.y)&&An(i.prev,i,i.next)>=0)return!1;i=i.next}return!0}function mn(t,e,n,r){var i=t.prev,o=t,a=t.next;if(An(i,o,a)>=0)return!1;for(var s=i.x<o.x?i.x<a.x?i.x:a.x:o.x<a.x?o.x:a.x,u=i.y<o.y?i.y<a.y?i.y:a.y:o.y<a.y?o.y:a.y,c=i.x>o.x?i.x>a.x?i.x:a.x:o.x>a.x?o.x:a.x,l=i.y>o.y?i.y>a.y?i.y:a.y:o.y>a.y?o.y:a.y,h=Tn(s,u,e,n,r),f=Tn(c,l,e,n,r),d=t.nextZ;d&&d.z<=f;){if(d!==t.prev&&d!==t.next&&Cn(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&An(d.prev,d,d.next)>=0)return!1;d=d.nextZ}for(d=t.prevZ;d&&d.z>=h;){if(d!==t.prev&&d!==t.next&&Cn(i.x,i.y,o.x,o.y,a.x,a.y,d.x,d.y)&&An(d.prev,d,d.next)>=0)return!1;d=d.prevZ}return!0}function gn(t,e,n){var r=t;do{var i=r.prev,o=r.next.next;!In(i,o)&&Rn(i,r,r.next,o)&&Nn(i,o)&&Nn(o,i)&&(e.push(i.i/n),e.push(r.i/n),e.push(o.i/n),Ln(r),Ln(r.next),r=t=o),r=r.next}while(r!==t);return r}function vn(t,e,n,r,i,o){var a=t;do{for(var s=a.next.next;s!==a.prev;){if(a.i!==s.i&&Mn(a,s)){var u=On(a,s);return a=fn(a,a.next),u=fn(u,u.next),dn(a,e,n,r,i,o),void dn(u,e,n,r,i,o)}s=s.next}a=a.next}while(a!==t)}function yn(t,e,n,r){var i,o,a,s,u,c=[];for(i=0,o=e.length;i<o;i++)a=e[i]*r,s=i<o-1?e[i+1]*r:t.length,u=hn(t,a,s,r,!1),u===u.next&&(u.steiner=!0),c.push(Sn(u));for(c.sort(_n),i=0;i<c.length;i++)bn(c[i],n),n=fn(n,n.next);return n}function _n(t,e){return t.x-e.x}function bn(t,e){if(e=wn(t,e)){var n=On(e,t);fn(n,n.next)}}function wn(t,e){var n,r=e,i=t.x,o=t.y,a=-1/0;do{if(o<=r.y&&o>=r.next.y&&r.next.y!==r.y){var s=r.x+(o-r.y)*(r.next.x-r.x)/(r.next.y-r.y);if(s<=i&&s>a){if(a=s,s===i){if(o===r.y)return r;if(o===r.next.y)return r.next}n=r.x<r.next.x?r:r.next}}r=r.next}while(r!==e);if(!n)return null;if(i===a)return n.prev;var u,c=n,l=n.x,h=n.y,f=1/0;for(r=n.next;r!==c;)i>=r.x&&r.x>=l&&i!==r.x&&Cn(o<h?i:a,o,l,h,o<h?a:i,o,r.x,r.y)&&((u=Math.abs(o-r.y)/(i-r.x))<f||u===f&&r.x>n.x)&&Nn(r,t)&&(n=r,f=u),r=r.next;return n}function En(t,e,n,r){var i=t;do{null===i.z&&(i.z=Tn(i.x,i.y,e,n,r)),i.prevZ=i.prev,i.nextZ=i.next,i=i.next}while(i!==t);i.prevZ.nextZ=null,i.prevZ=null,xn(i)}function xn(t){var e,n,r,i,o,a,s,u,c=1;do{for(n=t,t=null,o=null,a=0;n;){for(a++,r=n,s=0,e=0;e<c&&(s++,r=r.nextZ);e++);for(u=c;s>0||u>0&&r;)0!==s&&(0===u||!r||n.z<=r.z)?(i=n,n=n.nextZ,s--):(i=r,r=r.nextZ,u--),o?o.nextZ=i:t=i,i.prevZ=o,o=i;n=r}o.nextZ=null,c*=2}while(a>1);return t}function Tn(t,e,n,r,i){return t=32767*(t-n)*i,e=32767*(e-r)*i,t=16711935&(t|t<<8),t=252645135&(t|t<<4),t=858993459&(t|t<<2),t=1431655765&(t|t<<1),e=16711935&(e|e<<8),e=252645135&(e|e<<4),e=858993459&(e|e<<2),e=1431655765&(e|e<<1),t|e<<1}function Sn(t){var e=t,n=t;do{e.x<n.x&&(n=e),e=e.next}while(e!==t);return n}function Cn(t,e,n,r,i,o,a,s){return(i-a)*(e-s)-(t-a)*(o-s)>=0&&(t-a)*(r-s)-(n-a)*(e-s)>=0&&(n-a)*(o-s)-(i-a)*(r-s)>=0}function Mn(t,e){return t.next.i!==e.i&&t.prev.i!==e.i&&!Pn(t,e)&&Nn(t,e)&&Nn(e,t)&&Dn(t,e)}function An(t,e,n){return(e.y-t.y)*(n.x-e.x)-(e.x-t.x)*(n.y-e.y)}function In(t,e){return t.x===e.x&&t.y===e.y}function Rn(t,e,n,r){return!!(In(t,e)&&In(n,r)||In(t,r)&&In(n,e))||An(t,e,n)>0!==An(t,e,r)>0&&An(n,r,t)>0!==An(n,r,e)>0}function Pn(t,e){var n=t;do{if(n.i!==t.i&&n.next.i!==t.i&&n.i!==e.i&&n.next.i!==e.i&&Rn(n,n.next,t,e))return!0;n=n.next}while(n!==t);return!1}function Nn(t,e){return An(t.prev,t,t.next)<0?An(t,e,t.next)>=0&&An(t,t.prev,e)>=0:An(t,e,t.prev)<0||An(t,t.next,e)<0}function Dn(t,e){var n=t,r=!1,i=(t.x+e.x)/2,o=(t.y+e.y)/2;do{n.y>o!==n.next.y>o&&n.next.y!==n.y&&i<(n.next.x-n.x)*(o-n.y)/(n.next.y-n.y)+n.x&&(r=!r),n=n.next}while(n!==t);return r}function On(t,e){var n=new Un(t.i,t.x,t.y),r=new Un(e.i,e.x,e.y),i=t.next,o=e.prev;return t.next=e,e.prev=t,n.next=i,i.prev=n,r.next=n,n.prev=r,o.next=r,r.prev=o,r}function kn(t,e,n,r){var i=new Un(t,e,n);return r?(i.next=r.next,i.prev=r,r.next.prev=i,r.next=i):(i.prev=i,i.next=i),i}function Ln(t){t.next.prev=t.prev,t.prev.next=t.next,t.prevZ&&(t.prevZ.nextZ=t.nextZ),t.nextZ&&(t.nextZ.prevZ=t.prevZ)}function Un(t,e,n){this.i=t,this.x=e,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function Fn(t,e,n,r){for(var i=0,o=e,a=n-r;o<n;o+=r)i+=(t[a]-t[o])*(t[o+1]+t[a+1]),a=o;return i}function Bn(t){var e=t.length;e>2&&t[e-1].equals(t[0])&&t.pop()}function Vn(t,e){for(var n=0;n<e.length;n++)t.push(e[n].x),t.push(e[n].y)}function jn(t,e){C.call(this),this.type="ExtrudeGeometry",this.parameters={shapes:t,options:e},this.fromBufferGeometry(new Hn(t,e)),this.mergeVertices()}function Hn(t,e){B.call(this),this.type="ExtrudeBufferGeometry",this.parameters={shapes:t,options:e},t=Array.isArray(t)?t:[t];for(var n=this,r=[],o=[],a=0,u=t.length;a<u;a++){var c=t[a];!function(t){function a(t,e,n){return e||console.error("THREE.ExtrudeGeometry: vec does not exist"),e.clone().multiplyScalar(n).add(t)}function u(t,e,n){var r,o,a,s=t.x-e.x,u=t.y-e.y,c=n.x-t.x,l=n.y-t.y,h=s*s+u*u,f=s*l-u*c;if(Math.abs(f)>Number.EPSILON){var d=Math.sqrt(h),p=Math.sqrt(c*c+l*l),m=e.x-u/d,g=e.y+s/d,v=n.x-l/p,y=n.y+c/p,_=((v-m)*l-(y-g)*c)/(s*l-u*c);r=m+s*_-t.x,o=g+u*_-t.y;var b=r*r+o*o;if(b<=2)return new i(r,o);a=Math.sqrt(b/2)}else{var w=!1;s>Number.EPSILON?c>Number.EPSILON&&(w=!0):s<-Number.EPSILON?c<-Number.EPSILON&&(w=!0):Math.sign(u)===Math.sign(l)&&(w=!0),w?(r=-u,o=s,a=Math.sqrt(h)):(r=s,o=u,a=Math.sqrt(h/2))}return new i(r/a,o/a)}function c(t,e){var n,r;for(K=t.length;--K>=0;){n=K,(r=K-1)<0&&(r=t.length-1);var i=0,o=E+2*M;for(i=0;i<o;i++){var a=W*i,s=W*(i+1);f(e+n+a,e+r+a,e+r+s,e+n+s)}}}function l(t,e,n){b.push(t),b.push(e),b.push(n)}function h(t,e,i){d(t),d(e),d(i);var o=r.length/3,a=I.generateTopUV(n,r,o-3,o-2,o-1);p(a[0]),p(a[1]),p(a[2])}function f(t,e,i,o){d(t),d(e),d(o),d(e),d(i),d(o);var a=r.length/3,s=I.generateSideWallUV(n,r,a-6,a-3,a-2,a-1);p(s[0]),p(s[1]),p(s[3]),p(s[1]),p(s[2]),p(s[3])}function d(t){r.push(b[3*t+0]),r.push(b[3*t+1]),r.push(b[3*t+2])}function p(t){o.push(t.x),o.push(t.y)}var m,g,v,y,_,b=[],w=void 0!==e.curveSegments?e.curveSegments:12,E=void 0!==e.steps?e.steps:1,x=void 0!==e.amount?e.amount:100,T=void 0===e.bevelEnabled||e.bevelEnabled,S=void 0!==e.bevelThickness?e.bevelThickness:6,C=void 0!==e.bevelSize?e.bevelSize:S-2,M=void 0!==e.bevelSegments?e.bevelSegments:3,A=e.extrudePath,I=void 0!==e.UVGenerator?e.UVGenerator:Xu,R=!1;A&&(m=A.getSpacedPoints(E),R=!0,T=!1,g=A.computeFrenetFrames(E,!1),v=new s,y=new s,_=new s),T||(M=0,S=0,C=0);var P,N,D,O=t.extractPoints(w),k=O.shape,L=O.holes;if(!Qu.isClockWise(k))for(k=k.reverse(),N=0,D=L.length;N<D;N++)P=L[N],Qu.isClockWise(P)&&(L[N]=P.reverse());var U=Qu.triangulateShape(k,L),F=k;for(N=0,D=L.length;N<D;N++)P=L[N],k=k.concat(P);for(var B,V,j,H,G,z,W=k.length,q=U.length,Y=[],K=0,Q=F.length,X=Q-1,J=K+1;K<Q;K++,X++,J++)X===Q&&(X=0),J===Q&&(J=0),Y[K]=u(F[K],F[X],F[J]);var Z,$=[],tt=Y.concat();for(N=0,D=L.length;N<D;N++){for(P=L[N],Z=[],K=0,Q=P.length,X=Q-1,J=K+1;K<Q;K++,X++,J++)X===Q&&(X=0),J===Q&&(J=0),Z[K]=u(P[K],P[X],P[J]);$.push(Z),tt=tt.concat(Z)}for(B=0;B<M;B++){for(j=B/M,H=S*Math.cos(j*Math.PI/2),V=C*Math.sin(j*Math.PI/2),K=0,Q=F.length;K<Q;K++)G=a(F[K],Y[K],V),l(G.x,G.y,-H);for(N=0,D=L.length;N<D;N++)for(P=L[N],Z=$[N],K=0,Q=P.length;K<Q;K++)G=a(P[K],Z[K],V),l(G.x,G.y,-H)}for(V=C,K=0;K<W;K++)G=T?a(k[K],tt[K],V):k[K],R?(y.copy(g.normals[0]).multiplyScalar(G.x),v.copy(g.binormals[0]).multiplyScalar(G.y),_.copy(m[0]).add(y).add(v),l(_.x,_.y,_.z)):l(G.x,G.y,0);var et;for(et=1;et<=E;et++)for(K=0;K<W;K++)G=T?a(k[K],tt[K],V):k[K],R?(y.copy(g.normals[et]).multiplyScalar(G.x),v.copy(g.binormals[et]).multiplyScalar(G.y),_.copy(m[et]).add(y).add(v),l(_.x,_.y,_.z)):l(G.x,G.y,x/E*et);for(B=M-1;B>=0;B--){for(j=B/M,H=S*Math.cos(j*Math.PI/2),V=C*Math.sin(j*Math.PI/2),K=0,Q=F.length;K<Q;K++)G=a(F[K],Y[K],V),l(G.x,G.y,x+H);for(N=0,D=L.length;N<D;N++)for(P=L[N],Z=$[N],K=0,Q=P.length;K<Q;K++)G=a(P[K],Z[K],V),R?l(G.x,G.y+m[E-1].y,m[E-1].x+H):l(G.x,G.y,x+H)}!function(){var t=r.length/3;if(T){var e=0,i=W*e;for(K=0;K<q;K++)z=U[K],h(z[2]+i,z[1]+i,z[0]+i);for(e=E+2*M,i=W*e,K=0;K<q;K++)z=U[K],h(z[0]+i,z[1]+i,z[2]+i)}else{for(K=0;K<q;K++)z=U[K],h(z[2],z[1],z[0]);for(K=0;K<q;K++)z=U[K],h(z[0]+W*E,z[1]+W*E,z[2]+W*E)}n.addGroup(t,r.length/3-t,0)}(),function(){var t=r.length/3,e=0;for(c(F,e),e+=F.length,N=0,D=L.length;N<D;N++)P=L[N],c(P,e),e+=P.length;n.addGroup(t,r.length/3-t,1)}()}(c)}this.addAttribute("position",new k(r,3)),this.addAttribute("uv",new k(o,2)),this.computeVertexNormals()}function Gn(t,e){C.call(this),this.type="TextGeometry",this.parameters={text:t,parameters:e},this.fromBufferGeometry(new zn(t,e)),this.mergeVertices()}function zn(t,e){e=e||{};var n=e.font;if(!n||!n.isFont)return console.error("THREE.TextGeometry: font parameter is not an instance of THREE.Font."),new C;var r=n.generateShapes(t,e.size,e.curveSegments);e.amount=void 0!==e.height?e.height:50,void 0===e.bevelThickness&&(e.bevelThickness=10),void 0===e.bevelSize&&(e.bevelSize=8),void 0===e.bevelEnabled&&(e.bevelEnabled=!1),Hn.call(this,r,e),this.type="TextBufferGeometry"}function Wn(t,e,n,r,i,o,a){C.call(this),this.type="SphereGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},this.fromBufferGeometry(new qn(t,e,n,r,i,o,a)),this.mergeVertices()}function qn(t,e,n,r,i,o,a){B.call(this),this.type="SphereBufferGeometry",this.parameters={radius:t,widthSegments:e,heightSegments:n,phiStart:r,phiLength:i,thetaStart:o,thetaLength:a},t=t||1,e=Math.max(3,Math.floor(e)||8),n=Math.max(2,Math.floor(n)||6),r=void 0!==r?r:0,i=void 0!==i?i:2*Math.PI,o=void 0!==o?o:0,a=void 0!==a?a:Math.PI;var u,c,l=o+a,h=0,f=[],d=new s,p=new s,m=[],g=[],v=[],y=[];for(c=0;c<=n;c++){var _=[],b=c/n;for(u=0;u<=e;u++){var w=u/e;d.x=-t*Math.cos(r+w*i)*Math.sin(o+b*a),d.y=t*Math.cos(o+b*a),d.z=t*Math.sin(r+w*i)*Math.sin(o+b*a),g.push(d.x,d.y,d.z),p.set(d.x,d.y,d.z).normalize(),v.push(p.x,p.y,p.z),y.push(w,1-b),_.push(h++)}f.push(_)}for(c=0;c<n;c++)for(u=0;u<e;u++){var E=f[c][u+1],x=f[c][u],T=f[c+1][u],S=f[c+1][u+1];(0!==c||o>0)&&m.push(E,x,S),(c!==n-1||l<Math.PI)&&m.push(x,T,S)}this.setIndex(m),this.addAttribute("position",new k(g,3)),this.addAttribute("normal",new k(v,3)),this.addAttribute("uv",new k(y,2))}function Yn(t,e,n,r,i,o){C.call(this),this.type="RingGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:i,thetaLength:o},this.fromBufferGeometry(new Kn(t,e,n,r,i,o)),this.mergeVertices()}function Kn(t,e,n,r,o,a){B.call(this),this.type="RingBufferGeometry",this.parameters={innerRadius:t,outerRadius:e,thetaSegments:n,phiSegments:r,thetaStart:o,thetaLength:a},t=t||.5,e=e||1,o=void 0!==o?o:0,a=void 0!==a?a:2*Math.PI,n=void 0!==n?Math.max(3,n):8,r=void 0!==r?Math.max(1,r):1;var u,c,l,h=[],f=[],d=[],p=[],m=t,g=(e-t)/r,v=new s,y=new i;for(c=0;c<=r;c++){for(l=0;l<=n;l++)u=o+l/n*a,v.x=m*Math.cos(u),v.y=m*Math.sin(u),f.push(v.x,v.y,v.z),d.push(0,0,1),y.x=(v.x/e+1)/2,y.y=(v.y/e+1)/2,p.push(y.x,y.y);m+=g}for(c=0;c<r;c++){var _=c*(n+1);for(l=0;l<n;l++){u=l+_;var b=u,w=u+n+1,E=u+n+2,x=u+1;h.push(b,w,x),h.push(w,E,x)}}this.setIndex(h),this.addAttribute("position",new k(f,3)),this.addAttribute("normal",new k(d,3)),this.addAttribute("uv",new k(p,2))}function Qn(t,e,n,r){C.call(this),this.type="LatheGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},this.fromBufferGeometry(new Xn(t,e,n,r)),this.mergeVertices()}function Xn(t,e,n,r){B.call(this),this.type="LatheBufferGeometry",this.parameters={points:t,segments:e,phiStart:n,phiLength:r},e=Math.floor(e)||12,n=n||0,r=r||2*Math.PI,r=Au.clamp(r,0,2*Math.PI);var o,a,u,c=[],l=[],h=[],f=1/e,d=new s,p=new i;for(a=0;a<=e;a++){var m=n+a*f*r,g=Math.sin(m),v=Math.cos(m);for(u=0;u<=t.length-1;u++)d.x=t[u].x*g,d.y=t[u].y,d.z=t[u].x*v,l.push(d.x,d.y,d.z),p.x=a/e,p.y=u/(t.length-1),h.push(p.x,p.y)}for(a=0;a<e;a++)for(u=0;u<t.length-1;u++){o=u+a*t.length;var y=o,_=o+t.length,b=o+t.length+1,w=o+1;c.push(y,_,w),c.push(_,b,w)}if(this.setIndex(c),this.addAttribute("position",new k(l,3)),this.addAttribute("uv",new k(h,2)),this.computeVertexNormals(),r===2*Math.PI){var E=this.attributes.normal.array,x=new s,T=new s,S=new s;for(o=e*t.length*3,a=0,u=0;a<t.length;a++,u+=3)x.x=E[u+0],x.y=E[u+1],x.z=E[u+2],T.x=E[o+u+0],T.y=E[o+u+1],T.z=E[o+u+2],S.addVectors(x,T).normalize(),E[u+0]=E[o+u+0]=S.x,E[u+1]=E[o+u+1]=S.y,E[u+2]=E[o+u+2]=S.z}}function Jn(t,e){C.call(this),this.type="ShapeGeometry","object"===typeof e&&(console.warn("THREE.ShapeGeometry: Options parameter has been removed."),e=e.curveSegments),this.parameters={shapes:t,curveSegments:e},this.fromBufferGeometry(new Zn(t,e)),this.mergeVertices()}function Zn(t,e){function n(t){var n,s,c,l=i.length/3,h=t.extractPoints(e),f=h.shape,d=h.holes;if(!1===Qu.isClockWise(f))for(f=f.reverse(),n=0,s=d.length;n<s;n++)c=d[n],!0===Qu.isClockWise(c)&&(d[n]=c.reverse());var p=Qu.triangulateShape(f,d);for(n=0,s=d.length;n<s;n++)c=d[n],f=f.concat(c);for(n=0,s=f.length;n<s;n++){var m=f[n];i.push(m.x,m.y,0),o.push(0,0,1),a.push(m.x,m.y)}for(n=0,s=p.length;n<s;n++){var g=p[n],v=g[0]+l,y=g[1]+l,_=g[2]+l;r.push(v,y,_),u+=3}}B.call(this),this.type="ShapeBufferGeometry",this.parameters={shapes:t,curveSegments:e},e=e||12;var r=[],i=[],o=[],a=[],s=0,u=0;if(!1===Array.isArray(t))n(t);else for(var c=0;c<t.length;c++)n(t[c]),this.addGroup(s,u,c),s+=u,u=0;this.setIndex(r),this.addAttribute("position",new k(i,3)),this.addAttribute("normal",new k(o,3)),this.addAttribute("uv",new k(a,2))}function $n(t,e){if(e.shapes=[],Array.isArray(t))for(var n=0,r=t.length;n<r;n++){var i=t[n];e.shapes.push(i.uuid)}else e.shapes.push(t.uuid);return e}function tr(t,e){B.call(this),this.type="EdgesGeometry",this.parameters={thresholdAngle:e},e=void 0!==e?e:1;var n,r,i,o,a=[],s=Math.cos(Au.DEG2RAD*e),u=[0,0],c={},l=["a","b","c"];t.isBufferGeometry?(o=new C,o.fromBufferGeometry(t)):o=t.clone(),o.mergeVertices(),o.computeFaceNormals();for(var h=o.vertices,f=o.faces,d=0,p=f.length;d<p;d++)for(var m=f[d],g=0;g<3;g++)n=m[l[g]],r=m[l[(g+1)%3]],u[0]=Math.min(n,r),u[1]=Math.max(n,r),i=u[0]+","+u[1],void 0===c[i]?c[i]={index1:u[0],index2:u[1],face1:d,face2:void 0}:c[i].face2=d;for(i in c){var v=c[i];if(void 0===v.face2||f[v.face1].normal.dot(f[v.face2].normal)<=s){var y=h[v.index1];a.push(y.x,y.y,y.z),y=h[v.index2],a.push(y.x,y.y,y.z)}}this.addAttribute("position",new k(a,3))}function er(t,e,n,r,i,o,a,s){C.call(this),this.type="CylinderGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:i,openEnded:o,thetaStart:a,thetaLength:s},this.fromBufferGeometry(new nr(t,e,n,r,i,o,a,s)),this.mergeVertices()}function nr(t,e,n,r,o,a,u,c){function l(n){var o,a,l,v=new i,b=new s,w=0,E=!0===n?t:e,x=!0===n?1:-1;for(a=g,o=1;o<=r;o++)d.push(0,y*x,0),p.push(0,x,0),m.push(.5,.5),g++;for(l=g,o=0;o<=r;o++){var T=o/r,S=T*c+u,C=Math.cos(S),M=Math.sin(S);b.x=E*M,b.y=y*x,b.z=E*C,d.push(b.x,b.y,b.z),p.push(0,x,0),v.x=.5*C+.5,v.y=.5*M*x+.5,m.push(v.x,v.y),g++}for(o=0;o<r;o++){var A=a+o,I=l+o;!0===n?f.push(I,I+1,A):f.push(I+1,I,A),w+=3}h.addGroup(_,w,!0===n?1:2),_+=w}B.call(this),this.type="CylinderBufferGeometry",this.parameters={radiusTop:t,radiusBottom:e,height:n,radialSegments:r,heightSegments:o,openEnded:a,thetaStart:u,thetaLength:c};var h=this;t=void 0!==t?t:1,e=void 0!==e?e:1,n=n||1,r=Math.floor(r)||8,o=Math.floor(o)||1,a=void 0!==a&&a,u=void 0!==u?u:0,c=void 0!==c?c:2*Math.PI;var f=[],d=[],p=[],m=[],g=0,v=[],y=n/2,_=0;!function(){var i,a,l=new s,b=new s,w=0,E=(e-t)/n;for(a=0;a<=o;a++){var x=[],T=a/o,S=T*(e-t)+t;for(i=0;i<=r;i++){var C=i/r,M=C*c+u,A=Math.sin(M),I=Math.cos(M);b.x=S*A,b.y=-T*n+y,b.z=S*I,d.push(b.x,b.y,b.z),l.set(A,E,I).normalize(),p.push(l.x,l.y,l.z),m.push(C,1-T),x.push(g++)}v.push(x)}for(i=0;i<r;i++)for(a=0;a<o;a++){var R=v[a][i],P=v[a+1][i],N=v[a+1][i+1],D=v[a][i+1];f.push(R,P,D),f.push(P,N,D),w+=6}h.addGroup(_,w,0),_+=w}(),!1===a&&(t>0&&l(!0),e>0&&l(!1)),this.setIndex(f),this.addAttribute("position",new k(d,3)),this.addAttribute("normal",new k(p,3)),this.addAttribute("uv",new k(m,2))}function rr(t,e,n,r,i,o,a){er.call(this,0,t,e,n,r,i,o,a),this.type="ConeGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function ir(t,e,n,r,i,o,a){nr.call(this,0,t,e,n,r,i,o,a),this.type="ConeBufferGeometry",this.parameters={radius:t,height:e,radialSegments:n,heightSegments:r,openEnded:i,thetaStart:o,thetaLength:a}}function or(t,e,n,r){C.call(this),this.type="CircleGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},this.fromBufferGeometry(new ar(t,e,n,r)),this.mergeVertices()}function ar(t,e,n,r){B.call(this),this.type="CircleBufferGeometry",this.parameters={radius:t,segments:e,thetaStart:n,thetaLength:r},t=t||1,e=void 0!==e?Math.max(3,e):8,n=void 0!==n?n:0,r=void 0!==r?r:2*Math.PI;var o,a,u=[],c=[],l=[],h=[],f=new s,d=new i;for(c.push(0,0,0),l.push(0,0,1),h.push(.5,.5),a=0,o=3;a<=e;a++,o+=3){var p=n+a/e*r;f.x=t*Math.cos(p),f.y=t*Math.sin(p),c.push(f.x,f.y,f.z),l.push(0,0,1),d.x=(c[o]/t+1)/2,d.y=(c[o+1]/t+1)/2,h.push(d.x,d.y)}for(o=1;o<=e;o++)u.push(o,o+1,0);this.setIndex(u),this.addAttribute("position",new k(c,3)),this.addAttribute("normal",new k(l,3)),this.addAttribute("uv",new k(h,2))}function sr(t){z.call(this),this.type="ShadowMaterial",this.color=new y(0),this.transparent=!0,this.setValues(t)}function ur(t){q.call(this,t),this.type="RawShaderMaterial"}function cr(t){z.call(this),this.defines={STANDARD:""},this.type="MeshStandardMaterial",this.color=new y(16777215),this.roughness=.5,this.metalness=.5,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new y(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.roughnessMap=null,this.metalnessMap=null,this.alphaMap=null,this.envMap=null,this.envMapIntensity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function lr(t){cr.call(this),this.defines={PHYSICAL:""},this.type="MeshPhysicalMaterial",this.reflectivity=.5,this.clearCoat=0,this.clearCoatRoughness=0,this.setValues(t)}function hr(t){z.call(this),this.type="MeshPhongMaterial",this.color=new y(16777215),this.specular=new y(1118481),this.shininess=30,this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new y(0),this.emissiveIntensity=1,this.emissiveMap=null,this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=qa,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function fr(t){hr.call(this),this.defines={TOON:""},this.type="MeshToonMaterial",this.gradientMap=null,this.setValues(t)}function dr(t){z.call(this),this.type="MeshNormalMaterial",this.bumpMap=null,this.bumpScale=1,this.normalMap=null,this.normalScale=new i(1,1),this.displacementMap=null,this.displacementScale=1,this.displacementBias=0,this.wireframe=!1,this.wireframeLinewidth=1,this.fog=!1,this.lights=!1,this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function pr(t){z.call(this),this.type="MeshLambertMaterial",this.color=new y(16777215),this.map=null,this.lightMap=null,this.lightMapIntensity=1,this.aoMap=null,this.aoMapIntensity=1,this.emissive=new y(0),this.emissiveIntensity=1,this.emissiveMap=null,this.specularMap=null,this.alphaMap=null,this.envMap=null,this.combine=qa,this.reflectivity=1,this.refractionRatio=.98,this.wireframe=!1,this.wireframeLinewidth=1,this.wireframeLinecap="round",this.wireframeLinejoin="round",this.skinning=!1,this.morphTargets=!1,this.morphNormals=!1,this.setValues(t)}function mr(t){ke.call(this),this.type="LineDashedMaterial",this.scale=1,this.dashSize=3,this.gapSize=1,this.setValues(t)}function gr(t,e,n){var r=this,i=!1,o=0,a=0,s=void 0;this.onStart=void 0,this.onLoad=t,this.onProgress=e,this.onError=n,this.itemStart=function(t){a++,!1===i&&void 0!==r.onStart&&r.onStart(t,o,a),i=!0},this.itemEnd=function(t){o++,void 0!==r.onProgress&&r.onProgress(t,o,a),o===a&&(i=!1,void 0!==r.onLoad&&r.onLoad())},this.itemError=function(t){void 0!==r.onError&&r.onError(t)},this.resolveURL=function(t){return s?s(t):t},this.setURLModifier=function(t){return s=t,this}}function vr(t){this.manager=void 0!==t?t:tc}function yr(t){this.manager=void 0!==t?t:tc,this._parser=null}function _r(t){this.manager=void 0!==t?t:tc,this._parser=null}function br(t){this.manager=void 0!==t?t:tc}function wr(t){this.manager=void 0!==t?t:tc}function Er(t){this.manager=void 0!==t?t:tc}function xr(){this.type="Curve",this.arcLengthDivisions=200}function Tr(t,e,n,r,i,o,a,s){xr.call(this),this.type="EllipseCurve",this.aX=t||0,this.aY=e||0,this.xRadius=n||1,this.yRadius=r||1,this.aStartAngle=i||0,this.aEndAngle=o||2*Math.PI,this.aClockwise=a||!1,this.aRotation=s||0}function Sr(t,e,n,r,i,o){Tr.call(this,t,e,n,n,r,i,o),this.type="ArcCurve"}function Cr(){function t(t,o,a,s){e=t,n=a,r=-3*t+3*o-2*a-s,i=2*t-2*o+a+s}var e=0,n=0,r=0,i=0;return{initCatmullRom:function(e,n,r,i,o){t(n,r,o*(r-e),o*(i-n))},initNonuniformCatmullRom:function(e,n,r,i,o,a,s){var u=(n-e)/o-(r-e)/(o+a)+(r-n)/a,c=(r-n)/a-(i-n)/(a+s)+(i-r)/s;u*=a,c*=a,t(n,r,u,c)},calc:function(t){var o=t*t;return e+n*t+r*o+i*(o*t)}}}function Mr(t,e,n,r){xr.call(this),this.type="CatmullRomCurve3",this.points=t||[],this.closed=e||!1,this.curveType=n||"centripetal",this.tension=r||.5}function Ar(t,e,n,r,i){var o=.5*(r-e),a=.5*(i-n),s=t*t;return(2*n-2*r+o+a)*(t*s)+(-3*n+3*r-2*o-a)*s+o*t+n}function Ir(t,e){var n=1-t;return n*n*e}function Rr(t,e){return 2*(1-t)*t*e}function Pr(t,e){return t*t*e}function Nr(t,e,n,r){return Ir(t,e)+Rr(t,n)+Pr(t,r)}function Dr(t,e){var n=1-t;return n*n*n*e}function Or(t,e){var n=1-t;return 3*n*n*t*e}function kr(t,e){return 3*(1-t)*t*t*e}function Lr(t,e){return t*t*t*e}function Ur(t,e,n,r,i){return Dr(t,e)+Or(t,n)+kr(t,r)+Lr(t,i)}function Fr(t,e,n,r){xr.call(this),this.type="CubicBezierCurve",this.v0=t||new i,this.v1=e||new i,this.v2=n||new i,this.v3=r||new i}function Br(t,e,n,r){xr.call(this),this.type="CubicBezierCurve3",this.v0=t||new s,this.v1=e||new s,this.v2=n||new s,this.v3=r||new s}function Vr(t,e){xr.call(this),this.type="LineCurve",this.v1=t||new i,this.v2=e||new i}function jr(t,e){xr.call(this),this.type="LineCurve3",this.v1=t||new s,this.v2=e||new s}function Hr(t,e,n){xr.call(this),this.type="QuadraticBezierCurve",this.v0=t||new i,this.v1=e||new i,this.v2=n||new i}function Gr(t,e,n){xr.call(this),this.type="QuadraticBezierCurve3",this.v0=t||new s,this.v1=e||new s,this.v2=n||new s}function zr(t){xr.call(this),this.type="SplineCurve",this.points=t||[]}function Wr(){xr.call(this),this.type="CurvePath",this.curves=[],this.autoClose=!1}function qr(t){Wr.call(this),this.type="Path",this.currentPoint=new i,t&&this.setFromPoints(t)}function Yr(t){qr.call(this,t),this.uuid=Au.generateUUID(),this.type="Shape",this.holes=[]}function Kr(t,e){E.call(this),this.type="Light",this.color=new y(t),this.intensity=void 0!==e?e:1,this.receiveShadow=void 0}function Qr(t,e,n){Kr.call(this,t,n),this.type="HemisphereLight",this.castShadow=void 0,this.position.copy(E.DefaultUp),this.updateMatrix(),this.groundColor=new y(e)}function Xr(t){this.camera=t,this.bias=0,this.radius=1,this.mapSize=new i(512,512),this.map=null,this.matrix=new o}function Jr(){Xr.call(this,new Ee(50,1,.5,500))}function Zr(t,e,n,r,i,o){Kr.call(this,t,e),this.type="SpotLight",this.position.copy(E.DefaultUp),this.updateMatrix(),this.target=new E,Object.defineProperty(this,"power",{get:function(){return this.intensity*Math.PI},set:function(t){this.intensity=t/Math.PI}}),this.distance=void 0!==n?n:0,this.angle=void 0!==r?r:Math.PI/3,this.penumbra=void 0!==i?i:0,this.decay=void 0!==o?o:1,this.shadow=new Jr}function $r(t,e,n,r){Kr.call(this,t,e),this.type="PointLight",Object.defineProperty(this,"power",{get:function(){return 4*this.intensity*Math.PI},set:function(t){this.intensity=t/(4*Math.PI)}}),this.distance=void 0!==n?n:0,this.decay=void 0!==r?r:1,this.shadow=new Xr(new Ee(90,1,.5,500))}function ti(){Xr.call(this,new T(-5,5,5,-5,.5,500))}function ei(t,e){Kr.call(this,t,e),this.type="DirectionalLight",this.position.copy(E.DefaultUp),this.updateMatrix(),this.target=new E,this.shadow=new ti}function ni(t,e){Kr.call(this,t,e),this.type="AmbientLight",this.castShadow=void 0}function ri(t,e,n,r){Kr.call(this,t,e),this.type="RectAreaLight",this.width=void 0!==n?n:10,this.height=void 0!==r?r:10}function ii(t,e,n,r){pi.call(this,t,e,n,r)}function oi(t,e,n){pi.call(this,t,e,n)}function ai(t,e,n,r){this.parameterPositions=t,this._cachedIndex=0,this.resultBuffer=void 0!==r?r:new e.constructor(n),this.sampleValues=e,this.valueSize=n}function si(t,e,n,r){ai.call(this,t,e,n,r)}function ui(t,e,n,r){pi.call(this,t,e,n,r)}function ci(t,e,n,r){pi.call(this,t,e,n,r)}function li(t,e,n,r){pi.call(this,t,e,n,r)}function hi(t,e,n,r){ai.call(this,t,e,n,r),this._weightPrev=-0,this._offsetPrev=-0,this._weightNext=-0,this._offsetNext=-0}function fi(t,e,n,r){ai.call(this,t,e,n,r)}function di(t,e,n,r){ai.call(this,t,e,n,r)}function pi(t,e,n,r){if(void 0===t)throw new Error("THREE.KeyframeTrack: track name is undefined");if(void 0===e||0===e.length)throw new Error("THREE.KeyframeTrack: no keyframes in track named "+t);this.name=t,this.times=sc.convertArray(e,this.TimeBufferType),this.values=sc.convertArray(n,this.ValueBufferType),this.setInterpolation(r||this.DefaultInterpolation),this.validate(),this.optimize()}function mi(t,e,n,r){pi.call(this,t,e,n,r)}function gi(t,e,n){this.name=t,this.tracks=n,this.duration=void 0!==e?e:-1,this.uuid=Au.generateUUID(),this.duration<0&&this.resetDuration(),this.optimize()}function vi(t){this.manager=void 0!==t?t:tc,this.textures={}}function yi(t){this.manager=void 0!==t?t:tc}function _i(){}function bi(t){"boolean"===typeof t&&(console.warn("THREE.JSONLoader: showStatus parameter has been removed from constructor."),t=void 0),this.manager=void 0!==t?t:tc,this.withCredentials=!1}function wi(t){this.manager=void 0!==t?t:tc,this.texturePath=""}function Ei(t){"undefined"===typeof createImageBitmap&&console.warn("THREE.ImageBitmapLoader: createImageBitmap() not supported."),"undefined"===typeof fetch&&console.warn("THREE.ImageBitmapLoader: fetch() not supported."),this.manager=void 0!==t?t:tc,this.options=void 0}function xi(){this.type="ShapePath",this.color=new y,this.subPaths=[],this.currentPath=null}function Ti(t){this.type="Font",this.data=t}function Si(t,e,n,r){for(var i=String(t).split(""),o=e/r.resolution,a=(r.boundingBox.yMax-r.boundingBox.yMin+r.underlineThickness)*o,s=[],u=0,c=0,l=0;l<i.length;l++){var h=i[l];if("\n"===h)u=0,c-=a;else{var f=Ci(h,n,o,u,c,r);u+=f.offsetX,s.push(f.path)}}return s}function Ci(t,e,n,r,i,o){var a=o.glyphs[t]||o.glyphs["?"];if(a){var s,u,c,l,h,f,d,p,m=new xi;if(a.o)for(var g=a._cachedOutline||(a._cachedOutline=a.o.split(" ")),v=0,y=g.length;v<y;){var _=g[v++];switch(_){case"m":s=g[v++]*n+r,u=g[v++]*n+i,m.moveTo(s,u);break;case"l":s=g[v++]*n+r,u=g[v++]*n+i,m.lineTo(s,u);break;case"q":c=g[v++]*n+r,l=g[v++]*n+i,h=g[v++]*n+r,f=g[v++]*n+i,m.quadraticCurveTo(h,f,c,l);break;case"b":c=g[v++]*n+r,l=g[v++]*n+i,h=g[v++]*n+r,f=g[v++]*n+i,d=g[v++]*n+r,p=g[v++]*n+i,m.bezierCurveTo(h,f,d,p,c,l)}}return{offsetX:a.ha*n,path:m}}}function Mi(t){this.manager=void 0!==t?t:tc}function Ai(t){this.manager=void 0!==t?t:tc}function Ii(){this.type="StereoCamera",this.aspect=1,this.eyeSep=.064,this.cameraL=new Ee,this.cameraL.layers.enable(1),this.cameraL.matrixAutoUpdate=!1,this.cameraR=new Ee,this.cameraR.layers.enable(2),this.cameraR.matrixAutoUpdate=!1}function Ri(t,e,n){E.call(this),this.type="CubeCamera";var r=new Ee(90,1,t,e);r.up.set(0,-1,0),r.lookAt(new s(1,0,0)),this.add(r);var i=new Ee(90,1,t,e);i.up.set(0,-1,0),i.lookAt(new s(-1,0,0)),this.add(i);var o=new Ee(90,1,t,e);o.up.set(0,0,1),o.lookAt(new s(0,1,0)),this.add(o);var a=new Ee(90,1,t,e);a.up.set(0,0,-1),a.lookAt(new s(0,-1,0)),this.add(a);var u=new Ee(90,1,t,e);u.up.set(0,-1,0),u.lookAt(new s(0,0,1)),this.add(u);var c=new Ee(90,1,t,e);c.up.set(0,-1,0),c.lookAt(new s(0,0,-1)),this.add(c);var l={format:Rs,magFilter:ps,minFilter:ps};this.renderTarget=new f(n,n,l),this.renderTarget.texture.name="CubeCamera",this.update=function(t,e){null===this.parent&&this.updateMatrixWorld();var n=this.renderTarget,s=n.texture.generateMipmaps;n.texture.generateMipmaps=!1,n.activeCubeFace=0,t.render(e,r,n),n.activeCubeFace=1,t.render(e,i,n),n.activeCubeFace=2,t.render(e,o,n),n.activeCubeFace=3,t.render(e,a,n),n.activeCubeFace=4,t.render(e,u,n),n.texture.generateMipmaps=s,n.activeCubeFace=5,t.render(e,c,n),t.setRenderTarget(null)},this.clear=function(t,e,n,r){for(var i=this.renderTarget,o=0;o<6;o++)i.activeCubeFace=o,t.setRenderTarget(i),t.clear(e,n,r);t.setRenderTarget(null)}}function Pi(){E.call(this),this.type="AudioListener",this.context=pc.getContext(),this.gain=this.context.createGain(),this.gain.connect(this.context.destination),this.filter=null}function Ni(t){E.call(this),this.type="Audio",this.context=t.context,this.gain=this.context.createGain(),this.gain.connect(t.getInput()),this.autoplay=!1,this.buffer=null,this.loop=!1,this.startTime=0,this.offset=0,this.playbackRate=1,this.isPlaying=!1,this.hasPlaybackControl=!0,this.sourceType="empty",this.filters=[]}function Di(t){Ni.call(this,t),this.panner=this.context.createPanner(),this.panner.connect(this.gain)}function Oi(t,e){this.analyser=t.context.createAnalyser(),this.analyser.fftSize=void 0!==e?e:2048,this.data=new Uint8Array(this.analyser.frequencyBinCount),t.getOutput().connect(this.analyser)}function ki(t,e,n){this.binding=t,this.valueSize=n;var r,i=Float64Array;switch(e){case"quaternion":r=this._slerp;break;case"string":case"bool":i=Array,r=this._select;break;default:r=this._lerp}this.buffer=new i(4*n),this._mixBufferRegion=r,this.cumulativeWeight=0,this.useCount=0,this.referenceCount=0}function Li(t,e,n){var r=n||Ui.parseTrackName(e);this._targetGroup=t,this._bindings=t.subscribe_(e,r)}function Ui(t,e,n){this.path=e,this.parsedPath=n||Ui.parseTrackName(e),this.node=Ui.findNode(t,this.parsedPath.nodeName)||t,this.rootNode=t}function Fi(){this.uuid=Au.generateUUID(),this._objects=Array.prototype.slice.call(arguments),this.nCachedObjects_=0;var t={};this._indicesByUUID=t;for(var e=0,n=arguments.length;e!==n;++e)t[arguments[e].uuid]=e;this._paths=[],this._parsedPaths=[],this._bindings=[],this._bindingsIndicesByPath={};var r=this;this.stats={objects:{get total(){return r._objects.length},get inUse(){return this.total-r.nCachedObjects_}},get bindingsPerObject(){return r._bindings.length}}}function Bi(t,e,n){this._mixer=t,this._clip=e,this._localRoot=n||null;for(var r=e.tracks,i=r.length,o=new Array(i),a={endingStart:fu,endingEnd:fu},s=0;s!==i;++s){var u=r[s].createInterpolant(null);o[s]=u,u.settings=a}this._interpolantSettings=a,this._interpolants=o,this._propertyBindings=new Array(i),this._cacheIndex=null,this._byClipCacheIndex=null,this._timeScaleInterpolant=null,this._weightInterpolant=null,this.loop=su,this._loopCount=-1,this._startTime=null,this.time=0,this.timeScale=1,this._effectiveTimeScale=1,this.weight=1,this._effectiveWeight=1,this.repetitions=1/0,this.paused=!1,this.enabled=!0,this.clampWhenFinished=!1,this.zeroSlopeAtStart=!0,this.zeroSlopeAtEnd=!0}function Vi(t){this._root=t,this._initMemoryManager(),this._accuIndex=0,this.time=0,this.timeScale=1}function ji(t){"string"===typeof t&&(console.warn("THREE.Uniform: Type parameter is no longer needed."),t=arguments[1]),this.value=t}function Hi(){B.call(this),this.type="InstancedBufferGeometry",this.maxInstancedCount=void 0}function Gi(t,e,n,r){this.data=t,this.itemSize=e,this.offset=n,this.normalized=!0===r}function zi(t,e){this.array=t,this.stride=e,this.count=void 0!==t?t.length/e:0,this.dynamic=!1,this.updateRange={offset:0,count:-1},this.version=0}function Wi(t,e,n){zi.call(this,t,e),this.meshPerAttribute=n||1}function qi(t,e,n){M.call(this,t,e),this.meshPerAttribute=n||1}function Yi(t,e,n,r){this.ray=new Y(t,e),this.near=n||0,this.far=r||1/0,this.params={Mesh:{},Line:{},LOD:{},Points:{threshold:1},Sprite:{}},Object.defineProperties(this.params,{PointCloud:{get:function(){return console.warn("THREE.Raycaster: params.PointCloud has been renamed to params.Points."),this.Points}}})}function Ki(t,e){return t.distance-e.distance}function Qi(t,e,n,r){if(!1!==t.visible&&(t.raycast(e,n),!0===r))for(var i=t.children,o=0,a=i.length;o<a;o++)Qi(i[o],e,n,!0)}function Xi(t){this.autoStart=void 0===t||t,this.startTime=0,this.oldTime=0,this.elapsedTime=0,this.running=!1}function Ji(t,e,n){return this.radius=void 0!==t?t:1,this.phi=void 0!==e?e:0,this.theta=void 0!==n?n:0,this}function Zi(t,e,n){return this.radius=void 0!==t?t:1,this.theta=void 0!==e?e:0,this.y=void 0!==n?n:0,this}function $i(t,e){this.min=void 0!==t?t:new i(1/0,1/0),this.max=void 0!==e?e:new i(-1/0,-1/0)}function to(t){E.call(this),this.material=t,this.render=function(){}}function eo(t,e,n,r){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==n?n:16711680,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=3*s.faces.length:s&&s.isBufferGeometry&&(a=s.attributes.normal.count);var u=new B,c=new k(2*a*3,3);u.addAttribute("position",c),Ue.call(this,u,new ke({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function no(t,e){E.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;for(var n=new B,r=[0,0,0,0,0,1,0,0,0,1,0,1,0,0,0,-1,0,1,0,0,0,0,1,1,0,0,0,0,-1,1],i=0,o=1;i<32;i++,o++){var a=i/32*Math.PI*2,s=o/32*Math.PI*2;r.push(Math.cos(a),Math.sin(a),1,Math.cos(s),Math.sin(s),1)}n.addAttribute("position",new k(r,3));var u=new ke({fog:!1});this.cone=new Ue(n,u),this.add(this.cone),this.update()}function ro(t){var e=[];t&&t.isBone&&e.push(t);for(var n=0;n<t.children.length;n++)e.push.apply(e,ro(t.children[n]));return e}function io(t){for(var e=ro(t),n=new B,r=[],i=[],o=new y(0,0,1),a=new y(0,1,0),s=0;s<e.length;s++){var u=e[s];u.parent&&u.parent.isBone&&(r.push(0,0,0),r.push(0,0,0),i.push(o.r,o.g,o.b),i.push(a.r,a.g,a.b))}n.addAttribute("position",new k(r,3)),n.addAttribute("color",new k(i,3));var c=new ke({vertexColors:ma,depthTest:!1,depthWrite:!1,transparent:!0});Ue.call(this,n,c),this.root=t,this.bones=e,this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1}function oo(t,e,n){this.light=t,this.light.updateMatrixWorld(),this.color=n;var r=new qn(e,4,2),i=new W({wireframe:!0,fog:!1});X.call(this,r,i),this.matrix=this.light.matrixWorld,this.matrixAutoUpdate=!1,this.update()}function ao(t,e){E.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=e;var n=new ke({fog:!1}),r=new B;r.addAttribute("position",new M(new Float32Array(15),3)),this.line=new Le(r,n),this.add(this.line),this.update()}function so(t,e,n){E.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n;var r=new $e(e);r.rotateY(.5*Math.PI),this.material=new W({wireframe:!0,fog:!1}),void 0===this.color&&(this.material.vertexColors=ma);var i=r.getAttribute("position"),o=new Float32Array(3*i.count);r.addAttribute("color",new M(o,3)),this.add(new X(r,this.material)),this.update()}function uo(t,e,n,r){t=t||10,e=e||10,n=new y(void 0!==n?n:4473924),r=new y(void 0!==r?r:8947848);for(var i=e/2,o=t/e,a=t/2,s=[],u=[],c=0,l=0,h=-a;c<=e;c++,h+=o){s.push(-a,0,h,a,0,h),s.push(h,0,-a,h,0,a);var f=c===i?n:r;f.toArray(u,l),l+=3,f.toArray(u,l),l+=3,f.toArray(u,l),l+=3,f.toArray(u,l),l+=3}var d=new B;d.addAttribute("position",new k(s,3)),d.addAttribute("color",new k(u,3));var p=new ke({vertexColors:ma});Ue.call(this,d,p)}function co(t,e,n,r,i,o){t=t||10,e=e||16,n=n||8,r=r||64,i=new y(void 0!==i?i:4473924),o=new y(void 0!==o?o:8947848);var a,s,u,c,l,h,f,d=[],p=[];for(c=0;c<=e;c++)u=c/e*(2*Math.PI),a=Math.sin(u)*t,s=Math.cos(u)*t,d.push(0,0,0),d.push(a,0,s),f=1&c?i:o,p.push(f.r,f.g,f.b),p.push(f.r,f.g,f.b);for(c=0;c<=n;c++)for(f=1&c?i:o,h=t-t/n*c,l=0;l<r;l++)u=l/r*(2*Math.PI),a=Math.sin(u)*h,s=Math.cos(u)*h,d.push(a,0,s),p.push(f.r,f.g,f.b),u=(l+1)/r*(2*Math.PI),a=Math.sin(u)*h,s=Math.cos(u)*h,d.push(a,0,s),p.push(f.r,f.g,f.b);var m=new B;m.addAttribute("position",new k(d,3)),m.addAttribute("color",new k(p,3));var g=new ke({vertexColors:ma});Ue.call(this,m,g)}function lo(t,e,n,r){this.object=t,this.size=void 0!==e?e:1;var i=void 0!==n?n:16776960,o=void 0!==r?r:1,a=0,s=this.object.geometry;s&&s.isGeometry?a=s.faces.length:console.warn("THREE.FaceNormalsHelper: only THREE.Geometry is supported. Use THREE.VertexNormalsHelper, instead.");var u=new B,c=new k(2*a*3,3);u.addAttribute("position",c),Ue.call(this,u,new ke({color:i,linewidth:o})),this.matrixAutoUpdate=!1,this.update()}function ho(t,e,n){E.call(this),this.light=t,this.light.updateMatrixWorld(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.color=n,void 0===e&&(e=1);var r=new B;r.addAttribute("position",new k([-e,e,0,e,e,0,e,-e,0,-e,-e,0,-e,e,0],3));var i=new ke({fog:!1});this.lightPlane=new Le(r,i),this.add(this.lightPlane),r=new B,r.addAttribute("position",new k([0,0,0,0,0,1],3)),this.targetLine=new Le(r,i),this.add(this.targetLine),this.update()}function fo(t){function e(t,e,r){n(t,r),n(e,r)}function n(t,e){o.push(0,0,0),a.push(e.r,e.g,e.b),void 0===s[t]&&(s[t]=[]),s[t].push(o.length/3-1)}var r=new B,i=new ke({color:16777215,vertexColors:pa}),o=[],a=[],s={},u=new y(16755200),c=new y(16711680),l=new y(43775),h=new y(16777215),f=new y(3355443);e("n1","n2",u),e("n2","n4",u),e("n4","n3",u),e("n3","n1",u),e("f1","f2",u),e("f2","f4",u),e("f4","f3",u),e("f3","f1",u),e("n1","f1",u),e("n2","f2",u),e("n3","f3",u),e("n4","f4",u),e("p","n1",c),e("p","n2",c),e("p","n3",c),e("p","n4",c),e("u1","u2",l),e("u2","u3",l),e("u3","u1",l),e("c","t",h),e("p","c",f),e("cn1","cn2",f),e("cn3","cn4",f),e("cf1","cf2",f),e("cf3","cf4",f),r.addAttribute("position",new k(o,3)),r.addAttribute("color",new k(a,3)),Ue.call(this,r,i),this.camera=t,this.camera.updateProjectionMatrix&&this.camera.updateProjectionMatrix(),this.matrix=t.matrixWorld,this.matrixAutoUpdate=!1,this.pointMap=s,this.update()}function po(t,e){this.object=t,void 0===e&&(e=16776960);var n=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),r=new Float32Array(24),i=new B;i.setIndex(new M(n,1)),i.addAttribute("position",new M(r,3)),Ue.call(this,i,new ke({color:e})),this.matrixAutoUpdate=!1,this.update()}function mo(t,e){this.type="Box3Helper",this.box=t;var n=void 0!==e?e:16776960,r=new Uint16Array([0,1,1,2,2,3,3,0,4,5,5,6,6,7,7,4,0,4,1,5,2,6,3,7]),i=[1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,-1,-1,1,-1,-1,-1,-1,1,-1,-1],o=new B;o.setIndex(new M(r,1)),o.addAttribute("position",new k(i,3)),Ue.call(this,o,new ke({color:n})),this.geometry.computeBoundingSphere()}function go(t,e,n){this.type="PlaneHelper",this.plane=t,this.size=void 0===e?1:e;var r=void 0!==n?n:16776960,i=[1,-1,1,-1,1,1,-1,-1,1,1,1,1,-1,1,1,-1,-1,1,1,-1,1,1,1,1,0,0,1,0,0,0],o=new B;o.addAttribute("position",new k(i,3)),o.computeBoundingSphere(),Le.call(this,o,new ke({color:r}));var a=[1,1,1,-1,1,1,-1,-1,1,1,1,1,-1,-1,1,1,-1,1],s=new B;s.addAttribute("position",new k(a,3)),s.computeBoundingSphere(),this.add(new X(s,new W({color:r,opacity:.2,transparent:!0,depthWrite:!1})))}function vo(t,e,n,r,i,o){E.call(this),void 0===r&&(r=16776960),void 0===n&&(n=1),void 0===i&&(i=.2*n),void 0===o&&(o=.2*i),void 0===gc&&(gc=new B,gc.addAttribute("position",new k([0,0,0,0,1,0],3)),vc=new nr(0,.5,1,5,1),vc.translate(0,-.5,0)),this.position.copy(e),this.line=new Le(gc,new ke({color:r})),this.line.matrixAutoUpdate=!1,this.add(this.line),this.cone=new X(vc,new W({color:r})),this.cone.matrixAutoUpdate=!1,this.add(this.cone),this.setDirection(t),this.setLength(n,i,o)}function yo(t){t=t||1;var e=[0,0,0,t,0,0,0,0,0,0,t,0,0,0,0,0,0,t],n=[1,0,0,1,.6,0,0,1,0,.6,1,0,0,0,1,0,.6,1],r=new B;r.addAttribute("position",new k(e,3)),r.addAttribute("color",new k(n,3));var i=new ke({vertexColors:ma});Ue.call(this,r,i)}function _o(t,e,n,r,i,o,a){return console.warn("THREE.Face4 has been removed. A THREE.Face3 will be created instead."),new S(t,e,n,i,o,a)}function bo(t){return console.warn("THREE.MeshFaceMaterial has been removed. Use an Array instead."),t}function wo(t){return void 0===t&&(t=[]),console.warn("THREE.MultiMaterial has been removed. Use an Array instead."),t.isMultiMaterial=!0,t.materials=t,t.clone=function(){return t.slice()},t}function Eo(t,e){return console.warn("THREE.PointCloud has been renamed to THREE.Points."),new Ve(t,e)}function xo(t){return console.warn("THREE.Particle has been renamed to THREE.Sprite."),new Re(t)}function To(t,e){return console.warn("THREE.ParticleSystem has been renamed to THREE.Points."),new Ve(t,e)}function So(t){return console.warn("THREE.PointCloudMaterial has been renamed to THREE.PointsMaterial."),new Be(t)}function Co(t){return console.warn("THREE.ParticleBasicMaterial has been renamed to THREE.PointsMaterial."),new Be(t)}function Mo(t){return console.warn("THREE.ParticleSystemMaterial has been renamed to THREE.PointsMaterial."),new Be(t)}function Ao(t,e,n){return console.warn("THREE.Vertex has been removed. Use THREE.Vector3 instead."),new s(t,e,n)}function Io(t,e){return console.warn("THREE.DynamicBufferAttribute has been removed. Use new THREE.BufferAttribute().setDynamic( true ) instead."),new M(t,e).setDynamic(!0)}function Ro(t,e){return console.warn("THREE.Int8Attribute has been removed. Use new THREE.Int8BufferAttribute() instead."),new A(t,e)}function Po(t,e){return console.warn("THREE.Uint8Attribute has been removed. Use new THREE.Uint8BufferAttribute() instead."),new I(t,e)}function No(t,e){return console.warn("THREE.Uint8ClampedAttribute has been removed. Use new THREE.Uint8ClampedBufferAttribute() instead."),new R(t,e)}function Do(t,e){return console.warn("THREE.Int16Attribute has been removed. Use new THREE.Int16BufferAttribute() instead."),new P(t,e)}function Oo(t,e){return console.warn("THREE.Uint16Attribute has been removed. Use new THREE.Uint16BufferAttribute() instead."),new N(t,e)}function ko(t,e){return console.warn("THREE.Int32Attribute has been removed. Use new THREE.Int32BufferAttribute() instead."),new D(t,e)}function Lo(t,e){return console.warn("THREE.Uint32Attribute has been removed. Use new THREE.Uint32BufferAttribute() instead."),new O(t,e)}function Uo(t,e){return console.warn("THREE.Float32Attribute has been removed. Use new THREE.Float32BufferAttribute() instead."),new k(t,e)}function Fo(t,e){return console.warn("THREE.Float64Attribute has been removed. Use new THREE.Float64BufferAttribute() instead."),new L(t,e)}function Bo(t){console.warn("THREE.ClosedSplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Mr.call(this,t),this.type="catmullrom",this.closed=!0}function Vo(t){console.warn("THREE.SplineCurve3 has been deprecated. Use THREE.CatmullRomCurve3 instead."),Mr.call(this,t),this.type="catmullrom"}function jo(t){console.warn("THREE.Spline has been removed. Use THREE.CatmullRomCurve3 instead."),Mr.call(this,t),this.type="catmullrom"}function Ho(t){return console.warn("THREE.AxisHelper has been renamed to THREE.AxesHelper."),new yo(t)}function Go(t,e){return console.warn("THREE.BoundingBoxHelper has been deprecated. Creating a THREE.BoxHelper instead."),new po(t,e)}function zo(t,e){return console.warn("THREE.EdgesHelper has been removed. Use THREE.EdgesGeometry instead."),new Ue(new tr(t.geometry),new ke({color:void 0!==e?e:16777215}))}function Wo(t,e){return console.warn("THREE.WireframeHelper has been removed. Use THREE.WireframeGeometry instead."),new Ue(new We(t.geometry),new ke({color:void 0!==e?e:16777215}))}function qo(t){return console.warn("THREE.XHRLoader has been renamed to THREE.FileLoader."),new vr(t)}function Yo(t){return console.warn("THREE.BinaryTextureLoader has been renamed to THREE.DataTextureLoader."),new _r(t)}function Ko(){console.error("THREE.Projector has been moved to /examples/js/renderers/Projector.js."),this.projectVector=function(t,e){console.warn("THREE.Projector: .projectVector() is now vector.project()."),t.project(e)},this.unprojectVector=function(t,e){console.warn("THREE.Projector: .unprojectVector() is now vector.unproject()."),t.unproject(e)},this.pickingRay=function(){console.error("THREE.Projector: .pickingRay() is now raycaster.setFromCamera().")}}function Qo(){console.error("THREE.CanvasRenderer has been moved to /examples/js/renderers/CanvasRenderer.js"),this.domElement=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),this.clear=function(){},this.render=function(){},this.setClearColor=function(){},this.setSize=function(){}}function Xo(){console.error("THREE.LensFlare has been moved to /examples/js/objects/Lensflare.js")}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"WebGLRenderTargetCube",function(){return f}),n.d(e,"WebGLRenderTarget",function(){return h}),n.d(e,"WebGLRenderer",function(){return Se}),n.d(e,"ShaderLib",function(){return Ou}),n.d(e,"UniformsLib",function(){return Du}),n.d(e,"UniformsUtils",function(){return Pu}),n.d(e,"ShaderChunk",function(){return Ru}),n.d(e,"FogExp2",function(){return Ce}),n.d(e,"Fog",function(){return Me}),n.d(e,"Scene",function(){return Ae}),n.d(e,"Sprite",function(){return Re}),n.d(e,"LOD",function(){return Pe}),n.d(e,"SkinnedMesh",function(){return Oe}),n.d(e,"Skeleton",function(){return Ne}),n.d(e,"Bone",function(){return De}),n.d(e,"Mesh",function(){return X}),n.d(e,"LineSegments",function(){return Ue}),n.d(e,"LineLoop",function(){return Fe}),n.d(e,"Line",function(){return Le}),n.d(e,"Points",function(){return Ve}),n.d(e,"Group",function(){return je}),n.d(e,"VideoTexture",function(){return He}),n.d(e,"DataTexture",function(){return d}),n.d(e,"CompressedTexture",function(){return Ge}),n.d(e,"CubeTexture",function(){return ut}),n.d(e,"CanvasTexture",function(){return ve}),n.d(e,"DepthTexture",function(){return ze}),n.d(e,"Texture",function(){return c}),n.d(e,"CompressedTextureLoader",function(){return yr}),n.d(e,"DataTextureLoader",function(){return _r}),n.d(e,"CubeTextureLoader",function(){return wr}),n.d(e,"TextureLoader",function(){return Er}),n.d(e,"ObjectLoader",function(){return wi}),n.d(e,"MaterialLoader",function(){return vi}),n.d(e,"BufferGeometryLoader",function(){return yi}),n.d(e,"DefaultLoadingManager",function(){return tc}),n.d(e,"LoadingManager",function(){return gr}),n.d(e,"JSONLoader",function(){return bi}),n.d(e,"ImageLoader",function(){return br}),n.d(e,"ImageBitmapLoader",function(){return Ei}),n.d(e,"FontLoader",function(){return Mi}),n.d(e,"FileLoader",function(){return vr}),n.d(e,"Loader",function(){return _i}),n.d(e,"LoaderUtils",function(){return cc}),n.d(e,"Cache",function(){return $u}),n.d(e,"AudioLoader",function(){return Ai}),n.d(e,"SpotLightShadow",function(){return Jr}),n.d(e,"SpotLight",function(){return Zr}),n.d(e,"PointLight",function(){return $r}),n.d(e,"RectAreaLight",function(){return ri}),n.d(e,"HemisphereLight",function(){return Qr}),n.d(e,"DirectionalLightShadow",function(){return ti}),n.d(e,"DirectionalLight",function(){return ei}),n.d(e,"AmbientLight",function(){return ni}),n.d(e,"LightShadow",function(){return Xr}),n.d(e,"Light",function(){return Kr}),n.d(e,"StereoCamera",function(){return Ii}),n.d(e,"PerspectiveCamera",function(){return Ee}),n.d(e,"OrthographicCamera",function(){return T}),n.d(e,"CubeCamera",function(){return Ri}),n.d(e,"ArrayCamera",function(){return xe}),n.d(e,"Camera",function(){return x}),n.d(e,"AudioListener",function(){return Pi}),n.d(e,"PositionalAudio",function(){return Di}),n.d(e,"AudioContext",function(){return pc}),n.d(e,"AudioAnalyser",function(){return Oi}),n.d(e,"Audio",function(){return Ni}),n.d(e,"VectorKeyframeTrack",function(){return mi}),n.d(e,"StringKeyframeTrack",function(){return ii}),n.d(e,"QuaternionKeyframeTrack",function(){return ui}),n.d(e,"NumberKeyframeTrack",function(){return li}),n.d(e,"ColorKeyframeTrack",function(){return ci}),n.d(e,"BooleanKeyframeTrack",function(){return oi}),n.d(e,"PropertyMixer",function(){return ki}),n.d(e,"PropertyBinding",function(){return Ui}),n.d(e,"KeyframeTrack",function(){return pi}),n.d(e,"AnimationUtils",function(){return sc}),n.d(e,"AnimationObjectGroup",function(){return Fi}),n.d(e,"AnimationMixer",function(){return Vi}),n.d(e,"AnimationClip",function(){return gi}),n.d(e,"Uniform",function(){return ji}),n.d(e,"InstancedBufferGeometry",function(){return Hi}),n.d(e,"BufferGeometry",function(){return B}),n.d(e,"Geometry",function(){return C}),n.d(e,"InterleavedBufferAttribute",function(){return Gi}),n.d(e,"InstancedInterleavedBuffer",function(){return Wi}),n.d(e,"InterleavedBuffer",function(){return zi}),n.d(e,"InstancedBufferAttribute",function(){return qi}),n.d(e,"Face3",function(){return S}),n.d(e,"Object3D",function(){return E}),n.d(e,"Raycaster",function(){return Yi}),n.d(e,"Layers",function(){return w}),n.d(e,"EventDispatcher",function(){return r}),n.d(e,"Clock",function(){return Xi}),n.d(e,"QuaternionLinearInterpolant",function(){return si}),n.d(e,"LinearInterpolant",function(){return fi}),n.d(e,"DiscreteInterpolant",function(){return di}),n.d(e,"CubicInterpolant",function(){return hi}),n.d(e,"Interpolant",function(){return ai}),n.d(e,"Triangle",function(){return Q}),n.d(e,"Math",function(){return Au}),n.d(e,"Spherical",function(){return Ji}),n.d(e,"Cylindrical",function(){return Zi}),n.d(e,"Plane",function(){return g}),n.d(e,"Frustum",function(){return v}),n.d(e,"Sphere",function(){return m}),n.d(e,"Ray",function(){return Y}),n.d(e,"Matrix4",function(){return o}),n.d(e,"Matrix3",function(){return u}),n.d(e,"Box3",function(){return p}),n.d(e,"Box2",function(){return $i}),n.d(e,"Line3",function(){return K}),n.d(e,"Euler",function(){return b}),n.d(e,"Vector4",function(){return l}),n.d(e,"Vector3",function(){return s}),n.d(e,"Vector2",function(){return i}),n.d(e,"Quaternion",function(){return a}),n.d(e,"Color",function(){return y}),n.d(e,"ImmediateRenderObject",function(){return to}),n.d(e,"VertexNormalsHelper",function(){return eo}),n.d(e,"SpotLightHelper",function(){return no}),n.d(e,"SkeletonHelper",function(){return io}),n.d(e,"PointLightHelper",function(){return oo}),n.d(e,"RectAreaLightHelper",function(){return ao}),n.d(e,"HemisphereLightHelper",function(){return so}),n.d(e,"GridHelper",function(){return uo}),n.d(e,"PolarGridHelper",function(){return co}),n.d(e,"FaceNormalsHelper",function(){return lo}),n.d(e,"DirectionalLightHelper",function(){return ho}),n.d(e,"CameraHelper",function(){return fo}),n.d(e,"BoxHelper",function(){return po}),n.d(e,"Box3Helper",function(){return mo}),n.d(e,"PlaneHelper",function(){return go}),n.d(e,"ArrowHelper",function(){return vo}),n.d(e,"AxesHelper",function(){return yo}),n.d(e,"Shape",function(){return Yr}),n.d(e,"Path",function(){return qr}),n.d(e,"ShapePath",function(){return xi}),n.d(e,"Font",function(){return Ti}),n.d(e,"CurvePath",function(){return Wr}),n.d(e,"Curve",function(){return xr}),n.d(e,"ShapeUtils",function(){return Qu}),n.d(e,"WebGLUtils",function(){return we}),n.d(e,"WireframeGeometry",function(){return We}),n.d(e,"ParametricGeometry",function(){return qe}),n.d(e,"ParametricBufferGeometry",function(){return Ye}),n.d(e,"TetrahedronGeometry",function(){return Xe}),n.d(e,"TetrahedronBufferGeometry",function(){return Je}),n.d(e,"OctahedronGeometry",function(){return Ze}),n.d(e,"OctahedronBufferGeometry",function(){return $e}),n.d(e,"IcosahedronGeometry",function(){return tn}),n.d(e,"IcosahedronBufferGeometry",function(){return en}),n.d(e,"DodecahedronGeometry",function(){return nn}),n.d(e,"DodecahedronBufferGeometry",function(){return rn}),n.d(e,"PolyhedronGeometry",function(){return Ke}),n.d(e,"PolyhedronBufferGeometry",function(){return Qe}),n.d(e,"TubeGeometry",function(){return on}),n.d(e,"TubeBufferGeometry",function(){return an}),n.d(e,"TorusKnotGeometry",function(){return sn}),n.d(e,"TorusKnotBufferGeometry",function(){return un}),n.d(e,"TorusGeometry",function(){return cn}),n.d(e,"TorusBufferGeometry",function(){return ln}),n.d(e,"TextGeometry",function(){return Gn}),n.d(e,"TextBufferGeometry",function(){return zn}),n.d(e,"SphereGeometry",function(){return Wn}),n.d(e,"SphereBufferGeometry",function(){return qn}),n.d(e,"RingGeometry",function(){return Yn}),n.d(e,"RingBufferGeometry",function(){return Kn}),n.d(e,"PlaneGeometry",function(){return H}),n.d(e,"PlaneBufferGeometry",function(){return G}),n.d(e,"LatheGeometry",function(){return Qn}),n.d(e,"LatheBufferGeometry",function(){return Xn}),n.d(e,"ShapeGeometry",function(){return Jn}),n.d(e,"ShapeBufferGeometry",function(){return Zn}),n.d(e,"ExtrudeGeometry",function(){return jn}),n.d(e,"ExtrudeBufferGeometry",function(){return Hn}),n.d(e,"EdgesGeometry",function(){return tr}),n.d(e,"ConeGeometry",function(){return rr}),n.d(e,"ConeBufferGeometry",function(){return ir}),n.d(e,"CylinderGeometry",function(){return er}),n.d(e,"CylinderBufferGeometry",function(){return nr}),n.d(e,"CircleGeometry",function(){return or}),n.d(e,"CircleBufferGeometry",function(){return ar}),n.d(e,"BoxGeometry",function(){return V}),n.d(e,"BoxBufferGeometry",function(){return j}),n.d(e,"ShadowMaterial",function(){return sr}),n.d(e,"SpriteMaterial",function(){return Ie}),n.d(e,"RawShaderMaterial",function(){return ur}),n.d(e,"ShaderMaterial",function(){return q}),n.d(e,"PointsMaterial",function(){return Be}),n.d(e,"MeshPhysicalMaterial",function(){return lr}),n.d(e,"MeshStandardMaterial",function(){return cr}),n.d(e,"MeshPhongMaterial",function(){return hr}),n.d(e,"MeshToonMaterial",function(){return fr}),n.d(e,"MeshNormalMaterial",function(){return dr}),n.d(e,"MeshLambertMaterial",function(){return pr}),n.d(e,"MeshDepthMaterial",function(){return pe}),n.d(e,"MeshDistanceMaterial",function(){return me}),n.d(e,"MeshBasicMaterial",function(){return W});n.d(e,"LineDashedMaterial",function(){return mr}),n.d(e,"LineBasicMaterial",function(){return ke}),n.d(e,"Material",function(){return z}),n.d(e,"Float64BufferAttribute",function(){return L}),n.d(e,"Float32BufferAttribute",function(){return k}),n.d(e,"Uint32BufferAttribute",function(){return O}),n.d(e,"Int32BufferAttribute",function(){return D}),n.d(e,"Uint16BufferAttribute",function(){return N}),n.d(e,"Int16BufferAttribute",function(){return P}),n.d(e,"Uint8ClampedBufferAttribute",function(){return R}),n.d(e,"Uint8BufferAttribute",function(){return I}),n.d(e,"Int8BufferAttribute",function(){return A}),n.d(e,"BufferAttribute",function(){return M}),n.d(e,"ArcCurve",function(){return Sr}),n.d(e,"CatmullRomCurve3",function(){return Mr}),n.d(e,"CubicBezierCurve",function(){return Fr}),n.d(e,"CubicBezierCurve3",function(){return Br}),n.d(e,"EllipseCurve",function(){return Tr}),n.d(e,"LineCurve",function(){return Vr}),n.d(e,"LineCurve3",function(){return jr}),n.d(e,"QuadraticBezierCurve",function(){return Hr}),n.d(e,"QuadraticBezierCurve3",function(){return Gr}),n.d(e,"SplineCurve",function(){return zr}),n.d(e,"REVISION",function(){return Jo}),n.d(e,"MOUSE",function(){return Zo}),n.d(e,"CullFaceNone",function(){return $o}),n.d(e,"CullFaceBack",function(){return ta}),n.d(e,"CullFaceFront",function(){return ea}),n.d(e,"CullFaceFrontBack",function(){return na}),n.d(e,"FrontFaceDirectionCW",function(){return ra}),n.d(e,"FrontFaceDirectionCCW",function(){return ia}),n.d(e,"BasicShadowMap",function(){return oa}),n.d(e,"PCFShadowMap",function(){return aa}),n.d(e,"PCFSoftShadowMap",function(){return sa}),n.d(e,"FrontSide",function(){return ua}),n.d(e,"BackSide",function(){return ca}),n.d(e,"DoubleSide",function(){return la}),n.d(e,"FlatShading",function(){return ha}),n.d(e,"SmoothShading",function(){return fa}),n.d(e,"NoColors",function(){return da}),n.d(e,"FaceColors",function(){return pa}),n.d(e,"VertexColors",function(){return ma}),n.d(e,"NoBlending",function(){return ga}),n.d(e,"NormalBlending",function(){return va}),n.d(e,"AdditiveBlending",function(){return ya}),n.d(e,"SubtractiveBlending",function(){return _a}),n.d(e,"MultiplyBlending",function(){return ba}),n.d(e,"CustomBlending",function(){return wa}),n.d(e,"AddEquation",function(){return Ea}),n.d(e,"SubtractEquation",function(){return xa}),n.d(e,"ReverseSubtractEquation",function(){return Ta}),n.d(e,"MinEquation",function(){return Sa}),n.d(e,"MaxEquation",function(){return Ca}),n.d(e,"ZeroFactor",function(){return Ma}),n.d(e,"OneFactor",function(){return Aa}),n.d(e,"SrcColorFactor",function(){return Ia}),n.d(e,"OneMinusSrcColorFactor",function(){return Ra}),n.d(e,"SrcAlphaFactor",function(){return Pa}),n.d(e,"OneMinusSrcAlphaFactor",function(){return Na}),n.d(e,"DstAlphaFactor",function(){return Da}),n.d(e,"OneMinusDstAlphaFactor",function(){return Oa}),n.d(e,"DstColorFactor",function(){return ka}),n.d(e,"OneMinusDstColorFactor",function(){return La}),n.d(e,"SrcAlphaSaturateFactor",function(){return Ua}),n.d(e,"NeverDepth",function(){return Fa}),n.d(e,"AlwaysDepth",function(){return Ba}),n.d(e,"LessDepth",function(){return Va}),n.d(e,"LessEqualDepth",function(){return ja}),n.d(e,"EqualDepth",function(){return Ha}),n.d(e,"GreaterEqualDepth",function(){return Ga}),n.d(e,"GreaterDepth",function(){return za}),n.d(e,"NotEqualDepth",function(){return Wa}),n.d(e,"MultiplyOperation",function(){return qa}),n.d(e,"MixOperation",function(){return Ya}),n.d(e,"AddOperation",function(){return Ka}),n.d(e,"NoToneMapping",function(){return Qa}),n.d(e,"LinearToneMapping",function(){return Xa}),n.d(e,"ReinhardToneMapping",function(){return Ja}),n.d(e,"Uncharted2ToneMapping",function(){return Za}),n.d(e,"CineonToneMapping",function(){return $a}),n.d(e,"UVMapping",function(){return ts}),n.d(e,"CubeReflectionMapping",function(){return es}),n.d(e,"CubeRefractionMapping",function(){return ns}),n.d(e,"EquirectangularReflectionMapping",function(){return rs}),n.d(e,"EquirectangularRefractionMapping",function(){return is}),n.d(e,"SphericalReflectionMapping",function(){return os}),n.d(e,"CubeUVReflectionMapping",function(){return as}),n.d(e,"CubeUVRefractionMapping",function(){return ss}),n.d(e,"RepeatWrapping",function(){return us}),n.d(e,"ClampToEdgeWrapping",function(){return cs}),n.d(e,"MirroredRepeatWrapping",function(){return ls}),n.d(e,"NearestFilter",function(){return hs}),n.d(e,"NearestMipMapNearestFilter",function(){return fs}),n.d(e,"NearestMipMapLinearFilter",function(){return ds}),n.d(e,"LinearFilter",function(){return ps}),n.d(e,"LinearMipMapNearestFilter",function(){return ms}),n.d(e,"LinearMipMapLinearFilter",function(){return gs}),n.d(e,"UnsignedByteType",function(){return vs}),n.d(e,"ByteType",function(){return ys}),n.d(e,"ShortType",function(){return _s}),n.d(e,"UnsignedShortType",function(){return bs}),n.d(e,"IntType",function(){return ws}),n.d(e,"UnsignedIntType",function(){return Es}),n.d(e,"FloatType",function(){return xs}),n.d(e,"HalfFloatType",function(){return Ts}),n.d(e,"UnsignedShort4444Type",function(){return Ss}),n.d(e,"UnsignedShort5551Type",function(){return Cs}),n.d(e,"UnsignedShort565Type",function(){return Ms}),n.d(e,"UnsignedInt248Type",function(){return As}),n.d(e,"AlphaFormat",function(){return Is}),n.d(e,"RGBFormat",function(){return Rs}),n.d(e,"RGBAFormat",function(){return Ps}),n.d(e,"LuminanceFormat",function(){return Ns}),n.d(e,"LuminanceAlphaFormat",function(){return Ds}),n.d(e,"RGBEFormat",function(){return Os}),n.d(e,"DepthFormat",function(){return ks}),n.d(e,"DepthStencilFormat",function(){return Ls}),n.d(e,"RGB_S3TC_DXT1_Format",function(){return Us}),n.d(e,"RGBA_S3TC_DXT1_Format",function(){return Fs}),n.d(e,"RGBA_S3TC_DXT3_Format",function(){return Bs}),n.d(e,"RGBA_S3TC_DXT5_Format",function(){return Vs}),n.d(e,"RGB_PVRTC_4BPPV1_Format",function(){return js}),n.d(e,"RGB_PVRTC_2BPPV1_Format",function(){return Hs}),n.d(e,"RGBA_PVRTC_4BPPV1_Format",function(){return Gs}),n.d(e,"RGBA_PVRTC_2BPPV1_Format",function(){return zs}),n.d(e,"RGB_ETC1_Format",function(){return Ws}),n.d(e,"RGBA_ASTC_4x4_Format",function(){return qs}),n.d(e,"RGBA_ASTC_5x4_Format",function(){return Ys}),n.d(e,"RGBA_ASTC_5x5_Format",function(){return Ks}),n.d(e,"RGBA_ASTC_6x5_Format",function(){return Qs}),n.d(e,"RGBA_ASTC_6x6_Format",function(){return Xs}),n.d(e,"RGBA_ASTC_8x5_Format",function(){return Js}),n.d(e,"RGBA_ASTC_8x6_Format",function(){return Zs}),n.d(e,"RGBA_ASTC_8x8_Format",function(){return $s}),n.d(e,"RGBA_ASTC_10x5_Format",function(){return tu}),n.d(e,"RGBA_ASTC_10x6_Format",function(){return eu}),n.d(e,"RGBA_ASTC_10x8_Format",function(){return nu}),n.d(e,"RGBA_ASTC_10x10_Format",function(){return ru}),n.d(e,"RGBA_ASTC_12x10_Format",function(){return iu}),n.d(e,"RGBA_ASTC_12x12_Format",function(){return ou}),n.d(e,"LoopOnce",function(){return au}),n.d(e,"LoopRepeat",function(){return su}),n.d(e,"LoopPingPong",function(){return uu}),n.d(e,"InterpolateDiscrete",function(){return cu}),n.d(e,"InterpolateLinear",function(){return lu}),n.d(e,"InterpolateSmooth",function(){return hu}),n.d(e,"ZeroCurvatureEnding",function(){return fu}),n.d(e,"ZeroSlopeEnding",function(){return du}),n.d(e,"WrapAroundEnding",function(){return pu}),n.d(e,"TrianglesDrawMode",function(){return mu}),n.d(e,"TriangleStripDrawMode",function(){return gu}),n.d(e,"TriangleFanDrawMode",function(){return vu}),n.d(e,"LinearEncoding",function(){return yu}),n.d(e,"sRGBEncoding",function(){return _u}),n.d(e,"GammaEncoding",function(){return bu}),n.d(e,"RGBEEncoding",function(){return wu}),n.d(e,"LogLuvEncoding",function(){return Eu}),n.d(e,"RGBM7Encoding",function(){return xu}),n.d(e,"RGBM16Encoding",function(){return Tu}),n.d(e,"RGBDEncoding",function(){return Su}),n.d(e,"BasicDepthPacking",function(){return Cu}),n.d(e,"RGBADepthPacking",function(){return Mu}),n.d(e,"CubeGeometry",function(){return V}),n.d(e,"Face4",function(){return _o}),n.d(e,"LineStrip",function(){return yc}),n.d(e,"LinePieces",function(){return _c}),n.d(e,"MeshFaceMaterial",function(){return bo}),n.d(e,"MultiMaterial",function(){return wo}),n.d(e,"PointCloud",function(){return Eo}),n.d(e,"Particle",function(){return xo}),n.d(e,"ParticleSystem",function(){return To}),n.d(e,"PointCloudMaterial",function(){return So}),n.d(e,"ParticleBasicMaterial",function(){return Co}),n.d(e,"ParticleSystemMaterial",function(){return Mo}),n.d(e,"Vertex",function(){return Ao}),n.d(e,"DynamicBufferAttribute",function(){return Io}),n.d(e,"Int8Attribute",function(){return Ro}),n.d(e,"Uint8Attribute",function(){return Po}),n.d(e,"Uint8ClampedAttribute",function(){return No}),n.d(e,"Int16Attribute",function(){return Do}),n.d(e,"Uint16Attribute",function(){return Oo}),n.d(e,"Int32Attribute",function(){return ko}),n.d(e,"Uint32Attribute",function(){return Lo}),n.d(e,"Float32Attribute",function(){return Uo}),n.d(e,"Float64Attribute",function(){return Fo}),n.d(e,"ClosedSplineCurve3",function(){return Bo}),n.d(e,"SplineCurve3",function(){return Vo}),n.d(e,"Spline",function(){return jo}),n.d(e,"AxisHelper",function(){return Ho}),n.d(e,"BoundingBoxHelper",function(){return Go}),n.d(e,"EdgesHelper",function(){return zo}),n.d(e,"WireframeHelper",function(){return Wo}),n.d(e,"XHRLoader",function(){return qo}),n.d(e,"BinaryTextureLoader",function(){return Yo}),n.d(e,"GeometryUtils",function(){return bc}),n.d(e,"ImageUtils",function(){return wc}),n.d(e,"Projector",function(){return Ko}),n.d(e,"CanvasRenderer",function(){return Qo}),n.d(e,"SceneUtils",function(){return Ec}),n.d(e,"LensFlare",function(){return Xo});void 0===Number.EPSILON&&(Number.EPSILON=Math.pow(2,-52)),void 0===Number.isInteger&&(Number.isInteger=function(t){return"number"===typeof t&&isFinite(t)&&Math.floor(t)===t}),void 0===Math.sign&&(Math.sign=function(t){return t<0?-1:t>0?1:+t}),"name"in Function.prototype===!1&&Object.defineProperty(Function.prototype,"name",{get:function(){return this.toString().match(/^\s*function\s*([^\(\s]*)/)[1]}}),void 0===Object.assign&&function(){Object.assign=function(t){if(void 0===t||null===t)throw new TypeError("Cannot convert undefined or null to object");for(var e=Object(t),n=1;n<arguments.length;n++){var r=arguments[n];if(void 0!==r&&null!==r)for(var i in r)Object.prototype.hasOwnProperty.call(r,i)&&(e[i]=r[i])}return e}}(),Object.assign(r.prototype,{addEventListener:function(t,e){void 0===this._listeners&&(this._listeners={});var n=this._listeners;void 0===n[t]&&(n[t]=[]),-1===n[t].indexOf(e)&&n[t].push(e)},hasEventListener:function(t,e){if(void 0===this._listeners)return!1;var n=this._listeners;return void 0!==n[t]&&-1!==n[t].indexOf(e)},removeEventListener:function(t,e){if(void 0!==this._listeners){var n=this._listeners,r=n[t];if(void 0!==r){var i=r.indexOf(e);-1!==i&&r.splice(i,1)}}},dispatchEvent:function(t){if(void 0!==this._listeners){var e=this._listeners,n=e[t.type];if(void 0!==n){t.target=this;for(var r=n.slice(0),i=0,o=r.length;i<o;i++)r[i].call(this,t)}}}});var Jo="92",Zo={LEFT:0,MIDDLE:1,RIGHT:2},$o=0,ta=1,ea=2,na=3,ra=0,ia=1,oa=0,aa=1,sa=2,ua=0,ca=1,la=2,ha=1,fa=2,da=0,pa=1,ma=2,ga=0,va=1,ya=2,_a=3,ba=4,wa=5,Ea=100,xa=101,Ta=102,Sa=103,Ca=104,Ma=200,Aa=201,Ia=202,Ra=203,Pa=204,Na=205,Da=206,Oa=207,ka=208,La=209,Ua=210,Fa=0,Ba=1,Va=2,ja=3,Ha=4,Ga=5,za=6,Wa=7,qa=0,Ya=1,Ka=2,Qa=0,Xa=1,Ja=2,Za=3,$a=4,ts=300,es=301,ns=302,rs=303,is=304,os=305,as=306,ss=307,us=1e3,cs=1001,ls=1002,hs=1003,fs=1004,ds=1005,ps=1006,ms=1007,gs=1008,vs=1009,ys=1010,_s=1011,bs=1012,ws=1013,Es=1014,xs=1015,Ts=1016,Ss=1017,Cs=1018,Ms=1019,As=1020,Is=1021,Rs=1022,Ps=1023,Ns=1024,Ds=1025,Os=Ps,ks=1026,Ls=1027,Us=33776,Fs=33777,Bs=33778,Vs=33779,js=35840,Hs=35841,Gs=35842,zs=35843,Ws=36196,qs=37808,Ys=37809,Ks=37810,Qs=37811,Xs=37812,Js=37813,Zs=37814,$s=37815,tu=37816,eu=37817,nu=37818,ru=37819,iu=37820,ou=37821,au=2200,su=2201,uu=2202,cu=2300,lu=2301,hu=2302,fu=2400,du=2401,pu=2402,mu=0,gu=1,vu=2,yu=3e3,_u=3001,bu=3007,wu=3002,Eu=3003,xu=3004,Tu=3005,Su=3006,Cu=3200,Mu=3201,Au={DEG2RAD:Math.PI/180,RAD2DEG:180/Math.PI,generateUUID:function(){for(var t=[],e=0;e<256;e++)t[e]=(e<16?"0":"")+e.toString(16);return function(){var e=4294967295*Math.random()|0,n=4294967295*Math.random()|0,r=4294967295*Math.random()|0,i=4294967295*Math.random()|0;return(t[255&e]+t[e>>8&255]+t[e>>16&255]+t[e>>24&255]+"-"+t[255&n]+t[n>>8&255]+"-"+t[n>>16&15|64]+t[n>>24&255]+"-"+t[63&r|128]+t[r>>8&255]+"-"+t[r>>16&255]+t[r>>24&255]+t[255&i]+t[i>>8&255]+t[i>>16&255]+t[i>>24&255]).toUpperCase()}}(),clamp:function(t,e,n){return Math.max(e,Math.min(n,t))},euclideanModulo:function(t,e){return(t%e+e)%e},mapLinear:function(t,e,n,r,i){return r+(t-e)*(i-r)/(n-e)},lerp:function(t,e,n){return(1-n)*t+n*e},smoothstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*(3-2*t)},smootherstep:function(t,e,n){return t<=e?0:t>=n?1:(t=(t-e)/(n-e))*t*t*(t*(6*t-15)+10)},randInt:function(t,e){return t+Math.floor(Math.random()*(e-t+1))},randFloat:function(t,e){return t+Math.random()*(e-t)},randFloatSpread:function(t){return t*(.5-Math.random())},degToRad:function(t){return t*Au.DEG2RAD},radToDeg:function(t){return t*Au.RAD2DEG},isPowerOfTwo:function(t){return 0===(t&t-1)&&0!==t},ceilPowerOfTwo:function(t){return Math.pow(2,Math.ceil(Math.log(t)/Math.LN2))},floorPowerOfTwo:function(t){return Math.pow(2,Math.floor(Math.log(t)/Math.LN2))}};Object.defineProperties(i.prototype,{width:{get:function(){return this.x},set:function(t){this.x=t}},height:{get:function(){return this.y},set:function(t){this.y=t}}}),Object.assign(i.prototype,{isVector2:!0,set:function(t,e){return this.x=t,this.y=e,this},setScalar:function(t){return this.x=t,this.y=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y)},copy:function(t){return this.x=t.x,this.y=t.y,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this)},addScalar:function(t){return this.x+=t,this.y+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector2: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this)},subScalar:function(t){return this.x-=t,this.y-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this},multiply:function(t){return this.x*=t.x,this.y*=t.y,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this},divide:function(t){return this.x/=t.x,this.y/=t.y,this},divideScalar:function(t){return this.multiplyScalar(1/t)},applyMatrix3:function(t){var e=this.x,n=this.y,r=t.elements;return this.x=r[0]*e+r[3]*n+r[6],this.y=r[1]*e+r[4]*n+r[7],this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this},clampScalar:function(){var t=new i,e=new i;return function(n,r){return t.set(n,n),e.set(r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this},negate:function(){return this.x=-this.x,this.y=-this.y,this},dot:function(t){return this.x*t.x+this.y*t.y},lengthSq:function(){return this.x*this.x+this.y*this.y},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)},normalize:function(){return this.divideScalar(this.length()||1)},angle:function(){var t=Math.atan2(this.y,this.x);return t<0&&(t+=2*Math.PI),t},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y;return e*e+n*n},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector2: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this},rotateAround:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=this.x-t.x,o=this.y-t.y;return this.x=i*n-o*r+t.x,this.y=i*r+o*n+t.y,this}}),Object.assign(o.prototype,{isMatrix4:!0,set:function(t,e,n,r,i,o,a,s,u,c,l,h,f,d,p,m){var g=this.elements;return g[0]=t,g[4]=e,g[8]=n,g[12]=r,g[1]=i,g[5]=o,g[9]=a,g[13]=s,g[2]=u,g[6]=c,g[10]=l,g[14]=h,g[3]=f,g[7]=d,g[11]=p,g[15]=m,this},identity:function(){return this.set(1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1),this},clone:function(){return(new o).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],e[9]=n[9],e[10]=n[10],e[11]=n[11],e[12]=n[12],e[13]=n[13],e[14]=n[14],e[15]=n[15],this},copyPosition:function(t){var e=this.elements,n=t.elements;return e[12]=n[12],e[13]=n[13],e[14]=n[14],this},extractBasis:function(t,e,n){return t.setFromMatrixColumn(this,0),e.setFromMatrixColumn(this,1),n.setFromMatrixColumn(this,2),this},makeBasis:function(t,e,n){return this.set(t.x,e.x,n.x,0,t.y,e.y,n.y,0,t.z,e.z,n.z,0,0,0,0,1),this},extractRotation:function(){var t=new s;return function(e){var n=this.elements,r=e.elements,i=1/t.setFromMatrixColumn(e,0).length(),o=1/t.setFromMatrixColumn(e,1).length(),a=1/t.setFromMatrixColumn(e,2).length();return n[0]=r[0]*i,n[1]=r[1]*i,n[2]=r[2]*i,n[4]=r[4]*o,n[5]=r[5]*o,n[6]=r[6]*o,n[8]=r[8]*a,n[9]=r[9]*a,n[10]=r[10]*a,this}}(),makeRotationFromEuler:function(t){t&&t.isEuler||console.error("THREE.Matrix4: .makeRotationFromEuler() now expects a Euler rotation rather than a Vector3 and order.");var e=this.elements,n=t.x,r=t.y,i=t.z,o=Math.cos(n),a=Math.sin(n),s=Math.cos(r),u=Math.sin(r),c=Math.cos(i),l=Math.sin(i);if("XYZ"===t.order){var h=o*c,f=o*l,d=a*c,p=a*l;e[0]=s*c,e[4]=-s*l,e[8]=u,e[1]=f+d*u,e[5]=h-p*u,e[9]=-a*s,e[2]=p-h*u,e[6]=d+f*u,e[10]=o*s}else if("YXZ"===t.order){var m=s*c,g=s*l,v=u*c,y=u*l;e[0]=m+y*a,e[4]=v*a-g,e[8]=o*u,e[1]=o*l,e[5]=o*c,e[9]=-a,e[2]=g*a-v,e[6]=y+m*a,e[10]=o*s}else if("ZXY"===t.order){var m=s*c,g=s*l,v=u*c,y=u*l;e[0]=m-y*a,e[4]=-o*l,e[8]=v+g*a,e[1]=g+v*a,e[5]=o*c,e[9]=y-m*a,e[2]=-o*u,e[6]=a,e[10]=o*s}else if("ZYX"===t.order){var h=o*c,f=o*l,d=a*c,p=a*l;e[0]=s*c,e[4]=d*u-f,e[8]=h*u+p,e[1]=s*l,e[5]=p*u+h,e[9]=f*u-d,e[2]=-u,e[6]=a*s,e[10]=o*s}else if("YZX"===t.order){var _=o*s,b=o*u,w=a*s,E=a*u;e[0]=s*c,e[4]=E-_*l,e[8]=w*l+b,e[1]=l,e[5]=o*c,e[9]=-a*c,e[2]=-u*c,e[6]=b*l+w,e[10]=_-E*l}else if("XZY"===t.order){var _=o*s,b=o*u,w=a*s,E=a*u;e[0]=s*c,e[4]=-l,e[8]=u*c,e[1]=_*l+E,e[5]=o*c,e[9]=b*l-w,e[2]=w*l-b,e[6]=a*c,e[10]=E*l+_}return e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},makeRotationFromQuaternion:function(t){var e=this.elements,n=t._x,r=t._y,i=t._z,o=t._w,a=n+n,s=r+r,u=i+i,c=n*a,l=n*s,h=n*u,f=r*s,d=r*u,p=i*u,m=o*a,g=o*s,v=o*u;return e[0]=1-(f+p),e[4]=l-v,e[8]=h+g,e[1]=l+v,e[5]=1-(c+p),e[9]=d-m,e[2]=h-g,e[6]=d+m,e[10]=1-(c+f),e[3]=0,e[7]=0,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,this},lookAt:function(){var t=new s,e=new s,n=new s;return function(r,i,o){var a=this.elements;return n.subVectors(r,i),0===n.lengthSq()&&(n.z=1),n.normalize(),t.crossVectors(o,n),0===t.lengthSq()&&(1===Math.abs(o.z)?n.x+=1e-4:n.z+=1e-4,n.normalize(),t.crossVectors(o,n)),t.normalize(),e.crossVectors(n,t),a[0]=t.x,a[4]=e.x,a[8]=n.x,a[1]=t.y,a[5]=e.y,a[9]=n.y,a[2]=t.z,a[6]=e.z,a[10]=n.z,this}}(),multiply:function(t,e){return void 0!==e?(console.warn("THREE.Matrix4: .multiply() now only accepts one argument. Use .multiplyMatrices( a, b ) instead."),this.multiplyMatrices(t,e)):this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[4],s=n[8],u=n[12],c=n[1],l=n[5],h=n[9],f=n[13],d=n[2],p=n[6],m=n[10],g=n[14],v=n[3],y=n[7],_=n[11],b=n[15],w=r[0],E=r[4],x=r[8],T=r[12],S=r[1],C=r[5],M=r[9],A=r[13],I=r[2],R=r[6],P=r[10],N=r[14],D=r[3],O=r[7],k=r[11],L=r[15];return i[0]=o*w+a*S+s*I+u*D,i[4]=o*E+a*C+s*R+u*O,i[8]=o*x+a*M+s*P+u*k,i[12]=o*T+a*A+s*N+u*L,i[1]=c*w+l*S+h*I+f*D,i[5]=c*E+l*C+h*R+f*O,i[9]=c*x+l*M+h*P+f*k,i[13]=c*T+l*A+h*N+f*L,i[2]=d*w+p*S+m*I+g*D,i[6]=d*E+p*C+m*R+g*O,i[10]=d*x+p*M+m*P+g*k,i[14]=d*T+p*A+m*N+g*L,i[3]=v*w+y*S+_*I+b*D,i[7]=v*E+y*C+_*R+b*O,i[11]=v*x+y*M+_*P+b*k,i[15]=v*T+y*A+_*N+b*L,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[4]*=t,e[8]*=t,e[12]*=t,e[1]*=t,e[5]*=t,e[9]*=t,e[13]*=t,e[2]*=t,e[6]*=t,e[10]*=t,e[14]*=t,e[3]*=t,e[7]*=t,e[11]*=t,e[15]*=t,this},applyToBufferAttribute:function(){var t=new s;return function(e){for(var n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix4(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),determinant:function(){var t=this.elements,e=t[0],n=t[4],r=t[8],i=t[12],o=t[1],a=t[5],s=t[9],u=t[13],c=t[2],l=t[6],h=t[10],f=t[14];return t[3]*(+i*s*l-r*u*l-i*a*h+n*u*h+r*a*f-n*s*f)+t[7]*(+e*s*f-e*u*h+i*o*h-r*o*f+r*u*c-i*s*c)+t[11]*(+e*u*l-e*a*f-i*o*l+n*o*f+i*a*c-n*u*c)+t[15]*(-r*a*c-e*s*l+e*a*h+r*o*l-n*o*h+n*s*c)},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[4],e[4]=t,t=e[2],e[2]=e[8],e[8]=t,t=e[6],e[6]=e[9],e[9]=t,t=e[3],e[3]=e[12],e[12]=t,t=e[7],e[7]=e[13],e[13]=t,t=e[11],e[11]=e[14],e[14]=t,this},setPosition:function(t){var e=this.elements;return e[12]=t.x,e[13]=t.y,e[14]=t.z,this},getInverse:function(t,e){var n=this.elements,r=t.elements,i=r[0],o=r[1],a=r[2],s=r[3],u=r[4],c=r[5],l=r[6],h=r[7],f=r[8],d=r[9],p=r[10],m=r[11],g=r[12],v=r[13],y=r[14],_=r[15],b=d*y*h-v*p*h+v*l*m-c*y*m-d*l*_+c*p*_,w=g*p*h-f*y*h-g*l*m+u*y*m+f*l*_-u*p*_,E=f*v*h-g*d*h+g*c*m-u*v*m-f*c*_+u*d*_,x=g*d*l-f*v*l-g*c*p+u*v*p+f*c*y-u*d*y,T=i*b+o*w+a*E+s*x;if(0===T){var S="THREE.Matrix4: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(S);return console.warn(S),this.identity()}var C=1/T;return n[0]=b*C,n[1]=(v*p*s-d*y*s-v*a*m+o*y*m+d*a*_-o*p*_)*C,n[2]=(c*y*s-v*l*s+v*a*h-o*y*h-c*a*_+o*l*_)*C,n[3]=(d*l*s-c*p*s-d*a*h+o*p*h+c*a*m-o*l*m)*C,n[4]=w*C,n[5]=(f*y*s-g*p*s+g*a*m-i*y*m-f*a*_+i*p*_)*C,n[6]=(g*l*s-u*y*s-g*a*h+i*y*h+u*a*_-i*l*_)*C,n[7]=(u*p*s-f*l*s+f*a*h-i*p*h-u*a*m+i*l*m)*C,n[8]=E*C,n[9]=(g*d*s-f*v*s-g*o*m+i*v*m+f*o*_-i*d*_)*C,n[10]=(u*v*s-g*c*s+g*o*h-i*v*h-u*o*_+i*c*_)*C,n[11]=(f*c*s-u*d*s-f*o*h+i*d*h+u*o*m-i*c*m)*C,n[12]=x*C,n[13]=(f*v*a-g*d*a+g*o*p-i*v*p-f*o*y+i*d*y)*C,n[14]=(g*c*a-u*v*a-g*o*l+i*v*l+u*o*y-i*c*y)*C,n[15]=(u*d*a-f*c*a+f*o*l-i*d*l-u*o*p+i*c*p)*C,this},scale:function(t){var e=this.elements,n=t.x,r=t.y,i=t.z;return e[0]*=n,e[4]*=r,e[8]*=i,e[1]*=n,e[5]*=r,e[9]*=i,e[2]*=n,e[6]*=r,e[10]*=i,e[3]*=n,e[7]*=r,e[11]*=i,this},getMaxScaleOnAxis:function(){var t=this.elements,e=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],n=t[4]*t[4]+t[5]*t[5]+t[6]*t[6],r=t[8]*t[8]+t[9]*t[9]+t[10]*t[10];return Math.sqrt(Math.max(e,n,r))},makeTranslation:function(t,e,n){return this.set(1,0,0,t,0,1,0,e,0,0,1,n,0,0,0,1),this},makeRotationX:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(1,0,0,0,0,e,-n,0,0,n,e,0,0,0,0,1),this},makeRotationY:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,0,n,0,0,1,0,0,-n,0,e,0,0,0,0,1),this},makeRotationZ:function(t){var e=Math.cos(t),n=Math.sin(t);return this.set(e,-n,0,0,n,e,0,0,0,0,1,0,0,0,0,1),this},makeRotationAxis:function(t,e){var n=Math.cos(e),r=Math.sin(e),i=1-n,o=t.x,a=t.y,s=t.z,u=i*o,c=i*a;return this.set(u*o+n,u*a-r*s,u*s+r*a,0,u*a+r*s,c*a+n,c*s-r*o,0,u*s-r*a,c*s+r*o,i*s*s+n,0,0,0,0,1),this},makeScale:function(t,e,n){return this.set(t,0,0,0,0,e,0,0,0,0,n,0,0,0,0,1),this},makeShear:function(t,e,n){return this.set(1,e,n,0,t,1,n,0,t,e,1,0,0,0,0,1),this},compose:function(t,e,n){return this.makeRotationFromQuaternion(e),this.scale(n),this.setPosition(t),this},decompose:function(){var t=new s,e=new o;return function(n,r,i){var o=this.elements,a=t.set(o[0],o[1],o[2]).length(),s=t.set(o[4],o[5],o[6]).length(),u=t.set(o[8],o[9],o[10]).length();this.determinant()<0&&(a=-a),n.x=o[12],n.y=o[13],n.z=o[14],e.copy(this);var c=1/a,l=1/s,h=1/u;return e.elements[0]*=c,e.elements[1]*=c,e.elements[2]*=c,e.elements[4]*=l,e.elements[5]*=l,e.elements[6]*=l,e.elements[8]*=h,e.elements[9]*=h,e.elements[10]*=h,r.setFromRotationMatrix(e),i.x=a,i.y=s,i.z=u,this}}(),makePerspective:function(t,e,n,r,i,o){void 0===o&&console.warn("THREE.Matrix4: .makePerspective() has been redefined and has a new signature. Please check the docs.");var a=this.elements,s=2*i/(e-t),u=2*i/(n-r),c=(e+t)/(e-t),l=(n+r)/(n-r),h=-(o+i)/(o-i),f=-2*o*i/(o-i);return a[0]=s,a[4]=0,a[8]=c,a[12]=0,a[1]=0,a[5]=u,a[9]=l,a[13]=0,a[2]=0,a[6]=0,a[10]=h,a[14]=f,a[3]=0,a[7]=0,a[11]=-1,a[15]=0,this},makeOrthographic:function(t,e,n,r,i,o){var a=this.elements,s=1/(e-t),u=1/(n-r),c=1/(o-i),l=(e+t)*s,h=(n+r)*u,f=(o+i)*c;return a[0]=2*s,a[4]=0,a[8]=0,a[12]=-l,a[1]=0,a[5]=2*u,a[9]=0,a[13]=-h,a[2]=0,a[6]=0,a[10]=-2*c,a[14]=-f,a[3]=0,a[7]=0,a[11]=0,a[15]=1,this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<16;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<16;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t[e+9]=n[9],t[e+10]=n[10],t[e+11]=n[11],t[e+12]=n[12],t[e+13]=n[13],t[e+14]=n[14],t[e+15]=n[15],t}}),Object.assign(a,{slerp:function(t,e,n,r){return n.copy(t).slerp(e,r)},slerpFlat:function(t,e,n,r,i,o,a){var s=n[r+0],u=n[r+1],c=n[r+2],l=n[r+3],h=i[o+0],f=i[o+1],d=i[o+2],p=i[o+3];if(l!==p||s!==h||u!==f||c!==d){var m=1-a,g=s*h+u*f+c*d+l*p,v=g>=0?1:-1,y=1-g*g;if(y>Number.EPSILON){var _=Math.sqrt(y),b=Math.atan2(_,g*v);m=Math.sin(m*b)/_,a=Math.sin(a*b)/_}var w=a*v;if(s=s*m+h*w,u=u*m+f*w,c=c*m+d*w,l=l*m+p*w,m===1-a){var E=1/Math.sqrt(s*s+u*u+c*c+l*l);s*=E,u*=E,c*=E,l*=E}}t[e]=s,t[e+1]=u,t[e+2]=c,t[e+3]=l}}),Object.defineProperties(a.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},w:{get:function(){return this._w},set:function(t){this._w=t,this.onChangeCallback()}}}),Object.assign(a.prototype,{set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._w=r,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._w)},copy:function(t){return this._x=t.x,this._y=t.y,this._z=t.z,this._w=t.w,this.onChangeCallback(),this},setFromEuler:function(t,e){if(!t||!t.isEuler)throw new Error("THREE.Quaternion: .setFromEuler() now expects an Euler rotation rather than a Vector3 and order.");var n=t._x,r=t._y,i=t._z,o=t.order,a=Math.cos,s=Math.sin,u=a(n/2),c=a(r/2),l=a(i/2),h=s(n/2),f=s(r/2),d=s(i/2);return"XYZ"===o?(this._x=h*c*l+u*f*d,this._y=u*f*l-h*c*d,this._z=u*c*d+h*f*l,this._w=u*c*l-h*f*d):"YXZ"===o?(this._x=h*c*l+u*f*d,this._y=u*f*l-h*c*d,this._z=u*c*d-h*f*l,this._w=u*c*l+h*f*d):"ZXY"===o?(this._x=h*c*l-u*f*d,this._y=u*f*l+h*c*d,this._z=u*c*d+h*f*l,this._w=u*c*l-h*f*d):"ZYX"===o?(this._x=h*c*l-u*f*d,this._y=u*f*l+h*c*d,this._z=u*c*d-h*f*l,this._w=u*c*l+h*f*d):"YZX"===o?(this._x=h*c*l+u*f*d,this._y=u*f*l+h*c*d,this._z=u*c*d-h*f*l,this._w=u*c*l-h*f*d):"XZY"===o&&(this._x=h*c*l-u*f*d,this._y=u*f*l-h*c*d,this._z=u*c*d+h*f*l,this._w=u*c*l+h*f*d),!1!==e&&this.onChangeCallback(),this},setFromAxisAngle:function(t,e){var n=e/2,r=Math.sin(n);return this._x=t.x*r,this._y=t.y*r,this._z=t.z*r,this._w=Math.cos(n),this.onChangeCallback(),this},setFromRotationMatrix:function(t){var e,n=t.elements,r=n[0],i=n[4],o=n[8],a=n[1],s=n[5],u=n[9],c=n[2],l=n[6],h=n[10],f=r+s+h;return f>0?(e=.5/Math.sqrt(f+1),this._w=.25/e,this._x=(l-u)*e,this._y=(o-c)*e,this._z=(a-i)*e):r>s&&r>h?(e=2*Math.sqrt(1+r-s-h),this._w=(l-u)/e,this._x=.25*e,this._y=(i+a)/e,this._z=(o+c)/e):s>h?(e=2*Math.sqrt(1+s-r-h),this._w=(o-c)/e,this._x=(i+a)/e,this._y=.25*e,this._z=(u+l)/e):(e=2*Math.sqrt(1+h-r-s),this._w=(a-i)/e,this._x=(o+c)/e,this._y=(u+l)/e,this._z=.25*e),this.onChangeCallback(),this},setFromUnitVectors:function(){var t,e=new s;return function(n,r){return void 0===e&&(e=new s),t=n.dot(r)+1,t<1e-6?(t=0,Math.abs(n.x)>Math.abs(n.z)?e.set(-n.y,n.x,0):e.set(0,-n.z,n.y)):e.crossVectors(n,r),this._x=e.x,this._y=e.y,this._z=e.z,this._w=t,this.normalize()}}(),inverse:function(){return this.conjugate()},conjugate:function(){return this._x*=-1,this._y*=-1,this._z*=-1,this.onChangeCallback(),this},dot:function(t){return this._x*t._x+this._y*t._y+this._z*t._z+this._w*t._w},lengthSq:function(){return this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w},length:function(){return Math.sqrt(this._x*this._x+this._y*this._y+this._z*this._z+this._w*this._w)},normalize:function(){var t=this.length();return 0===t?(this._x=0,this._y=0,this._z=0,this._w=1):(t=1/t,this._x=this._x*t,this._y=this._y*t,this._z=this._z*t,this._w=this._w*t),this.onChangeCallback(),this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Quaternion: .multiply() now only accepts one argument. Use .multiplyQuaternions( a, b ) instead."),this.multiplyQuaternions(t,e)):this.multiplyQuaternions(this,t)},premultiply:function(t){return this.multiplyQuaternions(t,this)},multiplyQuaternions:function(t,e){var n=t._x,r=t._y,i=t._z,o=t._w,a=e._x,s=e._y,u=e._z,c=e._w;return this._x=n*c+o*a+r*u-i*s,this._y=r*c+o*s+i*a-n*u,this._z=i*c+o*u+n*s-r*a,this._w=o*c-n*a-r*s-i*u,this.onChangeCallback(),this},slerp:function(t,e){if(0===e)return this;if(1===e)return this.copy(t);var n=this._x,r=this._y,i=this._z,o=this._w,a=o*t._w+n*t._x+r*t._y+i*t._z;if(a<0?(this._w=-t._w,this._x=-t._x,this._y=-t._y,this._z=-t._z,a=-a):this.copy(t),a>=1)return this._w=o,this._x=n,this._y=r,this._z=i,this;var s=Math.sqrt(1-a*a);if(Math.abs(s)<.001)return this._w=.5*(o+this._w),this._x=.5*(n+this._x),this._y=.5*(r+this._y),this._z=.5*(i+this._z),this;var u=Math.atan2(s,a),c=Math.sin((1-e)*u)/s,l=Math.sin(e*u)/s;return this._w=o*c+this._w*l,this._x=n*c+this._x*l,this._y=r*c+this._y*l,this._z=i*c+this._z*l,this.onChangeCallback(),this},equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._w===this._w},fromArray:function(t,e){return void 0===e&&(e=0),this._x=t[e],this._y=t[e+1],this._z=t[e+2],this._w=t[e+3],this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._w,t},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(s.prototype,{isVector3:!0,set:function(t,e,n){return this.x=t,this.y=e,this.z=n,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this},multiply:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .multiply() now only accepts one argument. Use .multiplyVectors( a, b ) instead."),this.multiplyVectors(t,e)):(this.x*=t.x,this.y*=t.y,this.z*=t.z,this)},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this},multiplyVectors:function(t,e){return this.x=t.x*e.x,this.y=t.y*e.y,this.z=t.z*e.z,this},applyEuler:function(){var t=new a;return function(e){return e&&e.isEuler||console.error("THREE.Vector3: .applyEuler() now expects an Euler rotation rather than a Vector3 and order."),this.applyQuaternion(t.setFromEuler(e))}}(),applyAxisAngle:function(){var t=new a;return function(e,n){return this.applyQuaternion(t.setFromAxisAngle(e,n))}}(),applyMatrix3:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[3]*n+i[6]*r,this.y=i[1]*e+i[4]*n+i[7]*r,this.z=i[2]*e+i[5]*n+i[8]*r,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements,o=1/(i[3]*e+i[7]*n+i[11]*r+i[15]);return this.x=(i[0]*e+i[4]*n+i[8]*r+i[12])*o,this.y=(i[1]*e+i[5]*n+i[9]*r+i[13])*o,this.z=(i[2]*e+i[6]*n+i[10]*r+i[14])*o,this},applyQuaternion:function(t){var e=this.x,n=this.y,r=this.z,i=t.x,o=t.y,a=t.z,s=t.w,u=s*e+o*r-a*n,c=s*n+a*e-i*r,l=s*r+i*n-o*e,h=-i*e-o*n-a*r;return this.x=u*s+h*-i+c*-a-l*-o,this.y=c*s+h*-o+l*-i-u*-a,this.z=l*s+h*-a+u*-o-c*-i,this},project:function(){var t=new o;return function(e){return t.multiplyMatrices(e.projectionMatrix,t.getInverse(e.matrixWorld)),this.applyMatrix4(t)}}(),unproject:function(){var t=new o;return function(e){return t.multiplyMatrices(e.matrixWorld,t.getInverse(e.projectionMatrix)),this.applyMatrix4(t)}}(),transformDirection:function(t){var e=this.x,n=this.y,r=this.z,i=t.elements;return this.x=i[0]*e+i[4]*n+i[8]*r,this.y=i[1]*e+i[5]*n+i[9]*r,this.z=i[2]*e+i[6]*n+i[10]*r,this.normalize()},divide:function(t){return this.x/=t.x,this.y/=t.y,this.z/=t.z,this},divideScalar:function(t){return this.multiplyScalar(1/t)},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this},clampScalar:function(){var t=new s,e=new s;return function(n,r){return t.set(n,n,n),e.set(r,r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},cross:function(t,e){return void 0!==e?(console.warn("THREE.Vector3: .cross() now only accepts one argument. Use .crossVectors( a, b ) instead."),this.crossVectors(t,e)):this.crossVectors(this,t)},crossVectors:function(t,e){var n=t.x,r=t.y,i=t.z,o=e.x,a=e.y,s=e.z;return this.x=r*s-i*a,this.y=i*o-n*s,this.z=n*a-r*o,this},projectOnVector:function(t){var e=t.dot(this)/t.lengthSq();return this.copy(t).multiplyScalar(e)},projectOnPlane:function(){var t=new s;return function(e){return t.copy(this).projectOnVector(e),this.sub(t)}}(),reflect:function(){var t=new s;return function(e){return this.sub(t.copy(e).multiplyScalar(2*this.dot(e)))}}(),angleTo:function(t){var e=this.dot(t)/Math.sqrt(this.lengthSq()*t.lengthSq());return Math.acos(Au.clamp(e,-1,1))},distanceTo:function(t){return Math.sqrt(this.distanceToSquared(t))},distanceToSquared:function(t){var e=this.x-t.x,n=this.y-t.y,r=this.z-t.z;return e*e+n*n+r*r},manhattanDistanceTo:function(t){return Math.abs(this.x-t.x)+Math.abs(this.y-t.y)+Math.abs(this.z-t.z)},setFromSpherical:function(t){var e=Math.sin(t.phi)*t.radius;return this.x=e*Math.sin(t.theta),this.y=Math.cos(t.phi)*t.radius,this.z=e*Math.cos(t.theta),this},setFromCylindrical:function(t){return this.x=t.radius*Math.sin(t.theta),this.y=t.y,this.z=t.radius*Math.cos(t.theta),this},setFromMatrixPosition:function(t){var e=t.elements;return this.x=e[12],this.y=e[13],this.z=e[14],this},setFromMatrixScale:function(t){var e=this.setFromMatrixColumn(t,0).length(),n=this.setFromMatrixColumn(t,1).length(),r=this.setFromMatrixColumn(t,2).length();return this.x=e,this.y=n,this.z=r,this},setFromMatrixColumn:function(t,e){return this.fromArray(t.elements,4*e)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector3: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this}}),Object.assign(u.prototype,{isMatrix3:!0,set:function(t,e,n,r,i,o,a,s,u){var c=this.elements;return c[0]=t,c[1]=r,c[2]=a,c[3]=e,c[4]=i,c[5]=s,c[6]=n,c[7]=o,c[8]=u,this},identity:function(){return this.set(1,0,0,0,1,0,0,0,1),this},clone:function(){return(new this.constructor).fromArray(this.elements)},copy:function(t){var e=this.elements,n=t.elements;return e[0]=n[0],e[1]=n[1],e[2]=n[2],e[3]=n[3],e[4]=n[4],e[5]=n[5],e[6]=n[6],e[7]=n[7],e[8]=n[8],this},setFromMatrix4:function(t){var e=t.elements;return this.set(e[0],e[4],e[8],e[1],e[5],e[9],e[2],e[6],e[10]),this},applyToBufferAttribute:function(){var t=new s;return function(e){for(var n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.applyMatrix3(this),e.setXYZ(n,t.x,t.y,t.z);return e}}(),multiply:function(t){return this.multiplyMatrices(this,t)},premultiply:function(t){return this.multiplyMatrices(t,this)},multiplyMatrices:function(t,e){var n=t.elements,r=e.elements,i=this.elements,o=n[0],a=n[3],s=n[6],u=n[1],c=n[4],l=n[7],h=n[2],f=n[5],d=n[8],p=r[0],m=r[3],g=r[6],v=r[1],y=r[4],_=r[7],b=r[2],w=r[5],E=r[8];return i[0]=o*p+a*v+s*b,i[3]=o*m+a*y+s*w,i[6]=o*g+a*_+s*E,i[1]=u*p+c*v+l*b,i[4]=u*m+c*y+l*w,i[7]=u*g+c*_+l*E,i[2]=h*p+f*v+d*b,i[5]=h*m+f*y+d*w,i[8]=h*g+f*_+d*E,this},multiplyScalar:function(t){var e=this.elements;return e[0]*=t,e[3]*=t,e[6]*=t,e[1]*=t,e[4]*=t,e[7]*=t,e[2]*=t,e[5]*=t,e[8]*=t,this},determinant:function(){var t=this.elements,e=t[0],n=t[1],r=t[2],i=t[3],o=t[4],a=t[5],s=t[6],u=t[7],c=t[8];return e*o*c-e*a*u-n*i*c+n*a*s+r*i*u-r*o*s},getInverse:function(t,e){t&&t.isMatrix4&&console.error("THREE.Matrix3: .getInverse() no longer takes a Matrix4 argument.");var n=t.elements,r=this.elements,i=n[0],o=n[1],a=n[2],s=n[3],u=n[4],c=n[5],l=n[6],h=n[7],f=n[8],d=f*u-c*h,p=c*l-f*s,m=h*s-u*l,g=i*d+o*p+a*m;if(0===g){var v="THREE.Matrix3: .getInverse() can't invert matrix, determinant is 0";if(!0===e)throw new Error(v);return console.warn(v),this.identity()}var y=1/g;return r[0]=d*y,r[1]=(a*h-f*o)*y,r[2]=(c*o-a*u)*y,r[3]=p*y,r[4]=(f*i-a*l)*y,r[5]=(a*s-c*i)*y,r[6]=m*y,r[7]=(o*l-h*i)*y,r[8]=(u*i-o*s)*y,this},transpose:function(){var t,e=this.elements;return t=e[1],e[1]=e[3],e[3]=t,t=e[2],e[2]=e[6],e[6]=t,t=e[5],e[5]=e[7],e[7]=t,this},getNormalMatrix:function(t){return this.setFromMatrix4(t).getInverse(this).transpose()},transposeIntoArray:function(t){var e=this.elements;return t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8],this},setUvTransform:function(t,e,n,r,i,o,a){var s=Math.cos(i),u=Math.sin(i);this.set(n*s,n*u,-n*(s*o+u*a)+o+t,-r*u,r*s,-r*(-u*o+s*a)+a+e,0,0,1)},scale:function(t,e){var n=this.elements;return n[0]*=t,n[3]*=t,n[6]*=t,n[1]*=e,n[4]*=e,n[7]*=e,this},rotate:function(t){var e=Math.cos(t),n=Math.sin(t),r=this.elements,i=r[0],o=r[3],a=r[6],s=r[1],u=r[4],c=r[7];return r[0]=e*i+n*s,r[3]=e*o+n*u,r[6]=e*a+n*c,r[1]=-n*i+e*s,r[4]=-n*o+e*u,r[7]=-n*a+e*c,this},translate:function(t,e){var n=this.elements;return n[0]+=t*n[2],n[3]+=t*n[5],n[6]+=t*n[8],n[1]+=e*n[2],n[4]+=e*n[5],n[7]+=e*n[8],this},equals:function(t){for(var e=this.elements,n=t.elements,r=0;r<9;r++)if(e[r]!==n[r])return!1;return!0},fromArray:function(t,e){void 0===e&&(e=0);for(var n=0;n<9;n++)this.elements[n]=t[n+e];return this},toArray:function(t,e){void 0===t&&(t=[]),void 0===e&&(e=0);var n=this.elements;return t[e]=n[0],t[e+1]=n[1],t[e+2]=n[2],t[e+3]=n[3],t[e+4]=n[4],t[e+5]=n[5],t[e+6]=n[6],t[e+7]=n[7],t[e+8]=n[8],t}});var Iu=0;c.DEFAULT_IMAGE=void 0,c.DEFAULT_MAPPING=ts,c.prototype=Object.assign(Object.create(r.prototype),{constructor:c,isTexture:!0,updateMatrix:function(){this.matrix.setUvTransform(this.offset.x,this.offset.y,this.repeat.x,this.repeat.y,this.rotation,this.center.x,this.center.y)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.name=t.name,this.image=t.image,this.mipmaps=t.mipmaps.slice(0),this.mapping=t.mapping,this.wrapS=t.wrapS,this.wrapT=t.wrapT,this.magFilter=t.magFilter,this.minFilter=t.minFilter,this.anisotropy=t.anisotropy,this.format=t.format,this.type=t.type,this.offset.copy(t.offset),this.repeat.copy(t.repeat),this.center.copy(t.center),this.rotation=t.rotation,this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrix.copy(t.matrix),this.generateMipmaps=t.generateMipmaps,this.premultiplyAlpha=t.premultiplyAlpha,this.flipY=t.flipY,this.unpackAlignment=t.unpackAlignment,this.encoding=t.encoding,this},toJSON:function(t){var e=void 0===t||"string"===typeof t;if(!e&&void 0!==t.textures[this.uuid])return t.textures[this.uuid];var n={metadata:{version:4.5,type:"Texture",generator:"Texture.toJSON"},uuid:this.uuid,name:this.name,mapping:this.mapping,repeat:[this.repeat.x,this.repeat.y],offset:[this.offset.x,this.offset.y],center:[this.center.x,this.center.y],rotation:this.rotation,wrap:[this.wrapS,this.wrapT],format:this.format,minFilter:this.minFilter,magFilter:this.magFilter,anisotropy:this.anisotropy,flipY:this.flipY};if(void 0!==this.image){var r=this.image;void 0===r.uuid&&(r.uuid=Au.generateUUID()),e||void 0!==t.images[r.uuid]||(t.images[r.uuid]={uuid:r.uuid,url:function(t){var e;if(t instanceof HTMLCanvasElement)e=t;else{e=document.createElementNS("http://www.w3.org/1999/xhtml","canvas"),e.width=t.width,e.height=t.height;var n=e.getContext("2d");t instanceof ImageData?n.putImageData(t,0,0):n.drawImage(t,0,0,t.width,t.height)}return e.width>2048||e.height>2048?e.toDataURL("image/jpeg",.6):e.toDataURL("image/png")}(r)}),n.image=r.uuid}return e||(t.textures[this.uuid]=n),n},dispose:function(){this.dispatchEvent({type:"dispose"})},transformUv:function(t){if(this.mapping===ts){if(t.applyMatrix3(this.matrix),t.x<0||t.x>1)switch(this.wrapS){case us:t.x=t.x-Math.floor(t.x);break;case cs:t.x=t.x<0?0:1;break;case ls:1===Math.abs(Math.floor(t.x)%2)?t.x=Math.ceil(t.x)-t.x:t.x=t.x-Math.floor(t.x)}if(t.y<0||t.y>1)switch(this.wrapT){case us:t.y=t.y-Math.floor(t.y);break;case cs:t.y=t.y<0?0:1;break;case ls:1===Math.abs(Math.floor(t.y)%2)?t.y=Math.ceil(t.y)-t.y:t.y=t.y-Math.floor(t.y)}this.flipY&&(t.y=1-t.y)}}}),Object.defineProperty(c.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(l.prototype,{isVector4:!0,set:function(t,e,n,r){return this.x=t,this.y=e,this.z=n,this.w=r,this},setScalar:function(t){return this.x=t,this.y=t,this.z=t,this.w=t,this},setX:function(t){return this.x=t,this},setY:function(t){return this.y=t,this},setZ:function(t){return this.z=t,this},setW:function(t){return this.w=t,this},setComponent:function(t,e){switch(t){case 0:this.x=e;break;case 1:this.y=e;break;case 2:this.z=e;break;case 3:this.w=e;break;default:throw new Error("index is out of range: "+t)}return this},getComponent:function(t){switch(t){case 0:return this.x;case 1:return this.y;case 2:return this.z;case 3:return this.w;default:throw new Error("index is out of range: "+t)}},clone:function(){return new this.constructor(this.x,this.y,this.z,this.w)},copy:function(t){return this.x=t.x,this.y=t.y,this.z=t.z,this.w=void 0!==t.w?t.w:1,this},add:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .add() now only accepts one argument. Use .addVectors( a, b ) instead."),this.addVectors(t,e)):(this.x+=t.x,this.y+=t.y,this.z+=t.z,this.w+=t.w,this)},addScalar:function(t){return this.x+=t,this.y+=t,this.z+=t,this.w+=t,this},addVectors:function(t,e){return this.x=t.x+e.x,this.y=t.y+e.y,this.z=t.z+e.z,this.w=t.w+e.w,this},addScaledVector:function(t,e){return this.x+=t.x*e,this.y+=t.y*e,this.z+=t.z*e,this.w+=t.w*e,this},sub:function(t,e){return void 0!==e?(console.warn("THREE.Vector4: .sub() now only accepts one argument. Use .subVectors( a, b ) instead."),this.subVectors(t,e)):(this.x-=t.x,this.y-=t.y,this.z-=t.z,this.w-=t.w,this)},subScalar:function(t){return this.x-=t,this.y-=t,this.z-=t,this.w-=t,this},subVectors:function(t,e){return this.x=t.x-e.x,this.y=t.y-e.y,this.z=t.z-e.z,this.w=t.w-e.w,this},multiplyScalar:function(t){return this.x*=t,this.y*=t,this.z*=t,this.w*=t,this},applyMatrix4:function(t){var e=this.x,n=this.y,r=this.z,i=this.w,o=t.elements;return this.x=o[0]*e+o[4]*n+o[8]*r+o[12]*i,this.y=o[1]*e+o[5]*n+o[9]*r+o[13]*i,this.z=o[2]*e+o[6]*n+o[10]*r+o[14]*i,this.w=o[3]*e+o[7]*n+o[11]*r+o[15]*i,this},divideScalar:function(t){return this.multiplyScalar(1/t)},setAxisAngleFromQuaternion:function(t){this.w=2*Math.acos(t.w);var e=Math.sqrt(1-t.w*t.w);return e<1e-4?(this.x=1,this.y=0,this.z=0):(this.x=t.x/e,this.y=t.y/e,this.z=t.z/e),this},setAxisAngleFromRotationMatrix:function(t){var e,n,r,i,o=t.elements,a=o[0],s=o[4],u=o[8],c=o[1],l=o[5],h=o[9],f=o[2],d=o[6],p=o[10];if(Math.abs(s-c)<.01&&Math.abs(u-f)<.01&&Math.abs(h-d)<.01){if(Math.abs(s+c)<.1&&Math.abs(u+f)<.1&&Math.abs(h+d)<.1&&Math.abs(a+l+p-3)<.1)return this.set(1,0,0,0),this;e=Math.PI;var m=(a+1)/2,g=(l+1)/2,v=(p+1)/2,y=(s+c)/4,_=(u+f)/4,b=(h+d)/4;return m>g&&m>v?m<.01?(n=0,r=.707106781,i=.707106781):(n=Math.sqrt(m),r=y/n,i=_/n):g>v?g<.01?(n=.707106781,r=0,i=.707106781):(r=Math.sqrt(g),n=y/r,i=b/r):v<.01?(n=.707106781,r=.707106781,i=0):(i=Math.sqrt(v),n=_/i,r=b/i),this.set(n,r,i,e),this}var w=Math.sqrt((d-h)*(d-h)+(u-f)*(u-f)+(c-s)*(c-s));return Math.abs(w)<.001&&(w=1),this.x=(d-h)/w,this.y=(u-f)/w,this.z=(c-s)/w,this.w=Math.acos((a+l+p-1)/2),this},min:function(t){return this.x=Math.min(this.x,t.x),this.y=Math.min(this.y,t.y),this.z=Math.min(this.z,t.z),this.w=Math.min(this.w,t.w),this},max:function(t){return this.x=Math.max(this.x,t.x),this.y=Math.max(this.y,t.y),this.z=Math.max(this.z,t.z),this.w=Math.max(this.w,t.w),this},clamp:function(t,e){return this.x=Math.max(t.x,Math.min(e.x,this.x)),this.y=Math.max(t.y,Math.min(e.y,this.y)),this.z=Math.max(t.z,Math.min(e.z,this.z)),this.w=Math.max(t.w,Math.min(e.w,this.w)),this},clampScalar:function(){var t,e;return function(n,r){return void 0===t&&(t=new l,e=new l),t.set(n,n,n,n),e.set(r,r,r,r),this.clamp(t,e)}}(),clampLength:function(t,e){var n=this.length();return this.divideScalar(n||1).multiplyScalar(Math.max(t,Math.min(e,n)))},floor:function(){return this.x=Math.floor(this.x),this.y=Math.floor(this.y),this.z=Math.floor(this.z),this.w=Math.floor(this.w),this},ceil:function(){return this.x=Math.ceil(this.x),this.y=Math.ceil(this.y),this.z=Math.ceil(this.z),this.w=Math.ceil(this.w),this},round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this.z=Math.round(this.z),this.w=Math.round(this.w),this},roundToZero:function(){return this.x=this.x<0?Math.ceil(this.x):Math.floor(this.x),this.y=this.y<0?Math.ceil(this.y):Math.floor(this.y),this.z=this.z<0?Math.ceil(this.z):Math.floor(this.z),this.w=this.w<0?Math.ceil(this.w):Math.floor(this.w),this},negate:function(){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this.w=-this.w,this},dot:function(t){return this.x*t.x+this.y*t.y+this.z*t.z+this.w*t.w},lengthSq:function(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w},length:function(){return Math.sqrt(this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w)},manhattanLength:function(){return Math.abs(this.x)+Math.abs(this.y)+Math.abs(this.z)+Math.abs(this.w)},normalize:function(){return this.divideScalar(this.length()||1)},setLength:function(t){return this.normalize().multiplyScalar(t)},lerp:function(t,e){return this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this.z+=(t.z-this.z)*e,this.w+=(t.w-this.w)*e,this},lerpVectors:function(t,e,n){return this.subVectors(e,t).multiplyScalar(n).add(t)},equals:function(t){return t.x===this.x&&t.y===this.y&&t.z===this.z&&t.w===this.w},fromArray:function(t,e){return void 0===e&&(e=0),this.x=t[e],this.y=t[e+1],this.z=t[e+2],this.w=t[e+3],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.x,t[e+1]=this.y,t[e+2]=this.z,t[e+3]=this.w,t},fromBufferAttribute:function(t,e,n){return void 0!==n&&console.warn("THREE.Vector4: offset has been removed from .fromBufferAttribute()."),this.x=t.getX(e),this.y=t.getY(e),this.z=t.getZ(e),this.w=t.getW(e),this}}),h.prototype=Object.assign(Object.create(r.prototype),{constructor:h,isWebGLRenderTarget:!0,setSize:function(t,e){this.width===t&&this.height===e||(this.width=t,this.height=e,this.dispose()),this.viewport.set(0,0,t,e),this.scissor.set(0,0,t,e)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.width=t.width,this.height=t.height,this.viewport.copy(t.viewport),this.texture=t.texture.clone(),this.depthBuffer=t.depthBuffer,this.stencilBuffer=t.stencilBuffer,this.depthTexture=t.depthTexture,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),f.prototype=Object.create(h.prototype),f.prototype.constructor=f,f.prototype.isWebGLRenderTargetCube=!0,d.prototype=Object.create(c.prototype),d.prototype.constructor=d,d.prototype.isDataTexture=!0,Object.assign(p.prototype,{isBox3:!0,set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromArray:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=t.length;s<u;s+=3){var c=t[s],l=t[s+1],h=t[s+2];c<e&&(e=c),l<n&&(n=l),h<r&&(r=h),c>i&&(i=c),l>o&&(o=l),h>a&&(a=h)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromBufferAttribute:function(t){for(var e=1/0,n=1/0,r=1/0,i=-1/0,o=-1/0,a=-1/0,s=0,u=t.count;s<u;s++){var c=t.getX(s),l=t.getY(s),h=t.getZ(s);c<e&&(e=c),l<n&&(n=l),h<r&&(r=h),c>i&&(i=c),l>o&&(o=l),h>a&&(a=h)}return this.min.set(e,n,r),this.max.set(i,o,a),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new s;return function(e,n){var r=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),setFromObject:function(t){return this.makeEmpty(),this.expandByObject(t)},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=this.min.z=1/0,this.max.x=this.max.y=this.max.z=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y||this.max.z<this.min.z},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box3: .getCenter() target is now required"),t=new s),this.isEmpty()?t.set(0,0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box3: .getSize() target is now required"),t=new s),this.isEmpty()?t.set(0,0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},expandByObject:function(){function t(t){var o=t.geometry;if(void 0!==o)if(o.isGeometry){var a=o.vertices;for(n=0,r=a.length;n<r;n++)i.copy(a[n]),i.applyMatrix4(t.matrixWorld),e.expandByPoint(i)}else if(o.isBufferGeometry){var s=o.attributes.position;if(void 0!==s)for(n=0,r=s.count;n<r;n++)i.fromBufferAttribute(s,n).applyMatrix4(t.matrixWorld),e.expandByPoint(i)}}var e,n,r,i=new s;return function(n){return e=this,n.updateMatrixWorld(!0),n.traverse(t),this}}(),containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y||t.z<this.min.z||t.z>this.max.z)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y&&this.min.z<=t.min.z&&t.max.z<=this.max.z},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .getParameter() target is now required"),e=new s),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y),(t.z-this.min.z)/(this.max.z-this.min.z))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y||t.max.z<this.min.z||t.min.z>this.max.z)},intersectsSphere:function(){var t=new s;return function(e){return this.clampPoint(e.center,t),t.distanceToSquared(e.center)<=e.radius*e.radius}}(),intersectsPlane:function(t){var e,n;return t.normal.x>0?(e=t.normal.x*this.min.x,n=t.normal.x*this.max.x):(e=t.normal.x*this.max.x,n=t.normal.x*this.min.x),t.normal.y>0?(e+=t.normal.y*this.min.y,n+=t.normal.y*this.max.y):(e+=t.normal.y*this.max.y,n+=t.normal.y*this.min.y),t.normal.z>0?(e+=t.normal.z*this.min.z,n+=t.normal.z*this.max.z):(e+=t.normal.z*this.max.z,n+=t.normal.z*this.min.z),e<=t.constant&&n>=t.constant},intersectsTriangle:function(){function t(t){var i,o;for(i=0,o=t.length-3;i<=o;i+=3){u.fromArray(t,i);var a=l.x*Math.abs(u.x)+l.y*Math.abs(u.y)+l.z*Math.abs(u.z),s=e.dot(u),c=n.dot(u),h=r.dot(u);if(Math.max(-Math.max(s,c,h),Math.min(s,c,h))>a)return!1}return!0}var e=new s,n=new s,r=new s,i=new s,o=new s,a=new s,u=new s,c=new s,l=new s,h=new s;return function(s){if(this.isEmpty())return!1;this.getCenter(c),l.subVectors(this.max,c),e.subVectors(s.a,c),n.subVectors(s.b,c),r.subVectors(s.c,c),i.subVectors(n,e),o.subVectors(r,n),a.subVectors(e,r);var u=[0,-i.z,i.y,0,-o.z,o.y,0,-a.z,a.y,i.z,0,-i.x,o.z,0,-o.x,a.z,0,-a.x,-i.y,i.x,0,-o.y,o.x,0,-a.y,a.x,0];return!!t(u)&&(u=[1,0,0,0,1,0,0,0,1],!!t(u)&&(h.crossVectors(i,o),u=[h.x,h.y,h.z],t(u)))}}(),clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box3: .clampPoint() target is now required"),e=new s),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new s;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),getBoundingSphere:function(){var t=new s;return function(e){return void 0===e&&(console.warn("THREE.Box3: .getBoundingSphere() target is now required"),e=new m),this.getCenter(e.center),e.radius=.5*this.getSize(t).length(),e}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this.isEmpty()&&this.makeEmpty(),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},applyMatrix4:function(){var t=[new s,new s,new s,new s,new s,new s,new s,new s];return function(e){return this.isEmpty()?this:(t[0].set(this.min.x,this.min.y,this.min.z).applyMatrix4(e),t[1].set(this.min.x,this.min.y,this.max.z).applyMatrix4(e),t[2].set(this.min.x,this.max.y,this.min.z).applyMatrix4(e),t[3].set(this.min.x,this.max.y,this.max.z).applyMatrix4(e),t[4].set(this.max.x,this.min.y,this.min.z).applyMatrix4(e),t[5].set(this.max.x,this.min.y,this.max.z).applyMatrix4(e),t[6].set(this.max.x,this.max.y,this.min.z).applyMatrix4(e),t[7].set(this.max.x,this.max.y,this.max.z).applyMatrix4(e),this.setFromPoints(t),this)}}(),translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),Object.assign(m.prototype,{set:function(t,e){return this.center.copy(t),this.radius=e,this},setFromPoints:function(){var t=new p;return function(e,n){var r=this.center;void 0!==n?r.copy(n):t.setFromPoints(e).getCenter(r);for(var i=0,o=0,a=e.length;o<a;o++)i=Math.max(i,r.distanceToSquared(e[o]));return this.radius=Math.sqrt(i),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.center.copy(t.center),this.radius=t.radius,this},empty:function(){return this.radius<=0},containsPoint:function(t){return t.distanceToSquared(this.center)<=this.radius*this.radius},distanceToPoint:function(t){return t.distanceTo(this.center)-this.radius},intersectsSphere:function(t){var e=this.radius+t.radius;return t.center.distanceToSquared(this.center)<=e*e},intersectsBox:function(t){return t.intersectsSphere(this)},intersectsPlane:function(t){return Math.abs(t.distanceToPoint(this.center))<=this.radius},clampPoint:function(t,e){var n=this.center.distanceToSquared(t);return void 0===e&&(console.warn("THREE.Sphere: .clampPoint() target is now required"),e=new s),e.copy(t),n>this.radius*this.radius&&(e.sub(this.center).normalize(),e.multiplyScalar(this.radius).add(this.center)),e},getBoundingBox:function(t){return void 0===t&&(console.warn("THREE.Sphere: .getBoundingBox() target is now required"),t=new p),t.set(this.center,this.center),t.expandByScalar(this.radius),t},applyMatrix4:function(t){return this.center.applyMatrix4(t),this.radius=this.radius*t.getMaxScaleOnAxis(),this},translate:function(t){return this.center.add(t),this},equals:function(t){return t.center.equals(this.center)&&t.radius===this.radius}}),Object.assign(g.prototype,{set:function(t,e){return this.normal.copy(t),this.constant=e,this},setComponents:function(t,e,n,r){return this.normal.set(t,e,n),this.constant=r,this},setFromNormalAndCoplanarPoint:function(t,e){return this.normal.copy(t),this.constant=-e.dot(this.normal),this},setFromCoplanarPoints:function(){var t=new s,e=new s;return function(n,r,i){var o=t.subVectors(i,r).cross(e.subVectors(n,r)).normalize();return this.setFromNormalAndCoplanarPoint(o,n),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.normal.copy(t.normal),this.constant=t.constant,this},normalize:function(){var t=1/this.normal.length();return this.normal.multiplyScalar(t),this.constant*=t,this},negate:function(){return this.constant*=-1,this.normal.negate(),this},distanceToPoint:function(t){return this.normal.dot(t)+this.constant},distanceToSphere:function(t){return this.distanceToPoint(t.center)-t.radius},projectPoint:function(t,e){return void 0===e&&(console.warn("THREE.Plane: .projectPoint() target is now required"),e=new s),e.copy(this.normal).multiplyScalar(-this.distanceToPoint(t)).add(t)},intersectLine:function(){var t=new s;return function(e,n){void 0===n&&(console.warn("THREE.Plane: .intersectLine() target is now required"),n=new s);var r=e.delta(t),i=this.normal.dot(r);if(0!==i){var o=-(e.start.dot(this.normal)+this.constant)/i;if(!(o<0||o>1))return n.copy(r).multiplyScalar(o).add(e.start)}else if(0===this.distanceToPoint(e.start))return n.copy(e.start)}}(),intersectsLine:function(t){var e=this.distanceToPoint(t.start),n=this.distanceToPoint(t.end);return e<0&&n>0||n<0&&e>0},intersectsBox:function(t){return t.intersectsPlane(this)},intersectsSphere:function(t){return t.intersectsPlane(this)},coplanarPoint:function(t){return void 0===t&&(console.warn("THREE.Plane: .coplanarPoint() target is now required"),t=new s),t.copy(this.normal).multiplyScalar(-this.constant)},applyMatrix4:function(){var t=new s,e=new u;return function(n,r){var i=r||e.getNormalMatrix(n),o=this.coplanarPoint(t).applyMatrix4(n),a=this.normal.applyMatrix3(i).normalize();return this.constant=-o.dot(a),this}}(),translate:function(t){return this.constant-=t.dot(this.normal),this},equals:function(t){return t.normal.equals(this.normal)&&t.constant===this.constant}}),Object.assign(v.prototype,{set:function(t,e,n,r,i,o){var a=this.planes;return a[0].copy(t),a[1].copy(e),a[2].copy(n),a[3].copy(r),a[4].copy(i),a[5].copy(o),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){for(var e=this.planes,n=0;n<6;n++)e[n].copy(t.planes[n]);return this},setFromMatrix:function(t){var e=this.planes,n=t.elements,r=n[0],i=n[1],o=n[2],a=n[3],s=n[4],u=n[5],c=n[6],l=n[7],h=n[8],f=n[9],d=n[10],p=n[11],m=n[12],g=n[13],v=n[14],y=n[15];return e[0].setComponents(a-r,l-s,p-h,y-m).normalize(),e[1].setComponents(a+r,l+s,p+h,y+m).normalize(),e[2].setComponents(a+i,l+u,p+f,y+g).normalize(),e[3].setComponents(a-i,l-u,p-f,y-g).normalize(),e[4].setComponents(a-o,l-c,p-d,y-v).normalize(),e[5].setComponents(a+o,l+c,p+d,y+v).normalize(),this},intersectsObject:function(){var t=new m;return function(e){var n=e.geometry;return null===n.boundingSphere&&n.computeBoundingSphere(),t.copy(n.boundingSphere).applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSprite:function(){var t=new m;return function(e){return t.center.set(0,0,0),t.radius=.7071067811865476,t.applyMatrix4(e.matrixWorld),this.intersectsSphere(t)}}(),intersectsSphere:function(t){for(var e=this.planes,n=t.center,r=-t.radius,i=0;i<6;i++){if(e[i].distanceToPoint(n)<r)return!1}return!0},intersectsBox:function(){var t=new s,e=new s;return function(n){for(var r=this.planes,i=0;i<6;i++){var o=r[i];t.x=o.normal.x>0?n.min.x:n.max.x,e.x=o.normal.x>0?n.max.x:n.min.x,t.y=o.normal.y>0?n.min.y:n.max.y,e.y=o.normal.y>0?n.max.y:n.min.y,t.z=o.normal.z>0?n.min.z:n.max.z,e.z=o.normal.z>0?n.max.z:n.min.z;var a=o.distanceToPoint(t),s=o.distanceToPoint(e);if(a<0&&s<0)return!1}return!0}}(),containsPoint:function(t){for(var e=this.planes,n=0;n<6;n++)if(e[n].distanceToPoint(t)<0)return!1;return!0}});var Ru={alphamap_fragment:"#ifdef USE_ALPHAMAP\n\tdiffuseColor.a *= texture2D( alphaMap, vUv ).g;\n#endif\n",alphamap_pars_fragment:"#ifdef USE_ALPHAMAP\n\tuniform sampler2D alphaMap;\n#endif\n",alphatest_fragment:"#ifdef ALPHATEST\n\tif ( diffuseColor.a < ALPHATEST ) discard;\n#endif\n",aomap_fragment:"#ifdef USE_AOMAP\n\tfloat ambientOcclusion = ( texture2D( aoMap, vUv2 ).r - 1.0 ) * aoMapIntensity + 1.0;\n\treflectedLight.indirectDiffuse *= ambientOcclusion;\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\treflectedLight.indirectSpecular *= computeSpecularOcclusion( dotNV, ambientOcclusion, material.specularRoughness );\n\t#endif\n#endif\n",aomap_pars_fragment:"#ifdef USE_AOMAP\n\tuniform sampler2D aoMap;\n\tuniform float aoMapIntensity;\n#endif",begin_vertex:"\nvec3 transformed = vec3( position );\n",beginnormal_vertex:"\nvec3 objectNormal = vec3( normal );\n",bsdfs:"float punctualLightIntensityToIrradianceFactor( const in float lightDistance, const in float cutoffDistance, const in float decayExponent ) {\n\tif( decayExponent > 0.0 ) {\n#if defined ( PHYSICALLY_CORRECT_LIGHTS )\n\t\tfloat distanceFalloff = 1.0 / max( pow( lightDistance, decayExponent ), 0.01 );\n\t\tfloat maxDistanceCutoffFactor = pow2( saturate( 1.0 - pow4( lightDistance / cutoffDistance ) ) );\n\t\treturn distanceFalloff * maxDistanceCutoffFactor;\n#else\n\t\treturn pow( saturate( -lightDistance / cutoffDistance + 1.0 ), decayExponent );\n#endif\n\t}\n\treturn 1.0;\n}\nvec3 BRDF_Diffuse_Lambert( const in vec3 diffuseColor ) {\n\treturn RECIPROCAL_PI * diffuseColor;\n}\nvec3 F_Schlick( const in vec3 specularColor, const in float dotLH ) {\n\tfloat fresnel = exp2( ( -5.55473 * dotLH - 6.98316 ) * dotLH );\n\treturn ( 1.0 - specularColor ) * fresnel + specularColor;\n}\nfloat G_GGX_Smith( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gl = dotNL + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\tfloat gv = dotNV + sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\treturn 1.0 / ( gl * gv );\n}\nfloat G_GGX_SmithCorrelated( const in float alpha, const in float dotNL, const in float dotNV ) {\n\tfloat a2 = pow2( alpha );\n\tfloat gv = dotNL * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNV ) );\n\tfloat gl = dotNV * sqrt( a2 + ( 1.0 - a2 ) * pow2( dotNL ) );\n\treturn 0.5 / max( gv + gl, EPSILON );\n}\nfloat D_GGX( const in float alpha, const in float dotNH ) {\n\tfloat a2 = pow2( alpha );\n\tfloat denom = pow2( dotNH ) * ( a2 - 1.0 ) + 1.0;\n\treturn RECIPROCAL_PI * a2 / pow2( denom );\n}\nvec3 BRDF_Specular_GGX( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat alpha = pow2( roughness );\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNL = saturate( dot( geometry.normal, incidentLight.direction ) );\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_GGX_SmithCorrelated( alpha, dotNL, dotNV );\n\tfloat D = D_GGX( alpha, dotNH );\n\treturn F * ( G * D );\n}\nvec2 LTC_Uv( const in vec3 N, const in vec3 V, const in float roughness ) {\n\tconst float LUT_SIZE  = 64.0;\n\tconst float LUT_SCALE = ( LUT_SIZE - 1.0 ) / LUT_SIZE;\n\tconst float LUT_BIAS  = 0.5 / LUT_SIZE;\n\tfloat dotNV = saturate( dot( N, V ) );\n\tvec2 uv = vec2( roughness, sqrt( 1.0 - dotNV ) );\n\tuv = uv * LUT_SCALE + LUT_BIAS;\n\treturn uv;\n}\nfloat LTC_ClippedSphereFormFactor( const in vec3 f ) {\n\tfloat l = length( f );\n\treturn max( ( l * l + f.z ) / ( l + 1.0 ), 0.0 );\n}\nvec3 LTC_EdgeVectorFormFactor( const in vec3 v1, const in vec3 v2 ) {\n\tfloat x = dot( v1, v2 );\n\tfloat y = abs( x );\n\tfloat a = 0.8543985 + ( 0.4965155 + 0.0145206 * y ) * y;\n\tfloat b = 3.4175940 + ( 4.1616724 + y ) * y;\n\tfloat v = a / b;\n\tfloat theta_sintheta = ( x > 0.0 ) ? v : 0.5 * inversesqrt( max( 1.0 - x * x, 1e-7 ) ) - v;\n\treturn cross( v1, v2 ) * theta_sintheta;\n}\nvec3 LTC_Evaluate( const in vec3 N, const in vec3 V, const in vec3 P, const in mat3 mInv, const in vec3 rectCoords[ 4 ] ) {\n\tvec3 v1 = rectCoords[ 1 ] - rectCoords[ 0 ];\n\tvec3 v2 = rectCoords[ 3 ] - rectCoords[ 0 ];\n\tvec3 lightNormal = cross( v1, v2 );\n\tif( dot( lightNormal, P - rectCoords[ 0 ] ) < 0.0 ) return vec3( 0.0 );\n\tvec3 T1, T2;\n\tT1 = normalize( V - N * dot( V, N ) );\n\tT2 = - cross( N, T1 );\n\tmat3 mat = mInv * transposeMat3( mat3( T1, T2, N ) );\n\tvec3 coords[ 4 ];\n\tcoords[ 0 ] = mat * ( rectCoords[ 0 ] - P );\n\tcoords[ 1 ] = mat * ( rectCoords[ 1 ] - P );\n\tcoords[ 2 ] = mat * ( rectCoords[ 2 ] - P );\n\tcoords[ 3 ] = mat * ( rectCoords[ 3 ] - P );\n\tcoords[ 0 ] = normalize( coords[ 0 ] );\n\tcoords[ 1 ] = normalize( coords[ 1 ] );\n\tcoords[ 2 ] = normalize( coords[ 2 ] );\n\tcoords[ 3 ] = normalize( coords[ 3 ] );\n\tvec3 vectorFormFactor = vec3( 0.0 );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 0 ], coords[ 1 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 1 ], coords[ 2 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 2 ], coords[ 3 ] );\n\tvectorFormFactor += LTC_EdgeVectorFormFactor( coords[ 3 ], coords[ 0 ] );\n\tfloat result = LTC_ClippedSphereFormFactor( vectorFormFactor );\n\treturn vec3( result );\n}\nvec3 BRDF_Specular_GGX_Environment( const in GeometricContext geometry, const in vec3 specularColor, const in float roughness ) {\n\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\tconst vec4 c0 = vec4( - 1, - 0.0275, - 0.572, 0.022 );\n\tconst vec4 c1 = vec4( 1, 0.0425, 1.04, - 0.04 );\n\tvec4 r = roughness * c0 + c1;\n\tfloat a004 = min( r.x * r.x, exp2( - 9.28 * dotNV ) ) * r.x + r.y;\n\tvec2 AB = vec2( -1.04, 1.04 ) * a004 + r.zw;\n\treturn specularColor * AB.x + AB.y;\n}\nfloat G_BlinnPhong_Implicit( ) {\n\treturn 0.25;\n}\nfloat D_BlinnPhong( const in float shininess, const in float dotNH ) {\n\treturn RECIPROCAL_PI * ( shininess * 0.5 + 1.0 ) * pow( dotNH, shininess );\n}\nvec3 BRDF_Specular_BlinnPhong( const in IncidentLight incidentLight, const in GeometricContext geometry, const in vec3 specularColor, const in float shininess ) {\n\tvec3 halfDir = normalize( incidentLight.direction + geometry.viewDir );\n\tfloat dotNH = saturate( dot( geometry.normal, halfDir ) );\n\tfloat dotLH = saturate( dot( incidentLight.direction, halfDir ) );\n\tvec3 F = F_Schlick( specularColor, dotLH );\n\tfloat G = G_BlinnPhong_Implicit( );\n\tfloat D = D_BlinnPhong( shininess, dotNH );\n\treturn F * ( G * D );\n}\nfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\treturn ( 2.0 / pow2( ggxRoughness + 0.0001 ) - 2.0 );\n}\nfloat BlinnExponentToGGXRoughness( const in float blinnExponent ) {\n\treturn sqrt( 2.0 / ( blinnExponent + 2.0 ) );\n}\n",bumpmap_pars_fragment:"#ifdef USE_BUMPMAP\n\tuniform sampler2D bumpMap;\n\tuniform float bumpScale;\n\tvec2 dHdxy_fwd() {\n\t\tvec2 dSTdx = dFdx( vUv );\n\t\tvec2 dSTdy = dFdy( vUv );\n\t\tfloat Hll = bumpScale * texture2D( bumpMap, vUv ).x;\n\t\tfloat dBx = bumpScale * texture2D( bumpMap, vUv + dSTdx ).x - Hll;\n\t\tfloat dBy = bumpScale * texture2D( bumpMap, vUv + dSTdy ).x - Hll;\n\t\treturn vec2( dBx, dBy );\n\t}\n\tvec3 perturbNormalArb( vec3 surf_pos, vec3 surf_norm, vec2 dHdxy ) {\n\t\tvec3 vSigmaX = vec3( dFdx( surf_pos.x ), dFdx( surf_pos.y ), dFdx( surf_pos.z ) );\n\t\tvec3 vSigmaY = vec3( dFdy( surf_pos.x ), dFdy( surf_pos.y ), dFdy( surf_pos.z ) );\n\t\tvec3 vN = surf_norm;\n\t\tvec3 R1 = cross( vSigmaY, vN );\n\t\tvec3 R2 = cross( vN, vSigmaX );\n\t\tfloat fDet = dot( vSigmaX, R1 );\n\t\tvec3 vGrad = sign( fDet ) * ( dHdxy.x * R1 + dHdxy.y * R2 );\n\t\treturn normalize( abs( fDet ) * surf_norm - vGrad );\n\t}\n#endif\n",clipping_planes_fragment:"#if NUM_CLIPPING_PLANES > 0\n\tvec4 plane;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < UNION_CLIPPING_PLANES; i ++ ) {\n\t\tplane = clippingPlanes[ i ];\n\t\tif ( dot( vViewPosition, plane.xyz ) > plane.w ) discard;\n\t}\n\t#if UNION_CLIPPING_PLANES < NUM_CLIPPING_PLANES\n\t\tbool clipped = true;\n\t\t#pragma unroll_loop\n\t\tfor ( int i = UNION_CLIPPING_PLANES; i < NUM_CLIPPING_PLANES; i ++ ) {\n\t\t\tplane = clippingPlanes[ i ];\n\t\t\tclipped = ( dot( vViewPosition, plane.xyz ) > plane.w ) && clipped;\n\t\t}\n\t\tif ( clipped ) discard;\n\t#endif\n#endif\n",clipping_planes_pars_fragment:"#if NUM_CLIPPING_PLANES > 0\n\t#if ! defined( PHYSICAL ) && ! defined( PHONG )\n\t\tvarying vec3 vViewPosition;\n\t#endif\n\tuniform vec4 clippingPlanes[ NUM_CLIPPING_PLANES ];\n#endif\n",clipping_planes_pars_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvarying vec3 vViewPosition;\n#endif\n",clipping_planes_vertex:"#if NUM_CLIPPING_PLANES > 0 && ! defined( PHYSICAL ) && ! defined( PHONG )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n",color_fragment:"#ifdef USE_COLOR\n\tdiffuseColor.rgb *= vColor;\n#endif",color_pars_fragment:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif\n",color_pars_vertex:"#ifdef USE_COLOR\n\tvarying vec3 vColor;\n#endif",color_vertex:"#ifdef USE_COLOR\n\tvColor.xyz = color.xyz;\n#endif",common:"#define PI 3.14159265359\n#define PI2 6.28318530718\n#define PI_HALF 1.5707963267949\n#define RECIPROCAL_PI 0.31830988618\n#define RECIPROCAL_PI2 0.15915494\n#define LOG2 1.442695\n#define EPSILON 1e-6\n#define saturate(a) clamp( a, 0.0, 1.0 )\n#define whiteCompliment(a) ( 1.0 - saturate( a ) )\nfloat pow2( const in float x ) { return x*x; }\nfloat pow3( const in float x ) { return x*x*x; }\nfloat pow4( const in float x ) { float x2 = x*x; return x2*x2; }\nfloat average( const in vec3 color ) { return dot( color, vec3( 0.3333 ) ); }\nhighp float rand( const in vec2 uv ) {\n\tconst highp float a = 12.9898, b = 78.233, c = 43758.5453;\n\thighp float dt = dot( uv.xy, vec2( a,b ) ), sn = mod( dt, PI );\n\treturn fract(sin(sn) * c);\n}\nstruct IncidentLight {\n\tvec3 color;\n\tvec3 direction;\n\tbool visible;\n};\nstruct ReflectedLight {\n\tvec3 directDiffuse;\n\tvec3 directSpecular;\n\tvec3 indirectDiffuse;\n\tvec3 indirectSpecular;\n};\nstruct GeometricContext {\n\tvec3 position;\n\tvec3 normal;\n\tvec3 viewDir;\n};\nvec3 transformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( matrix * vec4( dir, 0.0 ) ).xyz );\n}\nvec3 inverseTransformDirection( in vec3 dir, in mat4 matrix ) {\n\treturn normalize( ( vec4( dir, 0.0 ) * matrix ).xyz );\n}\nvec3 projectOnPlane(in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\tfloat distance = dot( planeNormal, point - pointOnPlane );\n\treturn - distance * planeNormal + point;\n}\nfloat sideOfPlane( in vec3 point, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn sign( dot( point - pointOnPlane, planeNormal ) );\n}\nvec3 linePlaneIntersect( in vec3 pointOnLine, in vec3 lineDirection, in vec3 pointOnPlane, in vec3 planeNormal ) {\n\treturn lineDirection * ( dot( planeNormal, pointOnPlane - pointOnLine ) / dot( planeNormal, lineDirection ) ) + pointOnLine;\n}\nmat3 transposeMat3( const in mat3 m ) {\n\tmat3 tmp;\n\ttmp[ 0 ] = vec3( m[ 0 ].x, m[ 1 ].x, m[ 2 ].x );\n\ttmp[ 1 ] = vec3( m[ 0 ].y, m[ 1 ].y, m[ 2 ].y );\n\ttmp[ 2 ] = vec3( m[ 0 ].z, m[ 1 ].z, m[ 2 ].z );\n\treturn tmp;\n}\nfloat linearToRelativeLuminance( const in vec3 color ) {\n\tvec3 weights = vec3( 0.2126, 0.7152, 0.0722 );\n\treturn dot( weights, color.rgb );\n}\n",cube_uv_reflection_fragment:"#ifdef ENVMAP_TYPE_CUBE_UV\n#define cubeUV_textureSize (1024.0)\nint getFaceFromDirection(vec3 direction) {\n\tvec3 absDirection = abs(direction);\n\tint face = -1;\n\tif( absDirection.x > absDirection.z ) {\n\t\tif(absDirection.x > absDirection.y )\n\t\t\tface = direction.x > 0.0 ? 0 : 3;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\telse {\n\t\tif(absDirection.z > absDirection.y )\n\t\t\tface = direction.z > 0.0 ? 2 : 5;\n\t\telse\n\t\t\tface = direction.y > 0.0 ? 1 : 4;\n\t}\n\treturn face;\n}\n#define cubeUV_maxLods1  (log2(cubeUV_textureSize*0.25) - 1.0)\n#define cubeUV_rangeClamp (exp2((6.0 - 1.0) * 2.0))\nvec2 MipLevelInfo( vec3 vec, float roughnessLevel, float roughness ) {\n\tfloat scale = exp2(cubeUV_maxLods1 - roughnessLevel);\n\tfloat dxRoughness = dFdx(roughness);\n\tfloat dyRoughness = dFdy(roughness);\n\tvec3 dx = dFdx( vec * scale * dxRoughness );\n\tvec3 dy = dFdy( vec * scale * dyRoughness );\n\tfloat d = max( dot( dx, dx ), dot( dy, dy ) );\n\td = clamp(d, 1.0, cubeUV_rangeClamp);\n\tfloat mipLevel = 0.5 * log2(d);\n\treturn vec2(floor(mipLevel), fract(mipLevel));\n}\n#define cubeUV_maxLods2 (log2(cubeUV_textureSize*0.25) - 2.0)\n#define cubeUV_rcpTextureSize (1.0 / cubeUV_textureSize)\nvec2 getCubeUV(vec3 direction, float roughnessLevel, float mipLevel) {\n\tmipLevel = roughnessLevel > cubeUV_maxLods2 - 3.0 ? 0.0 : mipLevel;\n\tfloat a = 16.0 * cubeUV_rcpTextureSize;\n\tvec2 exp2_packed = exp2( vec2( roughnessLevel, mipLevel ) );\n\tvec2 rcp_exp2_packed = vec2( 1.0 ) / exp2_packed;\n\tfloat powScale = exp2_packed.x * exp2_packed.y;\n\tfloat scale = rcp_exp2_packed.x * rcp_exp2_packed.y * 0.25;\n\tfloat mipOffset = 0.75*(1.0 - rcp_exp2_packed.y) * rcp_exp2_packed.x;\n\tbool bRes = mipLevel == 0.0;\n\tscale =  bRes && (scale < a) ? a : scale;\n\tvec3 r;\n\tvec2 offset;\n\tint face = getFaceFromDirection(direction);\n\tfloat rcpPowScale = 1.0 / powScale;\n\tif( face == 0) {\n\t\tr = vec3(direction.x, -direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 1) {\n\t\tr = vec3(direction.y, direction.x, direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 2) {\n\t\tr = vec3(direction.z, direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.75 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? a : offset.y;\n\t}\n\telse if( face == 3) {\n\t\tr = vec3(direction.x, direction.z, direction.y);\n\t\toffset = vec2(0.0+mipOffset,0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse if( face == 4) {\n\t\tr = vec3(direction.y, direction.x, -direction.z);\n\t\toffset = vec2(scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\telse {\n\t\tr = vec3(direction.z, -direction.x, direction.y);\n\t\toffset = vec2(2.0*scale+mipOffset, 0.5 * rcpPowScale);\n\t\toffset.y = bRes && (offset.y < 2.0*a) ? 0.0 : offset.y;\n\t}\n\tr = normalize(r);\n\tfloat texelOffset = 0.5 * cubeUV_rcpTextureSize;\n\tvec2 s = ( r.yz / abs( r.x ) + vec2( 1.0 ) ) * 0.5;\n\tvec2 base = offset + vec2( texelOffset );\n\treturn base + s * ( scale - 2.0 * texelOffset );\n}\n#define cubeUV_maxLods3 (log2(cubeUV_textureSize*0.25) - 3.0)\nvec4 textureCubeUV(vec3 reflectedDirection, float roughness ) {\n\tfloat roughnessVal = roughness* cubeUV_maxLods3;\n\tfloat r1 = floor(roughnessVal);\n\tfloat r2 = r1 + 1.0;\n\tfloat t = fract(roughnessVal);\n\tvec2 mipInfo = MipLevelInfo(reflectedDirection, r1, roughness);\n\tfloat s = mipInfo.y;\n\tfloat level0 = mipInfo.x;\n\tfloat level1 = level0 + 1.0;\n\tlevel1 = level1 > 5.0 ? 5.0 : level1;\n\tlevel0 += min( floor( s + 0.5 ), 5.0 );\n\tvec2 uv_10 = getCubeUV(reflectedDirection, r1, level0);\n\tvec4 color10 = envMapTexelToLinear(texture2D(envMap, uv_10));\n\tvec2 uv_20 = getCubeUV(reflectedDirection, r2, level0);\n\tvec4 color20 = envMapTexelToLinear(texture2D(envMap, uv_20));\n\tvec4 result = mix(color10, color20, t);\n\treturn vec4(result.rgb, 1.0);\n}\n#endif\n",defaultnormal_vertex:"vec3 transformedNormal = normalMatrix * objectNormal;\n#ifdef FLIP_SIDED\n\ttransformedNormal = - transformedNormal;\n#endif\n",displacementmap_pars_vertex:"#ifdef USE_DISPLACEMENTMAP\n\tuniform sampler2D displacementMap;\n\tuniform float displacementScale;\n\tuniform float displacementBias;\n#endif\n",displacementmap_vertex:"#ifdef USE_DISPLACEMENTMAP\n\ttransformed += normalize( objectNormal ) * ( texture2D( displacementMap, uv ).x * displacementScale + displacementBias );\n#endif\n",emissivemap_fragment:"#ifdef USE_EMISSIVEMAP\n\tvec4 emissiveColor = texture2D( emissiveMap, vUv );\n\temissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\ttotalEmissiveRadiance *= emissiveColor.rgb;\n#endif\n",emissivemap_pars_fragment:"#ifdef USE_EMISSIVEMAP\n\tuniform sampler2D emissiveMap;\n#endif\n",encodings_fragment:"  gl_FragColor = linearToOutputTexel( gl_FragColor );\n",encodings_pars_fragment:"\nvec4 LinearToLinear( in vec4 value ) {\n\treturn value;\n}\nvec4 GammaToLinear( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( gammaFactor ) ), value.w );\n}\nvec4 LinearToGamma( in vec4 value, in float gammaFactor ) {\n\treturn vec4( pow( value.xyz, vec3( 1.0 / gammaFactor ) ), value.w );\n}\nvec4 sRGBToLinear( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb * 0.9478672986 + vec3( 0.0521327014 ), vec3( 2.4 ) ), value.rgb * 0.0773993808, vec3( lessThanEqual( value.rgb, vec3( 0.04045 ) ) ) ), value.w );\n}\nvec4 LinearTosRGB( in vec4 value ) {\n\treturn vec4( mix( pow( value.rgb, vec3( 0.41666 ) ) * 1.055 - vec3( 0.055 ), value.rgb * 12.92, vec3( lessThanEqual( value.rgb, vec3( 0.0031308 ) ) ) ), value.w );\n}\nvec4 RGBEToLinear( in vec4 value ) {\n\treturn vec4( value.rgb * exp2( value.a * 255.0 - 128.0 ), 1.0 );\n}\nvec4 LinearToRGBE( in vec4 value ) {\n\tfloat maxComponent = max( max( value.r, value.g ), value.b );\n\tfloat fExp = clamp( ceil( log2( maxComponent ) ), -128.0, 127.0 );\n\treturn vec4( value.rgb / exp2( fExp ), ( fExp + 128.0 ) / 255.0 );\n}\nvec4 RGBMToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.xyz * value.w * maxRange, 1.0 );\n}\nvec4 LinearToRGBM( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat M      = clamp( maxRGB / maxRange, 0.0, 1.0 );\n\tM            = ceil( M * 255.0 ) / 255.0;\n\treturn vec4( value.rgb / ( M * maxRange ), M );\n}\nvec4 RGBDToLinear( in vec4 value, in float maxRange ) {\n\treturn vec4( value.rgb * ( ( maxRange / 255.0 ) / value.a ), 1.0 );\n}\nvec4 LinearToRGBD( in vec4 value, in float maxRange ) {\n\tfloat maxRGB = max( value.x, max( value.g, value.b ) );\n\tfloat D      = max( maxRange / maxRGB, 1.0 );\n\tD            = min( floor( D ) / 255.0, 1.0 );\n\treturn vec4( value.rgb * ( D * ( 255.0 / maxRange ) ), D );\n}\nconst mat3 cLogLuvM = mat3( 0.2209, 0.3390, 0.4184, 0.1138, 0.6780, 0.7319, 0.0102, 0.1130, 0.2969 );\nvec4 LinearToLogLuv( in vec4 value )  {\n\tvec3 Xp_Y_XYZp = value.rgb * cLogLuvM;\n\tXp_Y_XYZp = max(Xp_Y_XYZp, vec3(1e-6, 1e-6, 1e-6));\n\tvec4 vResult;\n\tvResult.xy = Xp_Y_XYZp.xy / Xp_Y_XYZp.z;\n\tfloat Le = 2.0 * log2(Xp_Y_XYZp.y) + 127.0;\n\tvResult.w = fract(Le);\n\tvResult.z = (Le - (floor(vResult.w*255.0))/255.0)/255.0;\n\treturn vResult;\n}\nconst mat3 cLogLuvInverseM = mat3( 6.0014, -2.7008, -1.7996, -1.3320, 3.1029, -5.7721, 0.3008, -1.0882, 5.6268 );\nvec4 LogLuvToLinear( in vec4 value ) {\n\tfloat Le = value.z * 255.0 + value.w;\n\tvec3 Xp_Y_XYZp;\n\tXp_Y_XYZp.y = exp2((Le - 127.0) / 2.0);\n\tXp_Y_XYZp.z = Xp_Y_XYZp.y / value.y;\n\tXp_Y_XYZp.x = value.x * Xp_Y_XYZp.z;\n\tvec3 vRGB = Xp_Y_XYZp.rgb * cLogLuvInverseM;\n\treturn vec4( max(vRGB, 0.0), 1.0 );\n}\n",envmap_fragment:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvec3 cameraToVertex = normalize( vWorldPosition - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( normal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#else\n\t\tvec3 reflectVec = vReflect;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tvec4 envColor = textureCube( envMap, vec3( flipEnvMap * reflectVec.x, reflectVec.yz ) );\n\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\tvec2 sampleUV;\n\t\treflectVec = normalize( reflectVec );\n\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\tvec4 envColor = texture2D( envMap, sampleUV );\n\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\treflectVec = normalize( reflectVec );\n\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0, 0.0, 1.0 ) );\n\t\tvec4 envColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5 );\n\t#else\n\t\tvec4 envColor = vec4( 0.0 );\n\t#endif\n\tenvColor = envMapTexelToLinear( envColor );\n\t#ifdef ENVMAP_BLENDING_MULTIPLY\n\t\toutgoingLight = mix( outgoingLight, outgoingLight * envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_MIX )\n\t\toutgoingLight = mix( outgoingLight, envColor.xyz, specularStrength * reflectivity );\n\t#elif defined( ENVMAP_BLENDING_ADD )\n\t\toutgoingLight += envColor.xyz * specularStrength * reflectivity;\n\t#endif\n#endif\n",envmap_pars_fragment:"#if defined( USE_ENVMAP ) || defined( PHYSICAL )\n\tuniform float reflectivity;\n\tuniform float envMapIntensity;\n#endif\n#ifdef USE_ENVMAP\n\t#if ! defined( PHYSICAL ) && ( defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) )\n\t\tvarying vec3 vWorldPosition;\n\t#endif\n\t#ifdef ENVMAP_TYPE_CUBE\n\t\tuniform samplerCube envMap;\n\t#else\n\t\tuniform sampler2D envMap;\n\t#endif\n\tuniform float flipEnvMap;\n\tuniform int maxMipLevel;\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG ) || defined( PHYSICAL )\n\t\tuniform float refractionRatio;\n\t#else\n\t\tvarying vec3 vReflect;\n\t#endif\n#endif\n",envmap_pars_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvarying vec3 vWorldPosition;\n\t#else\n\t\tvarying vec3 vReflect;\n\t\tuniform float refractionRatio;\n\t#endif\n#endif\n",envmap_vertex:"#ifdef USE_ENVMAP\n\t#if defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( PHONG )\n\t\tvWorldPosition = worldPosition.xyz;\n\t#else\n\t\tvec3 cameraToVertex = normalize( worldPosition.xyz - cameraPosition );\n\t\tvec3 worldNormal = inverseTransformDirection( transformedNormal, viewMatrix );\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvReflect = reflect( cameraToVertex, worldNormal );\n\t\t#else\n\t\t\tvReflect = refract( cameraToVertex, worldNormal, refractionRatio );\n\t\t#endif\n\t#endif\n#endif\n",fog_vertex:"\n#ifdef USE_FOG\nfogDepth = -mvPosition.z;\n#endif",fog_pars_vertex:"#ifdef USE_FOG\n  varying float fogDepth;\n#endif\n",fog_fragment:"#ifdef USE_FOG\n\t#ifdef FOG_EXP2\n\t\tfloat fogFactor = whiteCompliment( exp2( - fogDensity * fogDensity * fogDepth * fogDepth * LOG2 ) );\n\t#else\n\t\tfloat fogFactor = smoothstep( fogNear, fogFar, fogDepth );\n\t#endif\n\tgl_FragColor.rgb = mix( gl_FragColor.rgb, fogColor, fogFactor );\n#endif\n",fog_pars_fragment:"#ifdef USE_FOG\n\tuniform vec3 fogColor;\n\tvarying float fogDepth;\n\t#ifdef FOG_EXP2\n\t\tuniform float fogDensity;\n\t#else\n\t\tuniform float fogNear;\n\t\tuniform float fogFar;\n\t#endif\n#endif\n",gradientmap_pars_fragment:"#ifdef TOON\n\tuniform sampler2D gradientMap;\n\tvec3 getGradientIrradiance( vec3 normal, vec3 lightDirection ) {\n\t\tfloat dotNL = dot( normal, lightDirection );\n\t\tvec2 coord = vec2( dotNL * 0.5 + 0.5, 0.0 );\n\t\t#ifdef USE_GRADIENTMAP\n\t\t\treturn texture2D( gradientMap, coord ).rgb;\n\t\t#else\n\t\t\treturn ( coord.x < 0.7 ) ? vec3( 0.7 ) : vec3( 1.0 );\n\t\t#endif\n\t}\n#endif\n",lightmap_fragment:"#ifdef USE_LIGHTMAP\n\treflectedLight.indirectDiffuse += PI * texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n#endif\n",lightmap_pars_fragment:"#ifdef USE_LIGHTMAP\n\tuniform sampler2D lightMap;\n\tuniform float lightMapIntensity;\n#endif",lights_lambert_vertex:"vec3 diffuse = vec3( 1.0 );\nGeometricContext geometry;\ngeometry.position = mvPosition.xyz;\ngeometry.normal = normalize( transformedNormal );\ngeometry.viewDir = normalize( -mvPosition.xyz );\nGeometricContext backGeometry;\nbackGeometry.position = geometry.position;\nbackGeometry.normal = -geometry.normal;\nbackGeometry.viewDir = geometry.viewDir;\nvLightFront = vec3( 0.0 );\n#ifdef DOUBLE_SIDED\n\tvLightBack = vec3( 0.0 );\n#endif\nIncidentLight directLight;\nfloat dotNL;\nvec3 directLightColor_Diffuse;\n#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tgetPointDirectLightIrradiance( pointLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tgetSpotDirectLightIrradiance( spotLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tgetDirectionalDirectLightIrradiance( directionalLights[ i ], geometry, directLight );\n\t\tdotNL = dot( geometry.normal, directLight.direction );\n\t\tdirectLightColor_Diffuse = PI * directLight.color;\n\t\tvLightFront += saturate( dotNL ) * directLightColor_Diffuse;\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += saturate( -dotNL ) * directLightColor_Diffuse;\n\t\t#endif\n\t}\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\tvLightFront += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t#ifdef DOUBLE_SIDED\n\t\t\tvLightBack += getHemisphereLightIrradiance( hemisphereLights[ i ], backGeometry );\n\t\t#endif\n\t}\n#endif\n",lights_pars_begin:"uniform vec3 ambientLightColor;\nvec3 getAmbientLightIrradiance( const in vec3 ambientLightColor ) {\n\tvec3 irradiance = ambientLightColor;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treturn irradiance;\n}\n#if NUM_DIR_LIGHTS > 0\n\tstruct DirectionalLight {\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform DirectionalLight directionalLights[ NUM_DIR_LIGHTS ];\n\tvoid getDirectionalDirectLightIrradiance( const in DirectionalLight directionalLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tdirectLight.color = directionalLight.color;\n\t\tdirectLight.direction = directionalLight.direction;\n\t\tdirectLight.visible = true;\n\t}\n#endif\n#if NUM_POINT_LIGHTS > 0\n\tstruct PointLight {\n\t\tvec3 position;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t\tfloat shadowCameraNear;\n\t\tfloat shadowCameraFar;\n\t};\n\tuniform PointLight pointLights[ NUM_POINT_LIGHTS ];\n\tvoid getPointDirectLightIrradiance( const in PointLight pointLight, const in GeometricContext geometry, out IncidentLight directLight ) {\n\t\tvec3 lVector = pointLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tdirectLight.color = pointLight.color;\n\t\tdirectLight.color *= punctualLightIntensityToIrradianceFactor( lightDistance, pointLight.distance, pointLight.decay );\n\t\tdirectLight.visible = ( directLight.color != vec3( 0.0 ) );\n\t}\n#endif\n#if NUM_SPOT_LIGHTS > 0\n\tstruct SpotLight {\n\t\tvec3 position;\n\t\tvec3 direction;\n\t\tvec3 color;\n\t\tfloat distance;\n\t\tfloat decay;\n\t\tfloat coneCos;\n\t\tfloat penumbraCos;\n\t\tint shadow;\n\t\tfloat shadowBias;\n\t\tfloat shadowRadius;\n\t\tvec2 shadowMapSize;\n\t};\n\tuniform SpotLight spotLights[ NUM_SPOT_LIGHTS ];\n\tvoid getSpotDirectLightIrradiance( const in SpotLight spotLight, const in GeometricContext geometry, out IncidentLight directLight  ) {\n\t\tvec3 lVector = spotLight.position - geometry.position;\n\t\tdirectLight.direction = normalize( lVector );\n\t\tfloat lightDistance = length( lVector );\n\t\tfloat angleCos = dot( directLight.direction, spotLight.direction );\n\t\tif ( angleCos > spotLight.coneCos ) {\n\t\t\tfloat spotEffect = smoothstep( spotLight.coneCos, spotLight.penumbraCos, angleCos );\n\t\t\tdirectLight.color = spotLight.color;\n\t\t\tdirectLight.color *= spotEffect * punctualLightIntensityToIrradianceFactor( lightDistance, spotLight.distance, spotLight.decay );\n\t\t\tdirectLight.visible = true;\n\t\t} else {\n\t\t\tdirectLight.color = vec3( 0.0 );\n\t\t\tdirectLight.visible = false;\n\t\t}\n\t}\n#endif\n#if NUM_RECT_AREA_LIGHTS > 0\n\tstruct RectAreaLight {\n\t\tvec3 color;\n\t\tvec3 position;\n\t\tvec3 halfWidth;\n\t\tvec3 halfHeight;\n\t};\n\tuniform sampler2D ltc_1;\tuniform sampler2D ltc_2;\n\tuniform RectAreaLight rectAreaLights[ NUM_RECT_AREA_LIGHTS ];\n#endif\n#if NUM_HEMI_LIGHTS > 0\n\tstruct HemisphereLight {\n\t\tvec3 direction;\n\t\tvec3 skyColor;\n\t\tvec3 groundColor;\n\t};\n\tuniform HemisphereLight hemisphereLights[ NUM_HEMI_LIGHTS ];\n\tvec3 getHemisphereLightIrradiance( const in HemisphereLight hemiLight, const in GeometricContext geometry ) {\n\t\tfloat dotNL = dot( geometry.normal, hemiLight.direction );\n\t\tfloat hemiDiffuseWeight = 0.5 * dotNL + 0.5;\n\t\tvec3 irradiance = mix( hemiLight.groundColor, hemiLight.skyColor, hemiDiffuseWeight );\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tirradiance *= PI;\n\t\t#endif\n\t\treturn irradiance;\n\t}\n#endif\n",lights_pars_maps:"#if defined( USE_ENVMAP ) && defined( PHYSICAL )\n\tvec3 getLightProbeIndirectIrradiance( const in GeometricContext geometry, const in int maxMIPLevel ) {\n\t\tvec3 worldNormal = inverseTransformDirection( geometry.normal, viewMatrix );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryVec, float( maxMIPLevel ) );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryVec = vec3( flipEnvMap * worldNormal.x, worldNormal.yz );\n\t\t\tvec4 envMapColor = textureCubeUV( queryVec, 1.0 );\n\t\t#else\n\t\t\tvec4 envMapColor = vec4( 0.0 );\n\t\t#endif\n\t\treturn PI * envMapColor.rgb * envMapIntensity;\n\t}\n\tfloat getSpecularMIPLevel( const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\tfloat maxMIPLevelScalar = float( maxMIPLevel );\n\t\tfloat desiredMIPLevel = maxMIPLevelScalar + 0.79248 - 0.5 * log2( pow2( blinnShininessExponent ) + 1.0 );\n\t\treturn clamp( desiredMIPLevel, 0.0, maxMIPLevelScalar );\n\t}\n\tvec3 getLightProbeIndirectRadiance( const in GeometricContext geometry, const in float blinnShininessExponent, const in int maxMIPLevel ) {\n\t\t#ifdef ENVMAP_MODE_REFLECTION\n\t\t\tvec3 reflectVec = reflect( -geometry.viewDir, geometry.normal );\n\t\t#else\n\t\t\tvec3 reflectVec = refract( -geometry.viewDir, geometry.normal, refractionRatio );\n\t\t#endif\n\t\treflectVec = inverseTransformDirection( reflectVec, viewMatrix );\n\t\tfloat specularMIPLevel = getSpecularMIPLevel( blinnShininessExponent, maxMIPLevel );\n\t\t#ifdef ENVMAP_TYPE_CUBE\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = textureCubeLodEXT( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = textureCube( envMap, queryReflectVec, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_CUBE_UV )\n\t\t\tvec3 queryReflectVec = vec3( flipEnvMap * reflectVec.x, reflectVec.yz );\n\t\t\tvec4 envMapColor = textureCubeUV(queryReflectVec, BlinnExponentToGGXRoughness(blinnShininessExponent));\n\t\t#elif defined( ENVMAP_TYPE_EQUIREC )\n\t\t\tvec2 sampleUV;\n\t\t\tsampleUV.y = asin( clamp( reflectVec.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\t\t\tsampleUV.x = atan( reflectVec.z, reflectVec.x ) * RECIPROCAL_PI2 + 0.5;\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, sampleUV, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, sampleUV, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#elif defined( ENVMAP_TYPE_SPHERE )\n\t\t\tvec3 reflectView = normalize( ( viewMatrix * vec4( reflectVec, 0.0 ) ).xyz + vec3( 0.0,0.0,1.0 ) );\n\t\t\t#ifdef TEXTURE_LOD_EXT\n\t\t\t\tvec4 envMapColor = texture2DLodEXT( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#else\n\t\t\t\tvec4 envMapColor = texture2D( envMap, reflectView.xy * 0.5 + 0.5, specularMIPLevel );\n\t\t\t#endif\n\t\t\tenvMapColor.rgb = envMapTexelToLinear( envMapColor ).rgb;\n\t\t#endif\n\t\treturn envMapColor.rgb * envMapIntensity;\n\t}\n#endif\n",lights_phong_fragment:"BlinnPhongMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularColor = specular;\nmaterial.specularShininess = shininess;\nmaterial.specularStrength = specularStrength;\n",lights_phong_pars_fragment:"varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\nstruct BlinnPhongMaterial {\n\tvec3\tdiffuseColor;\n\tvec3\tspecularColor;\n\tfloat\tspecularShininess;\n\tfloat\tspecularStrength;\n};\nvoid RE_Direct_BlinnPhong( const in IncidentLight directLight, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifdef TOON\n\t\tvec3 irradiance = getGradientIrradiance( geometry.normal, directLight.direction ) * directLight.color;\n\t#else\n\t\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\t\tvec3 irradiance = dotNL * directLight.color;\n\t#endif\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\treflectedLight.directDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\treflectedLight.directSpecular += irradiance * BRDF_Specular_BlinnPhong( directLight, geometry, material.specularColor, material.specularShininess ) * material.specularStrength;\n}\nvoid RE_IndirectDiffuse_BlinnPhong( const in vec3 irradiance, const in GeometricContext geometry, const in BlinnPhongMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\n#define RE_Direct\t\t\t\tRE_Direct_BlinnPhong\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_BlinnPhong\n#define Material_LightProbeLOD( material )\t(0)\n",lights_physical_fragment:"PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb * ( 1.0 - metalnessFactor );\nmaterial.specularRoughness = clamp( roughnessFactor, 0.04, 1.0 );\n#ifdef STANDARD\n\tmaterial.specularColor = mix( vec3( DEFAULT_SPECULAR_COEFFICIENT ), diffuseColor.rgb, metalnessFactor );\n#else\n\tmaterial.specularColor = mix( vec3( MAXIMUM_SPECULAR_COEFFICIENT * pow2( reflectivity ) ), diffuseColor.rgb, metalnessFactor );\n\tmaterial.clearCoat = saturate( clearCoat );\tmaterial.clearCoatRoughness = clamp( clearCoatRoughness, 0.04, 1.0 );\n#endif\n",lights_physical_pars_fragment:"struct PhysicalMaterial {\n\tvec3\tdiffuseColor;\n\tfloat\tspecularRoughness;\n\tvec3\tspecularColor;\n\t#ifndef STANDARD\n\t\tfloat clearCoat;\n\t\tfloat clearCoatRoughness;\n\t#endif\n};\n#define MAXIMUM_SPECULAR_COEFFICIENT 0.16\n#define DEFAULT_SPECULAR_COEFFICIENT 0.04\nfloat clearCoatDHRApprox( const in float roughness, const in float dotNL ) {\n\treturn DEFAULT_SPECULAR_COEFFICIENT + ( 1.0 - DEFAULT_SPECULAR_COEFFICIENT ) * ( pow( 1.0 - dotNL, 5.0 ) * pow( 1.0 - roughness, 2.0 ) );\n}\n#if NUM_RECT_AREA_LIGHTS > 0\n\tvoid RE_Direct_RectArea_Physical( const in RectAreaLight rectAreaLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t\tvec3 normal = geometry.normal;\n\t\tvec3 viewDir = geometry.viewDir;\n\t\tvec3 position = geometry.position;\n\t\tvec3 lightPos = rectAreaLight.position;\n\t\tvec3 halfWidth = rectAreaLight.halfWidth;\n\t\tvec3 halfHeight = rectAreaLight.halfHeight;\n\t\tvec3 lightColor = rectAreaLight.color;\n\t\tfloat roughness = material.specularRoughness;\n\t\tvec3 rectCoords[ 4 ];\n\t\trectCoords[ 0 ] = lightPos - halfWidth - halfHeight;\t\trectCoords[ 1 ] = lightPos + halfWidth - halfHeight;\n\t\trectCoords[ 2 ] = lightPos + halfWidth + halfHeight;\n\t\trectCoords[ 3 ] = lightPos - halfWidth + halfHeight;\n\t\tvec2 uv = LTC_Uv( normal, viewDir, roughness );\n\t\tvec4 t1 = texture2D( ltc_1, uv );\n\t\tvec4 t2 = texture2D( ltc_2, uv );\n\t\tmat3 mInv = mat3(\n\t\t\tvec3( t1.x, 0, t1.y ),\n\t\t\tvec3(    0, 1,    0 ),\n\t\t\tvec3( t1.z, 0, t1.w )\n\t\t);\n\t\tvec3 fresnel = ( material.specularColor * t2.x + ( vec3( 1.0 ) - material.specularColor ) * t2.y );\n\t\treflectedLight.directSpecular += lightColor * fresnel * LTC_Evaluate( normal, viewDir, position, mInv, rectCoords );\n\t\treflectedLight.directDiffuse += lightColor * material.diffuseColor * LTC_Evaluate( normal, viewDir, position, mat3( 1.0 ), rectCoords );\n\t}\n#endif\nvoid RE_Direct_Physical( const in IncidentLight directLight, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\tfloat dotNL = saturate( dot( geometry.normal, directLight.direction ) );\n\tvec3 irradiance = dotNL * directLight.color;\n\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\tirradiance *= PI;\n\t#endif\n\t#ifndef STANDARD\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.directSpecular += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Specular_GGX( directLight, geometry, material.specularColor, material.specularRoughness );\n\treflectedLight.directDiffuse += ( 1.0 - clearCoatDHR ) * irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n\t#ifndef STANDARD\n\t\treflectedLight.directSpecular += irradiance * material.clearCoat * BRDF_Specular_GGX( directLight, geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\nvoid RE_IndirectDiffuse_Physical( const in vec3 irradiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\treflectedLight.indirectDiffuse += irradiance * BRDF_Diffuse_Lambert( material.diffuseColor );\n}\nvoid RE_IndirectSpecular_Physical( const in vec3 radiance, const in vec3 clearCoatRadiance, const in GeometricContext geometry, const in PhysicalMaterial material, inout ReflectedLight reflectedLight ) {\n\t#ifndef STANDARD\n\t\tfloat dotNV = saturate( dot( geometry.normal, geometry.viewDir ) );\n\t\tfloat dotNL = dotNV;\n\t\tfloat clearCoatDHR = material.clearCoat * clearCoatDHRApprox( material.clearCoatRoughness, dotNL );\n\t#else\n\t\tfloat clearCoatDHR = 0.0;\n\t#endif\n\treflectedLight.indirectSpecular += ( 1.0 - clearCoatDHR ) * radiance * BRDF_Specular_GGX_Environment( geometry, material.specularColor, material.specularRoughness );\n\t#ifndef STANDARD\n\t\treflectedLight.indirectSpecular += clearCoatRadiance * material.clearCoat * BRDF_Specular_GGX_Environment( geometry, vec3( DEFAULT_SPECULAR_COEFFICIENT ), material.clearCoatRoughness );\n\t#endif\n}\n#define RE_Direct\t\t\t\tRE_Direct_Physical\n#define RE_Direct_RectArea\t\tRE_Direct_RectArea_Physical\n#define RE_IndirectDiffuse\t\tRE_IndirectDiffuse_Physical\n#define RE_IndirectSpecular\t\tRE_IndirectSpecular_Physical\n#define Material_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.specularRoughness )\n#define Material_ClearCoat_BlinnShininessExponent( material )   GGXRoughnessToBlinnExponent( material.clearCoatRoughness )\nfloat computeSpecularOcclusion( const in float dotNV, const in float ambientOcclusion, const in float roughness ) {\n\treturn saturate( pow( dotNV + ambientOcclusion, exp2( - 16.0 * roughness - 1.0 ) ) - 1.0 + ambientOcclusion );\n}\n",lights_fragment_begin:"\nGeometricContext geometry;\ngeometry.position = - vViewPosition;\ngeometry.normal = normal;\ngeometry.viewDir = normalize( vViewPosition );\nIncidentLight directLight;\n#if ( NUM_POINT_LIGHTS > 0 ) && defined( RE_Direct )\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tgetPointDirectLightIrradiance( pointLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( pointLight.shadow, directLight.visible ) ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_SPOT_LIGHTS > 0 ) && defined( RE_Direct )\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tgetSpotDirectLightIrradiance( spotLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( spotLight.shadow, directLight.visible ) ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_DIR_LIGHTS > 0 ) && defined( RE_Direct )\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tgetDirectionalDirectLightIrradiance( directionalLight, geometry, directLight );\n\t\t#ifdef USE_SHADOWMAP\n\t\tdirectLight.color *= all( bvec2( directionalLight.shadow, directLight.visible ) ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t\t#endif\n\t\tRE_Direct( directLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if ( NUM_RECT_AREA_LIGHTS > 0 ) && defined( RE_Direct_RectArea )\n\tRectAreaLight rectAreaLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_RECT_AREA_LIGHTS; i ++ ) {\n\t\trectAreaLight = rectAreaLights[ i ];\n\t\tRE_Direct_RectArea( rectAreaLight, geometry, material, reflectedLight );\n\t}\n#endif\n#if defined( RE_IndirectDiffuse )\n\tvec3 irradiance = getAmbientLightIrradiance( ambientLightColor );\n\t#if ( NUM_HEMI_LIGHTS > 0 )\n\t\t#pragma unroll_loop\n\t\tfor ( int i = 0; i < NUM_HEMI_LIGHTS; i ++ ) {\n\t\t\tirradiance += getHemisphereLightIrradiance( hemisphereLights[ i ], geometry );\n\t\t}\n\t#endif\n#endif\n#if defined( RE_IndirectSpecular )\n\tvec3 radiance = vec3( 0.0 );\n\tvec3 clearCoatRadiance = vec3( 0.0 );\n#endif\n",lights_fragment_maps:"#if defined( RE_IndirectDiffuse )\n\t#ifdef USE_LIGHTMAP\n\t\tvec3 lightMapIrradiance = texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t\t#ifndef PHYSICALLY_CORRECT_LIGHTS\n\t\t\tlightMapIrradiance *= PI;\n\t\t#endif\n\t\tirradiance += lightMapIrradiance;\n\t#endif\n\t#if defined( USE_ENVMAP ) && defined( PHYSICAL ) && defined( ENVMAP_TYPE_CUBE_UV )\n\t\tirradiance += getLightProbeIndirectIrradiance( geometry, maxMipLevel );\n\t#endif\n#endif\n#if defined( USE_ENVMAP ) && defined( RE_IndirectSpecular )\n\tradiance += getLightProbeIndirectRadiance( geometry, Material_BlinnShininessExponent( material ), maxMipLevel );\n\t#ifndef STANDARD\n\t\tclearCoatRadiance += getLightProbeIndirectRadiance( geometry, Material_ClearCoat_BlinnShininessExponent( material ), maxMipLevel );\n\t#endif\n#endif\n",lights_fragment_end:"#if defined( RE_IndirectDiffuse )\n\tRE_IndirectDiffuse( irradiance, geometry, material, reflectedLight );\n#endif\n#if defined( RE_IndirectSpecular )\n\tRE_IndirectSpecular( radiance, clearCoatRadiance, geometry, material, reflectedLight );\n#endif\n",logdepthbuf_fragment:"#if defined( USE_LOGDEPTHBUF ) && defined( USE_LOGDEPTHBUF_EXT )\n\tgl_FragDepthEXT = log2( vFragDepth ) * logDepthBufFC * 0.5;\n#endif",logdepthbuf_pars_fragment:"#ifdef USE_LOGDEPTHBUF\n\tuniform float logDepthBufFC;\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n#endif\n",logdepthbuf_pars_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvarying float vFragDepth;\n\t#endif\n\tuniform float logDepthBufFC;\n#endif",logdepthbuf_vertex:"#ifdef USE_LOGDEPTHBUF\n\t#ifdef USE_LOGDEPTHBUF_EXT\n\t\tvFragDepth = 1.0 + gl_Position.w;\n\t#else\n\t\tgl_Position.z = log2( max( EPSILON, gl_Position.w + 1.0 ) ) * logDepthBufFC - 1.0;\n\t\tgl_Position.z *= gl_Position.w;\n\t#endif\n#endif\n",map_fragment:"#ifdef USE_MAP\n\tvec4 texelColor = texture2D( map, vUv );\n\ttexelColor = mapTexelToLinear( texelColor );\n\tdiffuseColor *= texelColor;\n#endif\n",map_pars_fragment:"#ifdef USE_MAP\n\tuniform sampler2D map;\n#endif\n",map_particle_fragment:"#ifdef USE_MAP\n\tvec2 uv = ( uvTransform * vec3( gl_PointCoord.x, 1.0 - gl_PointCoord.y, 1 ) ).xy;\n\tvec4 mapTexel = texture2D( map, uv );\n\tdiffuseColor *= mapTexelToLinear( mapTexel );\n#endif\n",map_particle_pars_fragment:"#ifdef USE_MAP\n\tuniform mat3 uvTransform;\n\tuniform sampler2D map;\n#endif\n",metalnessmap_fragment:"float metalnessFactor = metalness;\n#ifdef USE_METALNESSMAP\n\tvec4 texelMetalness = texture2D( metalnessMap, vUv );\n\tmetalnessFactor *= texelMetalness.b;\n#endif\n",metalnessmap_pars_fragment:"#ifdef USE_METALNESSMAP\n\tuniform sampler2D metalnessMap;\n#endif",morphnormal_vertex:"#ifdef USE_MORPHNORMALS\n\tobjectNormal += ( morphNormal0 - normal ) * morphTargetInfluences[ 0 ];\n\tobjectNormal += ( morphNormal1 - normal ) * morphTargetInfluences[ 1 ];\n\tobjectNormal += ( morphNormal2 - normal ) * morphTargetInfluences[ 2 ];\n\tobjectNormal += ( morphNormal3 - normal ) * morphTargetInfluences[ 3 ];\n#endif\n",morphtarget_pars_vertex:"#ifdef USE_MORPHTARGETS\n\t#ifndef USE_MORPHNORMALS\n\tuniform float morphTargetInfluences[ 8 ];\n\t#else\n\tuniform float morphTargetInfluences[ 4 ];\n\t#endif\n#endif",morphtarget_vertex:"#ifdef USE_MORPHTARGETS\n\ttransformed += ( morphTarget0 - position ) * morphTargetInfluences[ 0 ];\n\ttransformed += ( morphTarget1 - position ) * morphTargetInfluences[ 1 ];\n\ttransformed += ( morphTarget2 - position ) * morphTargetInfluences[ 2 ];\n\ttransformed += ( morphTarget3 - position ) * morphTargetInfluences[ 3 ];\n\t#ifndef USE_MORPHNORMALS\n\ttransformed += ( morphTarget4 - position ) * morphTargetInfluences[ 4 ];\n\ttransformed += ( morphTarget5 - position ) * morphTargetInfluences[ 5 ];\n\ttransformed += ( morphTarget6 - position ) * morphTargetInfluences[ 6 ];\n\ttransformed += ( morphTarget7 - position ) * morphTargetInfluences[ 7 ];\n\t#endif\n#endif\n",normal_fragment_begin:"#ifdef FLAT_SHADED\n\tvec3 fdx = vec3( dFdx( vViewPosition.x ), dFdx( vViewPosition.y ), dFdx( vViewPosition.z ) );\n\tvec3 fdy = vec3( dFdy( vViewPosition.x ), dFdy( vViewPosition.y ), dFdy( vViewPosition.z ) );\n\tvec3 normal = normalize( cross( fdx, fdy ) );\n#else\n\tvec3 normal = normalize( vNormal );\n\t#ifdef DOUBLE_SIDED\n\t\tnormal = normal * ( float( gl_FrontFacing ) * 2.0 - 1.0 );\n\t#endif\n#endif\n",normal_fragment_maps:"#ifdef USE_NORMALMAP\n\tnormal = perturbNormal2Arb( -vViewPosition, normal );\n#elif defined( USE_BUMPMAP )\n\tnormal = perturbNormalArb( -vViewPosition, normal, dHdxy_fwd() );\n#endif\n",normalmap_pars_fragment:"#ifdef USE_NORMALMAP\n\tuniform sampler2D normalMap;\n\tuniform vec2 normalScale;\n\tvec3 perturbNormal2Arb( vec3 eye_pos, vec3 surf_norm ) {\n\t\tvec3 q0 = vec3( dFdx( eye_pos.x ), dFdx( eye_pos.y ), dFdx( eye_pos.z ) );\n\t\tvec3 q1 = vec3( dFdy( eye_pos.x ), dFdy( eye_pos.y ), dFdy( eye_pos.z ) );\n\t\tvec2 st0 = dFdx( vUv.st );\n\t\tvec2 st1 = dFdy( vUv.st );\n\t\tfloat scale = sign( st1.t * st0.s - st0.t * st1.s );\t\tscale *= float( gl_FrontFacing ) * 2.0 - 1.0;\n\t\tvec3 S = normalize( ( q0 * st1.t - q1 * st0.t ) * scale );\n\t\tvec3 T = normalize( ( - q0 * st1.s + q1 * st0.s ) * scale );\n\t\tvec3 N = normalize( surf_norm );\n\t\tvec3 mapN = texture2D( normalMap, vUv ).xyz * 2.0 - 1.0;\n\t\tmapN.xy = normalScale * mapN.xy;\n\t\tmat3 tsn = mat3( S, T, N );\n\t\treturn normalize( tsn * mapN );\n\t}\n#endif\n",packing:"vec3 packNormalToRGB( const in vec3 normal ) {\n\treturn normalize( normal ) * 0.5 + 0.5;\n}\nvec3 unpackRGBToNormal( const in vec3 rgb ) {\n\treturn 2.0 * rgb.xyz - 1.0;\n}\nconst float PackUpscale = 256. / 255.;const float UnpackDownscale = 255. / 256.;\nconst vec3 PackFactors = vec3( 256. * 256. * 256., 256. * 256.,  256. );\nconst vec4 UnpackFactors = UnpackDownscale / vec4( PackFactors, 1. );\nconst float ShiftRight8 = 1. / 256.;\nvec4 packDepthToRGBA( const in float v ) {\n\tvec4 r = vec4( fract( v * PackFactors ), v );\n\tr.yzw -= r.xyz * ShiftRight8;\treturn r * PackUpscale;\n}\nfloat unpackRGBAToDepth( const in vec4 v ) {\n\treturn dot( v, UnpackFactors );\n}\nfloat viewZToOrthographicDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn ( viewZ + near ) / ( near - far );\n}\nfloat orthographicDepthToViewZ( const in float linearClipZ, const in float near, const in float far ) {\n\treturn linearClipZ * ( near - far ) - near;\n}\nfloat viewZToPerspectiveDepth( const in float viewZ, const in float near, const in float far ) {\n\treturn (( near + viewZ ) * far ) / (( far - near ) * viewZ );\n}\nfloat perspectiveDepthToViewZ( const in float invClipZ, const in float near, const in float far ) {\n\treturn ( near * far ) / ( ( far - near ) * invClipZ - far );\n}\n",premultiplied_alpha_fragment:"#ifdef PREMULTIPLIED_ALPHA\n\tgl_FragColor.rgb *= gl_FragColor.a;\n#endif\n",project_vertex:"vec4 mvPosition = modelViewMatrix * vec4( transformed, 1.0 );\ngl_Position = projectionMatrix * mvPosition;\n",dithering_fragment:"#if defined( DITHERING )\n  gl_FragColor.rgb = dithering( gl_FragColor.rgb );\n#endif\n",dithering_pars_fragment:"#if defined( DITHERING )\n\tvec3 dithering( vec3 color ) {\n\t\tfloat grid_position = rand( gl_FragCoord.xy );\n\t\tvec3 dither_shift_RGB = vec3( 0.25 / 255.0, -0.25 / 255.0, 0.25 / 255.0 );\n\t\tdither_shift_RGB = mix( 2.0 * dither_shift_RGB, -2.0 * dither_shift_RGB, grid_position );\n\t\treturn color + dither_shift_RGB;\n\t}\n#endif\n",roughnessmap_fragment:"float roughnessFactor = roughness;\n#ifdef USE_ROUGHNESSMAP\n\tvec4 texelRoughness = texture2D( roughnessMap, vUv );\n\troughnessFactor *= texelRoughness.g;\n#endif\n",roughnessmap_pars_fragment:"#ifdef USE_ROUGHNESSMAP\n\tuniform sampler2D roughnessMap;\n#endif",shadowmap_pars_fragment:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform sampler2D directionalShadowMap[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform sampler2D spotShadowMap[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform sampler2D pointShadowMap[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n\tfloat texture2DCompare( sampler2D depths, vec2 uv, float compare ) {\n\t\treturn step( compare, unpackRGBAToDepth( texture2D( depths, uv ) ) );\n\t}\n\tfloat texture2DShadowLerp( sampler2D depths, vec2 size, vec2 uv, float compare ) {\n\t\tconst vec2 offset = vec2( 0.0, 1.0 );\n\t\tvec2 texelSize = vec2( 1.0 ) / size;\n\t\tvec2 centroidUV = floor( uv * size + 0.5 ) / size;\n\t\tfloat lb = texture2DCompare( depths, centroidUV + texelSize * offset.xx, compare );\n\t\tfloat lt = texture2DCompare( depths, centroidUV + texelSize * offset.xy, compare );\n\t\tfloat rb = texture2DCompare( depths, centroidUV + texelSize * offset.yx, compare );\n\t\tfloat rt = texture2DCompare( depths, centroidUV + texelSize * offset.yy, compare );\n\t\tvec2 f = fract( uv * size + 0.5 );\n\t\tfloat a = mix( lb, lt, f.y );\n\t\tfloat b = mix( rb, rt, f.y );\n\t\tfloat c = mix( a, b, f.x );\n\t\treturn c;\n\t}\n\tfloat getShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord ) {\n\t\tfloat shadow = 1.0;\n\t\tshadowCoord.xyz /= shadowCoord.w;\n\t\tshadowCoord.z += shadowBias;\n\t\tbvec4 inFrustumVec = bvec4 ( shadowCoord.x >= 0.0, shadowCoord.x <= 1.0, shadowCoord.y >= 0.0, shadowCoord.y <= 1.0 );\n\t\tbool inFrustum = all( inFrustumVec );\n\t\tbvec2 frustumTestVec = bvec2( inFrustum, shadowCoord.z <= 1.0 );\n\t\tbool frustumTest = all( frustumTestVec );\n\t\tif ( frustumTest ) {\n\t\t#if defined( SHADOWMAP_TYPE_PCF )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DCompare( shadowMap, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#elif defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 texelSize = vec2( 1.0 ) / shadowMapSize;\n\t\t\tfloat dx0 = - texelSize.x * shadowRadius;\n\t\t\tfloat dy0 = - texelSize.y * shadowRadius;\n\t\t\tfloat dx1 = + texelSize.x * shadowRadius;\n\t\t\tfloat dy1 = + texelSize.y * shadowRadius;\n\t\t\tshadow = (\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy, shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, 0.0 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( 0.0, dy1 ), shadowCoord.z ) +\n\t\t\t\ttexture2DShadowLerp( shadowMap, shadowMapSize, shadowCoord.xy + vec2( dx1, dy1 ), shadowCoord.z )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\tshadow = texture2DCompare( shadowMap, shadowCoord.xy, shadowCoord.z );\n\t\t#endif\n\t\t}\n\t\treturn shadow;\n\t}\n\tvec2 cubeToUV( vec3 v, float texelSizeY ) {\n\t\tvec3 absV = abs( v );\n\t\tfloat scaleToCube = 1.0 / max( absV.x, max( absV.y, absV.z ) );\n\t\tabsV *= scaleToCube;\n\t\tv *= scaleToCube * ( 1.0 - 2.0 * texelSizeY );\n\t\tvec2 planar = v.xy;\n\t\tfloat almostATexel = 1.5 * texelSizeY;\n\t\tfloat almostOne = 1.0 - almostATexel;\n\t\tif ( absV.z >= almostOne ) {\n\t\t\tif ( v.z > 0.0 )\n\t\t\t\tplanar.x = 4.0 - v.x;\n\t\t} else if ( absV.x >= almostOne ) {\n\t\t\tfloat signX = sign( v.x );\n\t\t\tplanar.x = v.z * signX + 2.0 * signX;\n\t\t} else if ( absV.y >= almostOne ) {\n\t\t\tfloat signY = sign( v.y );\n\t\t\tplanar.x = v.x + 2.0 * signY + 2.0;\n\t\t\tplanar.y = v.z * signY - 2.0;\n\t\t}\n\t\treturn vec2( 0.125, 0.25 ) * planar + vec2( 0.375, 0.75 );\n\t}\n\tfloat getPointShadow( sampler2D shadowMap, vec2 shadowMapSize, float shadowBias, float shadowRadius, vec4 shadowCoord, float shadowCameraNear, float shadowCameraFar ) {\n\t\tvec2 texelSize = vec2( 1.0 ) / ( shadowMapSize * vec2( 4.0, 2.0 ) );\n\t\tvec3 lightToPosition = shadowCoord.xyz;\n\t\tfloat dp = ( length( lightToPosition ) - shadowCameraNear ) / ( shadowCameraFar - shadowCameraNear );\t\tdp += shadowBias;\n\t\tvec3 bd3D = normalize( lightToPosition );\n\t\t#if defined( SHADOWMAP_TYPE_PCF ) || defined( SHADOWMAP_TYPE_PCF_SOFT )\n\t\t\tvec2 offset = vec2( - 1, 1 ) * shadowRadius * texelSize.y;\n\t\t\treturn (\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yyx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxy, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.xxx, texelSize.y ), dp ) +\n\t\t\t\ttexture2DCompare( shadowMap, cubeToUV( bd3D + offset.yxx, texelSize.y ), dp )\n\t\t\t) * ( 1.0 / 9.0 );\n\t\t#else\n\t\t\treturn texture2DCompare( shadowMap, cubeToUV( bd3D, texelSize.y ), dp );\n\t\t#endif\n\t}\n#endif\n",shadowmap_pars_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t\tuniform mat4 directionalShadowMatrix[ NUM_DIR_LIGHTS ];\n\t\tvarying vec4 vDirectionalShadowCoord[ NUM_DIR_LIGHTS ];\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t\tuniform mat4 spotShadowMatrix[ NUM_SPOT_LIGHTS ];\n\t\tvarying vec4 vSpotShadowCoord[ NUM_SPOT_LIGHTS ];\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t\tuniform mat4 pointShadowMatrix[ NUM_POINT_LIGHTS ];\n\t\tvarying vec4 vPointShadowCoord[ NUM_POINT_LIGHTS ];\n\t#endif\n#endif\n",shadowmap_vertex:"#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tvDirectionalShadowCoord[ i ] = directionalShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tvSpotShadowCoord[ i ] = spotShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tvPointShadowCoord[ i ] = pointShadowMatrix[ i ] * worldPosition;\n\t}\n\t#endif\n#endif\n",shadowmask_pars_fragment:"float getShadowMask() {\n\tfloat shadow = 1.0;\n\t#ifdef USE_SHADOWMAP\n\t#if NUM_DIR_LIGHTS > 0\n\tDirectionalLight directionalLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_DIR_LIGHTS; i ++ ) {\n\t\tdirectionalLight = directionalLights[ i ];\n\t\tshadow *= bool( directionalLight.shadow ) ? getShadow( directionalShadowMap[ i ], directionalLight.shadowMapSize, directionalLight.shadowBias, directionalLight.shadowRadius, vDirectionalShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_SPOT_LIGHTS > 0\n\tSpotLight spotLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_SPOT_LIGHTS; i ++ ) {\n\t\tspotLight = spotLights[ i ];\n\t\tshadow *= bool( spotLight.shadow ) ? getShadow( spotShadowMap[ i ], spotLight.shadowMapSize, spotLight.shadowBias, spotLight.shadowRadius, vSpotShadowCoord[ i ] ) : 1.0;\n\t}\n\t#endif\n\t#if NUM_POINT_LIGHTS > 0\n\tPointLight pointLight;\n\t#pragma unroll_loop\n\tfor ( int i = 0; i < NUM_POINT_LIGHTS; i ++ ) {\n\t\tpointLight = pointLights[ i ];\n\t\tshadow *= bool( pointLight.shadow ) ? getPointShadow( pointShadowMap[ i ], pointLight.shadowMapSize, pointLight.shadowBias, pointLight.shadowRadius, vPointShadowCoord[ i ], pointLight.shadowCameraNear, pointLight.shadowCameraFar ) : 1.0;\n\t}\n\t#endif\n\t#endif\n\treturn shadow;\n}\n",skinbase_vertex:"#ifdef USE_SKINNING\n\tmat4 boneMatX = getBoneMatrix( skinIndex.x );\n\tmat4 boneMatY = getBoneMatrix( skinIndex.y );\n\tmat4 boneMatZ = getBoneMatrix( skinIndex.z );\n\tmat4 boneMatW = getBoneMatrix( skinIndex.w );\n#endif",skinning_pars_vertex:"#ifdef USE_SKINNING\n\tuniform mat4 bindMatrix;\n\tuniform mat4 bindMatrixInverse;\n\t#ifdef BONE_TEXTURE\n\t\tuniform sampler2D boneTexture;\n\t\tuniform int boneTextureSize;\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tfloat j = i * 4.0;\n\t\t\tfloat x = mod( j, float( boneTextureSize ) );\n\t\t\tfloat y = floor( j / float( boneTextureSize ) );\n\t\t\tfloat dx = 1.0 / float( boneTextureSize );\n\t\t\tfloat dy = 1.0 / float( boneTextureSize );\n\t\t\ty = dy * ( y + 0.5 );\n\t\t\tvec4 v1 = texture2D( boneTexture, vec2( dx * ( x + 0.5 ), y ) );\n\t\t\tvec4 v2 = texture2D( boneTexture, vec2( dx * ( x + 1.5 ), y ) );\n\t\t\tvec4 v3 = texture2D( boneTexture, vec2( dx * ( x + 2.5 ), y ) );\n\t\t\tvec4 v4 = texture2D( boneTexture, vec2( dx * ( x + 3.5 ), y ) );\n\t\t\tmat4 bone = mat4( v1, v2, v3, v4 );\n\t\t\treturn bone;\n\t\t}\n\t#else\n\t\tuniform mat4 boneMatrices[ MAX_BONES ];\n\t\tmat4 getBoneMatrix( const in float i ) {\n\t\t\tmat4 bone = boneMatrices[ int(i) ];\n\t\t\treturn bone;\n\t\t}\n\t#endif\n#endif\n",skinning_vertex:"#ifdef USE_SKINNING\n\tvec4 skinVertex = bindMatrix * vec4( transformed, 1.0 );\n\tvec4 skinned = vec4( 0.0 );\n\tskinned += boneMatX * skinVertex * skinWeight.x;\n\tskinned += boneMatY * skinVertex * skinWeight.y;\n\tskinned += boneMatZ * skinVertex * skinWeight.z;\n\tskinned += boneMatW * skinVertex * skinWeight.w;\n\ttransformed = ( bindMatrixInverse * skinned ).xyz;\n#endif\n",skinnormal_vertex:"#ifdef USE_SKINNING\n\tmat4 skinMatrix = mat4( 0.0 );\n\tskinMatrix += skinWeight.x * boneMatX;\n\tskinMatrix += skinWeight.y * boneMatY;\n\tskinMatrix += skinWeight.z * boneMatZ;\n\tskinMatrix += skinWeight.w * boneMatW;\n\tskinMatrix  = bindMatrixInverse * skinMatrix * bindMatrix;\n\tobjectNormal = vec4( skinMatrix * vec4( objectNormal, 0.0 ) ).xyz;\n#endif\n",specularmap_fragment:"float specularStrength;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\tspecularStrength = texelSpecular.r;\n#else\n\tspecularStrength = 1.0;\n#endif",specularmap_pars_fragment:"#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif",tonemapping_fragment:"#if defined( TONE_MAPPING )\n  gl_FragColor.rgb = toneMapping( gl_FragColor.rgb );\n#endif\n",tonemapping_pars_fragment:"#ifndef saturate\n\t#define saturate(a) clamp( a, 0.0, 1.0 )\n#endif\nuniform float toneMappingExposure;\nuniform float toneMappingWhitePoint;\nvec3 LinearToneMapping( vec3 color ) {\n\treturn toneMappingExposure * color;\n}\nvec3 ReinhardToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( color / ( vec3( 1.0 ) + color ) );\n}\n#define Uncharted2Helper( x ) max( ( ( x * ( 0.15 * x + 0.10 * 0.50 ) + 0.20 * 0.02 ) / ( x * ( 0.15 * x + 0.50 ) + 0.20 * 0.30 ) ) - 0.02 / 0.30, vec3( 0.0 ) )\nvec3 Uncharted2ToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\treturn saturate( Uncharted2Helper( color ) / Uncharted2Helper( vec3( toneMappingWhitePoint ) ) );\n}\nvec3 OptimizedCineonToneMapping( vec3 color ) {\n\tcolor *= toneMappingExposure;\n\tcolor = max( vec3( 0.0 ), color - 0.004 );\n\treturn pow( ( color * ( 6.2 * color + 0.5 ) ) / ( color * ( 6.2 * color + 1.7 ) + 0.06 ), vec3( 2.2 ) );\n}\n",uv_pars_fragment:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n#endif",uv_pars_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvarying vec2 vUv;\n\tuniform mat3 uvTransform;\n#endif\n",uv_vertex:"#if defined( USE_MAP ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP ) || defined( USE_SPECULARMAP ) || defined( USE_ALPHAMAP ) || defined( USE_EMISSIVEMAP ) || defined( USE_ROUGHNESSMAP ) || defined( USE_METALNESSMAP )\n\tvUv = ( uvTransform * vec3( uv, 1 ) ).xy;\n#endif",uv2_pars_fragment:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvarying vec2 vUv2;\n#endif",uv2_pars_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tattribute vec2 uv2;\n\tvarying vec2 vUv2;\n#endif",uv2_vertex:"#if defined( USE_LIGHTMAP ) || defined( USE_AOMAP )\n\tvUv2 = uv2;\n#endif",worldpos_vertex:"#if defined( USE_ENVMAP ) || defined( DISTANCE ) || defined ( USE_SHADOWMAP )\n\tvec4 worldPosition = modelMatrix * vec4( transformed, 1.0 );\n#endif\n",cube_frag:"uniform samplerCube tCube;\nuniform float tFlip;\nuniform float opacity;\nvarying vec3 vWorldPosition;\nvoid main() {\n\tgl_FragColor = textureCube( tCube, vec3( tFlip * vWorldPosition.x, vWorldPosition.yz ) );\n\tgl_FragColor.a *= opacity;\n}\n",cube_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\tgl_Position.z = gl_Position.w;\n}\n",depth_frag:"#if DEPTH_PACKING == 3200\n\tuniform float opacity;\n#endif\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#if DEPTH_PACKING == 3200\n\t\tdiffuseColor.a = opacity;\n\t#endif\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <logdepthbuf_fragment>\n\t#if DEPTH_PACKING == 3200\n\t\tgl_FragColor = vec4( vec3( 1.0 - gl_FragCoord.z ), opacity );\n\t#elif DEPTH_PACKING == 3201\n\t\tgl_FragColor = packDepthToRGBA( gl_FragCoord.z );\n\t#endif\n}\n",depth_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n}\n",distanceRGBA_frag:"#define DISTANCE\nuniform vec3 referencePosition;\nuniform float nearDistance;\nuniform float farDistance;\nvarying vec3 vWorldPosition;\n#include <common>\n#include <packing>\n#include <uv_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main () {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( 1.0 );\n\t#include <map_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\tfloat dist = length( vWorldPosition - referencePosition );\n\tdist = ( dist - nearDistance ) / ( farDistance - nearDistance );\n\tdist = saturate( dist );\n\tgl_FragColor = packDepthToRGBA( dist );\n}\n",distanceRGBA_vert:"#define DISTANCE\nvarying vec3 vWorldPosition;\n#include <common>\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_DISPLACEMENTMAP\n\t\t#include <beginnormal_vertex>\n\t\t#include <morphnormal_vertex>\n\t\t#include <skinnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\tvWorldPosition = worldPosition.xyz;\n}\n",equirect_frag:"uniform sampler2D tEquirect;\nvarying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvec3 direction = normalize( vWorldPosition );\n\tvec2 sampleUV;\n\tsampleUV.y = asin( clamp( direction.y, - 1.0, 1.0 ) ) * RECIPROCAL_PI + 0.5;\n\tsampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 + 0.5;\n\tgl_FragColor = texture2D( tEquirect, sampleUV );\n}\n",equirect_vert:"varying vec3 vWorldPosition;\n#include <common>\nvoid main() {\n\tvWorldPosition = transformDirection( position, modelMatrix );\n\t#include <begin_vertex>\n\t#include <project_vertex>\n}\n",linedashed_frag:"uniform vec3 diffuse;\nuniform float opacity;\nuniform float dashSize;\nuniform float totalSize;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_fragment>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tif ( mod( vLineDistance, totalSize ) > dashSize ) {\n\t\tdiscard;\n\t}\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <color_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",linedashed_vert:"uniform float scale;\nattribute float lineDistance;\nvarying float vLineDistance;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\tvLineDistance = scale * lineDistance;\n\tvec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\tgl_Position = projectionMatrix * mvPosition;\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <fog_vertex>\n}\n",meshbasic_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\t#ifdef USE_LIGHTMAP\n\t\treflectedLight.indirectDiffuse += texture2D( lightMap, vUv2 ).xyz * lightMapIntensity;\n\t#else\n\t\treflectedLight.indirectDiffuse += vec3( 1.0 );\n\t#endif\n\t#include <aomap_fragment>\n\treflectedLight.indirectDiffuse *= diffuseColor.rgb;\n\tvec3 outgoingLight = reflectedLight.indirectDiffuse;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",meshbasic_vert:"#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <skinbase_vertex>\n\t#ifdef USE_ENVMAP\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <worldpos_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <envmap_vertex>\n\t#include <fog_vertex>\n}\n",meshlambert_frag:"uniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float opacity;\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <emissivemap_fragment>\n\treflectedLight.indirectDiffuse = getAmbientLightIrradiance( ambientLightColor );\n\t#include <lightmap_fragment>\n\treflectedLight.indirectDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb );\n\t#ifdef DOUBLE_SIDED\n\t\treflectedLight.directDiffuse = ( gl_FrontFacing ) ? vLightFront : vLightBack;\n\t#else\n\t\treflectedLight.directDiffuse = vLightFront;\n\t#endif\n\treflectedLight.directDiffuse *= BRDF_Diffuse_Lambert( diffuseColor.rgb ) * getShadowMask();\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshlambert_vert:"#define LAMBERT\nvarying vec3 vLightFront;\n#ifdef DOUBLE_SIDED\n\tvarying vec3 vLightBack;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <envmap_pars_vertex>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <lights_lambert_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphong_frag:"#define PHONG\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform vec3 specular;\nuniform float shininess;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <gradientmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_phong_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <specularmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <specularmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_phong_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t#include <envmap_fragment>\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphong_vert:"#define PHONG\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <envmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <envmap_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",meshphysical_frag:"#define PHYSICAL\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifndef STANDARD\n\tuniform float clearCoat;\n\tuniform float clearCoatRoughness;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <envmap_pars_fragment>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <lights_pars_begin>\n#include <lights_pars_maps>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}\n",meshphysical_vert:"#define PHYSICAL\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",normal_frag:"#define NORMAL\nuniform float opacity;\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <packing>\n#include <uv_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\nvoid main() {\n\t#include <logdepthbuf_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\tgl_FragColor = vec4( packNormalToRGB( normal ), opacity );\n}\n",normal_vert:"#define NORMAL\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvarying vec3 vViewPosition;\n#endif\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n#endif\n#include <uv_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <logdepthbuf_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n#endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n#if defined( FLAT_SHADED ) || defined( USE_BUMPMAP ) || defined( USE_NORMALMAP )\n\tvViewPosition = - mvPosition.xyz;\n#endif\n}\n",points_frag:"uniform vec3 diffuse;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <color_pars_fragment>\n#include <map_particle_pars_fragment>\n#include <fog_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec3 outgoingLight = vec3( 0.0 );\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\t#include <logdepthbuf_fragment>\n\t#include <map_particle_fragment>\n\t#include <color_fragment>\n\t#include <alphatest_fragment>\n\toutgoingLight = diffuseColor.rgb;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}\n",points_vert:"uniform float size;\nuniform float scale;\n#include <common>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <color_vertex>\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#ifdef USE_SIZEATTENUATION\n\t\tgl_PointSize = size * ( scale / - mvPosition.z );\n\t#else\n\t\tgl_PointSize = size;\n\t#endif\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n",shadow_frag:"uniform vec3 color;\nuniform float opacity;\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\nvoid main() {\n\tgl_FragColor = vec4( color, opacity * ( 1.0 - getShadowMask() ) );\n\t#include <fog_fragment>\n}\n",shadow_vert:"#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\nvoid main() {\n\t#include <begin_vertex>\n\t#include <project_vertex>\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}\n"},Pu={merge:function(t){for(var e={},n=0;n<t.length;n++){var r=this.clone(t[n]);for(var i in r)e[i]=r[i]}return e},clone:function(t){var e={};for(var n in t){e[n]={};for(var r in t[n]){var i=t[n][r];i&&(i.isColor||i.isMatrix3||i.isMatrix4||i.isVector2||i.isVector3||i.isVector4||i.isTexture)?e[n][r]=i.clone():Array.isArray(i)?e[n][r]=i.slice():e[n][r]=i}}return e}},Nu={aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,rebeccapurple:6697881,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074};Object.assign(y.prototype,{isColor:!0,r:1,g:1,b:1,set:function(t){return t&&t.isColor?this.copy(t):"number"===typeof t?this.setHex(t):"string"===typeof t&&this.setStyle(t),this},setScalar:function(t){return this.r=t,this.g=t,this.b=t,this},setHex:function(t){return t=Math.floor(t),this.r=(t>>16&255)/255,this.g=(t>>8&255)/255,this.b=(255&t)/255,this},setRGB:function(t,e,n){return this.r=t,this.g=e,this.b=n,this},setHSL:function(){function t(t,e,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?t+6*(e-t)*n:n<.5?e:n<2/3?t+6*(e-t)*(2/3-n):t}return function(e,n,r){if(e=Au.euclideanModulo(e,1),n=Au.clamp(n,0,1),r=Au.clamp(r,0,1),0===n)this.r=this.g=this.b=r;else{var i=r<=.5?r*(1+n):r+n-r*n,o=2*r-i;this.r=t(o,i,e+1/3),this.g=t(o,i,e),this.b=t(o,i,e-1/3)}return this}}(),setStyle:function(t){function e(e){void 0!==e&&parseFloat(e)<1&&console.warn("THREE.Color: Alpha component of "+t+" will be ignored.")}var n;if(n=/^((?:rgb|hsl)a?)\(\s*([^\)]*)\)/.exec(t)){var r,i=n[1],o=n[2];switch(i){case"rgb":case"rgba":if(r=/^(\d+)\s*,\s*(\d+)\s*,\s*(\d+)\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(255,parseInt(r[1],10))/255,this.g=Math.min(255,parseInt(r[2],10))/255,this.b=Math.min(255,parseInt(r[3],10))/255,e(r[5]),this;if(r=/^(\d+)\%\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o))return this.r=Math.min(100,parseInt(r[1],10))/100,this.g=Math.min(100,parseInt(r[2],10))/100,this.b=Math.min(100,parseInt(r[3],10))/100,e(r[5]),this;break;case"hsl":case"hsla":if(r=/^([0-9]*\.?[0-9]+)\s*,\s*(\d+)\%\s*,\s*(\d+)\%\s*(,\s*([0-9]*\.?[0-9]+)\s*)?$/.exec(o)){var a=parseFloat(r[1])/360,s=parseInt(r[2],10)/100,u=parseInt(r[3],10)/100;return e(r[5]),this.setHSL(a,s,u)}}}else if(n=/^\#([A-Fa-f0-9]+)$/.exec(t)){var c=n[1],l=c.length;if(3===l)return this.r=parseInt(c.charAt(0)+c.charAt(0),16)/255,this.g=parseInt(c.charAt(1)+c.charAt(1),16)/255,this.b=parseInt(c.charAt(2)+c.charAt(2),16)/255,this;if(6===l)return this.r=parseInt(c.charAt(0)+c.charAt(1),16)/255,this.g=parseInt(c.charAt(2)+c.charAt(3),16)/255,this.b=parseInt(c.charAt(4)+c.charAt(5),16)/255,this}if(t&&t.length>0){var c=Nu[t];void 0!==c?this.setHex(c):console.warn("THREE.Color: Unknown color "+t)}return this},clone:function(){return new this.constructor(this.r,this.g,this.b)},copy:function(t){return this.r=t.r,this.g=t.g,this.b=t.b,this},copyGammaToLinear:function(t,e){return void 0===e&&(e=2),this.r=Math.pow(t.r,e),this.g=Math.pow(t.g,e),this.b=Math.pow(t.b,e),this},copyLinearToGamma:function(t,e){void 0===e&&(e=2);var n=e>0?1/e:1;return this.r=Math.pow(t.r,n),this.g=Math.pow(t.g,n),this.b=Math.pow(t.b,n),this},convertGammaToLinear:function(){var t=this.r,e=this.g,n=this.b;return this.r=t*t,this.g=e*e,this.b=n*n,this},convertLinearToGamma:function(){return this.r=Math.sqrt(this.r),this.g=Math.sqrt(this.g),this.b=Math.sqrt(this.b),this},getHex:function(){return 255*this.r<<16^255*this.g<<8^255*this.b<<0},getHexString:function(){return("000000"+this.getHex().toString(16)).slice(-6)},getHSL:function(t){void 0===t&&(console.warn("THREE.Color: .getHSL() target is now required"),t={h:0,s:0,l:0});var e,n,r=this.r,i=this.g,o=this.b,a=Math.max(r,i,o),s=Math.min(r,i,o),u=(s+a)/2;if(s===a)e=0,n=0;else{var c=a-s;switch(n=u<=.5?c/(a+s):c/(2-a-s),a){case r:e=(i-o)/c+(i<o?6:0);break;case i:e=(o-r)/c+2;break;case o:e=(r-i)/c+4}e/=6}return t.h=e,t.s=n,t.l=u,t},getStyle:function(){return"rgb("+(255*this.r|0)+","+(255*this.g|0)+","+(255*this.b|0)+")"},offsetHSL:function(){var t={};return function(e,n,r){return this.getHSL(t),t.h+=e,t.s+=n,t.l+=r,this.setHSL(t.h,t.s,t.l),this}}(),add:function(t){return this.r+=t.r,this.g+=t.g,this.b+=t.b,this},addColors:function(t,e){return this.r=t.r+e.r,this.g=t.g+e.g,this.b=t.b+e.b,this},addScalar:function(t){return this.r+=t,this.g+=t,this.b+=t,this},sub:function(t){return this.r=Math.max(0,this.r-t.r),this.g=Math.max(0,this.g-t.g),this.b=Math.max(0,this.b-t.b),this},multiply:function(t){return this.r*=t.r,this.g*=t.g,this.b*=t.b,this},multiplyScalar:function(t){return this.r*=t,this.g*=t,this.b*=t,this},lerp:function(t,e){return this.r+=(t.r-this.r)*e,this.g+=(t.g-this.g)*e,this.b+=(t.b-this.b)*e,this},equals:function(t){return t.r===this.r&&t.g===this.g&&t.b===this.b},fromArray:function(t,e){return void 0===e&&(e=0),this.r=t[e],this.g=t[e+1],this.b=t[e+2],this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this.r,t[e+1]=this.g,t[e+2]=this.b,t},toJSON:function(){return this.getHex()}});var Du={common:{diffuse:{value:new y(15658734)},opacity:{value:1},map:{value:null},uvTransform:{value:new u},alphaMap:{value:null}},specularmap:{specularMap:{value:null}},envmap:{envMap:{value:null},flipEnvMap:{value:-1},reflectivity:{value:1},refractionRatio:{value:.98},maxMipLevel:{value:0}},aomap:{aoMap:{value:null},aoMapIntensity:{value:1}},lightmap:{lightMap:{value:null},lightMapIntensity:{value:1}},emissivemap:{emissiveMap:{value:null}},bumpmap:{bumpMap:{value:null},bumpScale:{value:1}},normalmap:{normalMap:{value:null},normalScale:{value:new i(1,1)}},displacementmap:{displacementMap:{value:null},displacementScale:{value:1},displacementBias:{value:0}},roughnessmap:{roughnessMap:{value:null}},metalnessmap:{metalnessMap:{value:null}},gradientmap:{gradientMap:{value:null}},fog:{fogDensity:{value:25e-5},fogNear:{value:1},fogFar:{value:2e3},fogColor:{value:new y(16777215)}},lights:{ambientLightColor:{value:[]},directionalLights:{value:[],properties:{direction:{},color:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},directionalShadowMap:{value:[]},directionalShadowMatrix:{value:[]},spotLights:{value:[],properties:{color:{},position:{},direction:{},distance:{},coneCos:{},penumbraCos:{},decay:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{}}},spotShadowMap:{value:[]},spotShadowMatrix:{value:[]},pointLights:{value:[],properties:{color:{},position:{},decay:{},distance:{},shadow:{},shadowBias:{},shadowRadius:{},shadowMapSize:{},shadowCameraNear:{},shadowCameraFar:{}}},pointShadowMap:{value:[]},pointShadowMatrix:{value:[]},hemisphereLights:{value:[],properties:{direction:{},skyColor:{},groundColor:{}}},rectAreaLights:{value:[],properties:{color:{},position:{},width:{},height:{}}}},points:{diffuse:{value:new y(15658734)},opacity:{value:1},size:{value:1},scale:{value:1},map:{value:null},uvTransform:{value:new u}}},Ou={basic:{uniforms:Pu.merge([Du.common,Du.specularmap,Du.envmap,Du.aomap,Du.lightmap,Du.fog]),vertexShader:Ru.meshbasic_vert,fragmentShader:Ru.meshbasic_frag},lambert:{uniforms:Pu.merge([Du.common,Du.specularmap,Du.envmap,Du.aomap,Du.lightmap,Du.emissivemap,Du.fog,Du.lights,{emissive:{value:new y(0)}}]),vertexShader:Ru.meshlambert_vert,fragmentShader:Ru.meshlambert_frag},phong:{uniforms:Pu.merge([Du.common,Du.specularmap,Du.envmap,Du.aomap,Du.lightmap,Du.emissivemap,Du.bumpmap,Du.normalmap,Du.displacementmap,Du.gradientmap,Du.fog,Du.lights,{emissive:{value:new y(0)},specular:{value:new y(1118481)},shininess:{value:30}}]),vertexShader:Ru.meshphong_vert,fragmentShader:Ru.meshphong_frag},standard:{uniforms:Pu.merge([Du.common,Du.envmap,Du.aomap,Du.lightmap,Du.emissivemap,Du.bumpmap,Du.normalmap,Du.displacementmap,Du.roughnessmap,Du.metalnessmap,Du.fog,Du.lights,{emissive:{value:new y(0)},roughness:{value:.5},metalness:{value:.5},envMapIntensity:{value:1}}]),vertexShader:Ru.meshphysical_vert,fragmentShader:Ru.meshphysical_frag},points:{uniforms:Pu.merge([Du.points,Du.fog]),vertexShader:Ru.points_vert,fragmentShader:Ru.points_frag},dashed:{uniforms:Pu.merge([Du.common,Du.fog,{scale:{value:1},dashSize:{value:1},totalSize:{value:2}}]),vertexShader:Ru.linedashed_vert,fragmentShader:Ru.linedashed_frag},depth:{uniforms:Pu.merge([Du.common,Du.displacementmap]),vertexShader:Ru.depth_vert,fragmentShader:Ru.depth_frag},normal:{uniforms:Pu.merge([Du.common,Du.bumpmap,Du.normalmap,Du.displacementmap,{opacity:{value:1}}]),vertexShader:Ru.normal_vert,fragmentShader:Ru.normal_frag},cube:{uniforms:{tCube:{value:null},tFlip:{value:-1},opacity:{value:1}},vertexShader:Ru.cube_vert,fragmentShader:Ru.cube_frag},equirect:{uniforms:{tEquirect:{value:null}},vertexShader:Ru.equirect_vert,fragmentShader:Ru.equirect_frag},distanceRGBA:{uniforms:Pu.merge([Du.common,Du.displacementmap,{referencePosition:{value:new s},nearDistance:{value:1},farDistance:{value:1e3}}]),vertexShader:Ru.distanceRGBA_vert,fragmentShader:Ru.distanceRGBA_frag},shadow:{uniforms:Pu.merge([Du.lights,Du.fog,{color:{value:new y(0)},opacity:{value:1}}]),vertexShader:Ru.shadow_vert,fragmentShader:Ru.shadow_frag}};Ou.physical={uniforms:Pu.merge([Ou.standard.uniforms,{clearCoat:{value:0},clearCoatRoughness:{value:0}}]),vertexShader:Ru.meshphysical_vert,fragmentShader:Ru.meshphysical_frag},b.RotationOrders=["XYZ","YZX","ZXY","XZY","YXZ","ZYX"],b.DefaultOrder="XYZ",Object.defineProperties(b.prototype,{x:{get:function(){return this._x},set:function(t){this._x=t,this.onChangeCallback()}},y:{get:function(){return this._y},set:function(t){this._y=t,this.onChangeCallback()}},z:{get:function(){return this._z},set:function(t){this._z=t,this.onChangeCallback()}},order:{get:function(){return this._order},set:function(t){this._order=t,this.onChangeCallback()}}}),Object.assign(b.prototype,{isEuler:!0,set:function(t,e,n,r){return this._x=t,this._y=e,this._z=n,this._order=r||this._order,this.onChangeCallback(),this},clone:function(){return new this.constructor(this._x,this._y,this._z,this._order)},copy:function(t){return this._x=t._x,this._y=t._y,this._z=t._z,this._order=t._order,this.onChangeCallback(),this},setFromRotationMatrix:function(t,e,n){var r=Au.clamp,i=t.elements,o=i[0],a=i[4],s=i[8],u=i[1],c=i[5],l=i[9],h=i[2],f=i[6],d=i[10];return e=e||this._order,"XYZ"===e?(this._y=Math.asin(r(s,-1,1)),Math.abs(s)<.99999?(this._x=Math.atan2(-l,d),this._z=Math.atan2(-a,o)):(this._x=Math.atan2(f,c),this._z=0)):"YXZ"===e?(this._x=Math.asin(-r(l,-1,1)),Math.abs(l)<.99999?(this._y=Math.atan2(s,d),this._z=Math.atan2(u,c)):(this._y=Math.atan2(-h,o),this._z=0)):"ZXY"===e?(this._x=Math.asin(r(f,-1,1)),Math.abs(f)<.99999?(this._y=Math.atan2(-h,d),this._z=Math.atan2(-a,c)):(this._y=0,this._z=Math.atan2(u,o))):"ZYX"===e?(this._y=Math.asin(-r(h,-1,1)),Math.abs(h)<.99999?(this._x=Math.atan2(f,d),this._z=Math.atan2(u,o)):(this._x=0,this._z=Math.atan2(-a,c))):"YZX"===e?(this._z=Math.asin(r(u,-1,1)),Math.abs(u)<.99999?(this._x=Math.atan2(-l,c),this._y=Math.atan2(-h,o)):(this._x=0,this._y=Math.atan2(s,d))):"XZY"===e?(this._z=Math.asin(-r(a,-1,1)),Math.abs(a)<.99999?(this._x=Math.atan2(f,c),this._y=Math.atan2(s,o)):(this._x=Math.atan2(-l,d),this._y=0)):console.warn("THREE.Euler: .setFromRotationMatrix() given unsupported order: "+e),this._order=e,!1!==n&&this.onChangeCallback(),this},setFromQuaternion:function(){var t=new o;return function(e,n,r){return t.makeRotationFromQuaternion(e),this.setFromRotationMatrix(t,n,r)}}(),setFromVector3:function(t,e){return this.set(t.x,t.y,t.z,e||this._order)},reorder:function(){var t=new a;return function(e){return t.setFromEuler(this),this.setFromQuaternion(t,e)}}(),equals:function(t){return t._x===this._x&&t._y===this._y&&t._z===this._z&&t._order===this._order},fromArray:function(t){return this._x=t[0],this._y=t[1],this._z=t[2],void 0!==t[3]&&(this._order=t[3]),this.onChangeCallback(),this},toArray:function(t,e){return void 0===t&&(t=[]),void 0===e&&(e=0),t[e]=this._x,t[e+1]=this._y,t[e+2]=this._z,t[e+3]=this._order,t},toVector3:function(t){return t?t.set(this._x,this._y,this._z):new s(this._x,this._y,this._z)},onChange:function(t){return this.onChangeCallback=t,this},onChangeCallback:function(){}}),Object.assign(w.prototype,{set:function(t){this.mask=1<<t|0},enable:function(t){this.mask|=1<<t|0},toggle:function(t){this.mask^=1<<t|0},disable:function(t){this.mask&=~(1<<t|0)},test:function(t){return 0!==(this.mask&t.mask)}});var ku=0;E.DefaultUp=new s(0,1,0),E.DefaultMatrixAutoUpdate=!0,E.prototype=Object.assign(Object.create(r.prototype),{constructor:E,isObject3D:!0,onBeforeRender:function(){},onAfterRender:function(){},applyMatrix:function(t){this.matrix.multiplyMatrices(t,this.matrix),this.matrix.decompose(this.position,this.quaternion,this.scale)},applyQuaternion:function(t){return this.quaternion.premultiply(t),this},setRotationFromAxisAngle:function(t,e){this.quaternion.setFromAxisAngle(t,e)},setRotationFromEuler:function(t){this.quaternion.setFromEuler(t,!0)},setRotationFromMatrix:function(t){this.quaternion.setFromRotationMatrix(t)},setRotationFromQuaternion:function(t){this.quaternion.copy(t)},rotateOnAxis:function(){var t=new a;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.multiply(t),this}}(),rotateOnWorldAxis:function(){var t=new a;return function(e,n){return t.setFromAxisAngle(e,n),this.quaternion.premultiply(t),this}}(),rotateX:function(){var t=new s(1,0,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateY:function(){var t=new s(0,1,0);return function(e){return this.rotateOnAxis(t,e)}}(),rotateZ:function(){var t=new s(0,0,1);return function(e){return this.rotateOnAxis(t,e)}}(),translateOnAxis:function(){var t=new s;return function(e,n){return t.copy(e).applyQuaternion(this.quaternion),this.position.add(t.multiplyScalar(n)),this}}(),translateX:function(){var t=new s(1,0,0);return function(e){return this.translateOnAxis(t,e)}}(),translateY:function(){var t=new s(0,1,0);return function(e){return this.translateOnAxis(t,e)}}(),translateZ:function(){var t=new s(0,0,1);return function(e){return this.translateOnAxis(t,e)}}(),localToWorld:function(t){return t.applyMatrix4(this.matrixWorld)},worldToLocal:function(){var t=new o;return function(e){return e.applyMatrix4(t.getInverse(this.matrixWorld))}}(),lookAt:function(){var t=new o,e=new s;return function(n,r,i){n.isVector3?e.copy(n):e.set(n,r,i),this.isCamera?t.lookAt(this.position,e,this.up):t.lookAt(e,this.position,this.up),this.quaternion.setFromRotationMatrix(t)}}(),add:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.add(arguments[e]);return this}return t===this?(console.error("THREE.Object3D.add: object can't be added as a child of itself.",t),this):(t&&t.isObject3D?(null!==t.parent&&t.parent.remove(t),t.parent=this,t.dispatchEvent({type:"added"}),this.children.push(t)):console.error("THREE.Object3D.add: object not an instance of THREE.Object3D.",t),this)},remove:function(t){if(arguments.length>1){for(var e=0;e<arguments.length;e++)this.remove(arguments[e]);return this}var n=this.children.indexOf(t);return-1!==n&&(t.parent=null,t.dispatchEvent({type:"removed"}),this.children.splice(n,1)),this},getObjectById:function(t){return this.getObjectByProperty("id",t)},getObjectByName:function(t){return this.getObjectByProperty("name",t)},getObjectByProperty:function(t,e){if(this[t]===e)return this;for(var n=0,r=this.children.length;n<r;n++){var i=this.children[n],o=i.getObjectByProperty(t,e);if(void 0!==o)return o}},getWorldPosition:function(t){return void 0===t&&(console.warn("THREE.Object3D: .getWorldPosition() target is now required"),t=new s),this.updateMatrixWorld(!0),t.setFromMatrixPosition(this.matrixWorld)},getWorldQuaternion:function(){var t=new s,e=new s;return function(n){return void 0===n&&(console.warn("THREE.Object3D: .getWorldQuaternion() target is now required"),n=new a),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,n,e),n}}(),getWorldScale:function(){var t=new s,e=new a;return function(n){return void 0===n&&(console.warn("THREE.Object3D: .getWorldScale() target is now required"),n=new s),this.updateMatrixWorld(!0),this.matrixWorld.decompose(t,e,n),n}}(),getWorldDirection:function(){var t=new a;return function(e){return void 0===e&&(console.warn("THREE.Object3D: .getWorldDirection() target is now required"),e=new s),this.getWorldQuaternion(t),e.set(0,0,1).applyQuaternion(t)}}(),raycast:function(){},traverse:function(t){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverse(t)},traverseVisible:function(t){if(!1!==this.visible){t(this);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].traverseVisible(t)}},traverseAncestors:function(t){var e=this.parent;null!==e&&(t(e),e.traverseAncestors(t))},updateMatrix:function(){this.matrix.compose(this.position,this.quaternion,this.scale),this.matrixWorldNeedsUpdate=!0},updateMatrixWorld:function(t){this.matrixAutoUpdate&&this.updateMatrix(),(this.matrixWorldNeedsUpdate||t)&&(null===this.parent?this.matrixWorld.copy(this.matrix):this.matrixWorld.multiplyMatrices(this.parent.matrixWorld,this.matrix),this.matrixWorldNeedsUpdate=!1,t=!0);for(var e=this.children,n=0,r=e.length;n<r;n++)e[n].updateMatrixWorld(t)},toJSON:function(t){function e(e,n){return void 0===e[n.uuid]&&(e[n.uuid]=n.toJSON(t)),n.uuid}function n(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}var r=void 0===t||"string"===typeof t,i={};r&&(t={geometries:{},materials:{},textures:{},images:{},shapes:{}},i.metadata={version:4.5,type:"Object",generator:"Object3D.toJSON"});var o={};if(o.uuid=this.uuid,o.type=this.type,""!==this.name&&(o.name=this.name),!0===this.castShadow&&(o.castShadow=!0),!0===this.receiveShadow&&(o.receiveShadow=!0),!1===this.visible&&(o.visible=!1),!1===this.frustumCulled&&(o.frustumCulled=!1),0!==this.renderOrder&&(o.renderOrder=this.renderOrder),"{}"!==JSON.stringify(this.userData)&&(o.userData=this.userData),o.matrix=this.matrix.toArray(),!1===this.matrixAutoUpdate&&(o.matrixAutoUpdate=!1),void 0!==this.geometry){o.geometry=e(t.geometries,this.geometry);var a=this.geometry.parameters;if(void 0!==a&&void 0!==a.shapes){var s=a.shapes;if(Array.isArray(s))for(var u=0,c=s.length;u<c;u++){var l=s[u];e(t.shapes,l)}else e(t.shapes,s)}}if(void 0!==this.material)if(Array.isArray(this.material)){for(var h=[],u=0,c=this.material.length;u<c;u++)h.push(e(t.materials,this.material[u]));o.material=h}else o.material=e(t.materials,this.material);if(this.children.length>0){o.children=[];for(var u=0;u<this.children.length;u++)o.children.push(this.children[u].toJSON(t).object)}if(r){var f=n(t.geometries),d=n(t.materials),p=n(t.textures),m=n(t.images),s=n(t.shapes);f.length>0&&(i.geometries=f),d.length>0&&(i.materials=d),p.length>0&&(i.textures=p),m.length>0&&(i.images=m),s.length>0&&(i.shapes=s)}return i.object=o,i},clone:function(t){return(new this.constructor).copy(this,t)},copy:function(t,e){if(void 0===e&&(e=!0),this.name=t.name,this.up.copy(t.up),this.position.copy(t.position),this.quaternion.copy(t.quaternion),this.scale.copy(t.scale),this.matrix.copy(t.matrix),this.matrixWorld.copy(t.matrixWorld),this.matrixAutoUpdate=t.matrixAutoUpdate,this.matrixWorldNeedsUpdate=t.matrixWorldNeedsUpdate,this.layers.mask=t.layers.mask,this.visible=t.visible,this.castShadow=t.castShadow,this.receiveShadow=t.receiveShadow,this.frustumCulled=t.frustumCulled,this.renderOrder=t.renderOrder,this.userData=JSON.parse(JSON.stringify(t.userData)),!0===e)for(var n=0;n<t.children.length;n++){var r=t.children[n];this.add(r.clone())}return this}}),x.prototype=Object.assign(Object.create(E.prototype),{constructor:x,isCamera:!0,copy:function(t,e){return E.prototype.copy.call(this,t,e),this.matrixWorldInverse.copy(t.matrixWorldInverse),this.projectionMatrix.copy(t.projectionMatrix),this},getWorldDirection:function(){var t=new a;return function(e){return void 0===e&&(console.warn("THREE.Camera: .getWorldDirection() target is now required"),e=new s),this.getWorldQuaternion(t),e.set(0,0,-1).applyQuaternion(t)}}(),updateMatrixWorld:function(t){E.prototype.updateMatrixWorld.call(this,t),this.matrixWorldInverse.getInverse(this.matrixWorld)},clone:function(){return(new this.constructor).copy(this)}}),T.prototype=Object.assign(Object.create(x.prototype),{constructor:T,isOrthographicCamera:!0,copy:function(t,e){return x.prototype.copy.call(this,t,e),this.left=t.left,this.right=t.right,this.top=t.top,this.bottom=t.bottom,this.near=t.near,this.far=t.far,this.zoom=t.zoom,this.view=null===t.view?null:Object.assign({},t.view),this},setViewOffset:function(t,e,n,r,i,o){null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=(this.right-this.left)/(2*this.zoom),e=(this.top-this.bottom)/(2*this.zoom),n=(this.right+this.left)/2,r=(this.top+this.bottom)/2,i=n-t,o=n+t,a=r+e,s=r-e;if(null!==this.view&&this.view.enabled){var u=this.zoom/(this.view.width/this.view.fullWidth),c=this.zoom/(this.view.height/this.view.fullHeight),l=(this.right-this.left)/this.view.width,h=(this.top-this.bottom)/this.view.height;i+=l*(this.view.offsetX/u),o=i+l*(this.view.width/u),a-=h*(this.view.offsetY/c),s=a-h*(this.view.height/c)}this.projectionMatrix.makeOrthographic(i,o,a,s,this.near,this.far)},toJSON:function(t){var e=E.prototype.toJSON.call(this,t);return e.object.zoom=this.zoom,e.object.left=this.left,e.object.right=this.right,e.object.top=this.top,e.object.bottom=this.bottom,e.object.near=this.near,e.object.far=this.far,null!==this.view&&(e.object.view=Object.assign({},this.view)),e}}),Object.assign(S.prototype,{clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.a=t.a,this.b=t.b,this.c=t.c,this.normal.copy(t.normal),this.color.copy(t.color),this.materialIndex=t.materialIndex;for(var e=0,n=t.vertexNormals.length;e<n;e++)this.vertexNormals[e]=t.vertexNormals[e].clone();for(var e=0,n=t.vertexColors.length;e<n;e++)this.vertexColors[e]=t.vertexColors[e].clone();return this}});var Lu=0;C.prototype=Object.assign(Object.create(r.prototype),{constructor:C,isGeometry:!0,applyMatrix:function(t){for(var e=(new u).getNormalMatrix(t),n=0,r=this.vertices.length;n<r;n++){this.vertices[n].applyMatrix4(t)}for(var n=0,r=this.faces.length;n<r;n++){var i=this.faces[n];i.normal.applyMatrix3(e).normalize();for(var o=0,a=i.vertexNormals.length;o<a;o++)i.vertexNormals[o].applyMatrix3(e).normalize()}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this.verticesNeedUpdate=!0,this.normalsNeedUpdate=!0,this},rotateX:function(){var t=new o;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new o;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new o;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new o;return function(e,n,r){return t.makeTranslation(e,n,r),this.applyMatrix(t),this}}(),scale:function(){var t=new o;return function(e,n,r){return t.makeScale(e,n,r),this.applyMatrix(t),this}}(),lookAt:function(){var t=new E;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),fromBufferGeometry:function(t){function e(t,e,r,i){var o=void 0!==u?[f[t].clone(),f[e].clone(),f[r].clone()]:[],a=void 0!==c?[n.colors[t].clone(),n.colors[e].clone(),n.colors[r].clone()]:[],s=new S(t,e,r,o,a,i);n.faces.push(s),void 0!==l&&n.faceVertexUvs[0].push([d[t].clone(),d[e].clone(),d[r].clone()]),void 0!==h&&n.faceVertexUvs[1].push([p[t].clone(),p[e].clone(),p[r].clone()])}var n=this,r=null!==t.index?t.index.array:void 0,o=t.attributes,a=o.position.array,u=void 0!==o.normal?o.normal.array:void 0,c=void 0!==o.color?o.color.array:void 0,l=void 0!==o.uv?o.uv.array:void 0,h=void 0!==o.uv2?o.uv2.array:void 0;void 0!==h&&(this.faceVertexUvs[1]=[]);for(var f=[],d=[],p=[],m=0,g=0;m<a.length;m+=3,g+=2)n.vertices.push(new s(a[m],a[m+1],a[m+2])),void 0!==u&&f.push(new s(u[m],u[m+1],u[m+2])),void 0!==c&&n.colors.push(new y(c[m],c[m+1],c[m+2])),void 0!==l&&d.push(new i(l[g],l[g+1])),void 0!==h&&p.push(new i(h[g],h[g+1]));var v=t.groups;if(v.length>0)for(var m=0;m<v.length;m++)for(var _=v[m],b=_.start,w=_.count,g=b,E=b+w;g<E;g+=3)void 0!==r?e(r[g],r[g+1],r[g+2],_.materialIndex):e(g,g+1,g+2,_.materialIndex);else if(void 0!==r)for(var m=0;m<r.length;m+=3)e(r[m],r[m+1],r[m+2]);else for(var m=0;m<a.length/3;m+=3)e(m,m+1,m+2);return this.computeFaceNormals(),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),this},center:function(){var t=new s;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(t).negate(),this.translate(t.x,t.y,t.z),this}}(),normalize:function(){this.computeBoundingSphere();var t=this.boundingSphere.center,e=this.boundingSphere.radius,n=0===e?1:1/e,r=new o;return r.set(n,0,0,-n*t.x,0,n,0,-n*t.y,0,0,n,-n*t.z,0,0,0,1),this.applyMatrix(r),this},computeFaceNormals:function(){for(var t=new s,e=new s,n=0,r=this.faces.length;n<r;n++){var i=this.faces[n],o=this.vertices[i.a],a=this.vertices[i.b],u=this.vertices[i.c];t.subVectors(u,a),e.subVectors(o,a),t.cross(e),t.normalize(),i.normal.copy(t)}},computeVertexNormals:function(t){void 0===t&&(t=!0);var e,n,r,i,o,a;for(a=new Array(this.vertices.length),e=0,n=this.vertices.length;e<n;e++)a[e]=new s;if(t){var u,c,l,h=new s,f=new s;for(r=0,i=this.faces.length;r<i;r++)o=this.faces[r],u=this.vertices[o.a],c=this.vertices[o.b],l=this.vertices[o.c],h.subVectors(l,c),f.subVectors(u,c),h.cross(f),a[o.a].add(h),a[o.b].add(h),a[o.c].add(h)}else for(this.computeFaceNormals(),r=0,i=this.faces.length;r<i;r++)o=this.faces[r],a[o.a].add(o.normal),a[o.b].add(o.normal),a[o.c].add(o.normal);for(e=0,n=this.vertices.length;e<n;e++)a[e].normalize();for(r=0,i=this.faces.length;r<i;r++){o=this.faces[r];var d=o.vertexNormals;3===d.length?(d[0].copy(a[o.a]),d[1].copy(a[o.b]),d[2].copy(a[o.c])):(d[0]=a[o.a].clone(),d[1]=a[o.b].clone(),d[2]=a[o.c].clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeFlatVertexNormals:function(){var t,e,n;for(this.computeFaceNormals(),t=0,e=this.faces.length;t<e;t++){n=this.faces[t];var r=n.vertexNormals;3===r.length?(r[0].copy(n.normal),r[1].copy(n.normal),r[2].copy(n.normal)):(r[0]=n.normal.clone(),r[1]=n.normal.clone(),r[2]=n.normal.clone())}this.faces.length>0&&(this.normalsNeedUpdate=!0)},computeMorphNormals:function(){var t,e,n,r,i;for(n=0,r=this.faces.length;n<r;n++)for(i=this.faces[n],i.__originalFaceNormal?i.__originalFaceNormal.copy(i.normal):i.__originalFaceNormal=i.normal.clone(),i.__originalVertexNormals||(i.__originalVertexNormals=[]),t=0,e=i.vertexNormals.length;t<e;t++)i.__originalVertexNormals[t]?i.__originalVertexNormals[t].copy(i.vertexNormals[t]):i.__originalVertexNormals[t]=i.vertexNormals[t].clone();var o=new C;for(o.faces=this.faces,t=0,e=this.morphTargets.length;t<e;t++){if(!this.morphNormals[t]){this.morphNormals[t]={},this.morphNormals[t].faceNormals=[],this.morphNormals[t].vertexNormals=[];var a,u,c=this.morphNormals[t].faceNormals,l=this.morphNormals[t].vertexNormals;for(n=0,r=this.faces.length;n<r;n++)a=new s,u={a:new s,b:new s,c:new s},c.push(a),l.push(u)}var h=this.morphNormals[t];o.vertices=this.morphTargets[t].vertices,o.computeFaceNormals(),o.computeVertexNormals();var a,u;for(n=0,r=this.faces.length;n<r;n++)i=this.faces[n],a=h.faceNormals[n],u=h.vertexNormals[n],a.copy(i.normal),u.a.copy(i.vertexNormals[0]),u.b.copy(i.vertexNormals[1]),u.c.copy(i.vertexNormals[2])}for(n=0,r=this.faces.length;n<r;n++)i=this.faces[n],i.normal=i.__originalFaceNormal,i.vertexNormals=i.__originalVertexNormals},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new p),this.boundingBox.setFromPoints(this.vertices)},computeBoundingSphere:function(){null===this.boundingSphere&&(this.boundingSphere=new m),this.boundingSphere.setFromPoints(this.vertices)},merge:function(t,e,n){if(!t||!t.isGeometry)return void console.error("THREE.Geometry.merge(): geometry not an instance of THREE.Geometry.",t);var r,i=this.vertices.length,o=this.vertices,a=t.vertices,s=this.faces,c=t.faces,l=this.faceVertexUvs[0],h=t.faceVertexUvs[0],f=this.colors,d=t.colors;void 0===n&&(n=0),void 0!==e&&(r=(new u).getNormalMatrix(e));for(var p=0,m=a.length;p<m;p++){var g=a[p],v=g.clone();void 0!==e&&v.applyMatrix4(e),o.push(v)}for(var p=0,m=d.length;p<m;p++)f.push(d[p].clone());for(p=0,m=c.length;p<m;p++){var y,_,b,w=c[p],E=w.vertexNormals,x=w.vertexColors;y=new S(w.a+i,w.b+i,w.c+i),y.normal.copy(w.normal),void 0!==r&&y.normal.applyMatrix3(r).normalize();for(var T=0,C=E.length;T<C;T++)_=E[T].clone(),void 0!==r&&_.applyMatrix3(r).normalize(),y.vertexNormals.push(_);y.color.copy(w.color);for(var T=0,C=x.length;T<C;T++)b=x[T],y.vertexColors.push(b.clone());y.materialIndex=w.materialIndex+n,s.push(y)}for(p=0,m=h.length;p<m;p++){var M=h[p],A=[];if(void 0!==M){for(var T=0,C=M.length;T<C;T++)A.push(M[T].clone());l.push(A)}}},mergeMesh:function(t){if(!t||!t.isMesh)return void console.error("THREE.Geometry.mergeMesh(): mesh not an instance of THREE.Mesh.",t);t.matrixAutoUpdate&&t.updateMatrix(),this.merge(t.geometry,t.matrix)},mergeVertices:function(){var t,e,n,r,i,o,a,s,u={},c=[],l=[],h=Math.pow(10,4);for(n=0,r=this.vertices.length;n<r;n++)t=this.vertices[n],e=Math.round(t.x*h)+"_"+Math.round(t.y*h)+"_"+Math.round(t.z*h),void 0===u[e]?(u[e]=n,c.push(this.vertices[n]),l[n]=c.length-1):l[n]=l[u[e]];var f=[];for(n=0,r=this.faces.length;n<r;n++){i=this.faces[n],i.a=l[i.a],i.b=l[i.b],i.c=l[i.c],o=[i.a,i.b,i.c];for(var d=0;d<3;d++)if(o[d]===o[(d+1)%3]){f.push(n);break}}for(n=f.length-1;n>=0;n--){var p=f[n];for(this.faces.splice(p,1),a=0,s=this.faceVertexUvs.length;a<s;a++)this.faceVertexUvs[a].splice(p,1)}var m=this.vertices.length-c.length;return this.vertices=c,m},setFromPoints:function(t){this.vertices=[];for(var e=0,n=t.length;e<n;e++){var r=t[e];this.vertices.push(new s(r.x,r.y,r.z||0))}return this},sortFacesByMaterialIndex:function(){function t(t,e){return t.materialIndex-e.materialIndex}for(var e=this.faces,n=e.length,r=0;r<n;r++)e[r]._id=r;e.sort(t);var i,o,a=this.faceVertexUvs[0],s=this.faceVertexUvs[1];a&&a.length===n&&(i=[]),s&&s.length===n&&(o=[]);for(var r=0;r<n;r++){var u=e[r]._id;i&&i.push(a[u]),o&&o.push(s[u])}i&&(this.faceVertexUvs[0]=i),o&&(this.faceVertexUvs[1]=o)},toJSON:function(){function t(t,e,n){return n?t|1<<e:t&~(1<<e)}function e(t){var e=t.x.toString()+t.y.toString()+t.z.toString();return void 0!==f[e]?f[e]:(f[e]=h.length/3,h.push(t.x,t.y,t.z),f[e])}function n(t){var e=t.r.toString()+t.g.toString()+t.b.toString();return void 0!==p[e]?p[e]:(p[e]=d.length,d.push(t.getHex()),p[e])}function r(t){var e=t.x.toString()+t.y.toString();return void 0!==g[e]?g[e]:(g[e]=m.length/2,m.push(t.x,t.y),g[e])}var i={metadata:{version:4.5,type:"Geometry",generator:"Geometry.toJSON"}};if(i.uuid=this.uuid,i.type=this.type,""!==this.name&&(i.name=this.name),void 0!==this.parameters){var o=this.parameters;for(var a in o)void 0!==o[a]&&(i[a]=o[a]);return i}for(var s=[],u=0;u<this.vertices.length;u++){var c=this.vertices[u];s.push(c.x,c.y,c.z)}for(var l=[],h=[],f={},d=[],p={},m=[],g={},u=0;u<this.faces.length;u++){var v=this.faces[u],y=void 0!==this.faceVertexUvs[0][u],_=v.normal.length()>0,b=v.vertexNormals.length>0,w=1!==v.color.r||1!==v.color.g||1!==v.color.b,E=v.vertexColors.length>0,x=0;if(x=t(x,0,0),x=t(x,1,!0),x=t(x,2,!1),x=t(x,3,y),x=t(x,4,_),x=t(x,5,b),x=t(x,6,w),x=t(x,7,E),l.push(x),l.push(v.a,v.b,v.c),l.push(v.materialIndex),y){var T=this.faceVertexUvs[0][u];l.push(r(T[0]),r(T[1]),r(T[2]))}if(_&&l.push(e(v.normal)),b){var S=v.vertexNormals;l.push(e(S[0]),e(S[1]),e(S[2]))}if(w&&l.push(n(v.color)),E){var C=v.vertexColors;l.push(n(C[0]),n(C[1]),n(C[2]))}}return i.data={},i.data.vertices=s,i.data.normals=h,d.length>0&&(i.data.colors=d),m.length>0&&(i.data.uvs=[m]),i.data.faces=l,i},clone:function(){return(new C).copy(this)},copy:function(t){var e,n,r,i,o,a;this.vertices=[],this.colors=[],this.faces=[],this.faceVertexUvs=[[]],this.morphTargets=[],this.morphNormals=[],this.skinWeights=[],this.skinIndices=[],this.lineDistances=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var s=t.vertices;for(e=0,n=s.length;e<n;e++)this.vertices.push(s[e].clone());var u=t.colors;for(e=0,n=u.length;e<n;e++)this.colors.push(u[e].clone());var c=t.faces;for(e=0,n=c.length;e<n;e++)this.faces.push(c[e].clone());for(e=0,n=t.faceVertexUvs.length;e<n;e++){var l=t.faceVertexUvs[e];for(void 0===this.faceVertexUvs[e]&&(this.faceVertexUvs[e]=[]),r=0,i=l.length;r<i;r++){var h=l[r],f=[];for(o=0,a=h.length;o<a;o++){var d=h[o];f.push(d.clone())}this.faceVertexUvs[e].push(f)}}var p=t.morphTargets;for(e=0,n=p.length;e<n;e++){var m={};if(m.name=p[e].name,void 0!==p[e].vertices)for(m.vertices=[],r=0,i=p[e].vertices.length;r<i;r++)m.vertices.push(p[e].vertices[r].clone());if(void 0!==p[e].normals)for(m.normals=[],r=0,i=p[e].normals.length;r<i;r++)m.normals.push(p[e].normals[r].clone());this.morphTargets.push(m)}var g=t.morphNormals;for(e=0,n=g.length;e<n;e++){var v={};if(void 0!==g[e].vertexNormals)for(v.vertexNormals=[],r=0,i=g[e].vertexNormals.length;r<i;r++){var y=g[e].vertexNormals[r],_={};_.a=y.a.clone(),_.b=y.b.clone(),_.c=y.c.clone(),v.vertexNormals.push(_)}if(void 0!==g[e].faceNormals)for(v.faceNormals=[],r=0,i=g[e].faceNormals.length;r<i;r++)v.faceNormals.push(g[e].faceNormals[r].clone());this.morphNormals.push(v)}var b=t.skinWeights;for(e=0,n=b.length;e<n;e++)this.skinWeights.push(b[e].clone());var w=t.skinIndices;for(e=0,n=w.length;e<n;e++)this.skinIndices.push(w[e].clone());var E=t.lineDistances;for(e=0,n=E.length;e<n;e++)this.lineDistances.push(E[e]);var x=t.boundingBox;null!==x&&(this.boundingBox=x.clone());var T=t.boundingSphere;return null!==T&&(this.boundingSphere=T.clone()),this.elementsNeedUpdate=t.elementsNeedUpdate,this.verticesNeedUpdate=t.verticesNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.lineDistancesNeedUpdate=t.lineDistancesNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),Object.defineProperty(M.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(M.prototype,{isBufferAttribute:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==t?t.length/this.itemSize:0,this.array=t,this},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.name=t.name,this.array=new t.array.constructor(t.array),this.itemSize=t.itemSize,this.count=t.count,this.normalized=t.normalized,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.itemSize,n*=e.itemSize;for(var r=0,i=this.itemSize;r<i;r++)this.array[t+r]=e.array[n+r];return this},copyArray:function(t){return this.array.set(t),this},copyColorsArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyColorsArray(): color is undefined",r),o=new y),e[n++]=o.r,e[n++]=o.g,e[n++]=o.b}return this},copyVector2sArray:function(t){for(var e=this.array,n=0,r=0,o=t.length;r<o;r++){var a=t[r];void 0===a&&(console.warn("THREE.BufferAttribute.copyVector2sArray(): vector is undefined",r),a=new i),e[n++]=a.x,e[n++]=a.y}return this},copyVector3sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector3sArray(): vector is undefined",r),o=new s),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z}return this},copyVector4sArray:function(t){for(var e=this.array,n=0,r=0,i=t.length;r<i;r++){var o=t[r];void 0===o&&(console.warn("THREE.BufferAttribute.copyVector4sArray(): vector is undefined",r),o=new l),e[n++]=o.x,e[n++]=o.y,e[n++]=o.z,e[n++]=o.w}return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},getX:function(t){return this.array[t*this.itemSize]},setX:function(t,e){return this.array[t*this.itemSize]=e,this},getY:function(t){return this.array[t*this.itemSize+1]},setY:function(t,e){return this.array[t*this.itemSize+1]=e,this},getZ:function(t){return this.array[t*this.itemSize+2]},setZ:function(t,e){return this.array[t*this.itemSize+2]=e,this},getW:function(t){return this.array[t*this.itemSize+3]},setW:function(t,e){return this.array[t*this.itemSize+3]=e,this},setXY:function(t,e,n){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t*=this.itemSize,this.array[t+0]=e,this.array[t+1]=n,this.array[t+2]=r,this.array[t+3]=i,this},onUpload:function(t){return this.onUploadCallback=t,this},clone:function(){return new this.constructor(this.array,this.itemSize).copy(this)}}),A.prototype=Object.create(M.prototype),A.prototype.constructor=A,I.prototype=Object.create(M.prototype),I.prototype.constructor=I,R.prototype=Object.create(M.prototype),R.prototype.constructor=R,P.prototype=Object.create(M.prototype),P.prototype.constructor=P,N.prototype=Object.create(M.prototype),N.prototype.constructor=N,D.prototype=Object.create(M.prototype),D.prototype.constructor=D,O.prototype=Object.create(M.prototype),O.prototype.constructor=O,k.prototype=Object.create(M.prototype),k.prototype.constructor=k,L.prototype=Object.create(M.prototype),L.prototype.constructor=L,Object.assign(U.prototype,{computeGroups:function(t){for(var e,n=[],r=void 0,i=t.faces,o=0;o<i.length;o++){var a=i[o];a.materialIndex!==r&&(r=a.materialIndex,void 0!==e&&(e.count=3*o-e.start,n.push(e)),e={start:3*o,materialIndex:r})}void 0!==e&&(e.count=3*o-e.start,n.push(e)),this.groups=n},fromGeometry:function(t){var e,n=t.faces,r=t.vertices,o=t.faceVertexUvs,a=o[0]&&o[0].length>0,s=o[1]&&o[1].length>0,u=t.morphTargets,c=u.length;if(c>0){e=[];for(var l=0;l<c;l++)e[l]=[];this.morphTargets.position=e}var h,f=t.morphNormals,d=f.length;if(d>0){h=[];for(var l=0;l<d;l++)h[l]=[];this.morphTargets.normal=h}for(var p=t.skinIndices,m=t.skinWeights,g=p.length===r.length,v=m.length===r.length,l=0;l<n.length;l++){var y=n[l];this.vertices.push(r[y.a],r[y.b],r[y.c]);var _=y.vertexNormals;if(3===_.length)this.normals.push(_[0],_[1],_[2]);else{var b=y.normal;this.normals.push(b,b,b)}var w=y.vertexColors;if(3===w.length)this.colors.push(w[0],w[1],w[2]);else{var E=y.color;this.colors.push(E,E,E)}if(!0===a){var x=o[0][l];void 0!==x?this.uvs.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv ",l),this.uvs.push(new i,new i,new i))}if(!0===s){var x=o[1][l];void 0!==x?this.uvs2.push(x[0],x[1],x[2]):(console.warn("THREE.DirectGeometry.fromGeometry(): Undefined vertexUv2 ",l),this.uvs2.push(new i,new i,new i))}for(var T=0;T<c;T++){var S=u[T].vertices;e[T].push(S[y.a],S[y.b],S[y.c])}for(var T=0;T<d;T++){var C=f[T].vertexNormals[l];h[T].push(C.a,C.b,C.c)}g&&this.skinIndices.push(p[y.a],p[y.b],p[y.c]),v&&this.skinWeights.push(m[y.a],m[y.b],m[y.c])}return this.computeGroups(t),this.verticesNeedUpdate=t.verticesNeedUpdate,this.normalsNeedUpdate=t.normalsNeedUpdate,this.colorsNeedUpdate=t.colorsNeedUpdate,this.uvsNeedUpdate=t.uvsNeedUpdate,this.groupsNeedUpdate=t.groupsNeedUpdate,this}});var Uu=1;B.prototype=Object.assign(Object.create(r.prototype),{constructor:B,isBufferGeometry:!0,getIndex:function(){return this.index},setIndex:function(t){Array.isArray(t)?this.index=new(F(t)>65535?O:N)(t,1):this.index=t},addAttribute:function(t,e){return e&&e.isBufferAttribute||e&&e.isInterleavedBufferAttribute?"index"===t?(console.warn("THREE.BufferGeometry.addAttribute: Use .setIndex() for index attribute."),void this.setIndex(e)):(this.attributes[t]=e,this):(console.warn("THREE.BufferGeometry: .addAttribute() now expects ( name, attribute )."),void this.addAttribute(t,new M(arguments[1],arguments[2])))},getAttribute:function(t){return this.attributes[t]},removeAttribute:function(t){return delete this.attributes[t],this},addGroup:function(t,e,n){this.groups.push({start:t,count:e,materialIndex:void 0!==n?n:0})},clearGroups:function(){this.groups=[]},setDrawRange:function(t,e){this.drawRange.start=t,this.drawRange.count=e},applyMatrix:function(t){var e=this.attributes.position;void 0!==e&&(t.applyToBufferAttribute(e),e.needsUpdate=!0);var n=this.attributes.normal;if(void 0!==n){(new u).getNormalMatrix(t).applyToBufferAttribute(n),n.needsUpdate=!0}return null!==this.boundingBox&&this.computeBoundingBox(),null!==this.boundingSphere&&this.computeBoundingSphere(),this},rotateX:function(){var t=new o;return function(e){return t.makeRotationX(e),this.applyMatrix(t),this}}(),rotateY:function(){var t=new o;return function(e){return t.makeRotationY(e),this.applyMatrix(t),this}}(),rotateZ:function(){var t=new o;return function(e){return t.makeRotationZ(e),this.applyMatrix(t),this}}(),translate:function(){var t=new o;return function(e,n,r){return t.makeTranslation(e,n,r),this.applyMatrix(t),this}}(),scale:function(){var t=new o;return function(e,n,r){return t.makeScale(e,n,r),this.applyMatrix(t),this}}(),lookAt:function(){var t=new E;return function(e){t.lookAt(e),t.updateMatrix(),this.applyMatrix(t.matrix)}}(),center:function(){var t=new s;return function(){return this.computeBoundingBox(),this.boundingBox.getCenter(t).negate(),this.translate(t.x,t.y,t.z),this}}(),setFromObject:function(t){var e=t.geometry;if(t.isPoints||t.isLine){var n=new k(3*e.vertices.length,3),r=new k(3*e.colors.length,3);if(this.addAttribute("position",n.copyVector3sArray(e.vertices)),this.addAttribute("color",r.copyColorsArray(e.colors)),e.lineDistances&&e.lineDistances.length===e.vertices.length){var i=new k(e.lineDistances.length,1);this.addAttribute("lineDistance",i.copyArray(e.lineDistances))}null!==e.boundingSphere&&(this.boundingSphere=e.boundingSphere.clone()),null!==e.boundingBox&&(this.boundingBox=e.boundingBox.clone())}else t.isMesh&&e&&e.isGeometry&&this.fromGeometry(e);return this},setFromPoints:function(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n];e.push(i.x,i.y,i.z||0)}return this.addAttribute("position",new k(e,3)),this},updateFromObject:function(t){var e=t.geometry;if(t.isMesh){var n=e.__directGeometry;if(!0===e.elementsNeedUpdate&&(n=void 0,e.elementsNeedUpdate=!1),void 0===n)return this.fromGeometry(e);n.verticesNeedUpdate=e.verticesNeedUpdate,n.normalsNeedUpdate=e.normalsNeedUpdate,n.colorsNeedUpdate=e.colorsNeedUpdate,n.uvsNeedUpdate=e.uvsNeedUpdate,n.groupsNeedUpdate=e.groupsNeedUpdate,e.verticesNeedUpdate=!1,e.normalsNeedUpdate=!1,e.colorsNeedUpdate=!1,e.uvsNeedUpdate=!1,e.groupsNeedUpdate=!1,e=n}var r;return!0===e.verticesNeedUpdate&&(r=this.attributes.position,void 0!==r&&(r.copyVector3sArray(e.vertices),r.needsUpdate=!0),e.verticesNeedUpdate=!1),!0===e.normalsNeedUpdate&&(r=this.attributes.normal,void 0!==r&&(r.copyVector3sArray(e.normals),r.needsUpdate=!0),e.normalsNeedUpdate=!1),!0===e.colorsNeedUpdate&&(r=this.attributes.color,void 0!==r&&(r.copyColorsArray(e.colors),r.needsUpdate=!0),e.colorsNeedUpdate=!1),e.uvsNeedUpdate&&(r=this.attributes.uv,void 0!==r&&(r.copyVector2sArray(e.uvs),r.needsUpdate=!0),e.uvsNeedUpdate=!1),e.lineDistancesNeedUpdate&&(r=this.attributes.lineDistance,void 0!==r&&(r.copyArray(e.lineDistances),r.needsUpdate=!0),e.lineDistancesNeedUpdate=!1),e.groupsNeedUpdate&&(e.computeGroups(t.geometry),this.groups=e.groups,e.groupsNeedUpdate=!1),this},fromGeometry:function(t){return t.__directGeometry=(new U).fromGeometry(t),this.fromDirectGeometry(t.__directGeometry)},fromDirectGeometry:function(t){var e=new Float32Array(3*t.vertices.length);if(this.addAttribute("position",new M(e,3).copyVector3sArray(t.vertices)),t.normals.length>0){var n=new Float32Array(3*t.normals.length);this.addAttribute("normal",new M(n,3).copyVector3sArray(t.normals))}if(t.colors.length>0){var r=new Float32Array(3*t.colors.length);this.addAttribute("color",new M(r,3).copyColorsArray(t.colors))}if(t.uvs.length>0){var i=new Float32Array(2*t.uvs.length);this.addAttribute("uv",new M(i,2).copyVector2sArray(t.uvs))}if(t.uvs2.length>0){var o=new Float32Array(2*t.uvs2.length);this.addAttribute("uv2",new M(o,2).copyVector2sArray(t.uvs2))}this.groups=t.groups;for(var a in t.morphTargets){for(var s=[],u=t.morphTargets[a],c=0,l=u.length;c<l;c++){var h=u[c],f=new k(3*h.length,3);s.push(f.copyVector3sArray(h))}this.morphAttributes[a]=s}if(t.skinIndices.length>0){var d=new k(4*t.skinIndices.length,4);this.addAttribute("skinIndex",d.copyVector4sArray(t.skinIndices))}if(t.skinWeights.length>0){var p=new k(4*t.skinWeights.length,4);this.addAttribute("skinWeight",p.copyVector4sArray(t.skinWeights))}return null!==t.boundingSphere&&(this.boundingSphere=t.boundingSphere.clone()),null!==t.boundingBox&&(this.boundingBox=t.boundingBox.clone()),this},computeBoundingBox:function(){null===this.boundingBox&&(this.boundingBox=new p);var t=this.attributes.position;void 0!==t?this.boundingBox.setFromBufferAttribute(t):this.boundingBox.makeEmpty(),(isNaN(this.boundingBox.min.x)||isNaN(this.boundingBox.min.y)||isNaN(this.boundingBox.min.z))&&console.error('THREE.BufferGeometry.computeBoundingBox: Computed min/max have NaN values. The "position" attribute is likely to have NaN values.',this)},computeBoundingSphere:function(){var t=new p,e=new s;return function(){null===this.boundingSphere&&(this.boundingSphere=new m);var n=this.attributes.position;if(n){var r=this.boundingSphere.center;t.setFromBufferAttribute(n),t.getCenter(r);for(var i=0,o=0,a=n.count;o<a;o++)e.x=n.getX(o),e.y=n.getY(o),e.z=n.getZ(o),i=Math.max(i,r.distanceToSquared(e));this.boundingSphere.radius=Math.sqrt(i),isNaN(this.boundingSphere.radius)&&console.error('THREE.BufferGeometry.computeBoundingSphere(): Computed radius is NaN. The "position" attribute is likely to have NaN values.',this)}}}(),computeFaceNormals:function(){},computeVertexNormals:function(){var t=this.index,e=this.attributes,n=this.groups;if(e.position){var r=e.position.array;if(void 0===e.normal)this.addAttribute("normal",new M(new Float32Array(r.length),3));else for(var i=e.normal.array,o=0,a=i.length;o<a;o++)i[o]=0;var u,c,l,h=e.normal.array,f=new s,d=new s,p=new s,m=new s,g=new s;if(t){var v=t.array;0===n.length&&this.addGroup(0,v.length);for(var y=0,_=n.length;y<_;++y)for(var b=n[y],w=b.start,E=b.count,o=w,a=w+E;o<a;o+=3)u=3*v[o+0],c=3*v[o+1],l=3*v[o+2],f.fromArray(r,u),d.fromArray(r,c),p.fromArray(r,l),m.subVectors(p,d),g.subVectors(f,d),m.cross(g),h[u]+=m.x,h[u+1]+=m.y,h[u+2]+=m.z,h[c]+=m.x,h[c+1]+=m.y,h[c+2]+=m.z,h[l]+=m.x,h[l+1]+=m.y,h[l+2]+=m.z}else for(var o=0,a=r.length;o<a;o+=9)f.fromArray(r,o),d.fromArray(r,o+3),p.fromArray(r,o+6),m.subVectors(p,d),g.subVectors(f,d),m.cross(g),h[o]=m.x,h[o+1]=m.y,h[o+2]=m.z,h[o+3]=m.x,h[o+4]=m.y,h[o+5]=m.z,h[o+6]=m.x,h[o+7]=m.y,h[o+8]=m.z;this.normalizeNormals(),e.normal.needsUpdate=!0}},merge:function(t,e){if(!t||!t.isBufferGeometry)return void console.error("THREE.BufferGeometry.merge(): geometry not an instance of THREE.BufferGeometry.",t);void 0===e&&(e=0,console.warn("THREE.BufferGeometry.merge(): Overwriting original geometry, starting at offset=0. Use BufferGeometryUtils.mergeBufferGeometries() for lossless merge."));var n=this.attributes;for(var r in n)if(void 0!==t.attributes[r])for(var i=n[r],o=i.array,a=t.attributes[r],s=a.array,u=a.itemSize,c=0,l=u*e;c<s.length;c++,l++)o[l]=s[c];return this},normalizeNormals:function(){var t=new s;return function(){for(var e=this.attributes.normal,n=0,r=e.count;n<r;n++)t.x=e.getX(n),t.y=e.getY(n),t.z=e.getZ(n),t.normalize(),e.setXYZ(n,t.x,t.y,t.z)}}(),toNonIndexed:function(){if(null===this.index)return console.warn("THREE.BufferGeometry.toNonIndexed(): Geometry is already non-indexed."),this;var t=new B,e=this.index.array,n=this.attributes;for(var r in n){for(var i=n[r],o=i.array,a=i.itemSize,s=new o.constructor(e.length*a),u=0,c=0,l=0,h=e.length;l<h;l++){u=e[l]*a;for(var f=0;f<a;f++)s[c++]=o[u++]}t.addAttribute(r,new M(s,a))}for(var d=this.groups,l=0,h=d.length;l<h;l++){var p=d[l];t.addGroup(p.start,p.count,p.materialIndex)}return t},toJSON:function(){var t={metadata:{version:4.5,type:"BufferGeometry",generator:"BufferGeometry.toJSON"}};if(t.uuid=this.uuid,t.type=this.type,""!==this.name&&(t.name=this.name),void 0!==this.parameters){var e=this.parameters;for(var n in e)void 0!==e[n]&&(t[n]=e[n]);return t}t.data={attributes:{}};var r=this.index;if(null!==r){var i=Array.prototype.slice.call(r.array);t.data.index={type:r.array.constructor.name,array:i}}var o=this.attributes;for(var n in o){var a=o[n],i=Array.prototype.slice.call(a.array);t.data.attributes[n]={itemSize:a.itemSize,type:a.array.constructor.name,array:i,normalized:a.normalized}}var s=this.groups;s.length>0&&(t.data.groups=JSON.parse(JSON.stringify(s)));var u=this.boundingSphere;return null!==u&&(t.data.boundingSphere={center:u.center.toArray(),radius:u.radius}),t},clone:function(){return(new B).copy(this)},copy:function(t){var e,n,r;this.index=null,this.attributes={},this.morphAttributes={},this.groups=[],this.boundingBox=null,this.boundingSphere=null,this.name=t.name;var i=t.index;null!==i&&this.setIndex(i.clone());var o=t.attributes;for(e in o){var a=o[e];this.addAttribute(e,a.clone())}var s=t.morphAttributes;for(e in s){var u=[],c=s[e];for(n=0,r=c.length;n<r;n++)u.push(c[n].clone());this.morphAttributes[e]=u}var l=t.groups;for(n=0,r=l.length;n<r;n++){var h=l[n];this.addGroup(h.start,h.count,h.materialIndex)}var f=t.boundingBox;null!==f&&(this.boundingBox=f.clone());var d=t.boundingSphere;return null!==d&&(this.boundingSphere=d.clone()),this.drawRange.start=t.drawRange.start,this.drawRange.count=t.drawRange.count,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),V.prototype=Object.create(C.prototype),V.prototype.constructor=V,j.prototype=Object.create(B.prototype),j.prototype.constructor=j,H.prototype=Object.create(C.prototype),H.prototype.constructor=H,G.prototype=Object.create(B.prototype),G.prototype.constructor=G;var Fu=0;z.prototype=Object.assign(Object.create(r.prototype),{constructor:z,isMaterial:!0,onBeforeCompile:function(){},setValues:function(t){if(void 0!==t)for(var e in t){var n=t[e];if(void 0!==n)if("shading"!==e){var r=this[e];void 0!==r?r&&r.isColor?r.set(n):r&&r.isVector3&&n&&n.isVector3?r.copy(n):this[e]="overdraw"===e?Number(n):n:console.warn("THREE."+this.type+": '"+e+"' is not a property of this material.")}else console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=n===ha;else console.warn("THREE.Material: '"+e+"' parameter is undefined.")}},toJSON:function(t){function e(t){var e=[];for(var n in t){var r=t[n];delete r.metadata,e.push(r)}return e}var n=void 0===t||"string"===typeof t;n&&(t={textures:{},images:{}});var r={metadata:{version:4.5,type:"Material",generator:"Material.toJSON"}};if(r.uuid=this.uuid,r.type=this.type,""!==this.name&&(r.name=this.name),this.color&&this.color.isColor&&(r.color=this.color.getHex()),void 0!==this.roughness&&(r.roughness=this.roughness),void 0!==this.metalness&&(r.metalness=this.metalness),this.emissive&&this.emissive.isColor&&(r.emissive=this.emissive.getHex()),1!==this.emissiveIntensity&&(r.emissiveIntensity=this.emissiveIntensity),this.specular&&this.specular.isColor&&(r.specular=this.specular.getHex()),void 0!==this.shininess&&(r.shininess=this.shininess),void 0!==this.clearCoat&&(r.clearCoat=this.clearCoat),void 0!==this.clearCoatRoughness&&(r.clearCoatRoughness=this.clearCoatRoughness),this.map&&this.map.isTexture&&(r.map=this.map.toJSON(t).uuid),this.alphaMap&&this.alphaMap.isTexture&&(r.alphaMap=this.alphaMap.toJSON(t).uuid),this.lightMap&&this.lightMap.isTexture&&(r.lightMap=this.lightMap.toJSON(t).uuid),this.bumpMap&&this.bumpMap.isTexture&&(r.bumpMap=this.bumpMap.toJSON(t).uuid,r.bumpScale=this.bumpScale),this.normalMap&&this.normalMap.isTexture&&(r.normalMap=this.normalMap.toJSON(t).uuid,r.normalScale=this.normalScale.toArray()),this.displacementMap&&this.displacementMap.isTexture&&(r.displacementMap=this.displacementMap.toJSON(t).uuid,r.displacementScale=this.displacementScale,r.displacementBias=this.displacementBias),this.roughnessMap&&this.roughnessMap.isTexture&&(r.roughnessMap=this.roughnessMap.toJSON(t).uuid),this.metalnessMap&&this.metalnessMap.isTexture&&(r.metalnessMap=this.metalnessMap.toJSON(t).uuid),this.emissiveMap&&this.emissiveMap.isTexture&&(r.emissiveMap=this.emissiveMap.toJSON(t).uuid),this.specularMap&&this.specularMap.isTexture&&(r.specularMap=this.specularMap.toJSON(t).uuid),this.envMap&&this.envMap.isTexture&&(r.envMap=this.envMap.toJSON(t).uuid,r.reflectivity=this.reflectivity),this.gradientMap&&this.gradientMap.isTexture&&(r.gradientMap=this.gradientMap.toJSON(t).uuid),void 0!==this.size&&(r.size=this.size),void 0!==this.sizeAttenuation&&(r.sizeAttenuation=this.sizeAttenuation),this.blending!==va&&(r.blending=this.blending),!0===this.flatShading&&(r.flatShading=this.flatShading),this.side!==ua&&(r.side=this.side),this.vertexColors!==da&&(r.vertexColors=this.vertexColors),this.opacity<1&&(r.opacity=this.opacity),!0===this.transparent&&(r.transparent=this.transparent),r.depthFunc=this.depthFunc,r.depthTest=this.depthTest,r.depthWrite=this.depthWrite,0!==this.rotation&&(r.rotation=this.rotation),1!==this.linewidth&&(r.linewidth=this.linewidth),void 0!==this.dashSize&&(r.dashSize=this.dashSize),void 0!==this.gapSize&&(r.gapSize=this.gapSize),void 0!==this.scale&&(r.scale=this.scale),!0===this.dithering&&(r.dithering=!0),this.alphaTest>0&&(r.alphaTest=this.alphaTest),!0===this.premultipliedAlpha&&(r.premultipliedAlpha=this.premultipliedAlpha),!0===this.wireframe&&(r.wireframe=this.wireframe),this.wireframeLinewidth>1&&(r.wireframeLinewidth=this.wireframeLinewidth),"round"!==this.wireframeLinecap&&(r.wireframeLinecap=this.wireframeLinecap),"round"!==this.wireframeLinejoin&&(r.wireframeLinejoin=this.wireframeLinejoin),!0===this.morphTargets&&(r.morphTargets=!0),!0===this.skinning&&(r.skinning=!0),!1===this.visible&&(r.visible=!1),"{}"!==JSON.stringify(this.userData)&&(r.userData=this.userData),n){var i=e(t.textures),o=e(t.images);i.length>0&&(r.textures=i),o.length>0&&(r.images=o)}return r},clone:function(){return(new this.constructor).copy(this)},copy:function(t){this.name=t.name,this.fog=t.fog,this.lights=t.lights,this.blending=t.blending,this.side=t.side,this.flatShading=t.flatShading,this.vertexColors=t.vertexColors,this.opacity=t.opacity,this.transparent=t.transparent,this.blendSrc=t.blendSrc,this.blendDst=t.blendDst,this.blendEquation=t.blendEquation,this.blendSrcAlpha=t.blendSrcAlpha,this.blendDstAlpha=t.blendDstAlpha,this.blendEquationAlpha=t.blendEquationAlpha,this.depthFunc=t.depthFunc,this.depthTest=t.depthTest,this.depthWrite=t.depthWrite,this.colorWrite=t.colorWrite,this.precision=t.precision,this.polygonOffset=t.polygonOffset,this.polygonOffsetFactor=t.polygonOffsetFactor,this.polygonOffsetUnits=t.polygonOffsetUnits,this.dithering=t.dithering,this.alphaTest=t.alphaTest,this.premultipliedAlpha=t.premultipliedAlpha,this.overdraw=t.overdraw,this.visible=t.visible,this.userData=JSON.parse(JSON.stringify(t.userData)),this.clipShadows=t.clipShadows,this.clipIntersection=t.clipIntersection;var e=t.clippingPlanes,n=null;if(null!==e){var r=e.length;n=new Array(r);for(var i=0;i!==r;++i)n[i]=e[i].clone()}return this.clippingPlanes=n,this.shadowSide=t.shadowSide,this},dispose:function(){this.dispatchEvent({type:"dispose"})}}),W.prototype=Object.create(z.prototype),W.prototype.constructor=W,W.prototype.isMeshBasicMaterial=!0,W.prototype.copy=function(t){return z.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this},q.prototype=Object.create(z.prototype),q.prototype.constructor=q,q.prototype.isShaderMaterial=!0,q.prototype.copy=function(t){return z.prototype.copy.call(this,t),this.fragmentShader=t.fragmentShader,this.vertexShader=t.vertexShader,this.uniforms=Pu.clone(t.uniforms),this.defines=Object.assign({},t.defines),this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.lights=t.lights,this.clipping=t.clipping,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this.extensions=t.extensions,this},q.prototype.toJSON=function(t){var e=z.prototype.toJSON.call(this,t);return e.uniforms=this.uniforms,e.vertexShader=this.vertexShader,e.fragmentShader=this.fragmentShader,e},Object.assign(Y.prototype,{set:function(t,e){return this.origin.copy(t),this.direction.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.origin.copy(t.origin),this.direction.copy(t.direction),this},at:function(t,e){return void 0===e&&(console.warn("THREE.Ray: .at() target is now required"),e=new s),e.copy(this.direction).multiplyScalar(t).add(this.origin)},lookAt:function(t){return this.direction.copy(t).sub(this.origin).normalize(),this},recast:function(){var t=new s;return function(e){return this.origin.copy(this.at(e,t)),this}}(),closestPointToPoint:function(t,e){void 0===e&&(console.warn("THREE.Ray: .closestPointToPoint() target is now required"),e=new s),e.subVectors(t,this.origin);var n=e.dot(this.direction);return n<0?e.copy(this.origin):e.copy(this.direction).multiplyScalar(n).add(this.origin)},distanceToPoint:function(t){return Math.sqrt(this.distanceSqToPoint(t))},distanceSqToPoint:function(){var t=new s;return function(e){var n=t.subVectors(e,this.origin).dot(this.direction);return n<0?this.origin.distanceToSquared(e):(t.copy(this.direction).multiplyScalar(n).add(this.origin),t.distanceToSquared(e))}}(),distanceSqToSegment:function(){var t=new s,e=new s,n=new s;return function(r,i,o,a){t.copy(r).add(i).multiplyScalar(.5),e.copy(i).sub(r).normalize(),n.copy(this.origin).sub(t);var s,u,c,l,h=.5*r.distanceTo(i),f=-this.direction.dot(e),d=n.dot(this.direction),p=-n.dot(e),m=n.lengthSq(),g=Math.abs(1-f*f);if(g>0)if(s=f*p-d,u=f*d-p,l=h*g,s>=0)if(u>=-l)if(u<=l){var v=1/g;s*=v,u*=v,c=s*(s+f*u+2*d)+u*(f*s+u+2*p)+m}else u=h,s=Math.max(0,-(f*u+d)),c=-s*s+u*(u+2*p)+m;else u=-h,s=Math.max(0,-(f*u+d)),c=-s*s+u*(u+2*p)+m;else u<=-l?(s=Math.max(0,-(-f*h+d)),u=s>0?-h:Math.min(Math.max(-h,-p),h),c=-s*s+u*(u+2*p)+m):u<=l?(s=0,u=Math.min(Math.max(-h,-p),h),c=u*(u+2*p)+m):(s=Math.max(0,-(f*h+d)),u=s>0?h:Math.min(Math.max(-h,-p),h),c=-s*s+u*(u+2*p)+m);else u=f>0?-h:h,s=Math.max(0,-(f*u+d)),c=-s*s+u*(u+2*p)+m;return o&&o.copy(this.direction).multiplyScalar(s).add(this.origin),a&&a.copy(e).multiplyScalar(u).add(t),c}}(),intersectSphere:function(){var t=new s;return function(e,n){t.subVectors(e.center,this.origin);var r=t.dot(this.direction),i=t.dot(t)-r*r,o=e.radius*e.radius;if(i>o)return null;var a=Math.sqrt(o-i),s=r-a,u=r+a;return s<0&&u<0?null:s<0?this.at(u,n):this.at(s,n)}}(),intersectsSphere:function(t){return this.distanceToPoint(t.center)<=t.radius},distanceToPlane:function(t){var e=t.normal.dot(this.direction);if(0===e)return 0===t.distanceToPoint(this.origin)?0:null;var n=-(this.origin.dot(t.normal)+t.constant)/e;return n>=0?n:null},intersectPlane:function(t,e){var n=this.distanceToPlane(t);return null===n?null:this.at(n,e)},intersectsPlane:function(t){var e=t.distanceToPoint(this.origin);return 0===e||t.normal.dot(this.direction)*e<0},intersectBox:function(t,e){var n,r,i,o,a,s,u=1/this.direction.x,c=1/this.direction.y,l=1/this.direction.z,h=this.origin;return u>=0?(n=(t.min.x-h.x)*u,r=(t.max.x-h.x)*u):(n=(t.max.x-h.x)*u,r=(t.min.x-h.x)*u),c>=0?(i=(t.min.y-h.y)*c,o=(t.max.y-h.y)*c):(i=(t.max.y-h.y)*c,o=(t.min.y-h.y)*c),n>o||i>r?null:((i>n||n!==n)&&(n=i),(o<r||r!==r)&&(r=o),l>=0?(a=(t.min.z-h.z)*l,s=(t.max.z-h.z)*l):(a=(t.max.z-h.z)*l,s=(t.min.z-h.z)*l),n>s||a>r?null:((a>n||n!==n)&&(n=a),(s<r||r!==r)&&(r=s),r<0?null:this.at(n>=0?n:r,e)))},intersectsBox:function(){var t=new s;return function(e){return null!==this.intersectBox(e,t)}}(),intersectTriangle:function(){var t=new s,e=new s,n=new s,r=new s;return function(i,o,a,s,u){e.subVectors(o,i),n.subVectors(a,i),r.crossVectors(e,n);var c,l=this.direction.dot(r);if(l>0){if(s)return null;c=1}else{if(!(l<0))return null;c=-1,l=-l}t.subVectors(this.origin,i);var h=c*this.direction.dot(n.crossVectors(t,n));if(h<0)return null;var f=c*this.direction.dot(e.cross(t));if(f<0)return null;if(h+f>l)return null;var d=-c*t.dot(r);return d<0?null:this.at(d/l,u)}}(),applyMatrix4:function(t){return this.origin.applyMatrix4(t),this.direction.transformDirection(t),this},equals:function(t){return t.origin.equals(this.origin)&&t.direction.equals(this.direction)}}),Object.assign(K.prototype,{set:function(t,e){return this.start.copy(t),this.end.copy(e),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.start.copy(t.start),this.end.copy(t.end),this},getCenter:function(t){return void 0===t&&(console.warn("THREE.Line3: .getCenter() target is now required"),t=new s),t.addVectors(this.start,this.end).multiplyScalar(.5)},delta:function(t){return void 0===t&&(console.warn("THREE.Line3: .delta() target is now required"),t=new s),t.subVectors(this.end,this.start)},distanceSq:function(){return this.start.distanceToSquared(this.end)},distance:function(){return this.start.distanceTo(this.end)},at:function(t,e){return void 0===e&&(console.warn("THREE.Line3: .at() target is now required"),e=new s),this.delta(e).multiplyScalar(t).add(this.start)},closestPointToPointParameter:function(){var t=new s,e=new s;return function(n,r){t.subVectors(n,this.start),e.subVectors(this.end,this.start);var i=e.dot(e),o=e.dot(t),a=o/i;return r&&(a=Au.clamp(a,0,1)),a}}(),closestPointToPoint:function(t,e,n){var r=this.closestPointToPointParameter(t,e);return void 0===n&&(console.warn("THREE.Line3: .closestPointToPoint() target is now required"),n=new s),this.delta(n).multiplyScalar(r).add(this.start)},applyMatrix4:function(t){return this.start.applyMatrix4(t),this.end.applyMatrix4(t),this},equals:function(t){return t.start.equals(this.start)&&t.end.equals(this.end)}}),Object.assign(Q,{getNormal:function(){var t=new s;return function(e,n,r,i){void 0===i&&(console.warn("THREE.Triangle: .getNormal() target is now required"),i=new s),i.subVectors(r,n),t.subVectors(e,n),i.cross(t);var o=i.lengthSq();return o>0?i.multiplyScalar(1/Math.sqrt(o)):i.set(0,0,0)}}(),getBarycoord:function(){var t=new s,e=new s,n=new s;return function(r,i,o,a,u){t.subVectors(a,i),e.subVectors(o,i),n.subVectors(r,i);var c=t.dot(t),l=t.dot(e),h=t.dot(n),f=e.dot(e),d=e.dot(n),p=c*f-l*l;if(void 0===u&&(console.warn("THREE.Triangle: .getBarycoord() target is now required"),u=new s),0===p)return u.set(-2,-1,-1);var m=1/p,g=(f*h-l*d)*m,v=(c*d-l*h)*m;return u.set(1-g-v,v,g)}}(),containsPoint:function(){var t=new s;return function(e,n,r,i){return Q.getBarycoord(e,n,r,i,t),t.x>=0&&t.y>=0&&t.x+t.y<=1}}()}),Object.assign(Q.prototype,{set:function(t,e,n){return this.a.copy(t),this.b.copy(e),this.c.copy(n),this},setFromPointsAndIndices:function(t,e,n,r){return this.a.copy(t[e]),this.b.copy(t[n]),this.c.copy(t[r]),this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.a.copy(t.a),this.b.copy(t.b),this.c.copy(t.c),this},getArea:function(){var t=new s,e=new s;return function(){return t.subVectors(this.c,this.b),e.subVectors(this.a,this.b),.5*t.cross(e).length()}}(),getMidpoint:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getMidpoint() target is now required"),t=new s),t.addVectors(this.a,this.b).add(this.c).multiplyScalar(1/3)},getNormal:function(t){return Q.getNormal(this.a,this.b,this.c,t)},getPlane:function(t){return void 0===t&&(console.warn("THREE.Triangle: .getPlane() target is now required"),t=new s),t.setFromCoplanarPoints(this.a,this.b,this.c)},getBarycoord:function(t,e){return Q.getBarycoord(t,this.a,this.b,this.c,e)},containsPoint:function(t){return Q.containsPoint(t,this.a,this.b,this.c)},intersectsBox:function(t){return t.intersectsTriangle(this)},closestPointToPoint:function(){var t=new g,e=[new K,new K,new K],n=new s,r=new s;return function(i,o){void 0===o&&(console.warn("THREE.Triangle: .closestPointToPoint() target is now required"),o=new s);var a=1/0;if(t.setFromCoplanarPoints(this.a,this.b,this.c),t.projectPoint(i,n),!0===this.containsPoint(n))o.copy(n);else{e[0].set(this.a,this.b),e[1].set(this.b,this.c),e[2].set(this.c,this.a);for(var u=0;u<e.length;u++){e[u].closestPointToPoint(n,!0,r);var c=n.distanceToSquared(r);c<a&&(a=c,o.copy(r))}}return o}}(),equals:function(t){return t.a.equals(this.a)&&t.b.equals(this.b)&&t.c.equals(this.c)}}),X.prototype=Object.assign(Object.create(E.prototype),{constructor:X,isMesh:!0,setDrawMode:function(t){this.drawMode=t},copy:function(t){return E.prototype.copy.call(this,t),this.drawMode=t.drawMode,void 0!==t.morphTargetInfluences&&(this.morphTargetInfluences=t.morphTargetInfluences.slice()),void 0!==t.morphTargetDictionary&&(this.morphTargetDictionary=Object.assign({},t.morphTargetDictionary)),this},updateMorphTargets:function(){var t,e,n,r=this.geometry;if(r.isBufferGeometry){var i=r.morphAttributes,o=Object.keys(i);if(o.length>0){var a=i[o[0]];if(void 0!==a)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=a.length;t<e;t++)n=a[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}}else{var s=r.morphTargets;if(void 0!==s&&s.length>0)for(this.morphTargetInfluences=[],this.morphTargetDictionary={},t=0,e=s.length;t<e;t++)n=s[t].name||String(t),this.morphTargetInfluences.push(0),this.morphTargetDictionary[n]=t}},raycast:function(){function t(t,e,n,r,i,o,a){return Q.getBarycoord(t,e,n,r,_),i.multiplyScalar(_.x),o.multiplyScalar(_.y),a.multiplyScalar(_.z),i.add(o).add(a),i.clone()}function e(t,e,n,r,i,o,a,s){if(null===(e.side===ca?r.intersectTriangle(a,o,i,!0,s):r.intersectTriangle(i,o,a,e.side!==la,s)))return null;w.copy(s),w.applyMatrix4(t.matrixWorld);var u=n.ray.origin.distanceTo(w);return u<n.near||u>n.far?null:{distance:u,point:w.clone(),object:t}}function n(n,r,i,o,a,s,u,f){c.fromBufferAttribute(o,s),l.fromBufferAttribute(o,u),h.fromBufferAttribute(o,f);var d=e(n,n.material,r,i,c,l,h,b);if(d){a&&(g.fromBufferAttribute(a,s),v.fromBufferAttribute(a,u),y.fromBufferAttribute(a,f),d.uv=t(b,c,l,h,g,v,y));var p=new S(s,u,f);Q.getNormal(c,l,h,p.normal),d.face=p,d.faceIndex=s}return d}var r=new o,a=new Y,u=new m,c=new s,l=new s,h=new s,f=new s,d=new s,p=new s,g=new i,v=new i,y=new i,_=new s,b=new s,w=new s;return function(i,o){var s=this.geometry,m=this.material,_=this.matrixWorld;if(void 0!==m&&(null===s.boundingSphere&&s.computeBoundingSphere(),u.copy(s.boundingSphere),u.applyMatrix4(_),!1!==i.ray.intersectsSphere(u)&&(r.getInverse(_),a.copy(i.ray).applyMatrix4(r),null===s.boundingBox||!1!==a.intersectsBox(s.boundingBox)))){var w;if(s.isBufferGeometry){var E,x,T,S,C,M=s.index,A=s.attributes.position,I=s.attributes.uv;if(null!==M)for(S=0,C=M.count;S<C;S+=3)E=M.getX(S),x=M.getX(S+1),T=M.getX(S+2),(w=n(this,i,a,A,I,E,x,T))&&(w.faceIndex=Math.floor(S/3),o.push(w));else if(void 0!==A)for(S=0,C=A.count;S<C;S+=3)E=S,x=S+1,T=S+2,(w=n(this,i,a,A,I,E,x,T))&&o.push(w)}else if(s.isGeometry){var R,P,N,D,O=Array.isArray(m),k=s.vertices,L=s.faces,U=s.faceVertexUvs[0];U.length>0&&(D=U);for(var F=0,B=L.length;F<B;F++){var V=L[F],j=O?m[V.materialIndex]:m;if(void 0!==j){if(R=k[V.a],P=k[V.b],N=k[V.c],!0===j.morphTargets){var H=s.morphTargets,G=this.morphTargetInfluences;c.set(0,0,0),l.set(0,0,0),h.set(0,0,0);for(var z=0,W=H.length;z<W;z++){var q=G[z];if(0!==q){var Y=H[z].vertices;c.addScaledVector(f.subVectors(Y[V.a],R),q),l.addScaledVector(d.subVectors(Y[V.b],P),q),h.addScaledVector(p.subVectors(Y[V.c],N),q)}}c.add(R),l.add(P),h.add(N),R=c,P=l,N=h}if(w=e(this,j,i,a,R,P,N,b)){if(D&&D[F]){var K=D[F];g.copy(K[0]),v.copy(K[1]),y.copy(K[2]),w.uv=t(b,R,P,N,g,v,y)}w.face=V,w.faceIndex=F,o.push(w)}}}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ut.prototype=Object.create(c.prototype),ut.prototype.constructor=ut,ut.prototype.isCubeTexture=!0,Object.defineProperty(ut.prototype,"images",{get:function(){return this.image},set:function(t){this.image=t}});var Bu=new c,Vu=new ut,ju=[],Hu=[],Gu=new Float32Array(16),zu=new Float32Array(9);Bt.prototype.setValue=function(t,e){for(var n=this.seq,r=0,i=n.length;r!==i;++r){var o=n[r];o.setValue(t,e[o.id])}};var Wu=/([\w\d_]+)(\])?(\[|\.)?/g;Ht.prototype.setValue=function(t,e,n){var r=this.map[e];void 0!==r&&r.setValue(t,n,this.renderer)},Ht.prototype.setOptional=function(t,e,n){var r=e[n];void 0!==r&&this.setValue(t,n,r)},Ht.upload=function(t,e,n,r){for(var i=0,o=e.length;i!==o;++i){var a=e[i],s=n[a.id];!1!==s.needsUpdate&&a.setValue(t,s.value,r)}},Ht.seqWithValue=function(t,e){for(var n=[],r=0,i=t.length;r!==i;++r){var o=t[r];o.id in e&&n.push(o)}return n};var qu=0,Yu=0;pe.prototype=Object.create(z.prototype),pe.prototype.constructor=pe,pe.prototype.isMeshDepthMaterial=!0,pe.prototype.copy=function(t){return z.prototype.copy.call(this,t),this.depthPacking=t.depthPacking,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this},me.prototype=Object.create(z.prototype),me.prototype.constructor=me,me.prototype.isMeshDistanceMaterial=!0,me.prototype.copy=function(t){return z.prototype.copy.call(this,t),this.referencePosition.copy(t.referencePosition),this.nearDistance=t.nearDistance,this.farDistance=t.farDistance,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.map=t.map,this.alphaMap=t.alphaMap,this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this},ve.prototype=Object.create(c.prototype),ve.prototype.constructor=ve,Ee.prototype=Object.assign(Object.create(x.prototype),{constructor:Ee,isPerspectiveCamera:!0,copy:function(t,e){return x.prototype.copy.call(this,t,e),this.fov=t.fov,this.zoom=t.zoom,this.near=t.near,this.far=t.far,this.focus=t.focus,this.aspect=t.aspect,this.view=null===t.view?null:Object.assign({},t.view),this.filmGauge=t.filmGauge,this.filmOffset=t.filmOffset,this},setFocalLength:function(t){var e=.5*this.getFilmHeight()/t;this.fov=2*Au.RAD2DEG*Math.atan(e),this.updateProjectionMatrix()},getFocalLength:function(){var t=Math.tan(.5*Au.DEG2RAD*this.fov);return.5*this.getFilmHeight()/t},getEffectiveFOV:function(){return 2*Au.RAD2DEG*Math.atan(Math.tan(.5*Au.DEG2RAD*this.fov)/this.zoom)},getFilmWidth:function(){return this.filmGauge*Math.min(this.aspect,1)},getFilmHeight:function(){return this.filmGauge/Math.max(this.aspect,1)},setViewOffset:function(t,e,n,r,i,o){this.aspect=t/e,null===this.view&&(this.view={enabled:!0,fullWidth:1,fullHeight:1,offsetX:0,offsetY:0,width:1,height:1}),this.view.enabled=!0,this.view.fullWidth=t,this.view.fullHeight=e,this.view.offsetX=n,this.view.offsetY=r,this.view.width=i,this.view.height=o,this.updateProjectionMatrix()},clearViewOffset:function(){null!==this.view&&(this.view.enabled=!1),this.updateProjectionMatrix()},updateProjectionMatrix:function(){var t=this.near,e=t*Math.tan(.5*Au.DEG2RAD*this.fov)/this.zoom,n=2*e,r=this.aspect*n,i=-.5*r,o=this.view;if(null!==this.view&&this.view.enabled){var a=o.fullWidth,s=o.fullHeight;i+=o.offsetX*r/a,e-=o.offsetY*n/s,r*=o.width/a,n*=o.height/s}var u=this.filmOffset;0!==u&&(i+=t*u/this.getFilmWidth()),this.projectionMatrix.makePerspective(i,i+r,e,e-n,t,this.far)},toJSON:function(t){var e=E.prototype.toJSON.call(this,t);return e.object.fov=this.fov,e.object.zoom=this.zoom,e.object.near=this.near,e.object.far=this.far,e.object.focus=this.focus,e.object.aspect=this.aspect,null!==this.view&&(e.object.view=Object.assign({},this.view)),e.object.filmGauge=this.filmGauge,e.object.filmOffset=this.filmOffset,e}}),xe.prototype=Object.assign(Object.create(Ee.prototype),{constructor:xe,isArrayCamera:!0}),Ce.prototype.isFogExp2=!0,Ce.prototype.clone=function(){return new Ce(this.color.getHex(),this.density)},Ce.prototype.toJSON=function(){return{type:"FogExp2",color:this.color.getHex(),density:this.density}},Me.prototype.isFog=!0,Me.prototype.clone=function(){return new Me(this.color.getHex(),this.near,this.far)},Me.prototype.toJSON=function(){return{type:"Fog",color:this.color.getHex(),near:this.near,far:this.far}},Ae.prototype=Object.assign(Object.create(E.prototype),{constructor:Ae,copy:function(t,e){return E.prototype.copy.call(this,t,e),null!==t.background&&(this.background=t.background.clone()),null!==t.fog&&(this.fog=t.fog.clone()),null!==t.overrideMaterial&&(this.overrideMaterial=t.overrideMaterial.clone()),this.autoUpdate=t.autoUpdate,this.matrixAutoUpdate=t.matrixAutoUpdate,this},toJSON:function(t){var e=E.prototype.toJSON.call(this,t);return null!==this.background&&(e.object.background=this.background.toJSON(t)),null!==this.fog&&(e.object.fog=this.fog.toJSON()),e}}),Ie.prototype=Object.create(z.prototype),Ie.prototype.constructor=Ie,Ie.prototype.isSpriteMaterial=!0,Ie.prototype.copy=function(t){return z.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.rotation=t.rotation,this},Re.prototype=Object.assign(Object.create(E.prototype),{constructor:Re,isSprite:!0,raycast:function(){var t=new s,e=new s,n=new s;return function(r,i){e.setFromMatrixPosition(this.matrixWorld),r.ray.closestPointToPoint(e,t),n.setFromMatrixScale(this.matrixWorld);var o=n.x*n.y/4;if(!(e.distanceToSquared(t)>o)){var a=r.ray.origin.distanceTo(t);a<r.near||a>r.far||i.push({distance:a,point:t.clone(),face:null,object:this})}}}(),clone:function(){return new this.constructor(this.material).copy(this)},copy:function(t){return E.prototype.copy.call(this,t),void 0!==t.center&&this.center.copy(t.center),this}}),Pe.prototype=Object.assign(Object.create(E.prototype),{constructor:Pe,copy:function(t){E.prototype.copy.call(this,t,!1);for(var e=t.levels,n=0,r=e.length;n<r;n++){var i=e[n];this.addLevel(i.object.clone(),i.distance)}return this},addLevel:function(t,e){void 0===e&&(e=0),e=Math.abs(e);for(var n=this.levels,r=0;r<n.length&&!(e<n[r].distance);r++);n.splice(r,0,{distance:e,object:t}),this.add(t)},getObjectForDistance:function(t){for(var e=this.levels,n=1,r=e.length;n<r&&!(t<e[n].distance);n++);return e[n-1].object},raycast:function(){var t=new s;return function(e,n){t.setFromMatrixPosition(this.matrixWorld);var r=e.ray.origin.distanceTo(t);this.getObjectForDistance(r).raycast(e,n)}}(),update:function(){var t=new s,e=new s;return function(n){var r=this.levels;if(r.length>1){t.setFromMatrixPosition(n.matrixWorld),e.setFromMatrixPosition(this.matrixWorld);var i=t.distanceTo(e);r[0].object.visible=!0;for(var o=1,a=r.length;o<a&&i>=r[o].distance;o++)r[o-1].object.visible=!1,r[o].object.visible=!0;for(;o<a;o++)r[o].object.visible=!1}}}(),toJSON:function(t){var e=E.prototype.toJSON.call(this,t);e.object.levels=[];for(var n=this.levels,r=0,i=n.length;r<i;r++){var o=n[r];e.object.levels.push({object:o.object.uuid,distance:o.distance})}return e}}),Object.assign(Ne.prototype,{calculateInverses:function(){this.boneInverses=[];for(var t=0,e=this.bones.length;t<e;t++){var n=new o;this.bones[t]&&n.getInverse(this.bones[t].matrixWorld),this.boneInverses.push(n)}},pose:function(){var t,e,n;for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&t.matrixWorld.getInverse(this.boneInverses[e]);for(e=0,n=this.bones.length;e<n;e++)(t=this.bones[e])&&(t.parent&&t.parent.isBone?(t.matrix.getInverse(t.parent.matrixWorld),t.matrix.multiply(t.matrixWorld)):t.matrix.copy(t.matrixWorld),t.matrix.decompose(t.position,t.quaternion,t.scale))},update:function(){var t=new o,e=new o;return function(){for(var n=this.bones,r=this.boneInverses,i=this.boneMatrices,o=this.boneTexture,a=0,s=n.length;a<s;a++){var u=n[a]?n[a].matrixWorld:e;t.multiplyMatrices(u,r[a]),t.toArray(i,16*a)}void 0!==o&&(o.needsUpdate=!0)}}(),clone:function(){return new Ne(this.bones,this.boneInverses)},getBoneByName:function(t){for(var e=0,n=this.bones.length;e<n;e++){var r=this.bones[e];if(r.name===t)return r}}}),De.prototype=Object.assign(Object.create(E.prototype),{constructor:De,isBone:!0}),Oe.prototype=Object.assign(Object.create(X.prototype),{constructor:Oe,isSkinnedMesh:!0,initBones:function(){var t,e,n,r,i=[];if(this.geometry&&void 0!==this.geometry.bones){for(n=0,r=this.geometry.bones.length;n<r;n++)e=this.geometry.bones[n],t=new De,i.push(t),t.name=e.name,t.position.fromArray(e.pos),t.quaternion.fromArray(e.rotq),void 0!==e.scl&&t.scale.fromArray(e.scl);for(n=0,r=this.geometry.bones.length;n<r;n++)e=this.geometry.bones[n],-1!==e.parent&&null!==e.parent&&void 0!==i[e.parent]?i[e.parent].add(i[n]):this.add(i[n])}return this.updateMatrixWorld(!0),i},bind:function(t,e){this.skeleton=t,void 0===e&&(this.updateMatrixWorld(!0),this.skeleton.calculateInverses(),e=this.matrixWorld),this.bindMatrix.copy(e),this.bindMatrixInverse.getInverse(e)},pose:function(){this.skeleton.pose()},normalizeSkinWeights:function(){var t,e;if(this.geometry&&this.geometry.isGeometry)for(e=0;e<this.geometry.skinWeights.length;e++){var n=this.geometry.skinWeights[e];t=1/n.manhattanLength(),t!==1/0?n.multiplyScalar(t):n.set(1,0,0,0)}else if(this.geometry&&this.geometry.isBufferGeometry){var r=new l,i=this.geometry.attributes.skinWeight;for(e=0;e<i.count;e++)r.x=i.getX(e),r.y=i.getY(e),r.z=i.getZ(e),r.w=i.getW(e),t=1/r.manhattanLength(),t!==1/0?r.multiplyScalar(t):r.set(1,0,0,0),i.setXYZW(e,r.x,r.y,r.z,r.w)}},updateMatrixWorld:function(t){X.prototype.updateMatrixWorld.call(this,t),"attached"===this.bindMode?this.bindMatrixInverse.getInverse(this.matrixWorld):"detached"===this.bindMode?this.bindMatrixInverse.getInverse(this.bindMatrix):console.warn("THREE.SkinnedMesh: Unrecognized bindMode: "+this.bindMode)},clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),ke.prototype=Object.create(z.prototype),ke.prototype.constructor=ke,ke.prototype.isLineBasicMaterial=!0,ke.prototype.copy=function(t){return z.prototype.copy.call(this,t),this.color.copy(t.color),this.linewidth=t.linewidth,this.linecap=t.linecap,this.linejoin=t.linejoin,this},Le.prototype=Object.assign(Object.create(E.prototype),{constructor:Le,isLine:!0,computeLineDistances:function(){var t=new s,e=new s;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var r=n.attributes.position,i=[0],o=1,a=r.count;o<a;o++)t.fromBufferAttribute(r,o-1),e.fromBufferAttribute(r,o),i[o]=i[o-1],i[o]+=t.distanceTo(e);n.addAttribute("lineDistance",new k(i,1))}else console.warn("THREE.Line.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry){var s=n.vertices,i=n.lineDistances;i[0]=0;for(var o=1,a=s.length;o<a;o++)i[o]=i[o-1],i[o]+=s[o-1].distanceTo(s[o])}return this}}(),raycast:function(){var t=new o,e=new Y,n=new m;return function(r,i){var o=r.linePrecision,a=o*o,u=this.geometry,c=this.matrixWorld;if(null===u.boundingSphere&&u.computeBoundingSphere(),n.copy(u.boundingSphere),n.applyMatrix4(c),!1!==r.ray.intersectsSphere(n)){t.getInverse(c),e.copy(r.ray).applyMatrix4(t);var l=new s,h=new s,f=new s,d=new s,p=this&&this.isLineSegments?2:1;if(u.isBufferGeometry){var m=u.index,g=u.attributes,v=g.position.array;if(null!==m)for(var y=m.array,_=0,b=y.length-1;_<b;_+=p){var w=y[_],E=y[_+1];l.fromArray(v,3*w),h.fromArray(v,3*E);var x=e.distanceSqToSegment(l,h,d,f);if(!(x>a)){d.applyMatrix4(this.matrixWorld);var T=r.ray.origin.distanceTo(d);T<r.near||T>r.far||i.push({distance:T,point:f.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}else for(var _=0,b=v.length/3-1;_<b;_+=p){l.fromArray(v,3*_),h.fromArray(v,3*_+3);var x=e.distanceSqToSegment(l,h,d,f);if(!(x>a)){d.applyMatrix4(this.matrixWorld);var T=r.ray.origin.distanceTo(d);T<r.near||T>r.far||i.push({distance:T,point:f.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}else if(u.isGeometry)for(var S=u.vertices,C=S.length,_=0;_<C-1;_+=p){var x=e.distanceSqToSegment(S[_],S[_+1],d,f);if(!(x>a)){d.applyMatrix4(this.matrixWorld);var T=r.ray.origin.distanceTo(d);T<r.near||T>r.far||i.push({distance:T,point:f.clone().applyMatrix4(this.matrixWorld),index:_,face:null,faceIndex:null,object:this})}}}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),Ue.prototype=Object.assign(Object.create(Le.prototype),{constructor:Ue,isLineSegments:!0,computeLineDistances:function(){var t=new s,e=new s;return function(){var n=this.geometry;if(n.isBufferGeometry)if(null===n.index){for(var r=n.attributes.position,i=[],o=0,a=r.count;o<a;o+=2)t.fromBufferAttribute(r,o),e.fromBufferAttribute(r,o+1),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+t.distanceTo(e);n.addAttribute("lineDistance",new k(i,1))}else console.warn("THREE.LineSegments.computeLineDistances(): Computation only possible with non-indexed BufferGeometry.");else if(n.isGeometry)for(var s=n.vertices,i=n.lineDistances,o=0,a=s.length;o<a;o+=2)t.copy(s[o]),e.copy(s[o+1]),i[o]=0===o?0:i[o-1],i[o+1]=i[o]+t.distanceTo(e);return this}}()}),Fe.prototype=Object.assign(Object.create(Le.prototype),{constructor:Fe,isLineLoop:!0}),Be.prototype=Object.create(z.prototype),Be.prototype.constructor=Be,Be.prototype.isPointsMaterial=!0,Be.prototype.copy=function(t){return z.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.size=t.size,this.sizeAttenuation=t.sizeAttenuation,this},Ve.prototype=Object.assign(Object.create(E.prototype),{constructor:Ve,isPoints:!0,raycast:function(){var t=new o,e=new Y,n=new m;return function(r,i){function o(t,n){var o=e.distanceSqToPoint(t);if(o<f){e.closestPointToPoint(t,p),p.applyMatrix4(c);var s=r.ray.origin.distanceTo(p);if(s<r.near||s>r.far)return;i.push({distance:s,distanceToRay:Math.sqrt(o),point:p.clone(),index:n,face:null,object:a})}}var a=this,u=this.geometry,c=this.matrixWorld,l=r.params.Points.threshold;if(null===u.boundingSphere&&u.computeBoundingSphere(),n.copy(u.boundingSphere),n.applyMatrix4(c),n.radius+=l,!1!==r.ray.intersectsSphere(n)){t.getInverse(c),e.copy(r.ray).applyMatrix4(t);var h=l/((this.scale.x+this.scale.y+this.scale.z)/3),f=h*h,d=new s,p=new s;if(u.isBufferGeometry){var m=u.index,g=u.attributes,v=g.position.array;if(null!==m)for(var y=m.array,_=0,b=y.length;_<b;_++){var w=y[_];d.fromArray(v,3*w),o(d,w)}else for(var _=0,E=v.length/3;_<E;_++)d.fromArray(v,3*_),o(d,_)}else for(var x=u.vertices,_=0,E=x.length;_<E;_++)o(x[_],_)}}}(),clone:function(){return new this.constructor(this.geometry,this.material).copy(this)}}),je.prototype=Object.assign(Object.create(E.prototype),{constructor:je,isGroup:!0}),He.prototype=Object.assign(Object.create(c.prototype),{constructor:He,isVideoTexture:!0,update:function(){var t=this.image;t.readyState>=t.HAVE_CURRENT_DATA&&(this.needsUpdate=!0)}}),Ge.prototype=Object.create(c.prototype),Ge.prototype.constructor=Ge,Ge.prototype.isCompressedTexture=!0,ze.prototype=Object.create(c.prototype),ze.prototype.constructor=ze,ze.prototype.isDepthTexture=!0,We.prototype=Object.create(B.prototype),We.prototype.constructor=We,qe.prototype=Object.create(C.prototype),qe.prototype.constructor=qe,Ye.prototype=Object.create(B.prototype),Ye.prototype.constructor=Ye,Ke.prototype=Object.create(C.prototype),Ke.prototype.constructor=Ke,Qe.prototype=Object.create(B.prototype),Qe.prototype.constructor=Qe,Xe.prototype=Object.create(C.prototype),Xe.prototype.constructor=Xe,Je.prototype=Object.create(Qe.prototype),Je.prototype.constructor=Je,Ze.prototype=Object.create(C.prototype),Ze.prototype.constructor=Ze,$e.prototype=Object.create(Qe.prototype),$e.prototype.constructor=$e,tn.prototype=Object.create(C.prototype),tn.prototype.constructor=tn,en.prototype=Object.create(Qe.prototype),en.prototype.constructor=en,nn.prototype=Object.create(C.prototype),nn.prototype.constructor=nn,rn.prototype=Object.create(Qe.prototype),rn.prototype.constructor=rn,on.prototype=Object.create(C.prototype),on.prototype.constructor=on,an.prototype=Object.create(B.prototype),an.prototype.constructor=an,sn.prototype=Object.create(C.prototype),sn.prototype.constructor=sn,un.prototype=Object.create(B.prototype),un.prototype.constructor=un,cn.prototype=Object.create(C.prototype),cn.prototype.constructor=cn,ln.prototype=Object.create(B.prototype),ln.prototype.constructor=ln;var Ku={triangulate:function(t,e,n){n=n||2;var r=e&&e.length,i=r?e[0]*n:t.length,o=hn(t,0,i,n,!0),a=[];if(!o)return a;var s,u,c,l,h,f,d;if(r&&(o=yn(t,e,o,n)),t.length>80*n){s=c=t[0],u=l=t[1];for(var p=n;p<i;p+=n)h=t[p],f=t[p+1],h<s&&(s=h),f<u&&(u=f),h>c&&(c=h),f>l&&(l=f);d=Math.max(c-s,l-u),d=0!==d?1/d:0}return dn(o,a,n,s,u,d),a}},Qu={area:function(t){for(var e=t.length,n=0,r=e-1,i=0;i<e;r=i++)n+=t[r].x*t[i].y-t[i].x*t[r].y;return.5*n},isClockWise:function(t){return Qu.area(t)<0},triangulateShape:function(t,e){var n=[],r=[],i=[];Bn(t),Vn(n,t);var o=t.length;e.forEach(Bn);for(var a=0;a<e.length;a++)r.push(o),o+=e[a].length,Vn(n,e[a]);for(var s=Ku.triangulate(n,r),a=0;a<s.length;a+=3)i.push(s.slice(a,a+3));return i}};jn.prototype=Object.create(C.prototype),jn.prototype.constructor=jn,Hn.prototype=Object.create(B.prototype),Hn.prototype.constructor=Hn;var Xu={generateTopUV:function(t,e,n,r,o){var a=e[3*n],s=e[3*n+1],u=e[3*r],c=e[3*r+1],l=e[3*o],h=e[3*o+1];return[new i(a,s),new i(u,c),new i(l,h)]},generateSideWallUV:function(t,e,n,r,o,a){var s=e[3*n],u=e[3*n+1],c=e[3*n+2],l=e[3*r],h=e[3*r+1],f=e[3*r+2],d=e[3*o],p=e[3*o+1],m=e[3*o+2],g=e[3*a],v=e[3*a+1],y=e[3*a+2];return Math.abs(u-h)<.01?[new i(s,1-c),new i(l,1-f),new i(d,1-m),new i(g,1-y)]:[new i(u,1-c),new i(h,1-f),new i(p,1-m),new i(v,1-y)]}};Gn.prototype=Object.create(C.prototype),Gn.prototype.constructor=Gn,zn.prototype=Object.create(Hn.prototype),zn.prototype.constructor=zn,Wn.prototype=Object.create(C.prototype),Wn.prototype.constructor=Wn,qn.prototype=Object.create(B.prototype),qn.prototype.constructor=qn,Yn.prototype=Object.create(C.prototype),Yn.prototype.constructor=Yn,Kn.prototype=Object.create(B.prototype),Kn.prototype.constructor=Kn,Qn.prototype=Object.create(C.prototype),Qn.prototype.constructor=Qn,Xn.prototype=Object.create(B.prototype),Xn.prototype.constructor=Xn,Jn.prototype=Object.create(C.prototype),Jn.prototype.constructor=Jn,Jn.prototype.toJSON=function(){var t=C.prototype.toJSON.call(this);return $n(this.parameters.shapes,t)},Zn.prototype=Object.create(B.prototype),Zn.prototype.constructor=Zn,Zn.prototype.toJSON=function(){var t=B.prototype.toJSON.call(this);return $n(this.parameters.shapes,t)},tr.prototype=Object.create(B.prototype),tr.prototype.constructor=tr,er.prototype=Object.create(C.prototype),er.prototype.constructor=er,nr.prototype=Object.create(B.prototype),nr.prototype.constructor=nr,rr.prototype=Object.create(er.prototype),rr.prototype.constructor=rr,ir.prototype=Object.create(nr.prototype),ir.prototype.constructor=ir,or.prototype=Object.create(C.prototype),or.prototype.constructor=or,ar.prototype=Object.create(B.prototype),ar.prototype.constructor=ar;var Ju=Object.freeze({WireframeGeometry:We,ParametricGeometry:qe,ParametricBufferGeometry:Ye,TetrahedronGeometry:Xe,TetrahedronBufferGeometry:Je,OctahedronGeometry:Ze,OctahedronBufferGeometry:$e,IcosahedronGeometry:tn,IcosahedronBufferGeometry:en,DodecahedronGeometry:nn,DodecahedronBufferGeometry:rn,PolyhedronGeometry:Ke,PolyhedronBufferGeometry:Qe,TubeGeometry:on,TubeBufferGeometry:an,TorusKnotGeometry:sn,TorusKnotBufferGeometry:un,TorusGeometry:cn,TorusBufferGeometry:ln,TextGeometry:Gn,TextBufferGeometry:zn,SphereGeometry:Wn,SphereBufferGeometry:qn,RingGeometry:Yn,RingBufferGeometry:Kn,PlaneGeometry:H,PlaneBufferGeometry:G,LatheGeometry:Qn,LatheBufferGeometry:Xn,ShapeGeometry:Jn,ShapeBufferGeometry:Zn,ExtrudeGeometry:jn,ExtrudeBufferGeometry:Hn,EdgesGeometry:tr,ConeGeometry:rr,ConeBufferGeometry:ir,CylinderGeometry:er,CylinderBufferGeometry:nr,CircleGeometry:or,CircleBufferGeometry:ar,BoxGeometry:V,BoxBufferGeometry:j});sr.prototype=Object.create(z.prototype),sr.prototype.constructor=sr,sr.prototype.isShadowMaterial=!0,sr.prototype.copy=function(t){return z.prototype.copy.call(this,t),this.color.copy(t.color),this},ur.prototype=Object.create(q.prototype),ur.prototype.constructor=ur,ur.prototype.isRawShaderMaterial=!0,cr.prototype=Object.create(z.prototype),cr.prototype.constructor=cr,cr.prototype.isMeshStandardMaterial=!0,cr.prototype.copy=function(t){return z.prototype.copy.call(this,t),this.defines={STANDARD:""},this.color.copy(t.color),this.roughness=t.roughness,this.metalness=t.metalness,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.roughnessMap=t.roughnessMap,this.metalnessMap=t.metalnessMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.envMapIntensity=t.envMapIntensity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},lr.prototype=Object.create(cr.prototype),lr.prototype.constructor=lr,lr.prototype.isMeshPhysicalMaterial=!0,lr.prototype.copy=function(t){return cr.prototype.copy.call(this,t),this.defines={PHYSICAL:""},this.reflectivity=t.reflectivity,this.clearCoat=t.clearCoat,this.clearCoatRoughness=t.clearCoatRoughness,this},hr.prototype=Object.create(z.prototype),hr.prototype.constructor=hr,hr.prototype.isMeshPhongMaterial=!0,hr.prototype.copy=function(t){return z.prototype.copy.call(this,t),this.color.copy(t.color),this.specular.copy(t.specular),this.shininess=t.shininess,this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},fr.prototype=Object.create(hr.prototype),fr.prototype.constructor=fr,fr.prototype.isMeshToonMaterial=!0,fr.prototype.copy=function(t){return hr.prototype.copy.call(this,t),this.gradientMap=t.gradientMap,this},dr.prototype=Object.create(z.prototype),dr.prototype.constructor=dr,dr.prototype.isMeshNormalMaterial=!0,dr.prototype.copy=function(t){return z.prototype.copy.call(this,t),this.bumpMap=t.bumpMap,this.bumpScale=t.bumpScale,this.normalMap=t.normalMap,this.normalScale.copy(t.normalScale),this.displacementMap=t.displacementMap,this.displacementScale=t.displacementScale,this.displacementBias=t.displacementBias,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},pr.prototype=Object.create(z.prototype),pr.prototype.constructor=pr,pr.prototype.isMeshLambertMaterial=!0,pr.prototype.copy=function(t){return z.prototype.copy.call(this,t),this.color.copy(t.color),this.map=t.map,this.lightMap=t.lightMap,this.lightMapIntensity=t.lightMapIntensity,this.aoMap=t.aoMap,this.aoMapIntensity=t.aoMapIntensity,this.emissive.copy(t.emissive),this.emissiveMap=t.emissiveMap,this.emissiveIntensity=t.emissiveIntensity,this.specularMap=t.specularMap,this.alphaMap=t.alphaMap,this.envMap=t.envMap,this.combine=t.combine,this.reflectivity=t.reflectivity,this.refractionRatio=t.refractionRatio,this.wireframe=t.wireframe,this.wireframeLinewidth=t.wireframeLinewidth,this.wireframeLinecap=t.wireframeLinecap,this.wireframeLinejoin=t.wireframeLinejoin,this.skinning=t.skinning,this.morphTargets=t.morphTargets,this.morphNormals=t.morphNormals,this},mr.prototype=Object.create(ke.prototype),mr.prototype.constructor=mr,mr.prototype.isLineDashedMaterial=!0,mr.prototype.copy=function(t){return ke.prototype.copy.call(this,t),this.scale=t.scale,this.dashSize=t.dashSize,this.gapSize=t.gapSize,this};var Zu=Object.freeze({ShadowMaterial:sr,SpriteMaterial:Ie,RawShaderMaterial:ur,ShaderMaterial:q,PointsMaterial:Be,MeshPhysicalMaterial:lr,MeshStandardMaterial:cr,MeshPhongMaterial:hr,MeshToonMaterial:fr,MeshNormalMaterial:dr,MeshLambertMaterial:pr,MeshDepthMaterial:pe,MeshDistanceMaterial:me,MeshBasicMaterial:W,LineDashedMaterial:mr,LineBasicMaterial:ke,Material:z}),$u={enabled:!1,files:{},add:function(t,e){!1!==this.enabled&&(this.files[t]=e)},get:function(t){if(!1!==this.enabled)return this.files[t]},remove:function(t){delete this.files[t]},clear:function(){this.files={}}},tc=new gr,ec={};Object.assign(vr.prototype,{load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=$u.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;if(void 0!==ec[t])return void ec[t].push({onLoad:e,onProgress:n,onError:r});var a=/^data:(.*?)(;base64)?,(.*)$/,s=t.match(a);if(s){var u=s[1],c=!!s[2],l=s[3];l=window.decodeURIComponent(l),c&&(l=window.atob(l));try{var h,f=(this.responseType||"").toLowerCase();switch(f){case"arraybuffer":case"blob":for(var d=new Uint8Array(l.length),p=0;p<l.length;p++)d[p]=l.charCodeAt(p);h="blob"===f?new Blob([d.buffer],{type:u}):d.buffer;break;case"document":var m=new DOMParser;h=m.parseFromString(l,u);break;case"json":h=JSON.parse(l);break;default:h=l}window.setTimeout(function(){e&&e(h),i.manager.itemEnd(t)},0)}catch(e){window.setTimeout(function(){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)},0)}}else{ec[t]=[],ec[t].push({onLoad:e,onProgress:n,onError:r});var g=new XMLHttpRequest;g.open("GET",t,!0),g.addEventListener("load",function(e){var n=this.response;$u.add(t,n);var r=ec[t];if(delete ec[t],200===this.status){for(var o=0,a=r.length;o<a;o++){var s=r[o];s.onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else if(0===this.status){console.warn("THREE.FileLoader: HTTP Status 0 received.");for(var o=0,a=r.length;o<a;o++){var s=r[o];s.onLoad&&s.onLoad(n)}i.manager.itemEnd(t)}else{for(var o=0,a=r.length;o<a;o++){var s=r[o];s.onError&&s.onError(e)}i.manager.itemEnd(t),i.manager.itemError(t)}},!1),g.addEventListener("progress",function(e){for(var n=ec[t],r=0,i=n.length;r<i;r++){var o=n[r];o.onProgress&&o.onProgress(e)}},!1),g.addEventListener("error",function(e){var n=ec[t];delete ec[t];for(var r=0,o=n.length;r<o;r++){var a=n[r];a.onError&&a.onError(e)}i.manager.itemEnd(t),i.manager.itemError(t)},!1),void 0!==this.responseType&&(g.responseType=this.responseType),void 0!==this.withCredentials&&(g.withCredentials=this.withCredentials),g.overrideMimeType&&g.overrideMimeType(void 0!==this.mimeType?this.mimeType:"text/plain");for(var v in this.requestHeader)g.setRequestHeader(v,this.requestHeader[v]);g.send(null)}return i.manager.itemStart(t),g},setPath:function(t){return this.path=t,this},setResponseType:function(t){return this.responseType=t,this},setWithCredentials:function(t){return this.withCredentials=t,this},setMimeType:function(t){return this.mimeType=t,this},setRequestHeader:function(t){return this.requestHeader=t,this}}),Object.assign(yr.prototype,{load:function(t,e,n,r){var i=this,o=[],a=new Ge;a.image=o;var s=new vr(this.manager);if(s.setPath(this.path),s.setResponseType("arraybuffer"),Array.isArray(t))for(var u=0,c=0,l=t.length;c<l;++c)!function(c){s.load(t[c],function(t){var n=i._parser(t,!0);o[c]={width:n.width,height:n.height,format:n.format,mipmaps:n.mipmaps},6===(u+=1)&&(1===n.mipmapCount&&(a.minFilter=ps),a.format=n.format,a.needsUpdate=!0,e&&e(a))},n,r)}(c);else s.load(t,function(t){var n=i._parser(t,!0);if(n.isCubemap)for(var r=n.mipmaps.length/n.mipmapCount,s=0;s<r;s++){o[s]={mipmaps:[]};for(var u=0;u<n.mipmapCount;u++)o[s].mipmaps.push(n.mipmaps[s*n.mipmapCount+u]),o[s].format=n.format,o[s].width=n.width,o[s].height=n.height}else a.image.width=n.width,a.image.height=n.height,a.mipmaps=n.mipmaps;1===n.mipmapCount&&(a.minFilter=ps),a.format=n.format,a.needsUpdate=!0,e&&e(a)},n,r);return a},setPath:function(t){return this.path=t,this}}),Object.assign(_r.prototype,{load:function(t,e,n,r){var i=this,o=new d,a=new vr(this.manager);return a.setResponseType("arraybuffer"),a.load(t,function(t){var n=i._parser(t);n&&(void 0!==n.image?o.image=n.image:void 0!==n.data&&(o.image.width=n.width,o.image.height=n.height,o.image.data=n.data),o.wrapS=void 0!==n.wrapS?n.wrapS:cs,o.wrapT=void 0!==n.wrapT?n.wrapT:cs,o.magFilter=void 0!==n.magFilter?n.magFilter:ps,o.minFilter=void 0!==n.minFilter?n.minFilter:gs,o.anisotropy=void 0!==n.anisotropy?n.anisotropy:1,void 0!==n.format&&(o.format=n.format),void 0!==n.type&&(o.type=n.type),void 0!==n.mipmaps&&(o.mipmaps=n.mipmaps),1===n.mipmapCount&&(o.minFilter=ps),o.needsUpdate=!0,e&&e(o,n))},n,r),o}}),Object.assign(br.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t),t=this.manager.resolveURL(t);var i=this,o=$u.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;var a=document.createElementNS("http://www.w3.org/1999/xhtml","img");return a.addEventListener("load",function(){$u.add(t,this),e&&e(this),i.manager.itemEnd(t)},!1),a.addEventListener("error",function(e){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)},!1),"data:"!==t.substr(0,5)&&void 0!==this.crossOrigin&&(a.crossOrigin=this.crossOrigin),i.manager.itemStart(t),a.src=t,a},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(wr.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){var i=new ut,o=new br(this.manager);o.setCrossOrigin(this.crossOrigin),o.setPath(this.path);for(var a=0,s=0;s<t.length;++s)!function(n){o.load(t[n],function(t){i.images[n]=t,6===++a&&(i.needsUpdate=!0,e&&e(i))},void 0,r)}(s);return i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(Er.prototype,{crossOrigin:"Anonymous",load:function(t,e,n,r){var i=new c,o=new br(this.manager);return o.setCrossOrigin(this.crossOrigin),o.setPath(this.path),o.load(t,function(n){i.image=n;var r=t.search(/\.(jpg|jpeg)$/)>0||0===t.search(/^data\:image\/jpeg/);i.format=r?Rs:Ps,i.needsUpdate=!0,void 0!==e&&e(i)},n,r),i},setCrossOrigin:function(t){return this.crossOrigin=t,this},setPath:function(t){return this.path=t,this}}),Object.assign(xr.prototype,{getPoint:function(){return console.warn("THREE.Curve: .getPoint() not implemented."),null},getPointAt:function(t,e){var n=this.getUtoTmapping(t);return this.getPoint(n,e)},getPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return e},getSpacedPoints:function(t){void 0===t&&(t=5);for(var e=[],n=0;n<=t;n++)e.push(this.getPointAt(n/t));return e},getLength:function(){var t=this.getLengths();return t[t.length-1]},getLengths:function(t){if(void 0===t&&(t=this.arcLengthDivisions),this.cacheArcLengths&&this.cacheArcLengths.length===t+1&&!this.needsUpdate)return this.cacheArcLengths;this.needsUpdate=!1;var e,n,r=[],i=this.getPoint(0),o=0;for(r.push(0),n=1;n<=t;n++)e=this.getPoint(n/t),o+=e.distanceTo(i),r.push(o),i=e;return this.cacheArcLengths=r,r},updateArcLengths:function(){this.needsUpdate=!0,this.getLengths()},getUtoTmapping:function(t,e){var n,r=this.getLengths(),i=0,o=r.length;n=e||t*r[o-1];for(var a,s=0,u=o-1;s<=u;)if(i=Math.floor(s+(u-s)/2),(a=r[i]-n)<0)s=i+1;else{if(!(a>0)){u=i;break}u=i-1}if(i=u,r[i]===n)return i/(o-1);var c=r[i];return(i+(n-c)/(r[i+1]-c))/(o-1)},getTangent:function(t){var e=t-1e-4,n=t+1e-4;e<0&&(e=0),n>1&&(n=1);var r=this.getPoint(e);return this.getPoint(n).clone().sub(r).normalize()},getTangentAt:function(t){var e=this.getUtoTmapping(t);return this.getTangent(e)},computeFrenetFrames:function(t,e){var n,r,i,a=new s,u=[],c=[],l=[],h=new s,f=new o;for(n=0;n<=t;n++)r=n/t,u[n]=this.getTangentAt(r),u[n].normalize();c[0]=new s,l[0]=new s;var d=Number.MAX_VALUE,p=Math.abs(u[0].x),m=Math.abs(u[0].y),g=Math.abs(u[0].z);for(p<=d&&(d=p,a.set(1,0,0)),m<=d&&(d=m,a.set(0,1,0)),g<=d&&a.set(0,0,1),h.crossVectors(u[0],a).normalize(),c[0].crossVectors(u[0],h),l[0].crossVectors(u[0],c[0]),n=1;n<=t;n++)c[n]=c[n-1].clone(),l[n]=l[n-1].clone(),h.crossVectors(u[n-1],u[n]),h.length()>Number.EPSILON&&(h.normalize(),i=Math.acos(Au.clamp(u[n-1].dot(u[n]),-1,1)),c[n].applyMatrix4(f.makeRotationAxis(h,i))),l[n].crossVectors(u[n],c[n]);if(!0===e)for(i=Math.acos(Au.clamp(c[0].dot(c[t]),-1,1)),i/=t,u[0].dot(h.crossVectors(c[0],c[t]))>0&&(i=-i),n=1;n<=t;n++)c[n].applyMatrix4(f.makeRotationAxis(u[n],i*n)),l[n].crossVectors(u[n],c[n]);return{tangents:u,normals:c,binormals:l}},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this},toJSON:function(){var t={metadata:{version:4.5,type:"Curve",generator:"Curve.toJSON"}};return t.arcLengthDivisions=this.arcLengthDivisions,t.type=this.type,t},fromJSON:function(t){return this.arcLengthDivisions=t.arcLengthDivisions,this}}),Tr.prototype=Object.create(xr.prototype),Tr.prototype.constructor=Tr,Tr.prototype.isEllipseCurve=!0,Tr.prototype.getPoint=function(t,e){for(var n=e||new i,r=2*Math.PI,o=this.aEndAngle-this.aStartAngle,a=Math.abs(o)<Number.EPSILON;o<0;)o+=r;for(;o>r;)o-=r;o<Number.EPSILON&&(o=a?0:r),!0!==this.aClockwise||a||(o===r?o=-r:o-=r);var s=this.aStartAngle+t*o,u=this.aX+this.xRadius*Math.cos(s),c=this.aY+this.yRadius*Math.sin(s);if(0!==this.aRotation){var l=Math.cos(this.aRotation),h=Math.sin(this.aRotation),f=u-this.aX,d=c-this.aY;u=f*l-d*h+this.aX,c=f*h+d*l+this.aY}return n.set(u,c)},Tr.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Tr.prototype.toJSON=function(){var t=xr.prototype.toJSON.call(this);return t.aX=this.aX,t.aY=this.aY,t.xRadius=this.xRadius,t.yRadius=this.yRadius,t.aStartAngle=this.aStartAngle,t.aEndAngle=this.aEndAngle,t.aClockwise=this.aClockwise,t.aRotation=this.aRotation,t},Tr.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.aX=t.aX,this.aY=t.aY,this.xRadius=t.xRadius,this.yRadius=t.yRadius,this.aStartAngle=t.aStartAngle,this.aEndAngle=t.aEndAngle,this.aClockwise=t.aClockwise,this.aRotation=t.aRotation,this},Sr.prototype=Object.create(Tr.prototype),Sr.prototype.constructor=Sr,Sr.prototype.isArcCurve=!0;var nc=new s,rc=new Cr,ic=new Cr,oc=new Cr;Mr.prototype=Object.create(xr.prototype),Mr.prototype.constructor=Mr,Mr.prototype.isCatmullRomCurve3=!0,Mr.prototype.getPoint=function(t,e){var n=e||new s,r=this.points,i=r.length,o=(i-(this.closed?0:1))*t,a=Math.floor(o),u=o-a;this.closed?a+=a>0?0:(Math.floor(Math.abs(a)/i)+1)*i:0===u&&a===i-1&&(a=i-2,u=1);var c,l,h,f;if(this.closed||a>0?c=r[(a-1)%i]:(nc.subVectors(r[0],r[1]).add(r[0]),c=nc),l=r[a%i],h=r[(a+1)%i],this.closed||a+2<i?f=r[(a+2)%i]:(nc.subVectors(r[i-1],r[i-2]).add(r[i-1]),f=nc),"centripetal"===this.curveType||"chordal"===this.curveType){var d="chordal"===this.curveType?.5:.25,p=Math.pow(c.distanceToSquared(l),d),m=Math.pow(l.distanceToSquared(h),d),g=Math.pow(h.distanceToSquared(f),d);m<1e-4&&(m=1),p<1e-4&&(p=m),g<1e-4&&(g=m),rc.initNonuniformCatmullRom(c.x,l.x,h.x,f.x,p,m,g),ic.initNonuniformCatmullRom(c.y,l.y,h.y,f.y,p,m,g),oc.initNonuniformCatmullRom(c.z,l.z,h.z,f.z,p,m,g)}else"catmullrom"===this.curveType&&(rc.initCatmullRom(c.x,l.x,h.x,f.x,this.tension),ic.initCatmullRom(c.y,l.y,h.y,f.y,this.tension),oc.initCatmullRom(c.z,l.z,h.z,f.z,this.tension));return n.set(rc.calc(u),ic.calc(u),oc.calc(u)),n},Mr.prototype.copy=function(t){xr.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Mr.prototype.toJSON=function(){var t=xr.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t.closed=this.closed,t.curveType=this.curveType,t.tension=this.tension,t},Mr.prototype.fromJSON=function(t){xr.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new s).fromArray(r))}return this.closed=t.closed,this.curveType=t.curveType,this.tension=t.tension,this},Fr.prototype=Object.create(xr.prototype),Fr.prototype.constructor=Fr,Fr.prototype.isCubicBezierCurve=!0,Fr.prototype.getPoint=function(t,e){var n=e||new i,r=this.v0,o=this.v1,a=this.v2,s=this.v3;return n.set(Ur(t,r.x,o.x,a.x,s.x),Ur(t,r.y,o.y,a.y,s.y)),n},Fr.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Fr.prototype.toJSON=function(){var t=xr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Fr.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Br.prototype=Object.create(xr.prototype),Br.prototype.constructor=Br,Br.prototype.isCubicBezierCurve3=!0,Br.prototype.getPoint=function(t,e){var n=e||new s,r=this.v0,i=this.v1,o=this.v2,a=this.v3;return n.set(Ur(t,r.x,i.x,o.x,a.x),Ur(t,r.y,i.y,o.y,a.y),Ur(t,r.z,i.z,o.z,a.z)),n},Br.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this.v3.copy(t.v3),this},Br.prototype.toJSON=function(){var t=xr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t.v3=this.v3.toArray(),t},Br.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this.v3.fromArray(t.v3),this},Vr.prototype=Object.create(xr.prototype),Vr.prototype.constructor=Vr,Vr.prototype.isLineCurve=!0,Vr.prototype.getPoint=function(t,e){var n=e||new i;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},Vr.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},Vr.prototype.getTangent=function(){return this.v2.clone().sub(this.v1).normalize()},Vr.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Vr.prototype.toJSON=function(){var t=xr.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Vr.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},jr.prototype=Object.create(xr.prototype),jr.prototype.constructor=jr,jr.prototype.isLineCurve3=!0,jr.prototype.getPoint=function(t,e){var n=e||new s;return 1===t?n.copy(this.v2):(n.copy(this.v2).sub(this.v1),n.multiplyScalar(t).add(this.v1)),n},jr.prototype.getPointAt=function(t,e){return this.getPoint(t,e)},jr.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v1.copy(t.v1),this.v2.copy(t.v2),this},jr.prototype.toJSON=function(){var t=xr.prototype.toJSON.call(this);return t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},jr.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Hr.prototype=Object.create(xr.prototype),Hr.prototype.constructor=Hr,Hr.prototype.isQuadraticBezierCurve=!0,Hr.prototype.getPoint=function(t,e){var n=e||new i,r=this.v0,o=this.v1,a=this.v2;return n.set(Nr(t,r.x,o.x,a.x),Nr(t,r.y,o.y,a.y)),n},Hr.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Hr.prototype.toJSON=function(){var t=xr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Hr.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},Gr.prototype=Object.create(xr.prototype),Gr.prototype.constructor=Gr,Gr.prototype.isQuadraticBezierCurve3=!0,Gr.prototype.getPoint=function(t,e){var n=e||new s,r=this.v0,i=this.v1,o=this.v2;return n.set(Nr(t,r.x,i.x,o.x),Nr(t,r.y,i.y,o.y),Nr(t,r.z,i.z,o.z)),n},Gr.prototype.copy=function(t){return xr.prototype.copy.call(this,t),this.v0.copy(t.v0),this.v1.copy(t.v1),this.v2.copy(t.v2),this},Gr.prototype.toJSON=function(){var t=xr.prototype.toJSON.call(this);return t.v0=this.v0.toArray(),t.v1=this.v1.toArray(),t.v2=this.v2.toArray(),t},Gr.prototype.fromJSON=function(t){return xr.prototype.fromJSON.call(this,t),this.v0.fromArray(t.v0),this.v1.fromArray(t.v1),this.v2.fromArray(t.v2),this},zr.prototype=Object.create(xr.prototype),zr.prototype.constructor=zr,zr.prototype.isSplineCurve=!0,zr.prototype.getPoint=function(t,e){var n=e||new i,r=this.points,o=(r.length-1)*t,a=Math.floor(o),s=o-a,u=r[0===a?a:a-1],c=r[a],l=r[a>r.length-2?r.length-1:a+1],h=r[a>r.length-3?r.length-1:a+2];return n.set(Ar(s,u.x,c.x,l.x,h.x),Ar(s,u.y,c.y,l.y,h.y)),n},zr.prototype.copy=function(t){xr.prototype.copy.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push(r.clone())}return this},zr.prototype.toJSON=function(){var t=xr.prototype.toJSON.call(this);t.points=[];for(var e=0,n=this.points.length;e<n;e++){var r=this.points[e];t.points.push(r.toArray())}return t},zr.prototype.fromJSON=function(t){xr.prototype.fromJSON.call(this,t),this.points=[];for(var e=0,n=t.points.length;e<n;e++){var r=t.points[e];this.points.push((new i).fromArray(r))}return this};var ac=Object.freeze({ArcCurve:Sr,CatmullRomCurve3:Mr,CubicBezierCurve:Fr,CubicBezierCurve3:Br,EllipseCurve:Tr,LineCurve:Vr,LineCurve3:jr,QuadraticBezierCurve:Hr,QuadraticBezierCurve3:Gr,SplineCurve:zr});Wr.prototype=Object.assign(Object.create(xr.prototype),{constructor:Wr,add:function(t){this.curves.push(t)},closePath:function(){var t=this.curves[0].getPoint(0),e=this.curves[this.curves.length-1].getPoint(1);t.equals(e)||this.curves.push(new Vr(e,t))},getPoint:function(t){for(var e=t*this.getLength(),n=this.getCurveLengths(),r=0;r<n.length;){if(n[r]>=e){var i=n[r]-e,o=this.curves[r],a=o.getLength(),s=0===a?0:1-i/a;return o.getPointAt(s)}r++}return null},getLength:function(){var t=this.getCurveLengths();return t[t.length-1]},updateArcLengths:function(){this.needsUpdate=!0,this.cacheLengths=null,this.getCurveLengths()},getCurveLengths:function(){if(this.cacheLengths&&this.cacheLengths.length===this.curves.length)return this.cacheLengths;for(var t=[],e=0,n=0,r=this.curves.length;n<r;n++)e+=this.curves[n].getLength(),t.push(e);return this.cacheLengths=t,t},getSpacedPoints:function(t){void 0===t&&(t=40);for(var e=[],n=0;n<=t;n++)e.push(this.getPoint(n/t));return this.autoClose&&e.push(e[0]),e},getPoints:function(t){t=t||12;for(var e,n=[],r=0,i=this.curves;r<i.length;r++)for(var o=i[r],a=o&&o.isEllipseCurve?2*t:o&&o.isLineCurve?1:o&&o.isSplineCurve?t*o.points.length:t,s=o.getPoints(a),u=0;u<s.length;u++){var c=s[u];e&&e.equals(c)||(n.push(c),e=c)}return this.autoClose&&n.length>1&&!n[n.length-1].equals(n[0])&&n.push(n[0]),n},copy:function(t){xr.prototype.copy.call(this,t),this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push(r.clone())}return this.autoClose=t.autoClose,this},toJSON:function(){var t=xr.prototype.toJSON.call(this);t.autoClose=this.autoClose,t.curves=[];for(var e=0,n=this.curves.length;e<n;e++){var r=this.curves[e];t.curves.push(r.toJSON())}return t},fromJSON:function(t){xr.prototype.fromJSON.call(this,t),this.autoClose=t.autoClose,this.curves=[];for(var e=0,n=t.curves.length;e<n;e++){var r=t.curves[e];this.curves.push((new ac[r.type]).fromJSON(r))}return this}}),qr.prototype=Object.assign(Object.create(Wr.prototype),{constructor:qr,setFromPoints:function(t){this.moveTo(t[0].x,t[0].y);for(var e=1,n=t.length;e<n;e++)this.lineTo(t[e].x,t[e].y)},moveTo:function(t,e){this.currentPoint.set(t,e)},lineTo:function(t,e){var n=new Vr(this.currentPoint.clone(),new i(t,e));this.curves.push(n),this.currentPoint.set(t,e)},quadraticCurveTo:function(t,e,n,r){var o=new Hr(this.currentPoint.clone(),new i(t,e),new i(n,r));this.curves.push(o),this.currentPoint.set(n,r)},bezierCurveTo:function(t,e,n,r,o,a){var s=new Fr(this.currentPoint.clone(),new i(t,e),new i(n,r),new i(o,a));this.curves.push(s),this.currentPoint.set(o,a)},splineThru:function(t){var e=[this.currentPoint.clone()].concat(t),n=new zr(e);this.curves.push(n),this.currentPoint.copy(t[t.length-1])},arc:function(t,e,n,r,i,o){var a=this.currentPoint.x,s=this.currentPoint.y;this.absarc(t+a,e+s,n,r,i,o)},absarc:function(t,e,n,r,i,o){this.absellipse(t,e,n,n,r,i,o)},ellipse:function(t,e,n,r,i,o,a,s){var u=this.currentPoint.x,c=this.currentPoint.y;this.absellipse(t+u,e+c,n,r,i,o,a,s)},absellipse:function(t,e,n,r,i,o,a,s){var u=new Tr(t,e,n,r,i,o,a,s);if(this.curves.length>0){var c=u.getPoint(0);c.equals(this.currentPoint)||this.lineTo(c.x,c.y)}this.curves.push(u);var l=u.getPoint(1);this.currentPoint.copy(l)},copy:function(t){return Wr.prototype.copy.call(this,t),this.currentPoint.copy(t.currentPoint),this},toJSON:function(){var t=Wr.prototype.toJSON.call(this);return t.currentPoint=this.currentPoint.toArray(),t},fromJSON:function(t){return Wr.prototype.fromJSON.call(this,t),this.currentPoint.fromArray(t.currentPoint),this}}),Yr.prototype=Object.assign(Object.create(qr.prototype),{constructor:Yr,getPointsHoles:function(t){for(var e=[],n=0,r=this.holes.length;n<r;n++)e[n]=this.holes[n].getPoints(t);return e},extractPoints:function(t){return{shape:this.getPoints(t),holes:this.getPointsHoles(t)}},copy:function(t){qr.prototype.copy.call(this,t),this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push(r.clone())}return this},toJSON:function(){var t=qr.prototype.toJSON.call(this);t.uuid=this.uuid,t.holes=[];for(var e=0,n=this.holes.length;e<n;e++){var r=this.holes[e];t.holes.push(r.toJSON())}return t},fromJSON:function(t){qr.prototype.fromJSON.call(this,t),this.uuid=t.uuid,this.holes=[];for(var e=0,n=t.holes.length;e<n;e++){var r=t.holes[e];this.holes.push((new qr).fromJSON(r))}return this}}),Kr.prototype=Object.assign(Object.create(E.prototype),{constructor:Kr,isLight:!0,copy:function(t){return E.prototype.copy.call(this,t),this.color.copy(t.color),this.intensity=t.intensity,this},toJSON:function(t){var e=E.prototype.toJSON.call(this,t);return e.object.color=this.color.getHex(),e.object.intensity=this.intensity,void 0!==this.groundColor&&(e.object.groundColor=this.groundColor.getHex()),void 0!==this.distance&&(e.object.distance=this.distance),void 0!==this.angle&&(e.object.angle=this.angle),void 0!==this.decay&&(e.object.decay=this.decay),void 0!==this.penumbra&&(e.object.penumbra=this.penumbra),void 0!==this.shadow&&(e.object.shadow=this.shadow.toJSON()),e}}),Qr.prototype=Object.assign(Object.create(Kr.prototype),{constructor:Qr,isHemisphereLight:!0,copy:function(t){return Kr.prototype.copy.call(this,t),this.groundColor.copy(t.groundColor),this}}),Object.assign(Xr.prototype,{copy:function(t){return this.camera=t.camera.clone(),this.bias=t.bias,this.radius=t.radius,this.mapSize.copy(t.mapSize),this},clone:function(){return(new this.constructor).copy(this)},toJSON:function(){var t={};return 0!==this.bias&&(t.bias=this.bias),1!==this.radius&&(t.radius=this.radius),512===this.mapSize.x&&512===this.mapSize.y||(t.mapSize=this.mapSize.toArray()),t.camera=this.camera.toJSON(!1).object,delete t.camera.matrix,t}}),Jr.prototype=Object.assign(Object.create(Xr.prototype),{constructor:Jr,isSpotLightShadow:!0,update:function(t){var e=this.camera,n=2*Au.RAD2DEG*t.angle,r=this.mapSize.width/this.mapSize.height,i=t.distance||e.far;n===e.fov&&r===e.aspect&&i===e.far||(e.fov=n,e.aspect=r,e.far=i,e.updateProjectionMatrix())}}),Zr.prototype=Object.assign(Object.create(Kr.prototype),{constructor:Zr,isSpotLight:!0,copy:function(t){return Kr.prototype.copy.call(this,t),this.distance=t.distance,this.angle=t.angle,this.penumbra=t.penumbra,this.decay=t.decay,this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),$r.prototype=Object.assign(Object.create(Kr.prototype),{constructor:$r,isPointLight:!0,copy:function(t){return Kr.prototype.copy.call(this,t),this.distance=t.distance,this.decay=t.decay,this.shadow=t.shadow.clone(),this}}),ti.prototype=Object.assign(Object.create(Xr.prototype),{constructor:ti}),ei.prototype=Object.assign(Object.create(Kr.prototype),{constructor:ei,isDirectionalLight:!0,copy:function(t){return Kr.prototype.copy.call(this,t),this.target=t.target.clone(),this.shadow=t.shadow.clone(),this}}),ni.prototype=Object.assign(Object.create(Kr.prototype),{constructor:ni,isAmbientLight:!0}),ri.prototype=Object.assign(Object.create(Kr.prototype),{constructor:ri,isRectAreaLight:!0,copy:function(t){return Kr.prototype.copy.call(this,t),this.width=t.width,this.height=t.height,this},toJSON:function(t){var e=Kr.prototype.toJSON.call(this,t);return e.object.width=this.width,e.object.height=this.height,e}}),ii.prototype=Object.assign(Object.create(pi.prototype),{constructor:ii,ValueTypeName:"string",ValueBufferType:Array,DefaultInterpolation:cu,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),oi.prototype=Object.assign(Object.create(pi.prototype),{constructor:oi,ValueTypeName:"bool",ValueBufferType:Array,DefaultInterpolation:cu,InterpolantFactoryMethodLinear:void 0,InterpolantFactoryMethodSmooth:void 0}),Object.assign(ai.prototype,{evaluate:function(t){var e=this.parameterPositions,n=this._cachedIndex,r=e[n],i=e[n-1];t:{e:{var o;n:{r:if(!(t<r)){for(var a=n+2;;){if(void 0===r){if(t<i)break r;return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,t,i)}if(n===a)break;if(i=r,r=e[++n],t<r)break e}o=e.length;break n}{if(t>=i)break t;var s=e[1];t<s&&(n=2,i=s);for(var a=n-2;;){if(void 0===i)return this._cachedIndex=0,this.beforeStart_(0,t,r);if(n===a)break;if(r=i,i=e[--n-1],t>=i)break e}o=n,n=0}}for(;n<o;){var u=n+o>>>1;t<e[u]?o=u:n=u+1}if(r=e[n],void 0===(i=e[n-1]))return this._cachedIndex=0,this.beforeStart_(0,t,r);if(void 0===r)return n=e.length,this._cachedIndex=n,this.afterEnd_(n-1,i,t)}this._cachedIndex=n,this.intervalChanged_(n,i,r)}return this.interpolate_(n,i,t,r)},settings:null,DefaultSettings_:{},getSettings_:function(){return this.settings||this.DefaultSettings_},copySampleValue_:function(t){for(var e=this.resultBuffer,n=this.sampleValues,r=this.valueSize,i=t*r,o=0;o!==r;++o)e[o]=n[i+o];return e},interpolate_:function(){throw new Error("call to abstract method")},intervalChanged_:function(){}}),Object.assign(ai.prototype,{beforeStart_:ai.prototype.copySampleValue_,afterEnd_:ai.prototype.copySampleValue_}),si.prototype=Object.assign(Object.create(ai.prototype),{constructor:si,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,s=this.valueSize,u=t*s,c=(n-e)/(r-e),l=u+s;u!==l;u+=4)a.slerpFlat(i,0,o,u-s,o,u,c);return i}}),ui.prototype=Object.assign(Object.create(pi.prototype),{constructor:ui,ValueTypeName:"quaternion",DefaultInterpolation:lu,InterpolantFactoryMethodLinear:function(t){return new si(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:void 0}),ci.prototype=Object.assign(Object.create(pi.prototype),{constructor:ci,ValueTypeName:"color"}),li.prototype=Object.assign(Object.create(pi.prototype),{constructor:li,ValueTypeName:"number"}),hi.prototype=Object.assign(Object.create(ai.prototype),{constructor:hi,DefaultSettings_:{endingStart:fu,endingEnd:fu},intervalChanged_:function(t,e,n){var r=this.parameterPositions,i=t-2,o=t+1,a=r[i],s=r[o];if(void 0===a)switch(this.getSettings_().endingStart){case du:i=t,a=2*e-n;break;case pu:i=r.length-2,a=e+r[i]-r[i+1];break;default:i=t,a=n}if(void 0===s)switch(this.getSettings_().endingEnd){case du:o=t,s=2*n-e;break;case pu:o=1,s=n+r[1]-r[0];break;default:o=t-1,s=e}var u=.5*(n-e),c=this.valueSize;this._weightPrev=u/(e-a),this._weightNext=u/(s-n),this._offsetPrev=i*c,this._offsetNext=o*c},interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,c=this._offsetPrev,l=this._offsetNext,h=this._weightPrev,f=this._weightNext,d=(n-e)/(r-e),p=d*d,m=p*d,g=-h*m+2*h*p-h*d,v=(1+h)*m+(-1.5-2*h)*p+(-.5+h)*d+1,y=(-1-f)*m+(1.5+f)*p+.5*d,_=f*m-f*p,b=0;b!==a;++b)i[b]=g*o[c+b]+v*o[u+b]+y*o[s+b]+_*o[l+b];return i}}),fi.prototype=Object.assign(Object.create(ai.prototype),{constructor:fi,interpolate_:function(t,e,n,r){for(var i=this.resultBuffer,o=this.sampleValues,a=this.valueSize,s=t*a,u=s-a,c=(n-e)/(r-e),l=1-c,h=0;h!==a;++h)i[h]=o[u+h]*l+o[s+h]*c;return i}}),di.prototype=Object.assign(Object.create(ai.prototype),{constructor:di,interpolate_:function(t){return this.copySampleValue_(t-1)}});var sc={arraySlice:function(t,e,n){return sc.isTypedArray(t)?new t.constructor(t.subarray(e,void 0!==n?n:t.length)):t.slice(e,n)},convertArray:function(t,e,n){return!t||!n&&t.constructor===e?t:"number"===typeof e.BYTES_PER_ELEMENT?new e(t):Array.prototype.slice.call(t)},isTypedArray:function(t){return ArrayBuffer.isView(t)&&!(t instanceof DataView)},getKeyframeOrder:function(t){function e(e,n){return t[e]-t[n]}for(var n=t.length,r=new Array(n),i=0;i!==n;++i)r[i]=i;return r.sort(e),r},sortedArray:function(t,e,n){for(var r=t.length,i=new t.constructor(r),o=0,a=0;a!==r;++o)for(var s=n[o]*e,u=0;u!==e;++u)i[a++]=t[s+u];return i},flattenJSON:function(t,e,n,r){for(var i=1,o=t[0];void 0!==o&&void 0===o[r];)o=t[i++];if(void 0!==o){var a=o[r];if(void 0!==a)if(Array.isArray(a))do{a=o[r],void 0!==a&&(e.push(o.time),n.push.apply(n,a)),o=t[i++]}while(void 0!==o);else if(void 0!==a.toArray)do{a=o[r],void 0!==a&&(e.push(o.time),a.toArray(n,n.length)),o=t[i++]}while(void 0!==o);else do{a=o[r],void 0!==a&&(e.push(o.time),n.push(a)),o=t[i++]}while(void 0!==o)}}};Object.assign(pi,{parse:function(t){if(void 0===t.type)throw new Error("THREE.KeyframeTrack: track type undefined, can not parse");var e=pi._getTrackTypeForValueTypeName(t.type);if(void 0===t.times){var n=[],r=[];sc.flattenJSON(t.keys,n,r,"value"),t.times=n,t.values=r}return void 0!==e.parse?e.parse(t):new e(t.name,t.times,t.values,t.interpolation)},toJSON:function(t){var e,n=t.constructor;if(void 0!==n.toJSON)e=n.toJSON(t);else{e={name:t.name,times:sc.convertArray(t.times,Array),values:sc.convertArray(t.values,Array)};var r=t.getInterpolation();r!==t.DefaultInterpolation&&(e.interpolation=r)}return e.type=t.ValueTypeName,e},_getTrackTypeForValueTypeName:function(t){switch(t.toLowerCase()){case"scalar":case"double":case"float":case"number":case"integer":return li;case"vector":case"vector2":case"vector3":case"vector4":return mi;case"color":return ci;case"quaternion":return ui;case"bool":case"boolean":return oi;case"string":return ii}throw new Error("THREE.KeyframeTrack: Unsupported typeName: "+t)}}),Object.assign(pi.prototype,{constructor:pi,TimeBufferType:Float32Array,ValueBufferType:Float32Array,DefaultInterpolation:lu,InterpolantFactoryMethodDiscrete:function(t){return new di(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodLinear:function(t){return new fi(this.times,this.values,this.getValueSize(),t)},InterpolantFactoryMethodSmooth:function(t){return new hi(this.times,this.values,this.getValueSize(),t)},setInterpolation:function(t){var e;switch(t){case cu:e=this.InterpolantFactoryMethodDiscrete;break;case lu:e=this.InterpolantFactoryMethodLinear;break;case hu:e=this.InterpolantFactoryMethodSmooth}if(void 0===e){var n="unsupported interpolation for "+this.ValueTypeName+" keyframe track named "+this.name;if(void 0===this.createInterpolant){if(t===this.DefaultInterpolation)throw new Error(n);this.setInterpolation(this.DefaultInterpolation)}return void console.warn("THREE.KeyframeTrack:",n)}this.createInterpolant=e},getInterpolation:function(){switch(this.createInterpolant){case this.InterpolantFactoryMethodDiscrete:return cu;case this.InterpolantFactoryMethodLinear:return lu;case this.InterpolantFactoryMethodSmooth:return hu}},getValueSize:function(){return this.values.length/this.times.length},shift:function(t){if(0!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]+=t;return this},scale:function(t){if(1!==t)for(var e=this.times,n=0,r=e.length;n!==r;++n)e[n]*=t;return this},trim:function(t,e){for(var n=this.times,r=n.length,i=0,o=r-1;i!==r&&n[i]<t;)++i;for(;-1!==o&&n[o]>e;)--o;if(++o,0!==i||o!==r){i>=o&&(o=Math.max(o,1),i=o-1);var a=this.getValueSize();this.times=sc.arraySlice(n,i,o),this.values=sc.arraySlice(this.values,i*a,o*a)}return this},validate:function(){var t=!0,e=this.getValueSize();e-Math.floor(e)!==0&&(console.error("THREE.KeyframeTrack: Invalid value size in track.",this),t=!1);var n=this.times,r=this.values,i=n.length;0===i&&(console.error("THREE.KeyframeTrack: Track is empty.",this),t=!1);for(var o=null,a=0;a!==i;a++){var s=n[a];if("number"===typeof s&&isNaN(s)){console.error("THREE.KeyframeTrack: Time is not a valid number.",this,a,s),t=!1;break}if(null!==o&&o>s){console.error("THREE.KeyframeTrack: Out of order keys.",this,a,s,o),t=!1;break}o=s}if(void 0!==r&&sc.isTypedArray(r))for(var a=0,u=r.length;a!==u;++a){var c=r[a];if(isNaN(c)){console.error("THREE.KeyframeTrack: Value is not a valid number.",this,a,c),t=!1;break}}return t},optimize:function(){for(var t=this.times,e=this.values,n=this.getValueSize(),r=this.getInterpolation()===hu,i=1,o=t.length-1,a=1;a<o;++a){var s=!1,u=t[a];if(u!==t[a+1]&&(1!==a||u!==u[0]))if(r)s=!0;else for(var c=a*n,l=c-n,h=c+n,f=0;f!==n;++f){var d=e[c+f];if(d!==e[l+f]||d!==e[h+f]){s=!0;break}}if(s){if(a!==i){t[i]=t[a];for(var p=a*n,m=i*n,f=0;f!==n;++f)e[m+f]=e[p+f]}++i}}if(o>0){t[i]=t[o];for(var p=o*n,m=i*n,f=0;f!==n;++f)e[m+f]=e[p+f];++i}return i!==t.length&&(this.times=sc.arraySlice(t,0,i),this.values=sc.arraySlice(e,0,i*n)),this}}),mi.prototype=Object.assign(Object.create(pi.prototype),{constructor:mi,ValueTypeName:"vector"}),Object.assign(gi,{parse:function(t){for(var e=[],n=t.tracks,r=1/(t.fps||1),i=0,o=n.length;i!==o;++i)e.push(pi.parse(n[i]).scale(r));return new gi(t.name,t.duration,e)},toJSON:function(t){for(var e=[],n=t.tracks,r={name:t.name,duration:t.duration,tracks:e},i=0,o=n.length;i!==o;++i)e.push(pi.toJSON(n[i]));return r},CreateFromMorphTargetSequence:function(t,e,n,r){for(var i=e.length,o=[],a=0;a<i;a++){var s=[],u=[];s.push((a+i-1)%i,a,(a+1)%i),u.push(0,1,0);var c=sc.getKeyframeOrder(s);s=sc.sortedArray(s,1,c),u=sc.sortedArray(u,1,c),r||0!==s[0]||(s.push(i),u.push(u[0])),o.push(new li(".morphTargetInfluences["+e[a].name+"]",s,u).scale(1/n))}return new gi(t,-1,o)},findByName:function(t,e){var n=t;if(!Array.isArray(t)){var r=t;n=r.geometry&&r.geometry.animations||r.animations}for(var i=0;i<n.length;i++)if(n[i].name===e)return n[i];return null},CreateClipsFromMorphTargetSequences:function(t,e,n){for(var r={},i=/^([\w-]*?)([\d]+)$/,o=0,a=t.length;o<a;o++){var s=t[o],u=s.name.match(i);if(u&&u.length>1){var c=u[1],l=r[c];l||(r[c]=l=[]),l.push(s)}}var h=[];for(var c in r)h.push(gi.CreateFromMorphTargetSequence(c,r[c],e,n));return h},parseAnimation:function(t,e){if(!t)return console.error("THREE.AnimationClip: No animation in JSONLoader data."),null;for(var n=function(t,e,n,r,i){if(0!==n.length){var o=[],a=[];sc.flattenJSON(n,o,a,r),0!==o.length&&i.push(new t(e,o,a))}},r=[],i=t.name||"default",o=t.length||-1,a=t.fps||30,s=t.hierarchy||[],u=0;u<s.length;u++){var c=s[u].keys;if(c&&0!==c.length)if(c[0].morphTargets){for(var l={},h=0;h<c.length;h++)if(c[h].morphTargets)for(var f=0;f<c[h].morphTargets.length;f++)l[c[h].morphTargets[f]]=-1;for(var d in l){for(var p=[],m=[],f=0;f!==c[h].morphTargets.length;++f){var g=c[h];p.push(g.time),m.push(g.morphTarget===d?1:0)}r.push(new li(".morphTargetInfluence["+d+"]",p,m))}o=l.length*(a||1)}else{var v=".bones["+e[u].name+"]";n(mi,v+".position",c,"pos",r),n(ui,v+".quaternion",c,"rot",r),n(mi,v+".scale",c,"scl",r)}}return 0===r.length?null:new gi(i,o,r)}}),Object.assign(gi.prototype,{resetDuration:function(){for(var t=this.tracks,e=0,n=0,r=t.length;n!==r;++n){var i=this.tracks[n];e=Math.max(e,i.times[i.times.length-1])}this.duration=e},trim:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].trim(0,this.duration);return this},optimize:function(){for(var t=0;t<this.tracks.length;t++)this.tracks[t].optimize();return this}}),Object.assign(vi.prototype,{load:function(t,e,n,r){var i=this;new vr(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},setTextures:function(t){this.textures=t},parse:function(t){function e(t){return void 0===n[t]&&console.warn("THREE.MaterialLoader: Undefined texture",t),n[t]}var n=this.textures,r=new Zu[t.type];if(void 0!==t.uuid&&(r.uuid=t.uuid),void 0!==t.name&&(r.name=t.name),void 0!==t.color&&r.color.setHex(t.color),void 0!==t.roughness&&(r.roughness=t.roughness),void 0!==t.metalness&&(r.metalness=t.metalness),void 0!==t.emissive&&r.emissive.setHex(t.emissive),void 0!==t.specular&&r.specular.setHex(t.specular),void 0!==t.shininess&&(r.shininess=t.shininess),void 0!==t.clearCoat&&(r.clearCoat=t.clearCoat),void 0!==t.clearCoatRoughness&&(r.clearCoatRoughness=t.clearCoatRoughness),void 0!==t.uniforms&&(r.uniforms=t.uniforms),void 0!==t.vertexShader&&(r.vertexShader=t.vertexShader),void 0!==t.fragmentShader&&(r.fragmentShader=t.fragmentShader),void 0!==t.vertexColors&&(r.vertexColors=t.vertexColors),void 0!==t.fog&&(r.fog=t.fog),void 0!==t.flatShading&&(r.flatShading=t.flatShading),void 0!==t.blending&&(r.blending=t.blending),void 0!==t.side&&(r.side=t.side),void 0!==t.opacity&&(r.opacity=t.opacity),void 0!==t.transparent&&(r.transparent=t.transparent),void 0!==t.alphaTest&&(r.alphaTest=t.alphaTest),void 0!==t.depthTest&&(r.depthTest=t.depthTest),void 0!==t.depthWrite&&(r.depthWrite=t.depthWrite),void 0!==t.colorWrite&&(r.colorWrite=t.colorWrite),void 0!==t.wireframe&&(r.wireframe=t.wireframe),void 0!==t.wireframeLinewidth&&(r.wireframeLinewidth=t.wireframeLinewidth),void 0!==t.wireframeLinecap&&(r.wireframeLinecap=t.wireframeLinecap),void 0!==t.wireframeLinejoin&&(r.wireframeLinejoin=t.wireframeLinejoin),void 0!==t.rotation&&(r.rotation=t.rotation),1!==t.linewidth&&(r.linewidth=t.linewidth),void 0!==t.dashSize&&(r.dashSize=t.dashSize),void 0!==t.gapSize&&(r.gapSize=t.gapSize),void 0!==t.scale&&(r.scale=t.scale),void 0!==t.polygonOffset&&(r.polygonOffset=t.polygonOffset),void 0!==t.polygonOffsetFactor&&(r.polygonOffsetFactor=t.polygonOffsetFactor),void 0!==t.polygonOffsetUnits&&(r.polygonOffsetUnits=t.polygonOffsetUnits),void 0!==t.skinning&&(r.skinning=t.skinning),void 0!==t.morphTargets&&(r.morphTargets=t.morphTargets),void 0!==t.dithering&&(r.dithering=t.dithering),void 0!==t.visible&&(r.visible=t.visible),void 0!==t.userData&&(r.userData=t.userData),void 0!==t.shading&&(r.flatShading=1===t.shading),void 0!==t.size&&(r.size=t.size),void 0!==t.sizeAttenuation&&(r.sizeAttenuation=t.sizeAttenuation),void 0!==t.map&&(r.map=e(t.map)),void 0!==t.alphaMap&&(r.alphaMap=e(t.alphaMap),r.transparent=!0),void 0!==t.bumpMap&&(r.bumpMap=e(t.bumpMap)),void 0!==t.bumpScale&&(r.bumpScale=t.bumpScale),void 0!==t.normalMap&&(r.normalMap=e(t.normalMap)),void 0!==t.normalScale){var o=t.normalScale;!1===Array.isArray(o)&&(o=[o,o]),r.normalScale=(new i).fromArray(o)}return void 0!==t.displacementMap&&(r.displacementMap=e(t.displacementMap)),void 0!==t.displacementScale&&(r.displacementScale=t.displacementScale),void 0!==t.displacementBias&&(r.displacementBias=t.displacementBias),void 0!==t.roughnessMap&&(r.roughnessMap=e(t.roughnessMap)),void 0!==t.metalnessMap&&(r.metalnessMap=e(t.metalnessMap)),void 0!==t.emissiveMap&&(r.emissiveMap=e(t.emissiveMap)),void 0!==t.emissiveIntensity&&(r.emissiveIntensity=t.emissiveIntensity),void 0!==t.specularMap&&(r.specularMap=e(t.specularMap)),void 0!==t.envMap&&(r.envMap=e(t.envMap)),void 0!==t.reflectivity&&(r.reflectivity=t.reflectivity),void 0!==t.lightMap&&(r.lightMap=e(t.lightMap)),void 0!==t.lightMapIntensity&&(r.lightMapIntensity=t.lightMapIntensity),void 0!==t.aoMap&&(r.aoMap=e(t.aoMap)),void 0!==t.aoMapIntensity&&(r.aoMapIntensity=t.aoMapIntensity),void 0!==t.gradientMap&&(r.gradientMap=e(t.gradientMap)),r}}),Object.assign(yi.prototype,{load:function(t,e,n,r){var i=this;new vr(i.manager).load(t,function(t){e(i.parse(JSON.parse(t)))},n,r)},parse:function(t){var e=new B,n=t.data.index;if(void 0!==n){var r=new uc[n.type](n.array);e.setIndex(new M(r,1))}var i=t.data.attributes;for(var o in i){var a=i[o],r=new uc[a.type](a.array);e.addAttribute(o,new M(r,a.itemSize,a.normalized))}var u=t.data.groups||t.data.drawcalls||t.data.offsets;if(void 0!==u)for(var c=0,l=u.length;c!==l;++c){var h=u[c];e.addGroup(h.start,h.count,h.materialIndex)}var f=t.data.boundingSphere;if(void 0!==f){var d=new s;void 0!==f.center&&d.fromArray(f.center),e.boundingSphere=new m(d,f.radius)}return e}});var uc={Int8Array:Int8Array,Uint8Array:Uint8Array,Uint8ClampedArray:"undefined"!==typeof Uint8ClampedArray?Uint8ClampedArray:Uint8Array,Int16Array:Int16Array,Uint16Array:Uint16Array,Int32Array:Int32Array,Uint32Array:Uint32Array,Float32Array:Float32Array,Float64Array:Float64Array};_i.Handlers={handlers:[],add:function(t,e){this.handlers.push(t,e)},get:function(t){for(var e=this.handlers,n=0,r=e.length;n<r;n+=2){var i=e[n],o=e[n+1];if(i.test(t))return o}return null}},Object.assign(_i.prototype,{crossOrigin:void 0,onLoadStart:function(){},onLoadProgress:function(){},onLoadComplete:function(){},initMaterials:function(t,e,n){for(var r=[],i=0;i<t.length;++i)r[i]=this.createMaterial(t[i],e,n);return r},createMaterial:function(){var t={NoBlending:ga,NormalBlending:va,AdditiveBlending:ya,SubtractiveBlending:_a,MultiplyBlending:ba,CustomBlending:wa},e=new y,n=new Er,r=new vi;return function(i,o,a){function s(t,e,r,i,s){var c,l=o+t,h=_i.Handlers.get(l);null!==h?c=h.load(l):(n.setCrossOrigin(a),c=n.load(l)),void 0!==e&&(c.repeat.fromArray(e),1!==e[0]&&(c.wrapS=us),1!==e[1]&&(c.wrapT=us)),void 0!==r&&c.offset.fromArray(r),void 0!==i&&("repeat"===i[0]&&(c.wrapS=us),"mirror"===i[0]&&(c.wrapS=ls),"repeat"===i[1]&&(c.wrapT=us),"mirror"===i[1]&&(c.wrapT=ls)),void 0!==s&&(c.anisotropy=s);var f=Au.generateUUID();return u[f]=c,f}var u={},c={uuid:Au.generateUUID(),type:"MeshLambertMaterial"};for(var l in i){var h=i[l];switch(l){case"DbgColor":case"DbgIndex":case"opticalDensity":case"illumination":break;case"DbgName":c.name=h;break;case"blending":c.blending=t[h];break;case"colorAmbient":case"mapAmbient":console.warn("THREE.Loader.createMaterial:",l,"is no longer supported.");break;case"colorDiffuse":c.color=e.fromArray(h).getHex();break;case"colorSpecular":c.specular=e.fromArray(h).getHex();break;case"colorEmissive":c.emissive=e.fromArray(h).getHex();break;case"specularCoef":c.shininess=h;break;case"shading":"basic"===h.toLowerCase()&&(c.type="MeshBasicMaterial"),"phong"===h.toLowerCase()&&(c.type="MeshPhongMaterial"),"standard"===h.toLowerCase()&&(c.type="MeshStandardMaterial");break;case"mapDiffuse":c.map=s(h,i.mapDiffuseRepeat,i.mapDiffuseOffset,i.mapDiffuseWrap,i.mapDiffuseAnisotropy);break;case"mapDiffuseRepeat":case"mapDiffuseOffset":case"mapDiffuseWrap":case"mapDiffuseAnisotropy":break;case"mapEmissive":c.emissiveMap=s(h,i.mapEmissiveRepeat,i.mapEmissiveOffset,i.mapEmissiveWrap,i.mapEmissiveAnisotropy);break;case"mapEmissiveRepeat":case"mapEmissiveOffset":case"mapEmissiveWrap":case"mapEmissiveAnisotropy":break;case"mapLight":c.lightMap=s(h,i.mapLightRepeat,i.mapLightOffset,i.mapLightWrap,i.mapLightAnisotropy);break;case"mapLightRepeat":case"mapLightOffset":case"mapLightWrap":case"mapLightAnisotropy":break;case"mapAO":c.aoMap=s(h,i.mapAORepeat,i.mapAOOffset,i.mapAOWrap,i.mapAOAnisotropy);break;case"mapAORepeat":case"mapAOOffset":case"mapAOWrap":case"mapAOAnisotropy":break;case"mapBump":c.bumpMap=s(h,i.mapBumpRepeat,i.mapBumpOffset,i.mapBumpWrap,i.mapBumpAnisotropy);break;case"mapBumpScale":c.bumpScale=h;break;case"mapBumpRepeat":case"mapBumpOffset":case"mapBumpWrap":case"mapBumpAnisotropy":break;case"mapNormal":c.normalMap=s(h,i.mapNormalRepeat,i.mapNormalOffset,i.mapNormalWrap,i.mapNormalAnisotropy);break;case"mapNormalFactor":c.normalScale=h;break;case"mapNormalRepeat":case"mapNormalOffset":case"mapNormalWrap":case"mapNormalAnisotropy":break;case"mapSpecular":c.specularMap=s(h,i.mapSpecularRepeat,i.mapSpecularOffset,i.mapSpecularWrap,i.mapSpecularAnisotropy);break;case"mapSpecularRepeat":case"mapSpecularOffset":case"mapSpecularWrap":case"mapSpecularAnisotropy":break;case"mapMetalness":c.metalnessMap=s(h,i.mapMetalnessRepeat,i.mapMetalnessOffset,i.mapMetalnessWrap,i.mapMetalnessAnisotropy);break;case"mapMetalnessRepeat":case"mapMetalnessOffset":case"mapMetalnessWrap":case"mapMetalnessAnisotropy":break;case"mapRoughness":c.roughnessMap=s(h,i.mapRoughnessRepeat,i.mapRoughnessOffset,i.mapRoughnessWrap,i.mapRoughnessAnisotropy);break;case"mapRoughnessRepeat":case"mapRoughnessOffset":case"mapRoughnessWrap":case"mapRoughnessAnisotropy":break;case"mapAlpha":c.alphaMap=s(h,i.mapAlphaRepeat,i.mapAlphaOffset,i.mapAlphaWrap,i.mapAlphaAnisotropy);break;case"mapAlphaRepeat":case"mapAlphaOffset":case"mapAlphaWrap":case"mapAlphaAnisotropy":break;case"flipSided":c.side=ca;break;case"doubleSided":c.side=la;break;case"transparency":console.warn("THREE.Loader.createMaterial: transparency has been renamed to opacity"),c.opacity=h;break;case"depthTest":case"depthWrite":case"colorWrite":case"opacity":case"reflectivity":case"transparent":case"visible":case"wireframe":c[l]=h;break;case"vertexColors":!0===h&&(c.vertexColors=ma),"face"===h&&(c.vertexColors=pa);break;default:console.error("THREE.Loader.createMaterial: Unsupported",l,h)}}return"MeshBasicMaterial"===c.type&&delete c.emissive,"MeshPhongMaterial"!==c.type&&delete c.specular,c.opacity<1&&(c.transparent=!0),r.setTextures(u),r.parse(c)}}()});var cc={decodeText:function(t){if("undefined"!==typeof TextDecoder)return(new TextDecoder).decode(t);for(var e="",n=0,r=t.length;n<r;n++)e+=String.fromCharCode(t[n]);return decodeURIComponent(escape(e))},extractUrlBase:function(t){var e=t.lastIndexOf("/");return-1===e?"./":t.substr(0,e+1)}};Object.assign(bi.prototype,{load:function(t,e,n,r){var i=this,o=this.texturePath&&"string"===typeof this.texturePath?this.texturePath:cc.extractUrlBase(t),a=new vr(this.manager);a.setWithCredentials(this.withCredentials),a.load(t,function(n){var r=JSON.parse(n),a=r.metadata;if(void 0!==a){var s=a.type;if(void 0!==s&&"object"===s.toLowerCase())return void console.error("THREE.JSONLoader: "+t+" should be loaded with THREE.ObjectLoader instead.")}var u=i.parse(r,o);e(u.geometry,u.materials)},n,r)},setTexturePath:function(t){this.texturePath=t},parse:function(){function t(t,e){function n(t,e){return t&1<<e}var r,o,a,u,c,l,h,f,d,p,m,g,v,_,b,w,E,x,T,C,M,A,I,R,P,N,D,O=t.faces,k=t.vertices,L=t.normals,U=t.colors,F=t.scale,B=0;if(void 0!==t.uvs){for(r=0;r<t.uvs.length;r++)t.uvs[r].length&&B++;for(r=0;r<B;r++)e.faceVertexUvs[r]=[]}for(u=0,c=k.length;u<c;)x=new s,x.x=k[u++]*F,x.y=k[u++]*F,x.z=k[u++]*F,e.vertices.push(x);for(u=0,c=O.length;u<c;)if(p=O[u++],m=n(p,0),g=n(p,1),v=n(p,3),_=n(p,4),b=n(p,5),w=n(p,6),E=n(p,7),m){if(C=new S,C.a=O[u],C.b=O[u+1],C.c=O[u+3],M=new S,M.a=O[u+1],M.b=O[u+2],M.c=O[u+3],u+=4,g&&(d=O[u++],C.materialIndex=d,M.materialIndex=d),a=e.faces.length,v)for(r=0;r<B;r++)for(R=t.uvs[r],e.faceVertexUvs[r][a]=[],e.faceVertexUvs[r][a+1]=[],o=0;o<4;o++)f=O[u++],N=R[2*f],D=R[2*f+1],P=new i(N,D),2!==o&&e.faceVertexUvs[r][a].push(P),0!==o&&e.faceVertexUvs[r][a+1].push(P);if(_&&(h=3*O[u++],C.normal.set(L[h++],L[h++],L[h]),M.normal.copy(C.normal)),b)for(r=0;r<4;r++)h=3*O[u++],I=new s(L[h++],L[h++],L[h]),2!==r&&C.vertexNormals.push(I),0!==r&&M.vertexNormals.push(I);if(w&&(l=O[u++],A=U[l],C.color.setHex(A),M.color.setHex(A)),E)for(r=0;r<4;r++)l=O[u++],A=U[l],2!==r&&C.vertexColors.push(new y(A)),0!==r&&M.vertexColors.push(new y(A));e.faces.push(C),e.faces.push(M)}else{if(T=new S,T.a=O[u++],T.b=O[u++],T.c=O[u++],g&&(d=O[u++],T.materialIndex=d),a=e.faces.length,v)for(r=0;r<B;r++)for(R=t.uvs[r],e.faceVertexUvs[r][a]=[],o=0;o<3;o++)f=O[u++],N=R[2*f],D=R[2*f+1],P=new i(N,D),e.faceVertexUvs[r][a].push(P);if(_&&(h=3*O[u++],T.normal.set(L[h++],L[h++],L[h])),b)for(r=0;r<3;r++)h=3*O[u++],I=new s(L[h++],L[h++],L[h]),T.vertexNormals.push(I);if(w&&(l=O[u++],T.color.setHex(U[l])),E)for(r=0;r<3;r++)l=O[u++],T.vertexColors.push(new y(U[l]));e.faces.push(T)}}function e(t,e){var n=void 0!==t.influencesPerVertex?t.influencesPerVertex:2;if(t.skinWeights)for(var r=0,i=t.skinWeights.length;r<i;r+=n){var o=t.skinWeights[r],a=n>1?t.skinWeights[r+1]:0,s=n>2?t.skinWeights[r+2]:0,u=n>3?t.skinWeights[r+3]:0;e.skinWeights.push(new l(o,a,s,u))}if(t.skinIndices)for(var r=0,i=t.skinIndices.length;r<i;r+=n){var c=t.skinIndices[r],h=n>1?t.skinIndices[r+1]:0,f=n>2?t.skinIndices[r+2]:0,d=n>3?t.skinIndices[r+3]:0;e.skinIndices.push(new l(c,h,f,d))}e.bones=t.bones,e.bones&&e.bones.length>0&&(e.skinWeights.length!==e.skinIndices.length||e.skinIndices.length!==e.vertices.length)&&console.warn("When skinning, number of vertices ("+e.vertices.length+"), skinIndices ("+e.skinIndices.length+"), and skinWeights ("+e.skinWeights.length+") should match.")}function n(t,e){var n=t.scale;if(void 0!==t.morphTargets)for(var r=0,i=t.morphTargets.length;r<i;r++){e.morphTargets[r]={},e.morphTargets[r].name=t.morphTargets[r].name,e.morphTargets[r].vertices=[];for(var o=e.morphTargets[r].vertices,a=t.morphTargets[r].vertices,u=0,c=a.length;u<c;u+=3){var l=new s;l.x=a[u]*n,l.y=a[u+1]*n,l.z=a[u+2]*n,o.push(l)}}if(void 0!==t.morphColors&&t.morphColors.length>0){console.warn('THREE.JSONLoader: "morphColors" no longer supported. Using them as face colors.');for(var h=e.faces,f=t.morphColors[0].colors,r=0,i=h.length;r<i;r++)h[r].color.fromArray(f,3*r)}}function r(t,e){var n=[],r=[];void 0!==t.animation&&r.push(t.animation),void 0!==t.animations&&(t.animations.length?r=r.concat(t.animations):r.push(t.animations));for(var i=0;i<r.length;i++){var o=gi.parseAnimation(r[i],e.bones);o&&n.push(o)}if(e.morphTargets){var a=gi.CreateClipsFromMorphTargetSequences(e.morphTargets,10);n=n.concat(a)}n.length>0&&(e.animations=n)}return function(i,o){void 0!==i.data&&(i=i.data),void 0!==i.scale?i.scale=1/i.scale:i.scale=1;var a=new C;return t(i,a),e(i,a),n(i,a),r(i,a),a.computeFaceNormals(),a.computeBoundingSphere(),void 0===i.materials||0===i.materials.length?{geometry:a}:{geometry:a,materials:_i.prototype.initMaterials(i.materials,o,this.crossOrigin)}}}()}),Object.assign(wi.prototype,{load:function(t,e,n,r){""===this.texturePath&&(this.texturePath=t.substring(0,t.lastIndexOf("/")+1));var i=this;new vr(i.manager).load(t,function(n){var o=null;try{o=JSON.parse(n)}catch(e){return void 0!==r&&r(e),void console.error("THREE:ObjectLoader: Can't parse "+t+".",e.message)}var a=o.metadata;if(void 0===a||void 0===a.type||"geometry"===a.type.toLowerCase())return void console.error("THREE.ObjectLoader: Can't load "+t+". Use THREE.JSONLoader instead.");i.parse(o,e)},n,r)},setTexturePath:function(t){this.texturePath=t},setCrossOrigin:function(t){this.crossOrigin=t},parse:function(t,e){var n=this.parseShape(t.shapes),r=this.parseGeometries(t.geometries,n),i=this.parseImages(t.images,function(){void 0!==e&&e(s)}),o=this.parseTextures(t.textures,i),a=this.parseMaterials(t.materials,o),s=this.parseObject(t.object,r,a);return t.animations&&(s.animations=this.parseAnimations(t.animations)),void 0!==t.images&&0!==t.images.length||void 0!==e&&e(s),s},parseShape:function(t){var e={};if(void 0!==t)for(var n=0,r=t.length;n<r;n++){var i=(new Yr).fromJSON(t[n]);e[i.uuid]=i}return e},parseGeometries:function(t,e){var n={};if(void 0!==t)for(var r=new bi,i=new yi,o=0,a=t.length;o<a;o++){var s,u=t[o];switch(u.type){case"PlaneGeometry":case"PlaneBufferGeometry":s=new Ju[u.type](u.width,u.height,u.widthSegments,u.heightSegments);break;case"BoxGeometry":case"BoxBufferGeometry":case"CubeGeometry":s=new Ju[u.type](u.width,u.height,u.depth,u.widthSegments,u.heightSegments,u.depthSegments);break;case"CircleGeometry":case"CircleBufferGeometry":s=new Ju[u.type](u.radius,u.segments,u.thetaStart,u.thetaLength);break;case"CylinderGeometry":case"CylinderBufferGeometry":s=new Ju[u.type](u.radiusTop,u.radiusBottom,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"ConeGeometry":case"ConeBufferGeometry":s=new Ju[u.type](u.radius,u.height,u.radialSegments,u.heightSegments,u.openEnded,u.thetaStart,u.thetaLength);break;case"SphereGeometry":case"SphereBufferGeometry":s=new Ju[u.type](u.radius,u.widthSegments,u.heightSegments,u.phiStart,u.phiLength,u.thetaStart,u.thetaLength);break;case"DodecahedronGeometry":case"DodecahedronBufferGeometry":case"IcosahedronGeometry":case"IcosahedronBufferGeometry":case"OctahedronGeometry":case"OctahedronBufferGeometry":case"TetrahedronGeometry":case"TetrahedronBufferGeometry":s=new Ju[u.type](u.radius,u.detail);break;case"RingGeometry":case"RingBufferGeometry":s=new Ju[u.type](u.innerRadius,u.outerRadius,u.thetaSegments,u.phiSegments,u.thetaStart,u.thetaLength);break;case"TorusGeometry":case"TorusBufferGeometry":s=new Ju[u.type](u.radius,u.tube,u.radialSegments,u.tubularSegments,u.arc);break;case"TorusKnotGeometry":case"TorusKnotBufferGeometry":s=new Ju[u.type](u.radius,u.tube,u.tubularSegments,u.radialSegments,u.p,u.q);break;case"LatheGeometry":case"LatheBufferGeometry":s=new Ju[u.type](u.points,u.segments,u.phiStart,u.phiLength);break;case"PolyhedronGeometry":case"PolyhedronBufferGeometry":s=new Ju[u.type](u.vertices,u.indices,u.radius,u.details);break;case"ShapeGeometry":case"ShapeBufferGeometry":for(var c=[],l=0,h=u.shapes.length;l<h;l++){var f=e[u.shapes[l]];c.push(f)}s=new Ju[u.type](c,u.curveSegments);break;case"BufferGeometry":s=i.parse(u);break;case"Geometry":s=r.parse(u,this.texturePath).geometry;break;default:console.warn('THREE.ObjectLoader: Unsupported geometry type "'+u.type+'"');continue}s.uuid=u.uuid,void 0!==u.name&&(s.name=u.name),n[u.uuid]=s}return n},parseMaterials:function(t,e){var n={};if(void 0!==t){var r=new vi;r.setTextures(e);for(var i=0,o=t.length;i<o;i++){var a=t[i];if("MultiMaterial"===a.type){for(var s=[],u=0;u<a.materials.length;u++)s.push(r.parse(a.materials[u]));n[a.uuid]=s}else n[a.uuid]=r.parse(a)}}return n},parseAnimations:function(t){for(var e=[],n=0;n<t.length;n++){var r=gi.parse(t[n]);e.push(r)}return e},parseImages:function(t,e){var n=this,r={};if(void 0!==t&&t.length>0){var i=new gr(e),o=new br(i);o.setCrossOrigin(this.crossOrigin);for(var a=0,s=t.length;a<s;a++){var u=t[a],c=/^(\/\/)|([a-z]+:(\/\/)?)/i.test(u.url)?u.url:n.texturePath+u.url;r[u.uuid]=function(t){return n.manager.itemStart(t),o.load(t,function(){n.manager.itemEnd(t)},void 0,function(){n.manager.itemEnd(t),n.manager.itemError(t)})}(c)}}return r},parseTextures:function(t,e){function n(t,e){return"number"===typeof t?t:(console.warn("THREE.ObjectLoader.parseTexture: Constant should be in numeric form.",t),e[t])}var r={};if(void 0!==t)for(var i=0,o=t.length;i<o;i++){var a=t[i];void 0===a.image&&console.warn('THREE.ObjectLoader: No "image" specified for',a.uuid),void 0===e[a.image]&&console.warn("THREE.ObjectLoader: Undefined image",a.image);var s=new c(e[a.image]);s.needsUpdate=!0,s.uuid=a.uuid,void 0!==a.name&&(s.name=a.name),void 0!==a.mapping&&(s.mapping=n(a.mapping,lc)),void 0!==a.offset&&s.offset.fromArray(a.offset),void 0!==a.repeat&&s.repeat.fromArray(a.repeat),void 0!==a.center&&s.center.fromArray(a.center),void 0!==a.rotation&&(s.rotation=a.rotation),void 0!==a.wrap&&(s.wrapS=n(a.wrap[0],hc),s.wrapT=n(a.wrap[1],hc)),void 0!==a.format&&(s.format=a.format),void 0!==a.minFilter&&(s.minFilter=n(a.minFilter,fc)),void 0!==a.magFilter&&(s.magFilter=n(a.magFilter,fc)),void 0!==a.anisotropy&&(s.anisotropy=a.anisotropy),void 0!==a.flipY&&(s.flipY=a.flipY),r[a.uuid]=s}return r},parseObject:function(t,e,n){function r(t){return void 0===e[t]&&console.warn("THREE.ObjectLoader: Undefined geometry",t),e[t]}function i(t){if(void 0!==t){if(Array.isArray(t)){for(var e=[],r=0,i=t.length;r<i;r++){var o=t[r];void 0===n[o]&&console.warn("THREE.ObjectLoader: Undefined material",o),e.push(n[o])}return e}return void 0===n[t]&&console.warn("THREE.ObjectLoader: Undefined material",t),n[t]}}var o;switch(t.type){case"Scene":o=new Ae,void 0!==t.background&&Number.isInteger(t.background)&&(o.background=new y(t.background)),void 0!==t.fog&&("Fog"===t.fog.type?o.fog=new Me(t.fog.color,t.fog.near,t.fog.far):"FogExp2"===t.fog.type&&(o.fog=new Ce(t.fog.color,t.fog.density)));break;case"PerspectiveCamera":o=new Ee(t.fov,t.aspect,t.near,t.far),void 0!==t.focus&&(o.focus=t.focus),void 0!==t.zoom&&(o.zoom=t.zoom),void 0!==t.filmGauge&&(o.filmGauge=t.filmGauge),void 0!==t.filmOffset&&(o.filmOffset=t.filmOffset),void 0!==t.view&&(o.view=Object.assign({},t.view));break;case"OrthographicCamera":o=new T(t.left,t.right,t.top,t.bottom,t.near,t.far),void 0!==t.zoom&&(o.zoom=t.zoom),void 0!==t.view&&(o.view=Object.assign({},t.view));break;case"AmbientLight":o=new ni(t.color,t.intensity);break;case"DirectionalLight":o=new ei(t.color,t.intensity);break;case"PointLight":o=new $r(t.color,t.intensity,t.distance,t.decay);break;case"RectAreaLight":o=new ri(t.color,t.intensity,t.width,t.height);break;case"SpotLight":o=new Zr(t.color,t.intensity,t.distance,t.angle,t.penumbra,t.decay);break;case"HemisphereLight":o=new Qr(t.color,t.groundColor,t.intensity);break;case"SkinnedMesh":console.warn("THREE.ObjectLoader.parseObject() does not support SkinnedMesh yet.");case"Mesh":var a=r(t.geometry),s=i(t.material);o=a.bones&&a.bones.length>0?new Oe(a,s):new X(a,s);break;case"LOD":o=new Pe;break;case"Line":o=new Le(r(t.geometry),i(t.material),t.mode);break;case"LineLoop":o=new Fe(r(t.geometry),i(t.material));break;case"LineSegments":o=new Ue(r(t.geometry),i(t.material));break;case"PointCloud":case"Points":o=new Ve(r(t.geometry),i(t.material));break;case"Sprite":o=new Re(i(t.material));break;case"Group":o=new je;break;default:o=new E}if(o.uuid=t.uuid,void 0!==t.name&&(o.name=t.name),void 0!==t.matrix?(o.matrix.fromArray(t.matrix),void 0!==t.matrixAutoUpdate&&(o.matrixAutoUpdate=t.matrixAutoUpdate),o.matrixAutoUpdate&&o.matrix.decompose(o.position,o.quaternion,o.scale)):(void 0!==t.position&&o.position.fromArray(t.position),void 0!==t.rotation&&o.rotation.fromArray(t.rotation),void 0!==t.quaternion&&o.quaternion.fromArray(t.quaternion),void 0!==t.scale&&o.scale.fromArray(t.scale)),void 0!==t.castShadow&&(o.castShadow=t.castShadow),void 0!==t.receiveShadow&&(o.receiveShadow=t.receiveShadow),t.shadow&&(void 0!==t.shadow.bias&&(o.shadow.bias=t.shadow.bias),void 0!==t.shadow.radius&&(o.shadow.radius=t.shadow.radius),void 0!==t.shadow.mapSize&&o.shadow.mapSize.fromArray(t.shadow.mapSize),void 0!==t.shadow.camera&&(o.shadow.camera=this.parseObject(t.shadow.camera))),void 0!==t.visible&&(o.visible=t.visible),void 0!==t.frustumCulled&&(o.frustumCulled=t.frustumCulled),void 0!==t.renderOrder&&(o.renderOrder=t.renderOrder),void 0!==t.userData&&(o.userData=t.userData),void 0!==t.children)for(var u=t.children,c=0;c<u.length;c++)o.add(this.parseObject(u[c],e,n));if("LOD"===t.type)for(var l=t.levels,h=0;h<l.length;h++){var f=l[h],d=o.getObjectByProperty("uuid",f.object);void 0!==d&&o.addLevel(d,f.distance)}return o}});var lc={UVMapping:ts,CubeReflectionMapping:es,CubeRefractionMapping:ns,EquirectangularReflectionMapping:rs,EquirectangularRefractionMapping:is,SphericalReflectionMapping:os,CubeUVReflectionMapping:as,CubeUVRefractionMapping:ss},hc={RepeatWrapping:us,ClampToEdgeWrapping:cs,MirroredRepeatWrapping:ls},fc={NearestFilter:hs,NearestMipMapNearestFilter:fs,NearestMipMapLinearFilter:ds,LinearFilter:ps,LinearMipMapNearestFilter:ms,LinearMipMapLinearFilter:gs};Ei.prototype={constructor:Ei,setOptions:function(t){return this.options=t,this},load:function(t,e,n,r){void 0===t&&(t=""),void 0!==this.path&&(t=this.path+t);var i=this,o=$u.get(t);if(void 0!==o)return i.manager.itemStart(t),setTimeout(function(){e&&e(o),i.manager.itemEnd(t)},0),o;fetch(t).then(function(t){return t.blob()}).then(function(t){return createImageBitmap(t,i.options)}).then(function(n){$u.add(t,n),e&&e(n),i.manager.itemEnd(t)}).catch(function(e){r&&r(e),i.manager.itemEnd(t),i.manager.itemError(t)})},setCrossOrigin:function(){return this},setPath:function(t){return this.path=t,this}},Object.assign(xi.prototype,{moveTo:function(t,e){this.currentPath=new qr,this.subPaths.push(this.currentPath),this.currentPath.moveTo(t,e)},lineTo:function(t,e){this.currentPath.lineTo(t,e)},quadraticCurveTo:function(t,e,n,r){this.currentPath.quadraticCurveTo(t,e,n,r)},bezierCurveTo:function(t,e,n,r,i,o){this.currentPath.bezierCurveTo(t,e,n,r,i,o)},splineThru:function(t){this.currentPath.splineThru(t)},toShapes:function(t,e){function n(t){for(var e=[],n=0,r=t.length;n<r;n++){var i=t[n],o=new Yr;o.curves=i.curves,e.push(o)}return e}var r=Qu.isClockWise,i=this.subPaths;if(0===i.length)return[];if(!0===e)return n(i);var o,a,s,u=[];if(1===i.length)return a=i[0],s=new Yr,s.curves=a.curves,u.push(s),u;var c=!r(i[0].getPoints());c=t?!c:c;var l,h=[],f=[],d=[],p=0;f[p]=void 0,d[p]=[];for(var m=0,g=i.length;m<g;m++)a=i[m],l=a.getPoints(),o=r(l),o=t?!o:o,o?(!c&&f[p]&&p++,f[p]={s:new Yr,p:l},f[p].s.curves=a.curves,c&&p++,d[p]=[]):d[p].push({h:a,p:l[0]});if(!f[0])return n(i);if(f.length>1){for(var v=!1,y=[],_=0,b=f.length;_<b;_++)h[_]=[];for(var _=0,b=f.length;_<b;_++)for(var w=d[_],E=0;E<w.length;E++){for(var x=w[E],T=!0,S=0;S<f.length;S++)(function(t,e){for(var n=e.length,r=!1,i=n-1,o=0;o<n;i=o++){var a=e[i],s=e[o],u=s.x-a.x,c=s.y-a.y;if(Math.abs(c)>Number.EPSILON){if(c<0&&(a=e[o],u=-u,s=e[i],c=-c),t.y<a.y||t.y>s.y)continue;if(t.y===a.y){if(t.x===a.x)return!0}else{var l=c*(t.x-a.x)-u*(t.y-a.y);if(0===l)return!0;if(l<0)continue;r=!r}}else{if(t.y!==a.y)continue;if(s.x<=t.x&&t.x<=a.x||a.x<=t.x&&t.x<=s.x)return!0}}return r})(x.p,f[S].p)&&(_!==S&&y.push({froms:_,tos:S,hole:E}),T?(T=!1,h[S].push(x)):v=!0);T&&h[_].push(x)}y.length>0&&(v||(d=h))}for(var C,m=0,M=f.length;m<M;m++){s=f[m].s,u.push(s),C=d[m];for(var A=0,I=C.length;A<I;A++)s.holes.push(C[A].h)}return u}}),Object.assign(Ti.prototype,{isFont:!0,generateShapes:function(t,e,n){void 0===e&&(e=100),void 0===n&&(n=4);for(var r=[],i=Si(t,e,n,this.data),o=0,a=i.length;o<a;o++)Array.prototype.push.apply(r,i[o].toShapes());return r}}),Object.assign(Mi.prototype,{load:function(t,e,n,r){var i=this,o=new vr(this.manager);o.setPath(this.path),o.load(t,function(t){var n;try{n=JSON.parse(t)}catch(e){console.warn("THREE.FontLoader: typeface.js support is being deprecated. Use typeface.json instead."),n=JSON.parse(t.substring(65,t.length-2))}var r=i.parse(n);e&&e(r)},n,r)},parse:function(t){return new Ti(t)},setPath:function(t){return this.path=t,this}});var dc,pc={getContext:function(){return void 0===dc&&(dc=new(window.AudioContext||window.webkitAudioContext)),dc},setContext:function(t){dc=t}};Object.assign(Ai.prototype,{load:function(t,e,n,r){var i=new vr(this.manager);i.setResponseType("arraybuffer"),i.load(t,function(t){pc.getContext().decodeAudioData(t,function(t){e(t)})},n,r)}}),Object.assign(Ii.prototype,{update:function(){var t,e,n,r,i,a,s,u,c=new o,l=new o;return function(o){if(t!==this||e!==o.focus||n!==o.fov||r!==o.aspect*this.aspect||i!==o.near||a!==o.far||s!==o.zoom||u!==this.eyeSep){t=this,e=o.focus,n=o.fov,r=o.aspect*this.aspect,i=o.near,a=o.far,s=o.zoom;var h=o.projectionMatrix.clone();u=this.eyeSep/2;var f,d,p=u*i/e,m=i*Math.tan(Au.DEG2RAD*n*.5)/s;l.elements[12]=-u,c.elements[12]=u,f=-m*r+p,d=m*r+p,h.elements[0]=2*i/(d-f),h.elements[8]=(d+f)/(d-f),this.cameraL.projectionMatrix.copy(h),f=-m*r-p,d=m*r-p,h.elements[0]=2*i/(d-f),h.elements[8]=(d+f)/(d-f),this.cameraR.projectionMatrix.copy(h)}this.cameraL.matrixWorld.copy(o.matrixWorld).multiply(l),this.cameraR.matrixWorld.copy(o.matrixWorld).multiply(c)}}()}),Ri.prototype=Object.create(E.prototype),Ri.prototype.constructor=Ri,Pi.prototype=Object.assign(Object.create(E.prototype),{constructor:Pi,getInput:function(){return this.gain},removeFilter:function(){null!==this.filter&&(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination),this.gain.connect(this.context.destination),this.filter=null)},getFilter:function(){return this.filter},setFilter:function(t){null!==this.filter?(this.gain.disconnect(this.filter),this.filter.disconnect(this.context.destination)):this.gain.disconnect(this.context.destination),this.filter=t,this.gain.connect(this.filter),this.filter.connect(this.context.destination)},getMasterVolume:function(){return this.gain.gain.value},setMasterVolume:function(t){this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01)},updateMatrixWorld:function(){var t=new s,e=new a,n=new s,r=new s;return function(i){E.prototype.updateMatrixWorld.call(this,i);var o=this.context.listener,a=this.up;this.matrixWorld.decompose(t,e,n),r.set(0,0,-1).applyQuaternion(e),o.positionX?(o.positionX.setValueAtTime(t.x,this.context.currentTime),o.positionY.setValueAtTime(t.y,this.context.currentTime),o.positionZ.setValueAtTime(t.z,this.context.currentTime),o.forwardX.setValueAtTime(r.x,this.context.currentTime),o.forwardY.setValueAtTime(r.y,this.context.currentTime),o.forwardZ.setValueAtTime(r.z,this.context.currentTime),o.upX.setValueAtTime(a.x,this.context.currentTime),o.upY.setValueAtTime(a.y,this.context.currentTime),o.upZ.setValueAtTime(a.z,this.context.currentTime)):(o.setPosition(t.x,t.y,t.z),o.setOrientation(r.x,r.y,r.z,a.x,a.y,a.z))}}()}),Ni.prototype=Object.assign(Object.create(E.prototype),{constructor:Ni,getOutput:function(){return this.gain},setNodeSource:function(t){return this.hasPlaybackControl=!1,this.sourceType="audioNode",this.source=t,this.connect(),this},setBuffer:function(t){return this.buffer=t,this.sourceType="buffer",this.autoplay&&this.play(),this},play:function(){if(!0===this.isPlaying)return void console.warn("THREE.Audio: Audio is already playing.");if(!1===this.hasPlaybackControl)return void console.warn("THREE.Audio: this Audio has no playback control.");var t=this.context.createBufferSource();return t.buffer=this.buffer,t.loop=this.loop,t.onended=this.onEnded.bind(this),t.playbackRate.setValueAtTime(this.playbackRate,this.startTime),this.startTime=this.context.currentTime,t.start(this.startTime,this.offset),this.isPlaying=!0,this.source=t,this.connect()},pause:function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(!0===this.isPlaying&&(this.source.stop(),this.offset+=(this.context.currentTime-this.startTime)*this.playbackRate,this.isPlaying=!1),this)},stop:function(){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.source.stop(),this.offset=0,this.isPlaying=!1,this)},connect:function(){if(this.filters.length>0){this.source.connect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].connect(this.filters[t]);this.filters[this.filters.length-1].connect(this.getOutput())}else this.source.connect(this.getOutput());return this},disconnect:function(){if(this.filters.length>0){this.source.disconnect(this.filters[0]);for(var t=1,e=this.filters.length;t<e;t++)this.filters[t-1].disconnect(this.filters[t]);this.filters[this.filters.length-1].disconnect(this.getOutput())}else this.source.disconnect(this.getOutput());return this},getFilters:function(){return this.filters},setFilters:function(t){return t||(t=[]),!0===this.isPlaying?(this.disconnect(),this.filters=t,this.connect()):this.filters=t,this},getFilter:function(){return this.getFilters()[0]},setFilter:function(t){return this.setFilters(t?[t]:[])},setPlaybackRate:function(t){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.playbackRate=t,!0===this.isPlaying&&this.source.playbackRate.setValueAtTime(this.playbackRate,this.context.currentTime),this)},getPlaybackRate:function(){return this.playbackRate},onEnded:function(){this.isPlaying=!1},getLoop:function(){return!1===this.hasPlaybackControl?(console.warn("THREE.Audio: this Audio has no playback control."),!1):this.loop},setLoop:function(t){return!1===this.hasPlaybackControl?void console.warn("THREE.Audio: this Audio has no playback control."):(this.loop=t,!0===this.isPlaying&&(this.source.loop=this.loop),this)},getVolume:function(){return this.gain.gain.value},setVolume:function(t){return this.gain.gain.setTargetAtTime(t,this.context.currentTime,.01),this}}),Di.prototype=Object.assign(Object.create(Ni.prototype),{constructor:Di,getOutput:function(){return this.panner},getRefDistance:function(){return this.panner.refDistance},setRefDistance:function(t){this.panner.refDistance=t},getRolloffFactor:function(){return this.panner.rolloffFactor},setRolloffFactor:function(t){this.panner.rolloffFactor=t},getDistanceModel:function(){return this.panner.distanceModel},setDistanceModel:function(t){this.panner.distanceModel=t},getMaxDistance:function(){return this.panner.maxDistance},setMaxDistance:function(t){this.panner.maxDistance=t},updateMatrixWorld:function(){var t=new s;return function(e){E.prototype.updateMatrixWorld.call(this,e),t.setFromMatrixPosition(this.matrixWorld),this.panner.setPosition(t.x,t.y,t.z)}}()}),Object.assign(Oi.prototype,{getFrequencyData:function(){return this.analyser.getByteFrequencyData(this.data),this.data},getAverageFrequency:function(){for(var t=0,e=this.getFrequencyData(),n=0;n<e.length;n++)t+=e[n];return t/e.length}}),Object.assign(ki.prototype,{accumulate:function(t,e){var n=this.buffer,r=this.valueSize,i=t*r+r,o=this.cumulativeWeight;if(0===o){for(var a=0;a!==r;++a)n[i+a]=n[a];o=e}else{o+=e;var s=e/o;this._mixBufferRegion(n,i,0,s,r)}this.cumulativeWeight=o},apply:function(t){var e=this.valueSize,n=this.buffer,r=t*e+e,i=this.cumulativeWeight,o=this.binding;if(this.cumulativeWeight=0,i<1){var a=3*e;this._mixBufferRegion(n,r,a,1-i,e)}for(var s=e,u=e+e;s!==u;++s)if(n[s]!==n[s+e]){o.setValue(n,r);break}},saveOriginalState:function(){var t=this.binding,e=this.buffer,n=this.valueSize,r=3*n;t.getValue(e,r);for(var i=n,o=r;i!==o;++i)e[i]=e[r+i%n];this.cumulativeWeight=0},restoreOriginalState:function(){var t=3*this.valueSize;this.binding.setValue(this.buffer,t)},_select:function(t,e,n,r,i){if(r>=.5)for(var o=0;o!==i;++o)t[e+o]=t[n+o]},_slerp:function(t,e,n,r){a.slerpFlat(t,e,t,e,t,n,r)},_lerp:function(t,e,n,r,i){for(var o=1-r,a=0;a!==i;++a){var s=e+a;t[s]=t[s]*o+t[n+a]*r}}});var mc="\\[\\]\\.:\\/";Object.assign(Li.prototype,{getValue:function(t,e){this.bind();var n=this._targetGroup.nCachedObjects_,r=this._bindings[n];void 0!==r&&r.getValue(t,e)},setValue:function(t,e){for(var n=this._bindings,r=this._targetGroup.nCachedObjects_,i=n.length;r!==i;++r)n[r].setValue(t,e)},bind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].bind()},unbind:function(){for(var t=this._bindings,e=this._targetGroup.nCachedObjects_,n=t.length;e!==n;++e)t[e].unbind()}}),Object.assign(Ui,{Composite:Li,create:function(t,e,n){return t&&t.isAnimationObjectGroup?new Ui.Composite(t,e,n):new Ui(t,e,n)},sanitizeNodeName:function(){var t=new RegExp("["+mc+"]","g");return function(e){return e.replace(/\s/g,"_").replace(t,"")}}(),parseTrackName:function(){var t="[^"+mc+"]",e="[^"+mc.replace("\\.","")+"]",n=/((?:WC+[\/:])*)/.source.replace("WC",t),r=/(WCOD+)?/.source.replace("WCOD",e),i=/(?:\.(WC+)(?:\[(.+)\])?)?/.source.replace("WC",t),o=/\.(WC+)(?:\[(.+)\])?/.source.replace("WC",t),a=new RegExp("^"+n+r+i+o+"$"),s=["material","materials","bones"];return function(t){var e=a.exec(t);if(!e)throw new Error("PropertyBinding: Cannot parse trackName: "+t);var n={nodeName:e[2],objectName:e[3],objectIndex:e[4],propertyName:e[5],propertyIndex:e[6]},r=n.nodeName&&n.nodeName.lastIndexOf(".");if(void 0!==r&&-1!==r){var i=n.nodeName.substring(r+1);-1!==s.indexOf(i)&&(n.nodeName=n.nodeName.substring(0,r),n.objectName=i)}if(null===n.propertyName||0===n.propertyName.length)throw new Error("PropertyBinding: can not parse propertyName from trackName: "+t);return n}}(),findNode:function(t,e){if(!e||""===e||"root"===e||"."===e||-1===e||e===t.name||e===t.uuid)return t;if(t.skeleton){var n=t.skeleton.getBoneByName(e);if(void 0!==n)return n}if(t.children){var r=function(t){for(var n=0;n<t.length;n++){var i=t[n];if(i.name===e||i.uuid===e)return i;var o=r(i.children);if(o)return o}return null},i=r(t.children);if(i)return i}return null}}),Object.assign(Ui.prototype,{_getValue_unavailable:function(){},_setValue_unavailable:function(){},BindingType:{Direct:0,EntireArray:1,ArrayElement:2,HasFromToArray:3},Versioning:{None:0,NeedsUpdate:1,MatrixWorldNeedsUpdate:2},GetterByBindingType:[function(t,e){t[e]=this.node[this.propertyName]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)t[e++]=n[r]},function(t,e){t[e]=this.resolvedProperty[this.propertyIndex]},function(t,e){this.resolvedProperty.toArray(t,e)}],SetterByBindingTypeAndVersioning:[[function(t,e){this.targetObject[this.propertyName]=t[e]},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.targetObject[this.propertyName]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++]},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.needsUpdate=!0},function(t,e){for(var n=this.resolvedProperty,r=0,i=n.length;r!==i;++r)n[r]=t[e++];this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty[this.propertyIndex]=t[e]},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty[this.propertyIndex]=t[e],this.targetObject.matrixWorldNeedsUpdate=!0}],[function(t,e){this.resolvedProperty.fromArray(t,e)},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.needsUpdate=!0},function(t,e){this.resolvedProperty.fromArray(t,e),this.targetObject.matrixWorldNeedsUpdate=!0}]],getValue:function(t,e){this.bind(),this.getValue(t,e)},setValue:function(t,e){this.bind(),this.setValue(t,e)},bind:function(){var t=this.node,e=this.parsedPath,n=e.objectName,r=e.propertyName,i=e.propertyIndex;if(t||(t=Ui.findNode(this.rootNode,e.nodeName)||this.rootNode,this.node=t),this.getValue=this._getValue_unavailable,this.setValue=this._setValue_unavailable,!t)return void console.error("THREE.PropertyBinding: Trying to update node for track: "+this.path+" but it wasn't found.");if(n){var o=e.objectIndex;switch(n){case"materials":if(!t.material)return void console.error("THREE.PropertyBinding: Can not bind to material as node does not have a material.",this);if(!t.material.materials)return void console.error("THREE.PropertyBinding: Can not bind to material.materials as node.material does not have a materials array.",this);t=t.material.materials;break;case"bones":if(!t.skeleton)return void console.error("THREE.PropertyBinding: Can not bind to bones as node does not have a skeleton.",this);t=t.skeleton.bones;for(var a=0;a<t.length;a++)if(t[a].name===o){o=a;break}break;default:if(void 0===t[n])return void console.error("THREE.PropertyBinding: Can not bind to objectName of node undefined.",this);t=t[n]}if(void 0!==o){if(void 0===t[o])return void console.error("THREE.PropertyBinding: Trying to bind to objectIndex of objectName, but is undefined.",this,t);t=t[o]}}var s=t[r];if(void 0===s){var u=e.nodeName;return void console.error("THREE.PropertyBinding: Trying to update property for track: "+u+"."+r+" but it wasn't found.",t)}var c=this.Versioning.None;void 0!==t.needsUpdate?(c=this.Versioning.NeedsUpdate,this.targetObject=t):void 0!==t.matrixWorldNeedsUpdate&&(c=this.Versioning.MatrixWorldNeedsUpdate,this.targetObject=t);var l=this.BindingType.Direct;if(void 0!==i){if("morphTargetInfluences"===r){if(!t.geometry)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.",this);if(t.geometry.isBufferGeometry){if(!t.geometry.morphAttributes)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphAttributes.",this);for(var a=0;a<this.node.geometry.morphAttributes.position.length;a++)if(t.geometry.morphAttributes.position[a].name===i){i=a;break}}else{if(!t.geometry.morphTargets)return void console.error("THREE.PropertyBinding: Can not bind to morphTargetInfluences because node does not have a geometry.morphTargets.",this);for(var a=0;a<this.node.geometry.morphTargets.length;a++)if(t.geometry.morphTargets[a].name===i){i=a;break}}}l=this.BindingType.ArrayElement,this.resolvedProperty=s,this.propertyIndex=i}else void 0!==s.fromArray&&void 0!==s.toArray?(l=this.BindingType.HasFromToArray,this.resolvedProperty=s):Array.isArray(s)?(l=this.BindingType.EntireArray,this.resolvedProperty=s):this.propertyName=r;this.getValue=this.GetterByBindingType[l],this.setValue=this.SetterByBindingTypeAndVersioning[l][c]},unbind:function(){this.node=null,this.getValue=this._getValue_unbound,this.setValue=this._setValue_unbound}}),Object.assign(Ui.prototype,{_getValue_unbound:Ui.prototype.getValue,_setValue_unbound:Ui.prototype.setValue}),Object.assign(Fi.prototype,{isAnimationObjectGroup:!0,add:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._paths,o=this._parsedPaths,a=this._bindings,s=a.length,u=void 0,c=0,l=arguments.length;c!==l;++c){var h=arguments[c],f=h.uuid,d=r[f];if(void 0===d){d=e++,r[f]=d,t.push(h);for(var p=0,m=s;p!==m;++p)a[p].push(new Ui(h,i[p],o[p]))}else if(d<n){u=t[d];var g=--n,v=t[g];r[v.uuid]=d,t[d]=v,r[f]=g,t[g]=h;for(var p=0,m=s;p!==m;++p){var y=a[p],_=y[g],b=y[d];y[d]=_,void 0===b&&(b=new Ui(h,i[p],o[p])),y[g]=b}}else t[d]!==u&&console.error("THREE.AnimationObjectGroup: Different objects with the same UUID detected. Clean the caches or recreate your infrastructure when reloading scenes.")}this.nCachedObjects_=n},remove:function(){for(var t=this._objects,e=this.nCachedObjects_,n=this._indicesByUUID,r=this._bindings,i=r.length,o=0,a=arguments.length;o!==a;++o){var s=arguments[o],u=s.uuid,c=n[u];if(void 0!==c&&c>=e){var l=e++,h=t[l];n[h.uuid]=c,t[c]=h,n[u]=l,t[l]=s;for(var f=0,d=i;f!==d;++f){var p=r[f],m=p[l],g=p[c];p[c]=m,p[l]=g}}}this.nCachedObjects_=e},uncache:function(){for(var t=this._objects,e=t.length,n=this.nCachedObjects_,r=this._indicesByUUID,i=this._bindings,o=i.length,a=0,s=arguments.length;a!==s;++a){var u=arguments[a],c=u.uuid,l=r[c];if(void 0!==l)if(delete r[c],l<n){var h=--n,f=t[h],d=--e,p=t[d];r[f.uuid]=l,t[l]=f,r[p.uuid]=h,t[h]=p,t.pop();for(var m=0,g=o;m!==g;++m){var v=i[m],y=v[h],_=v[d];v[l]=y,v[h]=_,v.pop()}}else{var d=--e,p=t[d];r[p.uuid]=l,t[l]=p,t.pop();for(var m=0,g=o;m!==g;++m){var v=i[m];v[l]=v[d],v.pop()}}}this.nCachedObjects_=n},subscribe_:function(t,e){var n=this._bindingsIndicesByPath,r=n[t],i=this._bindings;if(void 0!==r)return i[r];var o=this._paths,a=this._parsedPaths,s=this._objects,u=s.length,c=this.nCachedObjects_,l=new Array(u);r=i.length,n[t]=r,o.push(t),a.push(e),i.push(l);for(var h=c,f=s.length;h!==f;++h){var d=s[h];l[h]=new Ui(d,t,e)}return l},unsubscribe_:function(t){var e=this._bindingsIndicesByPath,n=e[t];if(void 0!==n){var r=this._paths,i=this._parsedPaths,o=this._bindings,a=o.length-1,s=o[a];e[t[a]]=n,o[n]=s,o.pop(),i[n]=i[a],i.pop(),r[n]=r[a],r.pop()}}}),Object.assign(Bi.prototype,{play:function(){return this._mixer._activateAction(this),this},stop:function(){return this._mixer._deactivateAction(this),this.reset()},reset:function(){return this.paused=!1,this.enabled=!0,this.time=0,this._loopCount=-1,this._startTime=null,this.stopFading().stopWarping()},isRunning:function(){return this.enabled&&!this.paused&&0!==this.timeScale&&null===this._startTime&&this._mixer._isActiveAction(this)},isScheduled:function(){return this._mixer._isActiveAction(this)},startAt:function(t){return this._startTime=t,this},setLoop:function(t,e){return this.loop=t,this.repetitions=e,this},setEffectiveWeight:function(t){return this.weight=t,this._effectiveWeight=this.enabled?t:0,this.stopFading()},getEffectiveWeight:function(){return this._effectiveWeight},fadeIn:function(t){return this._scheduleFading(t,0,1)},fadeOut:function(t){return this._scheduleFading(t,1,0)},crossFadeFrom:function(t,e,n){if(t.fadeOut(e),this.fadeIn(e),n){var r=this._clip.duration,i=t._clip.duration,o=i/r,a=r/i;t.warp(1,o,e),this.warp(a,1,e)}return this},crossFadeTo:function(t,e,n){return t.crossFadeFrom(this,e,n)},stopFading:function(){var t=this._weightInterpolant;return null!==t&&(this._weightInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},setEffectiveTimeScale:function(t){return this.timeScale=t,this._effectiveTimeScale=this.paused?0:t,this.stopWarping()},getEffectiveTimeScale:function(){return this._effectiveTimeScale},setDuration:function(t){return this.timeScale=this._clip.duration/t,this.stopWarping()},syncWith:function(t){return this.time=t.time,this.timeScale=t.timeScale,this.stopWarping()},halt:function(t){return this.warp(this._effectiveTimeScale,0,t)},warp:function(t,e,n){var r=this._mixer,i=r.time,o=this._timeScaleInterpolant,a=this.timeScale;null===o&&(o=r._lendControlInterpolant(),this._timeScaleInterpolant=o);var s=o.parameterPositions,u=o.sampleValues;return s[0]=i,s[1]=i+n,u[0]=t/a,u[1]=e/a,this},stopWarping:function(){var t=this._timeScaleInterpolant;return null!==t&&(this._timeScaleInterpolant=null,this._mixer._takeBackControlInterpolant(t)),this},getMixer:function(){return this._mixer},getClip:function(){return this._clip},getRoot:function(){return this._localRoot||this._mixer._root},_update:function(t,e,n,r){if(!this.enabled)return void this._updateWeight(t);var i=this._startTime;if(null!==i){var o=(t-i)*n;if(o<0||0===n)return;this._startTime=null,e=n*o}e*=this._updateTimeScale(t);var a=this._updateTime(e),s=this._updateWeight(t);if(s>0)for(var u=this._interpolants,c=this._propertyBindings,l=0,h=u.length;l!==h;++l)u[l].evaluate(a),c[l].accumulate(r,s)},_updateWeight:function(t){var e=0;if(this.enabled){e=this.weight;var n=this._weightInterpolant;if(null!==n){var r=n.evaluate(t)[0];e*=r,t>n.parameterPositions[1]&&(this.stopFading(),0===r&&(this.enabled=!1))}}return this._effectiveWeight=e,e},_updateTimeScale:function(t){var e=0;if(!this.paused){e=this.timeScale;var n=this._timeScaleInterpolant;if(null!==n){e*=n.evaluate(t)[0],t>n.parameterPositions[1]&&(this.stopWarping(),0===e?this.paused=!0:this.timeScale=e)}}return this._effectiveTimeScale=e,e},_updateTime:function(t){var e=this.time+t;if(0===t)return e;var n=this._clip.duration,r=this.loop,i=this._loopCount;if(r===au){-1===i&&(this._loopCount=0,this._setEndings(!0,!0,!1));t:{if(e>=n)e=n;else{if(!(e<0))break t;e=0}this.clampWhenFinished?this.paused=!0:this.enabled=!1,this._mixer.dispatchEvent({type:"finished",action:this,direction:t<0?-1:1})}}else{var o=r===uu;if(-1===i&&(t>=0?(i=0,this._setEndings(!0,0===this.repetitions,o)):this._setEndings(0===this.repetitions,!0,o)),e>=n||e<0){var a=Math.floor(e/n);e-=n*a,i+=Math.abs(a);var s=this.repetitions-i;if(s<=0)this.clampWhenFinished?this.paused=!0:this.enabled=!1,e=t>0?n:0,this._mixer.dispatchEvent({type:"finished",action:this,direction:t>0?1:-1});else{if(1===s){var u=t<0;this._setEndings(u,!u,o)}else this._setEndings(!1,!1,o);this._loopCount=i,this._mixer.dispatchEvent({type:"loop",action:this,loopDelta:a})}}if(o&&1===(1&i))return this.time=e,n-e}return this.time=e,e},_setEndings:function(t,e,n){var r=this._interpolantSettings;n?(r.endingStart=du,r.endingEnd=du):(r.endingStart=t?this.zeroSlopeAtStart?du:fu:pu,r.endingEnd=e?this.zeroSlopeAtEnd?du:fu:pu)},_scheduleFading:function(t,e,n){var r=this._mixer,i=r.time,o=this._weightInterpolant;null===o&&(o=r._lendControlInterpolant(),this._weightInterpolant=o);var a=o.parameterPositions,s=o.sampleValues;return a[0]=i,s[0]=e,a[1]=i+t,s[1]=n,this}}),Vi.prototype=Object.assign(Object.create(r.prototype),{constructor:Vi,_bindAction:function(t,e){var n=t._localRoot||this._root,r=t._clip.tracks,i=r.length,o=t._propertyBindings,a=t._interpolants,s=n.uuid,u=this._bindingsByRootAndName,c=u[s];void 0===c&&(c={},u[s]=c);for(var l=0;l!==i;++l){var h=r[l],f=h.name,d=c[f];if(void 0!==d)o[l]=d;else{if(void 0!==(d=o[l])){null===d._cacheIndex&&(++d.referenceCount,this._addInactiveBinding(d,s,f));continue}var p=e&&e._propertyBindings[l].binding.parsedPath;d=new ki(Ui.create(n,f,p),h.ValueTypeName,h.getValueSize()),++d.referenceCount,this._addInactiveBinding(d,s,f),o[l]=d}a[l].resultBuffer=d.buffer}},_activateAction:function(t){if(!this._isActiveAction(t)){if(null===t._cacheIndex){var e=(t._localRoot||this._root).uuid,n=t._clip.uuid,r=this._actionsByClip[n];this._bindAction(t,r&&r.knownActions[0]),this._addInactiveAction(t,n,e)}for(var i=t._propertyBindings,o=0,a=i.length;o!==a;++o){var s=i[o];0===s.useCount++&&(this._lendBinding(s),s.saveOriginalState())}this._lendAction(t)}},_deactivateAction:function(t){if(this._isActiveAction(t)){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0===--i.useCount&&(i.restoreOriginalState(),this._takeBackBinding(i))}this._takeBackAction(t)}},_initMemoryManager:function(){this._actions=[],this._nActiveActions=0,this._actionsByClip={},this._bindings=[],this._nActiveBindings=0,this._bindingsByRootAndName={},this._controlInterpolants=[],this._nActiveControlInterpolants=0;var t=this;this.stats={actions:{get total(){return t._actions.length},get inUse(){return t._nActiveActions}},bindings:{get total(){return t._bindings.length},get inUse(){return t._nActiveBindings}},controlInterpolants:{get total(){return t._controlInterpolants.length},get inUse(){return t._nActiveControlInterpolants}}}},_isActiveAction:function(t){var e=t._cacheIndex;return null!==e&&e<this._nActiveActions},_addInactiveAction:function(t,e,n){var r=this._actions,i=this._actionsByClip,o=i[e];if(void 0===o)o={knownActions:[t],actionByRoot:{}},t._byClipCacheIndex=0,i[e]=o;else{var a=o.knownActions;t._byClipCacheIndex=a.length,a.push(t)}t._cacheIndex=r.length,r.push(t),o.actionByRoot[n]=t},_removeInactiveAction:function(t){var e=this._actions,n=e[e.length-1],r=t._cacheIndex;n._cacheIndex=r,e[r]=n,e.pop(),t._cacheIndex=null;var i=t._clip.uuid,o=this._actionsByClip,a=o[i],s=a.knownActions,u=s[s.length-1],c=t._byClipCacheIndex;u._byClipCacheIndex=c,s[c]=u,s.pop(),t._byClipCacheIndex=null,delete a.actionByRoot[(t._localRoot||this._root).uuid],0===s.length&&delete o[i],this._removeInactiveBindingsForAction(t)},_removeInactiveBindingsForAction:function(t){for(var e=t._propertyBindings,n=0,r=e.length;n!==r;++n){var i=e[n];0===--i.referenceCount&&this._removeInactiveBinding(i)}},_lendAction:function(t){var e=this._actions,n=t._cacheIndex,r=this._nActiveActions++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackAction:function(t){var e=this._actions,n=t._cacheIndex,r=--this._nActiveActions,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_addInactiveBinding:function(t,e,n){var r=this._bindingsByRootAndName,i=r[e],o=this._bindings;void 0===i&&(i={},r[e]=i),i[n]=t,t._cacheIndex=o.length,o.push(t)},_removeInactiveBinding:function(t){var e=this._bindings,n=t.binding,r=n.rootNode.uuid,i=n.path,o=this._bindingsByRootAndName,a=o[r],s=e[e.length-1],u=t._cacheIndex;s._cacheIndex=u,e[u]=s,e.pop(),delete a[i];t:{for(var c in a)break t;delete o[r]}},_lendBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=this._nActiveBindings++,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_takeBackBinding:function(t){var e=this._bindings,n=t._cacheIndex,r=--this._nActiveBindings,i=e[r];t._cacheIndex=r,e[r]=t,i._cacheIndex=n,e[n]=i},_lendControlInterpolant:function(){var t=this._controlInterpolants,e=this._nActiveControlInterpolants++,n=t[e];return void 0===n&&(n=new fi(new Float32Array(2),new Float32Array(2),1,this._controlInterpolantsResultBuffer),n.__cacheIndex=e,t[e]=n),n},_takeBackControlInterpolant:function(t){var e=this._controlInterpolants,n=t.__cacheIndex,r=--this._nActiveControlInterpolants,i=e[r];t.__cacheIndex=r,e[r]=t,i.__cacheIndex=n,e[n]=i},_controlInterpolantsResultBuffer:new Float32Array(1),clipAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"===typeof t?gi.findByName(n,t):t,o=null!==i?i.uuid:t,a=this._actionsByClip[o],s=null;if(void 0!==a){var u=a.actionByRoot[r];if(void 0!==u)return u;s=a.knownActions[0],null===i&&(i=s._clip)}if(null===i)return null;var c=new Bi(this,i,e);return this._bindAction(c,s),this._addInactiveAction(c,o,r),c},existingAction:function(t,e){var n=e||this._root,r=n.uuid,i="string"===typeof t?gi.findByName(n,t):t,o=i?i.uuid:t,a=this._actionsByClip[o];return void 0!==a?a.actionByRoot[r]||null:null},stopAllAction:function(){var t=this._actions,e=this._nActiveActions,n=this._bindings,r=this._nActiveBindings;this._nActiveActions=0,this._nActiveBindings=0;for(var i=0;i!==e;++i)t[i].reset();for(var i=0;i!==r;++i)n[i].useCount=0;return this},update:function(t){t*=this.timeScale;for(var e=this._actions,n=this._nActiveActions,r=this.time+=t,i=Math.sign(t),o=this._accuIndex^=1,a=0;a!==n;++a){e[a]._update(r,t,i,o)}for(var s=this._bindings,u=this._nActiveBindings,a=0;a!==u;++a)s[a].apply(o);return this},getRoot:function(){return this._root},uncacheClip:function(t){var e=this._actions,n=t.uuid,r=this._actionsByClip,i=r[n];if(void 0!==i){for(var o=i.knownActions,a=0,s=o.length;a!==s;++a){var u=o[a];this._deactivateAction(u);var c=u._cacheIndex,l=e[e.length-1];u._cacheIndex=null,u._byClipCacheIndex=null,l._cacheIndex=c,e[c]=l,e.pop(),this._removeInactiveBindingsForAction(u)}delete r[n]}},uncacheRoot:function(t){var e=t.uuid,n=this._actionsByClip;for(var r in n){var i=n[r].actionByRoot,o=i[e];void 0!==o&&(this._deactivateAction(o),this._removeInactiveAction(o))}var a=this._bindingsByRootAndName,s=a[e];if(void 0!==s)for(var u in s){var c=s[u];c.restoreOriginalState(),this._removeInactiveBinding(c)}},uncacheAction:function(t,e){var n=this.existingAction(t,e);null!==n&&(this._deactivateAction(n),this._removeInactiveAction(n))}}),ji.prototype.clone=function(){return new ji(void 0===this.value.clone?this.value:this.value.clone())},Hi.prototype=Object.assign(Object.create(B.prototype),{constructor:Hi,isInstancedBufferGeometry:!0,copy:function(t){return B.prototype.copy.call(this,t),this.maxInstancedCount=t.maxInstancedCount,this},clone:function(){return(new this.constructor).copy(this)}}),Object.defineProperties(Gi.prototype,{count:{get:function(){return this.data.count}},array:{get:function(){return this.data.array}}}),Object.assign(Gi.prototype,{isInterleavedBufferAttribute:!0,setX:function(t,e){return this.data.array[t*this.data.stride+this.offset]=e,this},setY:function(t,e){return this.data.array[t*this.data.stride+this.offset+1]=e,this},setZ:function(t,e){return this.data.array[t*this.data.stride+this.offset+2]=e,this},setW:function(t,e){return this.data.array[t*this.data.stride+this.offset+3]=e,this},getX:function(t){return this.data.array[t*this.data.stride+this.offset]},getY:function(t){return this.data.array[t*this.data.stride+this.offset+1]},getZ:function(t){return this.data.array[t*this.data.stride+this.offset+2]},getW:function(t){return this.data.array[t*this.data.stride+this.offset+3]},setXY:function(t,e,n){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this},setXYZ:function(t,e,n,r){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this},setXYZW:function(t,e,n,r,i){return t=t*this.data.stride+this.offset,this.data.array[t+0]=e,this.data.array[t+1]=n,this.data.array[t+2]=r,this.data.array[t+3]=i,this}}),Object.defineProperty(zi.prototype,"needsUpdate",{set:function(t){!0===t&&this.version++}}),Object.assign(zi.prototype,{isInterleavedBuffer:!0,onUploadCallback:function(){},setArray:function(t){if(Array.isArray(t))throw new TypeError("THREE.BufferAttribute: array should be a Typed Array.");return this.count=void 0!==t?t.length/this.stride:0,this.array=t,this},setDynamic:function(t){return this.dynamic=t,this},copy:function(t){return this.array=new t.array.constructor(t.array),this.count=t.count,this.stride=t.stride,this.dynamic=t.dynamic,this},copyAt:function(t,e,n){t*=this.stride,n*=e.stride;for(var r=0,i=this.stride;r<i;r++)this.array[t+r]=e.array[n+r];return this},set:function(t,e){return void 0===e&&(e=0),this.array.set(t,e),this},clone:function(){return(new this.constructor).copy(this)},onUpload:function(t){return this.onUploadCallback=t,this}}),Wi.prototype=Object.assign(Object.create(zi.prototype),{constructor:Wi,isInstancedInterleavedBuffer:!0,copy:function(t){return zi.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),qi.prototype=Object.assign(Object.create(M.prototype),{constructor:qi,isInstancedBufferAttribute:!0,copy:function(t){return M.prototype.copy.call(this,t),this.meshPerAttribute=t.meshPerAttribute,this}}),Object.assign(Yi.prototype,{linePrecision:1,set:function(t,e){this.ray.set(t,e)},setFromCamera:function(t,e){e&&e.isPerspectiveCamera?(this.ray.origin.setFromMatrixPosition(e.matrixWorld),this.ray.direction.set(t.x,t.y,.5).unproject(e).sub(this.ray.origin).normalize()):e&&e.isOrthographicCamera?(this.ray.origin.set(t.x,t.y,(e.near+e.far)/(e.near-e.far)).unproject(e),this.ray.direction.set(0,0,-1).transformDirection(e.matrixWorld)):console.error("THREE.Raycaster: Unsupported camera type.")},intersectObject:function(t,e,n){var r=n||[];return Qi(t,this,r,e),r.sort(Ki),r},intersectObjects:function(t,e,n){var r=n||[];if(!1===Array.isArray(t))return console.warn("THREE.Raycaster.intersectObjects: objects is not an Array."),r;for(var i=0,o=t.length;i<o;i++)Qi(t[i],this,r,e);return r.sort(Ki),r}}),Object.assign(Xi.prototype,{start:function(){this.startTime=("undefined"===typeof performance?Date:performance).now(),this.oldTime=this.startTime,this.elapsedTime=0,this.running=!0},stop:function(){this.getElapsedTime(),this.running=!1,this.autoStart=!1},getElapsedTime:function(){return this.getDelta(),this.elapsedTime},getDelta:function(){var t=0;if(this.autoStart&&!this.running)return this.start(),0;if(this.running){var e=("undefined"===typeof performance?Date:performance).now();t=(e-this.oldTime)/1e3,this.oldTime=e,this.elapsedTime+=t}return t}}),Object.assign(Ji.prototype,{set:function(t,e,n){return this.radius=t,this.phi=e,this.theta=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.phi=t.phi,this.theta=t.theta,this},makeSafe:function(){return this.phi=Math.max(1e-6,Math.min(Math.PI-1e-6,this.phi)),this},setFromVector3:function(t){return this.radius=t.length(),0===this.radius?(this.theta=0,this.phi=0):(this.theta=Math.atan2(t.x,t.z),this.phi=Math.acos(Au.clamp(t.y/this.radius,-1,1))),this}}),Object.assign(Zi.prototype,{set:function(t,e,n){return this.radius=t,this.theta=e,this.y=n,this},clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.radius=t.radius,this.theta=t.theta,this.y=t.y,this},setFromVector3:function(t){return this.radius=Math.sqrt(t.x*t.x+t.z*t.z),this.theta=Math.atan2(t.x,t.z),this.y=t.y,this}}),Object.assign($i.prototype,{set:function(t,e){return this.min.copy(t),this.max.copy(e),this},setFromPoints:function(t){this.makeEmpty();for(var e=0,n=t.length;e<n;e++)this.expandByPoint(t[e]);return this},setFromCenterAndSize:function(){var t=new i;return function(e,n){var r=t.copy(n).multiplyScalar(.5);return this.min.copy(e).sub(r),this.max.copy(e).add(r),this}}(),clone:function(){return(new this.constructor).copy(this)},copy:function(t){return this.min.copy(t.min),this.max.copy(t.max),this},makeEmpty:function(){return this.min.x=this.min.y=1/0,this.max.x=this.max.y=-1/0,this},isEmpty:function(){return this.max.x<this.min.x||this.max.y<this.min.y},getCenter:function(t){return void 0===t&&(console.warn("THREE.Box2: .getCenter() target is now required"),t=new i),this.isEmpty()?t.set(0,0):t.addVectors(this.min,this.max).multiplyScalar(.5)},getSize:function(t){return void 0===t&&(console.warn("THREE.Box2: .getSize() target is now required"),t=new i),this.isEmpty()?t.set(0,0):t.subVectors(this.max,this.min)},expandByPoint:function(t){return this.min.min(t),this.max.max(t),this},expandByVector:function(t){return this.min.sub(t),this.max.add(t),this},expandByScalar:function(t){return this.min.addScalar(-t),this.max.addScalar(t),this},containsPoint:function(t){return!(t.x<this.min.x||t.x>this.max.x||t.y<this.min.y||t.y>this.max.y)},containsBox:function(t){return this.min.x<=t.min.x&&t.max.x<=this.max.x&&this.min.y<=t.min.y&&t.max.y<=this.max.y},getParameter:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .getParameter() target is now required"),e=new i),e.set((t.x-this.min.x)/(this.max.x-this.min.x),(t.y-this.min.y)/(this.max.y-this.min.y))},intersectsBox:function(t){return!(t.max.x<this.min.x||t.min.x>this.max.x||t.max.y<this.min.y||t.min.y>this.max.y)},clampPoint:function(t,e){return void 0===e&&(console.warn("THREE.Box2: .clampPoint() target is now required"),e=new i),e.copy(t).clamp(this.min,this.max)},distanceToPoint:function(){var t=new i;return function(e){return t.copy(e).clamp(this.min,this.max).sub(e).length()}}(),intersect:function(t){return this.min.max(t.min),this.max.min(t.max),this},union:function(t){return this.min.min(t.min),this.max.max(t.max),this},translate:function(t){return this.min.add(t),this.max.add(t),this},equals:function(t){return t.min.equals(this.min)&&t.max.equals(this.max)}}),to.prototype=Object.create(E.prototype),to.prototype.constructor=to,to.prototype.isImmediateRenderObject=!0,eo.prototype=Object.create(Ue.prototype),eo.prototype.constructor=eo,eo.prototype.update=function(){var t=new s,e=new s,n=new u;return function(){var r=["a","b","c"];this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);var i=this.object.matrixWorld,o=this.geometry.attributes.position,a=this.object.geometry;if(a&&a.isGeometry)for(var s=a.vertices,u=a.faces,c=0,l=0,h=u.length;l<h;l++)for(var f=u[l],d=0,p=f.vertexNormals.length;d<p;d++){var m=s[f[r[d]]],g=f.vertexNormals[d];t.copy(m).applyMatrix4(i),e.copy(g).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(c,t.x,t.y,t.z),c+=1,o.setXYZ(c,e.x,e.y,e.z),c+=1}else if(a&&a.isBufferGeometry)for(var v=a.attributes.position,y=a.attributes.normal,c=0,d=0,p=v.count;d<p;d++)t.set(v.getX(d),v.getY(d),v.getZ(d)).applyMatrix4(i),e.set(y.getX(d),y.getY(d),y.getZ(d)),e.applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),o.setXYZ(c,t.x,t.y,t.z),c+=1,o.setXYZ(c,e.x,e.y,e.z),c+=1;o.needsUpdate=!0}}(),no.prototype=Object.create(E.prototype),no.prototype.constructor=no,no.prototype.dispose=function(){this.cone.geometry.dispose(),this.cone.material.dispose()},no.prototype.update=function(){var t=new s,e=new s;return function(){this.light.updateMatrixWorld();var n=this.light.distance?this.light.distance:1e3,r=n*Math.tan(this.light.angle);this.cone.scale.set(r,r,n),t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),this.cone.lookAt(e.sub(t)),void 0!==this.color?this.cone.material.color.set(this.color):this.cone.material.color.copy(this.light.color)}}(),io.prototype=Object.create(Ue.prototype),io.prototype.constructor=io,io.prototype.updateMatrixWorld=function(){var t=new s,e=new o,n=new o;return function(r){var i=this.bones,o=this.geometry,a=o.getAttribute("position");n.getInverse(this.root.matrixWorld);for(var s=0,u=0;s<i.length;s++){var c=i[s];c.parent&&c.parent.isBone&&(e.multiplyMatrices(n,c.matrixWorld),t.setFromMatrixPosition(e),a.setXYZ(u,t.x,t.y,t.z),e.multiplyMatrices(n,c.parent.matrixWorld),t.setFromMatrixPosition(e),a.setXYZ(u+1,t.x,t.y,t.z),u+=2)}o.getAttribute("position").needsUpdate=!0,E.prototype.updateMatrixWorld.call(this,r)}}(),oo.prototype=Object.create(X.prototype),oo.prototype.constructor=oo,oo.prototype.dispose=function(){this.geometry.dispose(),this.material.dispose()},oo.prototype.update=function(){void 0!==this.color?this.material.color.set(this.color):this.material.color.copy(this.light.color)},ao.prototype=Object.create(E.prototype),ao.prototype.constructor=ao,ao.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},ao.prototype.update=function(){var t=.5*this.light.width,e=.5*this.light.height,n=this.line.geometry.attributes.position,r=n.array;r[0]=t,r[1]=-e,r[2]=0,r[3]=t,r[4]=e,r[5]=0,r[6]=-t,r[7]=e,r[8]=0,r[9]=-t,r[10]=-e,r[11]=0,r[12]=t,r[13]=-e,r[14]=0,n.needsUpdate=!0,void 0!==this.color?this.line.material.color.set(this.color):this.line.material.color.copy(this.light.color)},so.prototype=Object.create(E.prototype),so.prototype.constructor=so,so.prototype.dispose=function(){this.children[0].geometry.dispose(),this.children[0].material.dispose()},so.prototype.update=function(){var t=new s,e=new y,n=new y;return function(){var r=this.children[0];if(void 0!==this.color)this.material.color.set(this.color);else{var i=r.geometry.getAttribute("color");e.copy(this.light.color),n.copy(this.light.groundColor);for(var o=0,a=i.count;o<a;o++){var s=o<a/2?e:n;i.setXYZ(o,s.r,s.g,s.b)}i.needsUpdate=!0}r.lookAt(t.setFromMatrixPosition(this.light.matrixWorld).negate())}}(),uo.prototype=Object.create(Ue.prototype),uo.prototype.constructor=uo,co.prototype=Object.create(Ue.prototype),co.prototype.constructor=co,lo.prototype=Object.create(Ue.prototype),lo.prototype.constructor=lo,lo.prototype.update=function(){var t=new s,e=new s,n=new u;return function(){this.object.updateMatrixWorld(!0),n.getNormalMatrix(this.object.matrixWorld);for(var r=this.object.matrixWorld,i=this.geometry.attributes.position,o=this.object.geometry,a=o.vertices,s=o.faces,u=0,c=0,l=s.length;c<l;c++){var h=s[c],f=h.normal;t.copy(a[h.a]).add(a[h.b]).add(a[h.c]).divideScalar(3).applyMatrix4(r),e.copy(f).applyMatrix3(n).normalize().multiplyScalar(this.size).add(t),i.setXYZ(u,t.x,t.y,t.z),u+=1,i.setXYZ(u,e.x,e.y,e.z),u+=1}i.needsUpdate=!0}}(),ho.prototype=Object.create(E.prototype),ho.prototype.constructor=ho,ho.prototype.dispose=function(){this.lightPlane.geometry.dispose(),this.lightPlane.material.dispose(),this.targetLine.geometry.dispose(),this.targetLine.material.dispose()},ho.prototype.update=function(){var t=new s,e=new s,n=new s;return function(){t.setFromMatrixPosition(this.light.matrixWorld),e.setFromMatrixPosition(this.light.target.matrixWorld),n.subVectors(e,t),this.lightPlane.lookAt(n),void 0!==this.color?(this.lightPlane.material.color.set(this.color),this.targetLine.material.color.set(this.color)):(this.lightPlane.material.color.copy(this.light.color),this.targetLine.material.color.copy(this.light.color)),this.targetLine.lookAt(n),this.targetLine.scale.z=n.length()}}(),fo.prototype=Object.create(Ue.prototype),fo.prototype.constructor=fo,fo.prototype.update=function(){function t(t,o,a,s){r.set(o,a,s).unproject(i);var u=n[t];if(void 0!==u)for(var c=e.getAttribute("position"),l=0,h=u.length;l<h;l++)c.setXYZ(u[l],r.x,r.y,r.z)}var e,n,r=new s,i=new x;return function(){e=this.geometry,n=this.pointMap;i.projectionMatrix.copy(this.camera.projectionMatrix),t("c",0,0,-1),t("t",0,0,1),t("n1",-1,-1,-1),t("n2",1,-1,-1),t("n3",-1,1,-1),t("n4",1,1,-1),t("f1",-1,-1,1),t("f2",1,-1,1),t("f3",-1,1,1),t("f4",1,1,1),t("u1",.7,1.1,-1),t("u2",-.7,1.1,-1),t("u3",0,2,-1),t("cf1",-1,0,1),t("cf2",1,0,1),t("cf3",0,-1,1),t("cf4",0,1,1),t("cn1",-1,0,-1),t("cn2",1,0,-1),t("cn3",0,-1,-1),t("cn4",0,1,-1),e.getAttribute("position").needsUpdate=!0}}(),po.prototype=Object.create(Ue.prototype),po.prototype.constructor=po,po.prototype.update=function(){var t=new p;return function(e){if(void 0!==e&&console.warn("THREE.BoxHelper: .update() has no longer arguments."),void 0!==this.object&&t.setFromObject(this.object),!t.isEmpty()){var n=t.min,r=t.max,i=this.geometry.attributes.position,o=i.array;o[0]=r.x,o[1]=r.y,o[2]=r.z,o[3]=n.x,o[4]=r.y,o[5]=r.z,o[6]=n.x,o[7]=n.y,o[8]=r.z,o[9]=r.x,o[10]=n.y,o[11]=r.z,o[12]=r.x,o[13]=r.y,o[14]=n.z,o[15]=n.x,o[16]=r.y,o[17]=n.z,o[18]=n.x,o[19]=n.y,o[20]=n.z,o[21]=r.x,o[22]=n.y,o[23]=n.z,i.needsUpdate=!0,this.geometry.computeBoundingSphere()}}}(),po.prototype.setFromObject=function(t){return this.object=t,this.update(),this},mo.prototype=Object.create(Ue.prototype),mo.prototype.constructor=mo,mo.prototype.updateMatrixWorld=function(t){var e=this.box;e.isEmpty()||(e.getCenter(this.position),e.getSize(this.scale),this.scale.multiplyScalar(.5),E.prototype.updateMatrixWorld.call(this,t))},go.prototype=Object.create(Le.prototype),go.prototype.constructor=go,go.prototype.updateMatrixWorld=function(t){var e=-this.plane.constant;Math.abs(e)<1e-8&&(e=1e-8),this.scale.set(.5*this.size,.5*this.size,e),this.lookAt(this.plane.normal),E.prototype.updateMatrixWorld.call(this,t)};var gc,vc;vo.prototype=Object.create(E.prototype),vo.prototype.constructor=vo,vo.prototype.setDirection=function(){var t,e=new s;return function(n){n.y>.99999?this.quaternion.set(0,0,0,1):n.y<-.99999?this.quaternion.set(1,0,0,0):(e.set(n.z,0,-n.x).normalize(),t=Math.acos(n.y),this.quaternion.setFromAxisAngle(e,t))}}(),vo.prototype.setLength=function(t,e,n){void 0===e&&(e=.2*t),void 0===n&&(n=.2*e),this.line.scale.set(1,Math.max(0,t-e),1),this.line.updateMatrix(),this.cone.scale.set(n,e,n),this.cone.position.y=t,this.cone.updateMatrix()},vo.prototype.setColor=function(t){this.line.material.color.copy(t),this.cone.material.color.copy(t)},yo.prototype=Object.create(Ue.prototype),yo.prototype.constructor=yo;var yc=0,_c=1;xr.create=function(t,e){return console.log("THREE.Curve.create() has been deprecated"),t.prototype=Object.create(xr.prototype),t.prototype.constructor=t,t.prototype.getPoint=e,t},Object.assign(Wr.prototype,{createPointsGeometry:function(t){console.warn("THREE.CurvePath: .createPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getPoints(t);return this.createGeometry(e)},createSpacedPointsGeometry:function(t){console.warn("THREE.CurvePath: .createSpacedPointsGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");var e=this.getSpacedPoints(t);return this.createGeometry(e)},createGeometry:function(t){console.warn("THREE.CurvePath: .createGeometry() has been removed. Use new THREE.Geometry().setFromPoints( points ) instead.");for(var e=new C,n=0,r=t.length;n<r;n++){var i=t[n];e.vertices.push(new s(i.x,i.y,i.z||0))}return e}}),Object.assign(qr.prototype,{fromPoints:function(t){console.warn("THREE.Path: .fromPoints() has been renamed to .setFromPoints()."),this.setFromPoints(t)}}),Bo.prototype=Object.create(Mr.prototype),Vo.prototype=Object.create(Mr.prototype),jo.prototype=Object.create(Mr.prototype),Object.assign(jo.prototype,{initFromArray:function(){console.error("THREE.Spline: .initFromArray() has been removed.")},getControlPointsArray:function(){console.error("THREE.Spline: .getControlPointsArray() has been removed.")},reparametrizeByArcLength:function(){console.error("THREE.Spline: .reparametrizeByArcLength() has been removed.")}}),uo.prototype.setColors=function(){console.error("THREE.GridHelper: setColors() has been deprecated, pass them in the constructor instead.")},io.prototype.update=function(){console.error("THREE.SkeletonHelper: update() no longer needs to be called.")},Object.assign(_i.prototype,{extractUrlBase:function(t){return console.warn("THREE.Loader: .extractUrlBase() has been deprecated. Use THREE.LoaderUtils.extractUrlBase() instead."),cc.extractUrlBase(t)}}),Object.assign($i.prototype,{center:function(t){return console.warn("THREE.Box2: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box2: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box2: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},size:function(t){return console.warn("THREE.Box2: .size() has been renamed to .getSize()."),this.getSize(t)}}),Object.assign(p.prototype,{center:function(t){return console.warn("THREE.Box3: .center() has been renamed to .getCenter()."),this.getCenter(t)},empty:function(){return console.warn("THREE.Box3: .empty() has been renamed to .isEmpty()."),this.isEmpty()},isIntersectionBox:function(t){return console.warn("THREE.Box3: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionSphere:function(t){return console.warn("THREE.Box3: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)},size:function(t){return console.warn("THREE.Box3: .size() has been renamed to .getSize()."),this.getSize(t)}}),K.prototype.center=function(t){return console.warn("THREE.Line3: .center() has been renamed to .getCenter()."),this.getCenter(t)},Object.assign(Au,{random16:function(){return console.warn("THREE.Math: .random16() has been deprecated. Use Math.random() instead."),Math.random()},nearestPowerOfTwo:function(t){return console.warn("THREE.Math: .nearestPowerOfTwo() has been renamed to .floorPowerOfTwo()."),Au.floorPowerOfTwo(t)},nextPowerOfTwo:function(t){return console.warn("THREE.Math: .nextPowerOfTwo() has been renamed to .ceilPowerOfTwo()."),Au.ceilPowerOfTwo(t)}}),Object.assign(u.prototype,{flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix3: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},multiplyVector3:function(t){return console.warn("THREE.Matrix3: .multiplyVector3() has been removed. Use vector.applyMatrix3( matrix ) instead."),t.applyMatrix3(this)},multiplyVector3Array:function(){console.error("THREE.Matrix3: .multiplyVector3Array() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix3: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix3: .applyToVector3Array() has been removed.")}}),Object.assign(o.prototype,{extractPosition:function(t){return console.warn("THREE.Matrix4: .extractPosition() has been renamed to .copyPosition()."),this.copyPosition(t)},flattenToArrayOffset:function(t,e){return console.warn("THREE.Matrix4: .flattenToArrayOffset() has been deprecated. Use .toArray() instead."),this.toArray(t,e)},getPosition:function(){var t;return function(){return void 0===t&&(t=new s),console.warn("THREE.Matrix4: .getPosition() has been removed. Use Vector3.setFromMatrixPosition( matrix ) instead."),t.setFromMatrixColumn(this,3)}}(),setRotationFromQuaternion:function(t){return console.warn("THREE.Matrix4: .setRotationFromQuaternion() has been renamed to .makeRotationFromQuaternion()."),this.makeRotationFromQuaternion(t)},multiplyToArray:function(){console.warn("THREE.Matrix4: .multiplyToArray() has been removed.")},multiplyVector3:function(t){return console.warn("THREE.Matrix4: .multiplyVector3() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector4:function(t){return console.warn("THREE.Matrix4: .multiplyVector4() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},multiplyVector3Array:function(){console.error("THREE.Matrix4: .multiplyVector3Array() has been removed.")},rotateAxis:function(t){console.warn("THREE.Matrix4: .rotateAxis() has been removed. Use Vector3.transformDirection( matrix ) instead."),t.transformDirection(this)},crossVector:function(t){return console.warn("THREE.Matrix4: .crossVector() has been removed. Use vector.applyMatrix4( matrix ) instead."),t.applyMatrix4(this)},translate:function(){console.error("THREE.Matrix4: .translate() has been removed.")},rotateX:function(){console.error("THREE.Matrix4: .rotateX() has been removed.")},rotateY:function(){console.error("THREE.Matrix4: .rotateY() has been removed.")},rotateZ:function(){console.error("THREE.Matrix4: .rotateZ() has been removed.")},rotateByAxis:function(){console.error("THREE.Matrix4: .rotateByAxis() has been removed.")},applyToBuffer:function(t){return console.warn("THREE.Matrix4: .applyToBuffer() has been removed. Use matrix.applyToBufferAttribute( attribute ) instead."),this.applyToBufferAttribute(t)},applyToVector3Array:function(){console.error("THREE.Matrix4: .applyToVector3Array() has been removed.")},makeFrustum:function(t,e,n,r,i,o){return console.warn("THREE.Matrix4: .makeFrustum() has been removed. Use .makePerspective( left, right, top, bottom, near, far ) instead."),this.makePerspective(t,e,r,n,i,o)}}),g.prototype.isIntersectionLine=function(t){return console.warn("THREE.Plane: .isIntersectionLine() has been renamed to .intersectsLine()."),this.intersectsLine(t)},a.prototype.multiplyVector3=function(t){return console.warn("THREE.Quaternion: .multiplyVector3() has been removed. Use is now vector.applyQuaternion( quaternion ) instead."),t.applyQuaternion(this)},Object.assign(Y.prototype,{isIntersectionBox:function(t){return console.warn("THREE.Ray: .isIntersectionBox() has been renamed to .intersectsBox()."),this.intersectsBox(t)},isIntersectionPlane:function(t){return console.warn("THREE.Ray: .isIntersectionPlane() has been renamed to .intersectsPlane()."),this.intersectsPlane(t)},isIntersectionSphere:function(t){return console.warn("THREE.Ray: .isIntersectionSphere() has been renamed to .intersectsSphere()."),this.intersectsSphere(t)}}),Object.assign(Q.prototype,{area:function(){return console.warn("THREE.Triangle: .area() has been renamed to .getArea()."),this.getArea()},barycoordFromPoint:function(t,e){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),this.getBarycoord(t,e)},midpoint:function(t){return console.warn("THREE.Triangle: .midpoint() has been renamed to .getMidpoint()."),this.getMidpoint(t)},normal:function(t){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),this.getNormal(t)},plane:function(t){return console.warn("THREE.Triangle: .plane() has been renamed to .getPlane()."),this.getPlane(t)}}),Object.assign(Q,{barycoordFromPoint:function(t,e,n,r,i){return console.warn("THREE.Triangle: .barycoordFromPoint() has been renamed to .getBarycoord()."),Q.getBarycoord(t,e,n,r,i)},normal:function(t,e,n,r){return console.warn("THREE.Triangle: .normal() has been renamed to .getNormal()."),Q.getNormal(t,e,n,r)}}),Object.assign(Yr.prototype,{extractAllPoints:function(t){return console.warn("THREE.Shape: .extractAllPoints() has been removed. Use .extractPoints() instead."),this.extractPoints(t)},extrude:function(t){return console.warn("THREE.Shape: .extrude() has been removed. Use ExtrudeGeometry() instead."),new jn(this,t)},makeGeometry:function(t){return console.warn("THREE.Shape: .makeGeometry() has been removed. Use ShapeGeometry() instead."),new Jn(this,t)}}),Object.assign(i.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector2: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector2: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector2: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(s.prototype,{setEulerFromRotationMatrix:function(){console.error("THREE.Vector3: .setEulerFromRotationMatrix() has been removed. Use Euler.setFromRotationMatrix() instead.")},setEulerFromQuaternion:function(){console.error("THREE.Vector3: .setEulerFromQuaternion() has been removed. Use Euler.setFromQuaternion() instead.")},getPositionFromMatrix:function(t){return console.warn("THREE.Vector3: .getPositionFromMatrix() has been renamed to .setFromMatrixPosition()."),this.setFromMatrixPosition(t)},getScaleFromMatrix:function(t){return console.warn("THREE.Vector3: .getScaleFromMatrix() has been renamed to .setFromMatrixScale()."),this.setFromMatrixScale(t)},getColumnFromMatrix:function(t,e){return console.warn("THREE.Vector3: .getColumnFromMatrix() has been renamed to .setFromMatrixColumn()."),this.setFromMatrixColumn(e,t)},applyProjection:function(t){return console.warn("THREE.Vector3: .applyProjection() has been removed. Use .applyMatrix4( m ) instead."),this.applyMatrix4(t)},fromAttribute:function(t,e,n){return console.warn("THREE.Vector3: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},distanceToManhattan:function(t){return console.warn("THREE.Vector3: .distanceToManhattan() has been renamed to .manhattanDistanceTo()."),this.manhattanDistanceTo(t)},lengthManhattan:function(){return console.warn("THREE.Vector3: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(l.prototype,{fromAttribute:function(t,e,n){return console.warn("THREE.Vector4: .fromAttribute() has been renamed to .fromBufferAttribute()."),this.fromBufferAttribute(t,e,n)},lengthManhattan:function(){return console.warn("THREE.Vector4: .lengthManhattan() has been renamed to .manhattanLength()."),this.manhattanLength()}}),Object.assign(C.prototype,{computeTangents:function(){console.error("THREE.Geometry: .computeTangents() has been removed.")},computeLineDistances:function(){console.error("THREE.Geometry: .computeLineDistances() has been removed. Use THREE.Line.computeLineDistances() instead.")}}),Object.assign(E.prototype,{getChildByName:function(t){return console.warn("THREE.Object3D: .getChildByName() has been renamed to .getObjectByName()."),this.getObjectByName(t)},renderDepth:function(){console.warn("THREE.Object3D: .renderDepth has been removed. Use .renderOrder, instead.")},translate:function(t,e){return console.warn("THREE.Object3D: .translate() has been removed. Use .translateOnAxis( axis, distance ) instead."),this.translateOnAxis(e,t)},getWorldRotation:function(){console.error("THREE.Object3D: .getWorldRotation() has been removed. Use THREE.Object3D.getWorldQuaternion( target ) instead.")}}),Object.defineProperties(E.prototype,{eulerOrder:{get:function(){return console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order},set:function(t){console.warn("THREE.Object3D: .eulerOrder is now .rotation.order."),this.rotation.order=t}},useQuaternion:{get:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")},set:function(){console.warn("THREE.Object3D: .useQuaternion has been removed. The library now uses quaternions by default.")}}}),Object.defineProperties(Pe.prototype,{objects:{get:function(){return console.warn("THREE.LOD: .objects has been renamed to .levels."),this.levels}}}),Object.defineProperty(Ne.prototype,"useVertexTexture",{get:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")},set:function(){console.warn("THREE.Skeleton: useVertexTexture has been removed.")}}),Object.defineProperty(xr.prototype,"__arcLengthDivisions",{get:function(){return console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions},set:function(t){console.warn("THREE.Curve: .__arcLengthDivisions is now .arcLengthDivisions."),this.arcLengthDivisions=t}}),Ee.prototype.setLens=function(t,e){console.warn("THREE.PerspectiveCamera.setLens is deprecated. Use .setFocalLength and .filmGauge for a photographic setup."),void 0!==e&&(this.filmGauge=e),this.setFocalLength(t)},Object.defineProperties(Kr.prototype,{onlyShadow:{set:function(){console.warn("THREE.Light: .onlyShadow has been removed.")}},shadowCameraFov:{set:function(t){console.warn("THREE.Light: .shadowCameraFov is now .shadow.camera.fov."),this.shadow.camera.fov=t}},shadowCameraLeft:{set:function(t){console.warn("THREE.Light: .shadowCameraLeft is now .shadow.camera.left."),this.shadow.camera.left=t}},shadowCameraRight:{set:function(t){console.warn("THREE.Light: .shadowCameraRight is now .shadow.camera.right."),this.shadow.camera.right=t}},shadowCameraTop:{set:function(t){console.warn("THREE.Light: .shadowCameraTop is now .shadow.camera.top."),this.shadow.camera.top=t}},shadowCameraBottom:{set:function(t){console.warn("THREE.Light: .shadowCameraBottom is now .shadow.camera.bottom."),this.shadow.camera.bottom=t}},shadowCameraNear:{set:function(t){console.warn("THREE.Light: .shadowCameraNear is now .shadow.camera.near."),this.shadow.camera.near=t}},shadowCameraFar:{set:function(t){console.warn("THREE.Light: .shadowCameraFar is now .shadow.camera.far."),this.shadow.camera.far=t}},shadowCameraVisible:{set:function(){console.warn("THREE.Light: .shadowCameraVisible has been removed. Use new THREE.CameraHelper( light.shadow.camera ) instead.")}},shadowBias:{set:function(t){console.warn("THREE.Light: .shadowBias is now .shadow.bias."),this.shadow.bias=t}},shadowDarkness:{set:function(){console.warn("THREE.Light: .shadowDarkness has been removed.")}},shadowMapWidth:{set:function(t){console.warn("THREE.Light: .shadowMapWidth is now .shadow.mapSize.width."),this.shadow.mapSize.width=t}},shadowMapHeight:{set:function(t){console.warn("THREE.Light: .shadowMapHeight is now .shadow.mapSize.height."),this.shadow.mapSize.height=t}}}),Object.defineProperties(M.prototype,{length:{get:function(){return console.warn("THREE.BufferAttribute: .length has been deprecated. Use .count instead."),this.array.length}},copyIndicesArray:function(){console.error("THREE.BufferAttribute: .copyIndicesArray() has been removed.")}}),Object.assign(B.prototype,{addIndex:function(t){console.warn("THREE.BufferGeometry: .addIndex() has been renamed to .setIndex()."),this.setIndex(t)},addDrawCall:function(t,e,n){void 0!==n&&console.warn("THREE.BufferGeometry: .addDrawCall() no longer supports indexOffset."),console.warn("THREE.BufferGeometry: .addDrawCall() is now .addGroup()."),this.addGroup(t,e)},clearDrawCalls:function(){console.warn("THREE.BufferGeometry: .clearDrawCalls() is now .clearGroups()."),this.clearGroups()},computeTangents:function(){console.warn("THREE.BufferGeometry: .computeTangents() has been removed.")},computeOffsets:function(){console.warn("THREE.BufferGeometry: .computeOffsets() has been removed.")}}),Object.defineProperties(B.prototype,{drawcalls:{get:function(){return console.error("THREE.BufferGeometry: .drawcalls has been renamed to .groups."),this.groups}},offsets:{get:function(){return console.warn("THREE.BufferGeometry: .offsets has been renamed to .groups."),this.groups}}}),Object.assign(Hn.prototype,{getArrays:function(){console.error("THREE.ExtrudeBufferGeometry: .getArrays() has been removed.")},addShapeList:function(){console.error("THREE.ExtrudeBufferGeometry: .addShapeList() has been removed.")},addShape:function(){console.error("THREE.ExtrudeBufferGeometry: .addShape() has been removed.")}}),Object.defineProperties(ji.prototype,{dynamic:{set:function(){console.warn("THREE.Uniform: .dynamic has been removed. Use object.onBeforeRender() instead.")}},onUpdate:{value:function(){return console.warn("THREE.Uniform: .onUpdate() has been removed. Use object.onBeforeRender() instead."),this}}}),Object.defineProperties(z.prototype,{wrapAround:{get:function(){console.warn("THREE.Material: .wrapAround has been removed.")},set:function(){console.warn("THREE.Material: .wrapAround has been removed.")}},wrapRGB:{get:function(){return console.warn("THREE.Material: .wrapRGB has been removed."),new y}},shading:{get:function(){console.error("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead.")},set:function(t){console.warn("THREE."+this.type+": .shading has been removed. Use the boolean .flatShading instead."),this.flatShading=t===ha}}}),Object.defineProperties(hr.prototype,{metal:{get:function(){return console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead."),!1},set:function(){console.warn("THREE.MeshPhongMaterial: .metal has been removed. Use THREE.MeshStandardMaterial instead")}}}),Object.defineProperties(q.prototype,{derivatives:{get:function(){return console.warn("THREE.ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives},set:function(t){console.warn("THREE. ShaderMaterial: .derivatives has been moved to .extensions.derivatives."),this.extensions.derivatives=t}}}),Object.assign(Se.prototype,{getCurrentRenderTarget:function(){return console.warn("THREE.WebGLRenderer: .getCurrentRenderTarget() is now .getRenderTarget()."),this.getRenderTarget()},getMaxAnisotropy:function(){return console.warn("THREE.WebGLRenderer: .getMaxAnisotropy() is now .capabilities.getMaxAnisotropy()."),this.capabilities.getMaxAnisotropy()},getPrecision:function(){return console.warn("THREE.WebGLRenderer: .getPrecision() is now .capabilities.precision."),this.capabilities.precision},resetGLState:function(){return console.warn("THREE.WebGLRenderer: .resetGLState() is now .state.reset()."),this.state.reset()},supportsFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsFloatTextures() is now .extensions.get( 'OES_texture_float' )."),this.extensions.get("OES_texture_float")},supportsHalfFloatTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsHalfFloatTextures() is now .extensions.get( 'OES_texture_half_float' )."),this.extensions.get("OES_texture_half_float")},supportsStandardDerivatives:function(){return console.warn("THREE.WebGLRenderer: .supportsStandardDerivatives() is now .extensions.get( 'OES_standard_derivatives' )."),this.extensions.get("OES_standard_derivatives")},supportsCompressedTextureS3TC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTextureS3TC() is now .extensions.get( 'WEBGL_compressed_texture_s3tc' )."),this.extensions.get("WEBGL_compressed_texture_s3tc")},supportsCompressedTexturePVRTC:function(){return console.warn("THREE.WebGLRenderer: .supportsCompressedTexturePVRTC() is now .extensions.get( 'WEBGL_compressed_texture_pvrtc' )."),this.extensions.get("WEBGL_compressed_texture_pvrtc")},supportsBlendMinMax:function(){return console.warn("THREE.WebGLRenderer: .supportsBlendMinMax() is now .extensions.get( 'EXT_blend_minmax' )."),this.extensions.get("EXT_blend_minmax")},supportsVertexTextures:function(){return console.warn("THREE.WebGLRenderer: .supportsVertexTextures() is now .capabilities.vertexTextures."),this.capabilities.vertexTextures},supportsInstancedArrays:function(){return console.warn("THREE.WebGLRenderer: .supportsInstancedArrays() is now .extensions.get( 'ANGLE_instanced_arrays' )."),this.extensions.get("ANGLE_instanced_arrays")},enableScissorTest:function(t){console.warn("THREE.WebGLRenderer: .enableScissorTest() is now .setScissorTest()."),this.setScissorTest(t)},initMaterial:function(){console.warn("THREE.WebGLRenderer: .initMaterial() has been removed.")},addPrePlugin:function(){console.warn("THREE.WebGLRenderer: .addPrePlugin() has been removed.")},addPostPlugin:function(){console.warn("THREE.WebGLRenderer: .addPostPlugin() has been removed.")},updateShadowMap:function(){console.warn("THREE.WebGLRenderer: .updateShadowMap() has been removed.")},setFaceCulling:function(){console.warn("THREE.WebGLRenderer: .setFaceCulling() has been removed.")}}),Object.defineProperties(Se.prototype,{shadowMapEnabled:{get:function(){return this.shadowMap.enabled},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapEnabled is now .shadowMap.enabled."),this.shadowMap.enabled=t}},shadowMapType:{get:function(){return this.shadowMap.type},set:function(t){console.warn("THREE.WebGLRenderer: .shadowMapType is now .shadowMap.type."),this.shadowMap.type=t}},shadowMapCullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMapCullFace has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(ge.prototype,{cullFace:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.cullFace has been removed. Set Material.shadowSide instead.")}},renderReverseSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderReverseSided has been removed. Set Material.shadowSide instead.")}},renderSingleSided:{get:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")},set:function(){console.warn("THREE.WebGLRenderer: .shadowMap.renderSingleSided has been removed. Set Material.shadowSide instead.")}}}),Object.defineProperties(h.prototype,{wrapS:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapS is now .texture.wrapS."),this.texture.wrapS=t}},wrapT:{get:function(){return console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT},set:function(t){console.warn("THREE.WebGLRenderTarget: .wrapT is now .texture.wrapT."),this.texture.wrapT=t}},magFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .magFilter is now .texture.magFilter."),this.texture.magFilter=t}},minFilter:{get:function(){return console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter},set:function(t){console.warn("THREE.WebGLRenderTarget: .minFilter is now .texture.minFilter."),this.texture.minFilter=t}},anisotropy:{get:function(){return console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy},set:function(t){console.warn("THREE.WebGLRenderTarget: .anisotropy is now .texture.anisotropy."),this.texture.anisotropy=t}},offset:{get:function(){return console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset},set:function(t){console.warn("THREE.WebGLRenderTarget: .offset is now .texture.offset."),this.texture.offset=t}},repeat:{get:function(){return console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat},set:function(t){console.warn("THREE.WebGLRenderTarget: .repeat is now .texture.repeat."),this.texture.repeat=t}},format:{get:function(){return console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format},set:function(t){console.warn("THREE.WebGLRenderTarget: .format is now .texture.format."),this.texture.format=t}},type:{get:function(){return console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type},set:function(t){console.warn("THREE.WebGLRenderTarget: .type is now .texture.type."),this.texture.type=t}},generateMipmaps:{get:function(){return console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps},set:function(t){console.warn("THREE.WebGLRenderTarget: .generateMipmaps is now .texture.generateMipmaps."),this.texture.generateMipmaps=t}}}),Object.defineProperties(Te.prototype,{standing:{set:function(){console.warn("THREE.WebVRManager: .standing has been removed.")}}}),Ni.prototype.load=function(t){console.warn("THREE.Audio: .load has been deprecated. Use THREE.AudioLoader instead.");var e=this;return(new Ai).load(t,function(t){e.setBuffer(t)}),this},Oi.prototype.getData=function(){return console.warn("THREE.AudioAnalyser: .getData() is now .getFrequencyData()."),this.getFrequencyData()},Ri.prototype.updateCubeMap=function(t,e){return console.warn("THREE.CubeCamera: .updateCubeMap() is now .update()."),this.update(t,e)};var bc={merge:function(t,e,n){console.warn("THREE.GeometryUtils: .merge() has been moved to Geometry. Use geometry.merge( geometry2, matrix, materialIndexOffset ) instead.");var r;e.isMesh&&(e.matrixAutoUpdate&&e.updateMatrix(),r=e.matrix,e=e.geometry),t.merge(e,r,n)},center:function(t){return console.warn("THREE.GeometryUtils: .center() has been moved to Geometry. Use geometry.center() instead."),t.center()}},wc={crossOrigin:void 0,loadTexture:function(t,e,n,r){console.warn("THREE.ImageUtils.loadTexture has been deprecated. Use THREE.TextureLoader() instead.");var i=new Er;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},loadTextureCube:function(t,e,n,r){console.warn("THREE.ImageUtils.loadTextureCube has been deprecated. Use THREE.CubeTextureLoader() instead.");var i=new wr;i.setCrossOrigin(this.crossOrigin);var o=i.load(t,n,void 0,r);return e&&(o.mapping=e),o},loadCompressedTexture:function(){console.error("THREE.ImageUtils.loadCompressedTexture has been removed. Use THREE.DDSLoader instead.")},loadCompressedTextureCube:function(){console.error("THREE.ImageUtils.loadCompressedTextureCube has been removed. Use THREE.DDSLoader instead.")}},Ec={createMultiMaterialObject:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},detach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")},attach:function(){console.error("THREE.SceneUtils has been moved to /examples/js/utils/SceneUtils.js")}}},function(t,e){var n;n=function(){return this}();try{n=n||Function("return this")()||(0,eval)("this")}catch(t){"object"===typeof window&&(n=window)}t.exports=n},function(t,e,n){"use strict";function r(){function t(t){f(p[t],"delete"),delete p[t]}function e(t){return t=t||s,a(p,t)||i("no-app",{name:t}),p[t]}function n(t,e){if(void 0===e&&(e={}),"object"!==typeof e||null===e){e={name:e}}var n=e;void 0===n.name&&(n.name=s);var r=n.name;"string"===typeof r&&r||i("bad-app-name",{name:r+""}),a(p,r)&&i("duplicate-app",{name:r});var o=new c(t,n,v);return p[r]=o,f(o,"create"),o}function u(){return Object.keys(p).map(function(t){return p[t]})}function l(t,n,r,a,s){m[t]&&i("duplicate-service",{name:t}),m[t]=n,a&&(g[t]=a,u().forEach(function(t){a("create",t)}));var l=function(n){return void 0===n&&(n=e()),"function"!==typeof n[t]&&i("invalid-app-argument",{name:t}),n[t]()};return void 0!==r&&Object(o.deepExtend)(l,r),v[t]=l,c.prototype[t]=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return this._getService.bind(this,t).apply(this,s?e:[])},l}function h(t){Object(o.deepExtend)(v,t)}function f(t,e){Object.keys(m).forEach(function(n){var r=d(t,n);null!==r&&g[r]&&g[r](e,t)})}function d(t,e){if("serverAuth"===e)return null;var n=e;t.options;return n}var p={},m={},g={},v={__esModule:!0,initializeApp:n,app:e,apps:null,Promise:Promise,SDK_VERSION:"4.13.0",INTERNAL:{registerService:l,createFirebaseNamespace:r,extendNamespace:h,createSubscribe:o.createSubscribe,ErrorFactory:o.ErrorFactory,removeApp:t,factories:m,useAsService:d,Promise:Promise,deepExtend:o.deepExtend}};return Object(o.patchProperty)(v,"default",v),Object.defineProperty(v,"apps",{get:u}),Object(o.patchProperty)(e,"App",c),v}function i(t,e){throw h.create(t,e)}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"firebase",function(){return f});var o=n(8),a=(n.n(o),function(t,e){return Object.prototype.hasOwnProperty.call(t,e)}),s="[DEFAULT]",u=[],c=function(){function t(t,e,n){this.firebase_=n,this.isDeleted_=!1,this.services_={},this.name_=e.name,this._automaticDataCollectionEnabled=e.automaticDataCollectionEnabled||!1,this.options_=Object(o.deepCopy)(t),this.INTERNAL={getUid:function(){return null},getToken:function(){return Promise.resolve(null)},addAuthTokenListener:function(t){u.push(t),setTimeout(function(){return t(null)},0)},removeAuthTokenListener:function(t){u=u.filter(function(e){return e!==t})}}}return Object.defineProperty(t.prototype,"automaticDataCollectionEnabled",{get:function(){return this.checkDestroyed_(),this._automaticDataCollectionEnabled},set:function(t){this.checkDestroyed_(),this._automaticDataCollectionEnabled=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return this.checkDestroyed_(),this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"options",{get:function(){return this.checkDestroyed_(),this.options_},enumerable:!0,configurable:!0}),t.prototype.delete=function(){var t=this;return new Promise(function(e){t.checkDestroyed_(),e()}).then(function(){t.firebase_.INTERNAL.removeApp(t.name_);var e=[];return Object.keys(t.services_).forEach(function(n){Object.keys(t.services_[n]).forEach(function(r){e.push(t.services_[n][r])})}),Promise.all(e.map(function(t){return t.INTERNAL.delete()}))}).then(function(){t.isDeleted_=!0,t.services_={}})},t.prototype._getService=function(t,e){if(void 0===e&&(e=s),this.checkDestroyed_(),this.services_[t]||(this.services_[t]={}),!this.services_[t][e]){var n=e!==s?e:void 0,r=this.firebase_.INTERNAL.factories[t](this,this.extendApp.bind(this),n);this.services_[t][e]=r}return this.services_[t][e]},t.prototype.extendApp=function(t){var e=this;Object(o.deepExtend)(this,t),t.INTERNAL&&t.INTERNAL.addAuthTokenListener&&(u.forEach(function(t){e.INTERNAL.addAuthTokenListener(t)}),u=[])},t.prototype.checkDestroyed_=function(){this.isDeleted_&&i("app-deleted",{name:this.name_})},t}();c.prototype.name&&c.prototype.options||c.prototype.delete||console.log("dc");var l={"no-app":"No Firebase App '{$name}' has been created - call Firebase App.initializeApp()","bad-app-name":"Illegal App name: '{$name}","duplicate-app":"Firebase App named '{$name}' already exists","app-deleted":"Firebase App named '{$name}' already deleted","duplicate-service":"Firebase service named '{$name}' already registered","sa-not-supported":"Initializing the Firebase SDK with a service account is only allowed in a Node.js environment. On client devices, you should instead initialize the SDK with an api key and auth domain","invalid-app-argument":"firebase.{$name}() takes either no argument or a Firebase App instance."},h=new o.ErrorFactory("app","Firebase",l),f=r();e.default=f},function(t,e,n){"use strict";function r(t,e){function n(){this.constructor=t}w(t,e),t.prototype=null===e?Object.create(e):(n.prototype=e.prototype,new n)}function i(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(null!=t&&"function"===typeof Object.getOwnPropertySymbols)for(var i=0,r=Object.getOwnPropertySymbols(t);i<r.length;i++)e.indexOf(r[i])<0&&(n[r[i]]=t[r[i]]);return n}function o(t,e,n,r){var i,o=arguments.length,a=o<3?e:null===r?r=Object.getOwnPropertyDescriptor(e,n):r;if("object"===typeof Reflect&&"function"===typeof Reflect.decorate)a=Reflect.decorate(t,e,n,r);else for(var s=t.length-1;s>=0;s--)(i=t[s])&&(a=(o<3?i(a):o>3?i(e,n,a):i(e,n))||a);return o>3&&a&&Object.defineProperty(e,n,a),a}function a(t,e){return function(n,r){e(n,r,t)}}function s(t,e){if("object"===typeof Reflect&&"function"===typeof Reflect.metadata)return Reflect.metadata(t,e)}function u(t,e,n,r){return new(n||(n=Promise))(function(i,o){function a(t){try{u(r.next(t))}catch(t){o(t)}}function s(t){try{u(r.throw(t))}catch(t){o(t)}}function u(t){t.done?i(t.value):new n(function(e){e(t.value)}).then(a,s)}u((r=r.apply(t,e||[])).next())})}function c(t,e){function n(t){return function(e){return r([t,e])}}function r(n){if(i)throw new TypeError("Generator is already executing.");for(;u;)try{if(i=1,o&&(a=o[2&n[0]?"return":n[0]?"throw":"next"])&&!(a=a.call(o,n[1])).done)return a;switch(o=0,a&&(n=[0,a.value]),n[0]){case 0:case 1:a=n;break;case 4:return u.label++,{value:n[1],done:!1};case 5:u.label++,o=n[1],n=[0];continue;case 7:n=u.ops.pop(),u.trys.pop();continue;default:if(a=u.trys,!(a=a.length>0&&a[a.length-1])&&(6===n[0]||2===n[0])){u=0;continue}if(3===n[0]&&(!a||n[1]>a[0]&&n[1]<a[3])){u.label=n[1];break}if(6===n[0]&&u.label<a[1]){u.label=a[1],a=n;break}if(a&&u.label<a[2]){u.label=a[2],u.ops.push(n);break}a[2]&&u.ops.pop(),u.trys.pop();continue}n=e.call(t,u)}catch(t){n=[6,t],o=0}finally{i=a=0}if(5&n[0])throw n[1];return{value:n[0]?n[1]:void 0,done:!0}}var i,o,a,s,u={label:0,sent:function(){if(1&a[0])throw a[1];return a[1]},trys:[],ops:[]};return s={next:n(0),throw:n(1),return:n(2)},"function"===typeof Symbol&&(s[Symbol.iterator]=function(){return this}),s}function l(t,e){for(var n in t)e.hasOwnProperty(n)||(e[n]=t[n])}function h(t){var e="function"===typeof Symbol&&t[Symbol.iterator],n=0;return e?e.call(t):{next:function(){return t&&n>=t.length&&(t=void 0),{value:t&&t[n++],done:!t}}}}function f(t,e){var n="function"===typeof Symbol&&t[Symbol.iterator];if(!n)return t;var r,i,o=n.call(t),a=[];try{for(;(void 0===e||e-- >0)&&!(r=o.next()).done;)a.push(r.value)}catch(t){i={error:t}}finally{try{r&&!r.done&&(n=o.return)&&n.call(o)}finally{if(i)throw i.error}}return a}function d(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(f(arguments[e]));return t}function p(t){return this instanceof p?(this.v=t,this):new p(t)}function m(t,e,n){function r(t){l[t]&&(c[t]=function(e){return new Promise(function(n,r){h.push([t,e,n,r])>1||i(t,e)})})}function i(t,e){try{o(l[t](e))}catch(t){u(h[0][3],t)}}function o(t){t.value instanceof p?Promise.resolve(t.value.v).then(a,s):u(h[0][2],t)}function a(t){i("next",t)}function s(t){i("throw",t)}function u(t,e){t(e),h.shift(),h.length&&i(h[0][0],h[0][1])}if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var c,l=n.apply(t,e||[]),h=[];return c={},r("next"),r("throw"),r("return"),c[Symbol.asyncIterator]=function(){return this},c}function g(t){function e(e,i){t[e]&&(n[e]=function(n){return(r=!r)?{value:p(t[e](n)),done:"return"===e}:i?i(n):n})}var n,r;return n={},e("next"),e("throw",function(t){throw t}),e("return"),n[Symbol.iterator]=function(){return this},n}function v(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator];return e?e.call(t):"function"===typeof h?h(t):t[Symbol.iterator]()}function y(t,e){return Object.defineProperty?Object.defineProperty(t,"raw",{value:e}):t.raw=e,t}function _(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var n in t)Object.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e.default=t,e}function b(t){return t&&t.__esModule?t:{default:t}}Object.defineProperty(e,"__esModule",{value:!0}),e.__extends=r,n.d(e,"__assign",function(){return E}),e.__rest=i,e.__decorate=o,e.__param=a,e.__metadata=s,e.__awaiter=u,e.__generator=c,e.__exportStar=l,e.__values=h,e.__read=f,e.__spread=d,e.__await=p,e.__asyncGenerator=m,e.__asyncDelegator=g,e.__asyncValues=v,e.__makeTemplateObject=y,e.__importStar=_,e.__importDefault=b;var w=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n])},E=Object.assign||function(t){for(var e,n=1,r=arguments.length;n<r;n++){e=arguments[n];for(var i in e)Object.prototype.hasOwnProperty.call(e,i)&&(t[i]=e[i])}return t}},function(t,e,n){"use strict";function r(t){if(null===t||void 0===t)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(t)}var i=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable;t.exports=function(){try{if(!Object.assign)return!1;var t=new String("abc");if(t[5]="de","5"===Object.getOwnPropertyNames(t)[0])return!1;for(var e={},n=0;n<10;n++)e["_"+String.fromCharCode(n)]=n;if("0123456789"!==Object.getOwnPropertyNames(e).map(function(t){return e[t]}).join(""))return!1;var r={};return"abcdefghijklmnopqrst".split("").forEach(function(t){r[t]=t}),"abcdefghijklmnopqrst"===Object.keys(Object.assign({},r)).join("")}catch(t){return!1}}()?Object.assign:function(t,e){for(var n,s,u=r(t),c=1;c<arguments.length;c++){n=Object(arguments[c]);for(var l in n)o.call(n,l)&&(u[l]=n[l]);if(i){s=i(n);for(var h=0;h<s.length;h++)a.call(n,s[h])&&(u[s[h]]=n[s[h]])}}return u}},function(t,e,n){"use strict";t.exports=n(24)},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(0),o=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),a=function(){function t(){r(this,t),this.positionTexture=null}return o(t,[{key:"setNodeCount",value:function(t){this.nodeCount=t}},{key:"setTextureSize",value:function(t){this.setNodeCount(t);for(var e=1,n=1;n*e<this.nodeCount&&(e*=2,!(n*e>=this.nodeCount));)n*=2;this.textureWidth=e,this.textureHeight=n}},{key:"getNodeTextureLocation",value:function(t){return{x:t%this.textureWidth*(1/this.textureWidth)+1/(2*this.textureWidth),y:Math.floor(t/this.textureWidth)*(1/this.textureHeight)+1/(2*this.textureHeight)}}},{key:"createPositionTexture",value:function(){for(var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.storedPositions,n=void 0===e?new Float32Array:e,r=new Float32Array(this.textureWidth*this.textureHeight*4),o=0;o<this.nodeCount;o++)r[4*o+0]=1e3*Math.random()-500,r[4*o+1]=1e3*Math.random()-500,r[4*o+2]=1e3*Math.random()-500,r[4*o+3]=0===o?2:0;if(n.length)for(var a=0;a<n.length;a++)r[a]=n[a];return this.positionTexture||(this.positionTexture=new i.DataTexture(r,this.textureWidth,this.textureHeight,i.RGBAFormat,i.FloatType),this.positionTexture.minFilter=i.NearestFilter,this.positionTexture.magFilter=i.NearestFilter,this.positionTexture.generateMipmaps=!1,this.positionTexture.flipY=!1,this.positionTexture.needsUpdate=!0),this.positionTexture}}]),t}();e.a=a},function(t,e){function n(){throw new Error("setTimeout has not been defined")}function r(){throw new Error("clearTimeout has not been defined")}function i(t){if(l===setTimeout)return setTimeout(t,0);if((l===n||!l)&&setTimeout)return l=setTimeout,setTimeout(t,0);try{return l(t,0)}catch(e){try{return l.call(null,t,0)}catch(e){return l.call(this,t,0)}}}function o(t){if(h===clearTimeout)return clearTimeout(t);if((h===r||!h)&&clearTimeout)return h=clearTimeout,clearTimeout(t);try{return h(t)}catch(e){try{return h.call(null,t)}catch(e){return h.call(this,t)}}}function a(){m&&d&&(m=!1,d.length?p=d.concat(p):g=-1,p.length&&s())}function s(){if(!m){var t=i(a);m=!0;for(var e=p.length;e;){for(d=p,p=[];++g<e;)d&&d[g].run();g=-1,e=p.length}d=null,m=!1,o(t)}}function u(t,e){this.fun=t,this.array=e}function c(){}var l,h,f=t.exports={};!function(){try{l="function"===typeof setTimeout?setTimeout:n}catch(t){l=n}try{h="function"===typeof clearTimeout?clearTimeout:r}catch(t){h=r}}();var d,p=[],m=!1,g=-1;f.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)e[n-1]=arguments[n];p.push(new u(t,e)),1!==p.length||m||i(s)},u.prototype.run=function(){this.fun.apply(null,this.array)},f.title="browser",f.browser=!0,f.env={},f.argv=[],f.version="",f.versions={},f.on=c,f.addListener=c,f.once=c,f.off=c,f.removeListener=c,f.removeAllListeners=c,f.emit=c,f.prependListener=c,f.prependOnceListener=c,f.listeners=function(t){return[]},f.binding=function(t){throw new Error("process.binding is not supported")},f.cwd=function(){return"/"},f.chdir=function(t){throw new Error("process.chdir is not supported")},f.umask=function(){return 0}},function(t,e,n){"use strict";function r(t){return i(void 0,t)}function i(t,e){if(!(e instanceof Object))return e;switch(e.constructor){case Date:var n=e;return new Date(n.getTime());case Object:void 0===t&&(t={});break;case Array:t=[];break;default:return e}for(var r in e)e.hasOwnProperty(r)&&(t[r]=i(t[r],e[r]));return t}function o(t,e,n){t[e]=n}function a(t){var e=N;return N=t,e}function s(t){return JSON.parse(t)}function u(t){return JSON.stringify(t)}function c(t,e){var n=new it(t,e);return n.subscribe.bind(n)}function l(t,e){return function(){for(var n=[],r=0;r<arguments.length;r++)n[r]=arguments[r];Promise.resolve(!0).then(function(){t.apply(void 0,n)}).catch(function(t){e&&e(t)})}}function h(t,e){if("object"!==typeof t||null===t)return!1;for(var n=0,r=e;n<r.length;n++){var i=r[n];if(i in t&&"function"===typeof t[i])return!0}return!1}function f(){}function d(t,e,n){var r="";switch(e){case 1:r=n?"first":"First";break;case 2:r=n?"second":"Second";break;case 3:r=n?"third":"Third";break;case 4:r=n?"fourth":"Fourth";break;default:throw new Error("errorPrefix called with argumentNumber > 4.  Need to update it?")}var i=t+" failed: ";return i+=r+" argument "}function p(t,e,n,r){if((!r||n)&&"string"!==typeof n)throw new Error(d(t,e,r)+"must be a valid firebase namespace.")}function m(t,e,n,r){if((!r||n)&&"function"!==typeof n)throw new Error(d(t,e,r)+"must be a valid function.")}function g(t,e,n,r){if((!r||n)&&("object"!==typeof n||null===n))throw new Error(d(t,e,r)+"must be a valid context object.")}Object.defineProperty(e,"__esModule",{value:!0});var v=n(3),y={NODE_CLIENT:!1,NODE_ADMIN:!1,SDK_VERSION:"${JSCORE_VERSION}"},_=function(t,e){if(!t)throw b(e)},b=function(t){return new Error("Firebase Database ("+y.SDK_VERSION+") INTERNAL ASSERT FAILED: "+t)},w=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):55296==(64512&i)&&r+1<t.length&&56320==(64512&t.charCodeAt(r+1))?(i=65536+((1023&i)<<10)+(1023&t.charCodeAt(++r)),e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},E=function(t){for(var e=[],n=0,r=0;n<t.length;){var i=t[n++];if(i<128)e[r++]=String.fromCharCode(i);else if(i>191&&i<224){var o=t[n++];e[r++]=String.fromCharCode((31&i)<<6|63&o)}else if(i>239&&i<365){var o=t[n++],a=t[n++],s=t[n++],u=((7&i)<<18|(63&o)<<12|(63&a)<<6|63&s)-65536;e[r++]=String.fromCharCode(55296+(u>>10)),e[r++]=String.fromCharCode(56320+(1023&u))}else{var o=t[n++],a=t[n++];e[r++]=String.fromCharCode((15&i)<<12|(63&o)<<6|63&a)}}return e.join("")},x={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:"function"===typeof atob,encodeByteArray:function(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();for(var n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[],i=0;i<t.length;i+=3){var o=t[i],a=i+1<t.length,s=a?t[i+1]:0,u=i+2<t.length,c=u?t[i+2]:0,l=o>>2,h=(3&o)<<4|s>>4,f=(15&s)<<2|c>>6,d=63&c;u||(d=64,a||(f=64)),r.push(n[l],n[h],n[f],n[d])}return r.join("")},encodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(w(t),e)},decodeString:function(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):E(this.decodeStringToByteArray(t,e))},decodeStringToByteArray:function(t,e){this.init_();for(var n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[],i=0;i<t.length;){var o=n[t.charAt(i++)],a=i<t.length,s=a?n[t.charAt(i)]:0;++i;var u=i<t.length,c=u?n[t.charAt(i)]:64;++i;var l=i<t.length,h=l?n[t.charAt(i)]:64;if(++i,null==o||null==s||null==c||null==h)throw Error();var f=o<<2|s>>4;if(r.push(f),64!=c){var d=s<<4&240|c>>2;if(r.push(d),64!=h){var p=c<<6&192|h;r.push(p)}}}return r},init_:function(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(var t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}},T=function(t){var e=w(t);return x.encodeByteArray(e,!0)},S=function(t){try{return x.decodeString(t,!0)}catch(t){console.error("base64Decode failed: ",t)}return null},C=function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t.prototype.wrapCallback=function(t){var e=this;return function(n,r){n?e.reject(n):e.resolve(r),"function"===typeof t&&(e.promise.catch(function(){}),1===t.length?t(n):t(n,r))}},t}(),M=function(){return"undefined"!==typeof navigator&&"string"===typeof navigator.userAgent?navigator.userAgent:""},A=function(){return"undefined"!==typeof window&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(M())},I=function(){return"object"===typeof navigator&&"ReactNative"===navigator.product},R=function(){return!0===y.NODE_CLIENT||!0===y.NODE_ADMIN},P="FirebaseError",N=Error.captureStackTrace,D=function(){function t(t,e){if(this.code=t,this.message=e,N)N(this,O.prototype.create);else{var n=Error.apply(this,arguments);this.name=P,Object.defineProperty(this,"stack",{get:function(){return n.stack}})}}return t}();D.prototype=Object.create(Error.prototype),D.prototype.constructor=D,D.prototype.name=P;var O=function(){function t(t,e,n){this.service=t,this.serviceName=e,this.errors=n,this.pattern=/\{\$([^}]+)}/g}return t.prototype.create=function(t,e){void 0===e&&(e={});var n,r=this.errors[t],i=this.service+"/"+t;n=void 0===r?"Error":r.replace(this.pattern,function(t,n){var r=e[n];return void 0!==r?r.toString():"<"+n+"?>"}),n=this.serviceName+": "+n+" ("+i+").";var o=new D(i,n);for(var a in e)e.hasOwnProperty(a)&&"_"!==a.slice(-1)&&(o[a]=e[a]);return o},t}(),k=function(t){var e={},n={},r={},i="";try{var o=t.split(".");e=s(S(o[0])||""),n=s(S(o[1])||""),i=o[2],r=n.d||{},delete n.d}catch(t){}return{header:e,claims:n,data:r,signature:i}},L=function(t){var e,n,r=k(t).claims,i=Math.floor((new Date).getTime()/1e3);return"object"===typeof r&&(r.hasOwnProperty("nbf")?e=r.nbf:r.hasOwnProperty("iat")&&(e=r.iat),n=r.hasOwnProperty("exp")?r.exp:e+86400),i&&e&&n&&i>=e&&i<=n},U=function(t){var e=k(t).claims;return"object"===typeof e&&e.hasOwnProperty("iat")?e.iat:null},F=function(t){var e=k(t),n=e.claims;return!!e.signature&&!!n&&"object"===typeof n&&n.hasOwnProperty("iat")},B=function(t){var e=k(t).claims;return"object"===typeof e&&!0===e.admin},V=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},j=function(t,e){if(Object.prototype.hasOwnProperty.call(t,e))return t[e]},H=function(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])},G=function(t,e){return H(e,function(e,n){t[e]=n}),t},z=function(t){return G({},t)},W=function(t){return"object"===typeof t&&null!==t},q=function(t){for(var e in t)return!1;return!0},Y=function(t){var e=0;for(var n in t)e++;return e},K=function(t,e,n){var r={};for(var i in t)r[i]=e.call(n,t[i],i,t);return r},Q=function(t,e,n){for(var r in t)if(e.call(n,t[r],r,t))return r},X=function(t,e,n){var r=Q(t,e,n);return r&&t[r]},J=function(t){for(var e in t)return e},Z=function(t){var e=[],n=0;for(var r in t)e[n++]=t[r];return e},$=function(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)&&!e(n,t[n]))return!1;return!0},tt=function(t){var e=[];return H(t,function(t,n){Array.isArray(n)?n.forEach(function(n){e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}):e.push(encodeURIComponent(t)+"="+encodeURIComponent(n))}),e.length?"&"+e.join("&"):""},et=function(t){var e={};return t.replace(/^\?/,"").split("&").forEach(function(t){if(t){var n=t.split("=");e[n[0]]=n[1]}}),e},nt=function(){function t(){this.blockSize=-1}return t}(),rt=function(t){function e(){var e=t.call(this)||this;e.chain_=[],e.buf_=[],e.W_=[],e.pad_=[],e.inbuf_=0,e.total_=0,e.blockSize=64,e.pad_[0]=128;for(var n=1;n<e.blockSize;++n)e.pad_[n]=0;return e.reset(),e}return v.__extends(e,t),e.prototype.reset=function(){this.chain_[0]=1732584193,this.chain_[1]=4023233417,this.chain_[2]=2562383102,this.chain_[3]=271733878,this.chain_[4]=3285377520,this.inbuf_=0,this.total_=0},e.prototype.compress_=function(t,e){e||(e=0);var n=this.W_;if("string"===typeof t)for(var r=0;r<16;r++)n[r]=t.charCodeAt(e)<<24|t.charCodeAt(e+1)<<16|t.charCodeAt(e+2)<<8|t.charCodeAt(e+3),e+=4;else for(var r=0;r<16;r++)n[r]=t[e]<<24|t[e+1]<<16|t[e+2]<<8|t[e+3],e+=4;for(var r=16;r<80;r++){var i=n[r-3]^n[r-8]^n[r-14]^n[r-16];n[r]=4294967295&(i<<1|i>>>31)}for(var o,a,s=this.chain_[0],u=this.chain_[1],c=this.chain_[2],l=this.chain_[3],h=this.chain_[4],r=0;r<80;r++){r<40?r<20?(o=l^u&(c^l),a=1518500249):(o=u^c^l,a=1859775393):r<60?(o=u&c|l&(u|c),a=2400959708):(o=u^c^l,a=3395469782);var i=(s<<5|s>>>27)+o+h+a+n[r]&4294967295;h=l,l=c,c=4294967295&(u<<30|u>>>2),u=s,s=i}this.chain_[0]=this.chain_[0]+s&4294967295,this.chain_[1]=this.chain_[1]+u&4294967295,this.chain_[2]=this.chain_[2]+c&4294967295,this.chain_[3]=this.chain_[3]+l&4294967295,this.chain_[4]=this.chain_[4]+h&4294967295},e.prototype.update=function(t,e){if(null!=t){void 0===e&&(e=t.length);for(var n=e-this.blockSize,r=0,i=this.buf_,o=this.inbuf_;r<e;){if(0==o)for(;r<=n;)this.compress_(t,r),r+=this.blockSize;if("string"===typeof t){for(;r<e;)if(i[o]=t.charCodeAt(r),++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}else for(;r<e;)if(i[o]=t[r],++o,++r,o==this.blockSize){this.compress_(i),o=0;break}}this.inbuf_=o,this.total_+=e}},e.prototype.digest=function(){var t=[],e=8*this.total_;this.inbuf_<56?this.update(this.pad_,56-this.inbuf_):this.update(this.pad_,this.blockSize-(this.inbuf_-56));for(var n=this.blockSize-1;n>=56;n--)this.buf_[n]=255&e,e/=256;this.compress_(this.buf_);for(var r=0,n=0;n<5;n++)for(var i=24;i>=0;i-=8)t[r]=this.chain_[n]>>i&255,++r;return t},e}(nt),it=function(){function t(t,e){var n=this;this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=e,this.task.then(function(){t(n)}).catch(function(t){n.error(t)})}return t.prototype.next=function(t){this.forEachObserver(function(e){e.next(t)})},t.prototype.error=function(t){this.forEachObserver(function(e){e.error(t)}),this.close(t)},t.prototype.complete=function(){this.forEachObserver(function(t){t.complete()}),this.close()},t.prototype.subscribe=function(t,e,n){var r,i=this;if(void 0===t&&void 0===e&&void 0===n)throw new Error("Missing Observer.");r=h(t,["next","error","complete"])?t:{next:t,error:e,complete:n},void 0===r.next&&(r.next=f),void 0===r.error&&(r.error=f),void 0===r.complete&&(r.complete=f);var o=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(function(){try{i.finalError?r.error(i.finalError):r.complete()}catch(t){}}),this.observers.push(r),o},t.prototype.unsubscribeOne=function(t){void 0!==this.observers&&void 0!==this.observers[t]&&(delete this.observers[t],this.observerCount-=1,0===this.observerCount&&void 0!==this.onNoObservers&&this.onNoObservers(this))},t.prototype.forEachObserver=function(t){if(!this.finalized)for(var e=0;e<this.observers.length;e++)this.sendOne(e,t)},t.prototype.sendOne=function(t,e){var n=this;this.task.then(function(){if(void 0!==n.observers&&void 0!==n.observers[t])try{e(n.observers[t])}catch(t){"undefined"!==typeof console&&console.error&&console.error(t)}})},t.prototype.close=function(t){var e=this;this.finalized||(this.finalized=!0,void 0!==t&&(this.finalError=t),this.task.then(function(){e.observers=void 0,e.onNoObservers=void 0}))},t}(),ot=function(t,e,n,r){var i;if(r<e?i="at least "+e:r>n&&(i=0===n?"none":"no more than "+n),i){var o=t+" failed: Was called with "+r+(1===r?" argument.":" arguments.")+" Expects "+i+".";throw new Error(o)}},at=function(t){for(var e=[],n=0,r=0;r<t.length;r++){var i=t.charCodeAt(r);if(i>=55296&&i<=56319){var o=i-55296;r++,_(r<t.length,"Surrogate pair missing trail surrogate.");i=65536+(o<<10)+(t.charCodeAt(r)-56320)}i<128?e[n++]=i:i<2048?(e[n++]=i>>6|192,e[n++]=63&i|128):i<65536?(e[n++]=i>>12|224,e[n++]=i>>6&63|128,e[n++]=63&i|128):(e[n++]=i>>18|240,e[n++]=i>>12&63|128,e[n++]=i>>6&63|128,e[n++]=63&i|128)}return e},st=function(t){for(var e=0,n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e++:r<2048?e+=2:r>=55296&&r<=56319?(e+=4,n++):e+=3}return e};e.assert=_,e.assertionError=b,e.base64=x,e.base64Decode=S,e.base64Encode=T,e.CONSTANTS=y,e.deepCopy=r,e.deepExtend=i,e.patchProperty=o,e.Deferred=C,e.getUA=M,e.isMobileCordova=A,e.isNodeSdk=R,e.isReactNative=I,e.ErrorFactory=O,e.FirebaseError=D,e.patchCapture=a,e.jsonEval=s,e.stringify=u,e.decode=k,e.isAdmin=B,e.issuedAtTime=U,e.isValidFormat=F,e.isValidTimestamp=L,e.clone=z,e.contains=V,e.every=$,e.extend=G,e.findKey=Q,e.findValue=X,e.forEach=H,e.getAnyKey=J,e.getCount=Y,e.getValues=Z,e.isEmpty=q,e.isNonNullObject=W,e.map=K,e.safeGet=j,e.querystring=tt,e.querystringDecode=et,e.Sha1=rt,e.async=l,e.createSubscribe=c,e.errorPrefix=d,e.validateArgCount=ot,e.validateCallback=m,e.validateContextObject=g,e.validateNamespace=p,e.stringLength=st,e.stringToByteArray=at},function(t,e,n){"use strict";function r(){}function i(t){try{return t.then}catch(t){return v=t,y}}function o(t,e){try{return t(e)}catch(t){return v=t,y}}function a(t,e,n){try{t(e,n)}catch(t){return v=t,y}}function s(t){if("object"!==typeof this)throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("Promise constructor's argument is not a function");this._75=0,this._83=0,this._18=null,this._38=null,t!==r&&m(t,this)}function u(t,e,n){return new t.constructor(function(i,o){var a=new s(r);a.then(i,o),c(t,new p(e,n,a))})}function c(t,e){for(;3===t._83;)t=t._18;if(s._47&&s._47(t),0===t._83)return 0===t._75?(t._75=1,void(t._38=e)):1===t._75?(t._75=2,void(t._38=[t._38,e])):void t._38.push(e);l(t,e)}function l(t,e){g(function(){var n=1===t._83?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._83?h(e.promise,t._18):f(e.promise,t._18));var r=o(n,t._18);r===y?f(e.promise,v):h(e.promise,r)})}function h(t,e){if(e===t)return f(t,new TypeError("A promise cannot be resolved with itself."));if(e&&("object"===typeof e||"function"===typeof e)){var n=i(e);if(n===y)return f(t,v);if(n===t.then&&e instanceof s)return t._83=3,t._18=e,void d(t);if("function"===typeof n)return void m(n.bind(e),t)}t._83=1,t._18=e,d(t)}function f(t,e){t._83=2,t._18=e,s._71&&s._71(t,e),d(t)}function d(t){if(1===t._75&&(c(t,t._38),t._38=null),2===t._75){for(var e=0;e<t._38.length;e++)c(t,t._38[e]);t._38=null}}function p(t,e,n){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof e?e:null,this.promise=n}function m(t,e){var n=!1,r=a(t,function(t){n||(n=!0,h(e,t))},function(t){n||(n=!0,f(e,t))});n||r!==y||(n=!0,f(e,v))}var g=n(18),v=null,y={};t.exports=s,s._47=null,s._71=null,s._44=r,s.prototype.then=function(t,e){if(this.constructor!==s)return u(this,t,e);var n=new s(r);return c(this,new p(t,e,n)),n}},function(t,e,n){t.exports=n(22)},function(t,e,n){"use strict";function r(t,e,n,r,o,a,s,u){if(i(e),!t){var c;if(void 0===e)c=new Error("Minified exception occurred; use the non-minified dev environment for the full error message and additional helpful warnings.");else{var l=[n,r,o,a,s,u],h=0;c=new Error(e.replace(/%s/g,function(){return l[h++]})),c.name="Invariant Violation"}throw c.framesToPop=1,c}}var i=function(t){};t.exports=r},function(t,e,n){"use strict";var r={};t.exports=r},function(t,e,n){"use strict";function r(t){return function(){return t}}var i=function(){};i.thatReturns=r,i.thatReturnsFalse=r(!1),i.thatReturnsTrue=r(!0),i.thatReturnsNull=r(null),i.thatReturnsThis=function(){return this},i.thatReturnsArgument=function(t){return t},t.exports=i},function(t,e,n){"use strict";function r(t){o.forEach(function(e){e.logLevel=t})}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"setLogLevel",function(){return r}),n.d(e,"Logger",function(){return u}),n.d(e,"LogLevel",function(){return i});var i,o=[];!function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"}(i||(i={}));var a=i.INFO,s=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(!(e<t.logLevel)){var o=(new Date).toISOString();switch(e){case i.DEBUG:case i.VERBOSE:console.log.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case i.INFO:console.info.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case i.WARN:console.warn.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;case i.ERROR:console.error.apply(console,["["+o+"]  "+t.name+":"].concat(n));break;default:throw new Error("Attempted to log a message with an invalid logType (value: "+e+")")}}},u=function(){function t(t){this.name=t,this._logLevel=a,this._logHandler=s,o.push(this)}return Object.defineProperty(t.prototype,"logLevel",{get:function(){return this._logLevel},set:function(t){if(!(t in i))throw new TypeError("Invalid value assigned to `logLevel`");this._logLevel=t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"logHandler",{get:function(){return this._logHandler},set:function(t){if("function"!==typeof t)throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=t},enumerable:!0,configurable:!0}),t.prototype.debug=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.DEBUG].concat(t))},t.prototype.log=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.VERBOSE].concat(t))},t.prototype.info=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.INFO].concat(t))},t.prototype.warn=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.WARN].concat(t))},t.prototype.error=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];this._logHandler.apply(this,[this,i.ERROR].concat(t))},t}()},function(t,e,n){n(16),t.exports=n(21)},function(t,e,n){"use strict";"undefined"===typeof Promise&&(n(17).enable(),window.Promise=n(19)),n(20),Object.assign=n(4)},function(t,e,n){"use strict";function r(){c=!1,s._47=null,s._71=null}function i(t){function e(e){(t.allRejections||a(h[e].error,t.whitelist||u))&&(h[e].displayId=l++,t.onUnhandled?(h[e].logged=!0,t.onUnhandled(h[e].displayId,h[e].error)):(h[e].logged=!0,o(h[e].displayId,h[e].error)))}function n(e){h[e].logged&&(t.onHandled?t.onHandled(h[e].displayId,h[e].error):h[e].onUnhandled||(console.warn("Promise Rejection Handled (id: "+h[e].displayId+"):"),console.warn('  This means you can ignore any previous messages of the form "Possible Unhandled Promise Rejection" with id '+h[e].displayId+".")))}t=t||{},c&&r(),c=!0;var i=0,l=0,h={};s._47=function(t){2===t._83&&h[t._56]&&(h[t._56].logged?n(t._56):clearTimeout(h[t._56].timeout),delete h[t._56])},s._71=function(t,n){0===t._75&&(t._56=i++,h[t._56]={displayId:null,error:n,timeout:setTimeout(e.bind(null,t._56),a(n,u)?100:2e3),logged:!1})}}function o(t,e){console.warn("Possible Unhandled Promise Rejection (id: "+t+"):"),((e&&(e.stack||e))+"").split("\n").forEach(function(t){console.warn("  "+t)})}function a(t,e){return e.some(function(e){return t instanceof e})}var s=n(9),u=[ReferenceError,TypeError,RangeError],c=!1;e.disable=r,e.enable=i},function(t,e,n){"use strict";(function(e){function n(t){a.length||(o(),s=!0),a[a.length]=t}function r(){for(;u<a.length;){var t=u;if(u+=1,a[t].call(),u>c){for(var e=0,n=a.length-u;e<n;e++)a[e]=a[e+u];a.length-=u,u=0}}a.length=0,u=0,s=!1}function i(t){return function(){function e(){clearTimeout(n),clearInterval(r),t()}var n=setTimeout(e,0),r=setInterval(e,50)}}t.exports=n;var o,a=[],s=!1,u=0,c=1024,l="undefined"!==typeof e?e:self,h=l.MutationObserver||l.WebKitMutationObserver;o="function"===typeof h?function(t){var e=1,n=new h(t),r=document.createTextNode("");return n.observe(r,{characterData:!0}),function(){e=-e,r.data=e}}(r):i(r),n.requestFlush=o,n.makeRequestCallFromTimer=i}).call(e,n(1))},function(t,e,n){"use strict";function r(t){var e=new i(i._44);return e._83=1,e._18=t,e}var i=n(9);t.exports=i;var o=r(!0),a=r(!1),s=r(null),u=r(void 0),c=r(0),l=r("");i.resolve=function(t){if(t instanceof i)return t;if(null===t)return s;if(void 0===t)return u;if(!0===t)return o;if(!1===t)return a;if(0===t)return c;if(""===t)return l;if("object"===typeof t||"function"===typeof t)try{var e=t.then;if("function"===typeof e)return new i(e.bind(t))}catch(t){return new i(function(e,n){n(t)})}return r(t)},i.all=function(t){var e=Array.prototype.slice.call(t);return new i(function(t,n){function r(a,s){if(s&&("object"===typeof s||"function"===typeof s)){if(s instanceof i&&s.then===i.prototype.then){for(;3===s._83;)s=s._18;return 1===s._83?r(a,s._18):(2===s._83&&n(s._18),void s.then(function(t){r(a,t)},n))}var u=s.then;if("function"===typeof u){return void new i(u.bind(s)).then(function(t){r(a,t)},n)}}e[a]=s,0===--o&&t(e)}if(0===e.length)return t([]);for(var o=e.length,a=0;a<e.length;a++)r(a,e[a])})},i.reject=function(t){return new i(function(e,n){n(t)})},i.race=function(t){return new i(function(e,n){t.forEach(function(t){i.resolve(t).then(e,n)})})},i.prototype.catch=function(t){return this.then(null,t)}},function(t,e){!function(t){"use strict";function e(t){if("string"!==typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function n(t){return"string"!==typeof t&&(t=String(t)),t}function r(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return v.iterable&&(e[Symbol.iterator]=function(){return e}),e}function i(t){this.map={},t instanceof i?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function o(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function a(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function s(t){var e=new FileReader,n=a(e);return e.readAsArrayBuffer(t),n}function u(t){var e=new FileReader,n=a(e);return e.readAsText(t),n}function c(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function l(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function h(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"===typeof t)this._bodyText=t;else if(v.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(v.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(v.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(v.arrayBuffer&&v.blob&&_(t))this._bodyArrayBuffer=l(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!v.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!b(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=l(t)}else this._bodyText="";this.headers.get("content-type")||("string"===typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob&&(this.blob=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(p)}),this.json=function(){return this.text().then(JSON.parse)},this}function f(t){var e=t.toUpperCase();return w.indexOf(e)>-1?e:t}function d(t,e){e=e||{};var n=e.body;if(t instanceof d){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new i(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new i(e.headers)),this.method=f(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function p(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(i))}}),e}function m(t){var e=new i;return t.split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();e.append(r,i)}}),e}function g(t,e){e||(e={}),this.type="default",this.status="status"in e?e.status:200,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new i(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var v={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(v.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=function(t){return t&&DataView.prototype.isPrototypeOf(t)},b=ArrayBuffer.isView||function(t){return t&&y.indexOf(Object.prototype.toString.call(t))>-1};i.prototype.append=function(t,r){t=e(t),r=n(r);var i=this.map[t];this.map[t]=i?i+","+r:r},i.prototype.delete=function(t){delete this.map[e(t)]},i.prototype.get=function(t){return t=e(t),this.has(t)?this.map[t]:null},i.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},i.prototype.set=function(t,r){this.map[e(t)]=n(r)},i.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},i.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),r(t)},i.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),r(t)},i.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),r(t)},v.iterable&&(i.prototype[Symbol.iterator]=i.prototype.entries);var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];d.prototype.clone=function(){return new d(this,{body:this._bodyInit})},h.call(d.prototype),h.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},g.error=function(){var t=new g(null,{status:0,statusText:""});return t.type="error",t};var E=[301,302,303,307,308];g.redirect=function(t,e){if(-1===E.indexOf(e))throw new RangeError("Invalid status code");return new g(null,{status:e,headers:{location:t}})},t.Headers=i,t.Request=d,t.Response=g,t.fetch=function(t,e){return new Promise(function(n,r){var i=new d(t,e),o=new XMLHttpRequest;o.onload=function(){var t={status:o.status,statusText:o.statusText,headers:m(o.getAllResponseHeaders()||"")};t.url="responseURL"in o?o.responseURL:t.headers.get("X-Request-URL");var e="response"in o?o.response:o.responseText;n(new g(e,t))},o.onerror=function(){r(new TypeError("Network request failed"))},o.ontimeout=function(){r(new TypeError("Network request failed"))},o.open(i.method,i.url,!0),"include"===i.credentials&&(o.withCredentials=!0),"responseType"in o&&v.blob&&(o.responseType="blob"),i.headers.forEach(function(t,e){o.setRequestHeader(e,t)}),o.send("undefined"===typeof i._bodyInit?null:i._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!==typeof self?self:this)},function(t,e,n){"use strict";function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(i,o){try{var a=e[i](o),s=a.value}catch(t){return void n(t)}if(!a.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});t(s)}return r("next")})}}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"init",function(){return p}),n.d(e,"canRun",function(){return m}),n.d(e,"setDate",function(){return g}),n.d(e,"setSphereView",function(){return v}),n.d(e,"setPlay",function(){return y}),n.d(e,"goToPrev",function(){return _}),n.d(e,"goToNext",function(){return b}),n.d(e,"on",function(){return w}),n.d(e,"getFirstCommit",function(){return E}),n.d(e,"getlastCommit",function(){return x}),n.d(e,"setConfig",function(){return T});var i=n(10),o=n.n(i),a=n(5),s=n.n(a),u=n(25),c=n.n(u),l=n(33),h=(n.n(l),n(34)),f=n(86),d=void 0,p=function(t){return d=c.a.render(s.a.createElement(h.a,{config:t}),document.getElementById("gource-root")),Object(f.a)(),this},m=function(){if(!window.WebGLRenderingContext)return console.log("Your browser does not support WebGL"),!1;var t=document.createElement("canvas").getContext("webgl");if(null===t&&(t=document.createElement("canvas").getContext("experimental-webgl")),null===t)return console.log("Your browser does not support WebGL"),!1;var e=t.getSupportedExtensions();return-1===e.indexOf("ANGLE_instanced_arrays")?(console.log("ANGLE_instanced_arrays support is required to run this app"),!1):-1===e.indexOf("OES_texture_float")?(console.log("OES_texture_float support is required to run this app"),!1):-1===e.indexOf("OES_texture_float_linear")?(console.log("OES_texture_float support is required to run this app"),!1):-1===e.indexOf("OES_texture_half_float")?(console.log("OES_texture_float support is required to run this app"),!1):-1!==e.indexOf("OES_texture_half_float_linear")||(console.log("OES_texture_float support is required to run this app"),!1)},g=function(t){d&&d.setDate(t)},v=function(t){d&&d.setSphereView(t)},y=function(t){d&&d.setPlay(t)},_=function(){d&&d.goToPrev()},b=function(){d&&d.goToNext()},w=function(t,e){if(d)return d.on(t,e)},E=function(){var t=r(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(d){t.next=2;break}return t.abrupt("return");case 2:return t.abrupt("return",d.getFirstCommit());case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),x=function(){var t=r(o.a.mark(function t(){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(d){t.next=2;break}return t.abrupt("return");case 2:return t.abrupt("return",d.getlastCommit());case 3:case"end":return t.stop()}},t,this)}));return function(){return t.apply(this,arguments)}}(),T=function(){var t=r(o.a.mark(function t(e){return o.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(d){t.next=2;break}return t.abrupt("return");case 2:return t.abrupt("return",d.setConfig(e));case 3:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}()},function(t,e,n){var r=function(){return this}()||Function("return this")(),i=r.regeneratorRuntime&&Object.getOwnPropertyNames(r).indexOf("regeneratorRuntime")>=0,o=i&&r.regeneratorRuntime;if(r.regeneratorRuntime=void 0,t.exports=n(23),i)r.regeneratorRuntime=o;else try{delete r.regeneratorRuntime}catch(t){r.regeneratorRuntime=void 0}},function(t,e){!function(e){"use strict";function n(t,e,n,r){var o=e&&e.prototype instanceof i?e:i,a=Object.create(o.prototype),s=new d(r||[]);return a._invoke=c(t,n,s),a}function r(t,e,n){try{return{type:"normal",arg:t.call(e,n)}}catch(t){return{type:"throw",arg:t}}}function i(){}function o(){}function a(){}function s(t){["next","throw","return"].forEach(function(e){t[e]=function(t){return this._invoke(e,t)}})}function u(t){function e(n,i,o,a){var s=r(t[n],t,i);if("throw"!==s.type){var u=s.arg,c=u.value;return c&&"object"===typeof c&&y.call(c,"__await")?Promise.resolve(c.__await).then(function(t){e("next",t,o,a)},function(t){e("throw",t,o,a)}):Promise.resolve(c).then(function(t){u.value=t,o(u)},a)}a(s.arg)}function n(t,n){function r(){return new Promise(function(r,i){e(t,n,r,i)})}return i=i?i.then(r,r):r()}var i;this._invoke=n}function c(t,e,n){var i=S;return function(o,a){if(i===M)throw new Error("Generator is already running");if(i===A){if("throw"===o)throw a;return m()}for(n.method=o,n.arg=a;;){var s=n.delegate;if(s){var u=l(s,n);if(u){if(u===I)continue;return u}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(i===S)throw i=A,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);i=M;var c=r(t,e,n);if("normal"===c.type){if(i=n.done?A:C,c.arg===I)continue;return{value:c.arg,done:n.done}}"throw"===c.type&&(i=A,n.method="throw",n.arg=c.arg)}}}function l(t,e){var n=t.iterator[e.method];if(n===g){if(e.delegate=null,"throw"===e.method){if(t.iterator.return&&(e.method="return",e.arg=g,l(t,e),"throw"===e.method))return I;e.method="throw",e.arg=new TypeError("The iterator does not provide a 'throw' method")}return I}var i=r(n,t.iterator,e.arg);if("throw"===i.type)return e.method="throw",e.arg=i.arg,e.delegate=null,I;var o=i.arg;return o?o.done?(e[t.resultName]=o.value,e.next=t.nextLoc,"return"!==e.method&&(e.method="next",e.arg=g),e.delegate=null,I):o:(e.method="throw",e.arg=new TypeError("iterator result is not an object"),e.delegate=null,I)}function h(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function f(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function d(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(h,this),this.reset(!0)}function p(t){if(t){var e=t[b];if(e)return e.call(t);if("function"===typeof t.next)return t;if(!isNaN(t.length)){var n=-1,r=function e(){for(;++n<t.length;)if(y.call(t,n))return e.value=t[n],e.done=!1,e;return e.value=g,e.done=!0,e};return r.next=r}}return{next:m}}function m(){return{value:g,done:!0}}var g,v=Object.prototype,y=v.hasOwnProperty,_="function"===typeof Symbol?Symbol:{},b=_.iterator||"@@iterator",w=_.asyncIterator||"@@asyncIterator",E=_.toStringTag||"@@toStringTag",x="object"===typeof t,T=e.regeneratorRuntime;if(T)return void(x&&(t.exports=T));T=e.regeneratorRuntime=x?t.exports:{},T.wrap=n;var S="suspendedStart",C="suspendedYield",M="executing",A="completed",I={},R={};R[b]=function(){return this};var P=Object.getPrototypeOf,N=P&&P(P(p([])));N&&N!==v&&y.call(N,b)&&(R=N);var D=a.prototype=i.prototype=Object.create(R);o.prototype=D.constructor=a,a.constructor=o,a[E]=o.displayName="GeneratorFunction",T.isGeneratorFunction=function(t){var e="function"===typeof t&&t.constructor;return!!e&&(e===o||"GeneratorFunction"===(e.displayName||e.name))},T.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,a):(t.__proto__=a,E in t||(t[E]="GeneratorFunction")),t.prototype=Object.create(D),t},T.awrap=function(t){return{__await:t}},s(u.prototype),u.prototype[w]=function(){return this},T.AsyncIterator=u,T.async=function(t,e,r,i){var o=new u(n(t,e,r,i));return T.isGeneratorFunction(e)?o:o.next().then(function(t){return t.done?t.value:o.next()})},s(D),D[E]="Generator",D[b]=function(){return this},D.toString=function(){return"[object Generator]"},T.keys=function(t){var e=[];for(var n in t)e.push(n);return e.reverse(),function n(){for(;e.length;){var r=e.pop();if(r in t)return n.value=r,n.done=!1,n}return n.done=!0,n}},T.values=p,d.prototype={constructor:d,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=g,this.done=!1,this.delegate=null,this.method="next",this.arg=g,this.tryEntries.forEach(f),!t)for(var e in this)"t"===e.charAt(0)&&y.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=g)},stop:function(){this.done=!0;var t=this.tryEntries[0],e=t.completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){function e(e,r){return o.type="throw",o.arg=t,n.next=e,r&&(n.method="next",n.arg=g),!!r}if(this.done)throw t;for(var n=this,r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return e("end");if(i.tryLoc<=this.prev){var a=y.call(i,"catchLoc"),s=y.call(i,"finallyLoc");if(a&&s){if(this.prev<i.catchLoc)return e(i.catchLoc,!0);if(this.prev<i.finallyLoc)return e(i.finallyLoc)}else if(a){if(this.prev<i.catchLoc)return e(i.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return e(i.finallyLoc)}}}},abrupt:function(t,e){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&y.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=t,o.arg=e,i?(this.method="next",this.next=i.finallyLoc,I):this.complete(o)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),I},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.finallyLoc===t)return this.complete(n.completion,n.afterLoc),f(n),I}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var n=this.tryEntries[e];if(n.tryLoc===t){var r=n.completion;if("throw"===r.type){var i=r.arg;f(n)}return i}}throw new Error("illegal catch attempt")},delegateYield:function(t,e,n){return this.delegate={iterator:p(t),resultName:e,nextLoc:n},"next"===this.method&&(this.arg=g),I}}}(function(){return this}()||Function("return this")())},function(t,e,n){"use strict";function r(t){for(var e=arguments.length-1,n="http://reactjs.org/docs/error-decoder.html?invariant="+t,r=0;r<e;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);y(!1,"Minified React error #"+t+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}function i(t,e,n){this.props=t,this.context=e,this.refs=_,this.updater=n||P}function o(){}function a(t,e,n){this.props=t,this.context=e,this.refs=_,this.updater=n||P}function s(t,e,n){var r=void 0,i={},o=null,a=null;if(null!=e)for(r in void 0!==e.ref&&(a=e.ref),void 0!==e.key&&(o=""+e.key),e)O.call(e,r)&&!k.hasOwnProperty(r)&&(i[r]=e[r]);var s=arguments.length-2;if(1===s)i.children=n;else if(1<s){for(var u=Array(s),c=0;c<s;c++)u[c]=arguments[c+2];i.children=u}if(t&&t.defaultProps)for(r in s=t.defaultProps)void 0===i[r]&&(i[r]=s[r]);return{$$typeof:E,type:t,key:o,ref:a,props:i,_owner:D.current}}function u(t){return"object"===typeof t&&null!==t&&t.$$typeof===E}function c(t){var e={"=":"=0",":":"=2"};return"$"+(""+t).replace(/[=:]/g,function(t){return e[t]})}function l(t,e,n,r){if(U.length){var i=U.pop();return i.result=t,i.keyPrefix=e,i.func=n,i.context=r,i.count=0,i}return{result:t,keyPrefix:e,func:n,context:r,count:0}}function h(t){t.result=null,t.keyPrefix=null,t.func=null,t.context=null,t.count=0,10>U.length&&U.push(t)}function f(t,e,n,i){var o=typeof t;"undefined"!==o&&"boolean"!==o||(t=null);var a=!1;if(null===t)a=!0;else switch(o){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case E:case x:a=!0}}if(a)return n(i,t,""===e?"."+d(t,0):e),1;if(a=0,e=""===e?".":e+":",Array.isArray(t))for(var s=0;s<t.length;s++){o=t[s];var u=e+d(o,s);a+=f(o,u,n,i)}else if(null===t||"undefined"===typeof t?u=null:(u=R&&t[R]||t["@@iterator"],u="function"===typeof u?u:null),"function"===typeof u)for(t=u.call(t),s=0;!(o=t.next()).done;)o=o.value,u=e+d(o,s++),a+=f(o,u,n,i);else"object"===o&&(n=""+t,r("31","[object Object]"===n?"object with keys {"+Object.keys(t).join(", ")+"}":n,""));return a}function d(t,e){return"object"===typeof t&&null!==t&&null!=t.key?c(t.key):e.toString(36)}function p(t,e){t.func.call(t.context,e,t.count++)}function m(t,e,n){var r=t.result,i=t.keyPrefix;t=t.func.call(t.context,e,t.count++),Array.isArray(t)?g(t,r,n,b.thatReturnsArgument):null!=t&&(u(t)&&(e=i+(!t.key||e&&e.key===t.key?"":(""+t.key).replace(L,"$&/")+"/")+n,t={$$typeof:E,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}),r.push(t))}function g(t,e,n,r,i){var o="";null!=n&&(o=(""+n).replace(L,"$&/")+"/"),e=l(e,o,r,i),null==t||f(t,"",m,e),h(e)}var v=n(4),y=n(11),_=n(12),b=n(13),w="function"===typeof Symbol&&Symbol.for,E=w?Symbol.for("react.element"):60103,x=w?Symbol.for("react.portal"):60106,T=w?Symbol.for("react.fragment"):60107,S=w?Symbol.for("react.strict_mode"):60108,C=w?Symbol.for("react.provider"):60109,M=w?Symbol.for("react.context"):60110,A=w?Symbol.for("react.async_mode"):60111,I=w?Symbol.for("react.forward_ref"):60112,R="function"===typeof Symbol&&Symbol.iterator,P={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}};i.prototype.isReactComponent={},i.prototype.setState=function(t,e){"object"!==typeof t&&"function"!==typeof t&&null!=t&&r("85"),this.updater.enqueueSetState(this,t,e,"setState")},i.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")},o.prototype=i.prototype;var N=a.prototype=new o;N.constructor=a,v(N,i.prototype),N.isPureReactComponent=!0;var D={current:null},O=Object.prototype.hasOwnProperty,k={key:!0,ref:!0,__self:!0,__source:!0},L=/\/+/g,U=[],F={Children:{map:function(t,e,n){if(null==t)return t;var r=[];return g(t,r,null,e,n),r},forEach:function(t,e,n){if(null==t)return t;e=l(null,null,e,n),null==t||f(t,"",p,e),h(e)},count:function(t){return null==t?0:f(t,"",b.thatReturnsNull,null)},toArray:function(t){var e=[];return g(t,e,null,b.thatReturnsArgument),e},only:function(t){return u(t)||r("143"),t}},createRef:function(){return{current:null}},Component:i,PureComponent:a,createContext:function(t,e){return void 0===e&&(e=null),t={$$typeof:M,_calculateChangedBits:e,_defaultValue:t,_currentValue:t,_changedBits:0,Provider:null,Consumer:null},t.Provider={$$typeof:C,_context:t},t.Consumer=t},forwardRef:function(t){return{$$typeof:I,render:t}},Fragment:T,StrictMode:S,unstable_AsyncMode:A,createElement:s,cloneElement:function(t,e,n){(null===t||void 0===t)&&r("267",t);var i=void 0,o=v({},t.props),a=t.key,s=t.ref,u=t._owner;if(null!=e){void 0!==e.ref&&(s=e.ref,u=D.current),void 0!==e.key&&(a=""+e.key);var c=void 0;t.type&&t.type.defaultProps&&(c=t.type.defaultProps);for(i in e)O.call(e,i)&&!k.hasOwnProperty(i)&&(o[i]=void 0===e[i]&&void 0!==c?c[i]:e[i])}if(1===(i=arguments.length-2))o.children=n;else if(1<i){c=Array(i);for(var l=0;l<i;l++)c[l]=arguments[l+2];o.children=c}return{$$typeof:E,type:t.type,key:a,ref:s,props:o,_owner:u}},createFactory:function(t){var e=s.bind(null,t);return e.type=t,e},isValidElement:u,version:"16.3.2",__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{ReactCurrentOwner:D,assign:v}},B=Object.freeze({default:F}),V=B&&F||B;t.exports=V.default?V.default:V},function(t,e,n){"use strict";function r(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(r)}catch(t){console.error(t)}}r(),t.exports=n(26)},function(t,e,n){"use strict";function r(t){for(var e=arguments.length-1,n="http://reactjs.org/docs/error-decoder.html?invariant="+t,r=0;r<e;r++)n+="&args[]="+encodeURIComponent(arguments[r+1]);cn(!1,"Minified React error #"+t+"; visit %s for the full message or use the non-minified dev environment for full errors and additional helpful warnings. ",n)}function i(t,e,n,r,i,o,a,s,u){this._hasCaughtError=!1,this._caughtError=null;var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(t){this._caughtError=t,this._hasCaughtError=!0}}function o(){if(yn._hasRethrowError){var t=yn._rethrowError;throw yn._rethrowError=null,yn._hasRethrowError=!1,t}}function a(){if(_n)for(var t in bn){var e=bn[t],n=_n.indexOf(t);if(-1<n||r("96",t),!wn[n]){e.extractEvents||r("97",t),wn[n]=e,n=e.eventTypes;for(var i in n){var o=void 0,a=n[i],u=e,c=i;En.hasOwnProperty(c)&&r("99",c),En[c]=a;var l=a.phasedRegistrationNames;if(l){for(o in l)l.hasOwnProperty(o)&&s(l[o],u,c);o=!0}else a.registrationName?(s(a.registrationName,u,c),o=!0):o=!1;o||r("98",i,t)}}}}function s(t,e,n){xn[t]&&r("100",t),xn[t]=e,Tn[t]=e.eventTypes[n].dependencies}function u(t){_n&&r("101"),_n=Array.prototype.slice.call(t),a()}function c(t){var e,n=!1;for(e in t)if(t.hasOwnProperty(e)){var i=t[e];bn.hasOwnProperty(e)&&bn[e]===i||(bn[e]&&r("102",e),bn[e]=i,n=!0)}n&&a()}function l(t,e,n,r){e=t.type||"unknown-event",t.currentTarget=An(r),yn.invokeGuardedCallbackAndCatchFirstError(e,n,void 0,t),t.currentTarget=null}function h(t,e){return null==e&&r("30"),null==t?e:Array.isArray(t)?Array.isArray(e)?(t.push.apply(t,e),t):(t.push(e),t):Array.isArray(e)?[t].concat(e):[t,e]}function f(t,e,n){Array.isArray(t)?t.forEach(e,n):t&&e.call(n,t)}function d(t,e){if(t){var n=t._dispatchListeners,r=t._dispatchInstances;if(Array.isArray(n))for(var i=0;i<n.length&&!t.isPropagationStopped();i++)l(t,e,n[i],r[i]);else n&&l(t,e,n,r);t._dispatchListeners=null,t._dispatchInstances=null,t.isPersistent()||t.constructor.release(t)}}function p(t){return d(t,!0)}function m(t){return d(t,!1)}function g(t,e){var n=t.stateNode;if(!n)return null;var i=Cn(n);if(!i)return null;n=i[e];t:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":(i=!i.disabled)||(t=t.type,i=!("button"===t||"input"===t||"select"===t||"textarea"===t)),t=!i;break t;default:t=!1}return t?null:(n&&"function"!==typeof n&&r("231",e,typeof n),n)}function v(t,e){null!==t&&(In=h(In,t)),t=In,In=null,t&&(e?f(t,p):f(t,m),In&&r("95"),yn.rethrowCaughtError())}function y(t,e,n,r){for(var i=null,o=0;o<wn.length;o++){var a=wn[o];a&&(a=a.extractEvents(t,e,n,r))&&(i=h(i,a))}v(i,!1)}function _(t){if(t[Dn])return t[Dn];for(;!t[Dn];){if(!t.parentNode)return null;t=t.parentNode}return t=t[Dn],5===t.tag||6===t.tag?t:null}function b(t){if(5===t.tag||6===t.tag)return t.stateNode;r("33")}function w(t){return t[On]||null}function E(t){do{t=t.return}while(t&&5!==t.tag);return t||null}function x(t,e,n){for(var r=[];t;)r.push(t),t=E(t);for(t=r.length;0<t--;)e(r[t],"captured",n);for(t=0;t<r.length;t++)e(r[t],"bubbled",n)}function T(t,e,n){(e=g(t,n.dispatchConfig.phasedRegistrationNames[e]))&&(n._dispatchListeners=h(n._dispatchListeners,e),n._dispatchInstances=h(n._dispatchInstances,t))}function S(t){t&&t.dispatchConfig.phasedRegistrationNames&&x(t._targetInst,T,t)}function C(t){if(t&&t.dispatchConfig.phasedRegistrationNames){var e=t._targetInst;e=e?E(e):null,x(e,T,t)}}function M(t,e,n){t&&n&&n.dispatchConfig.registrationName&&(e=g(t,n.dispatchConfig.registrationName))&&(n._dispatchListeners=h(n._dispatchListeners,e),n._dispatchInstances=h(n._dispatchInstances,t))}function A(t){t&&t.dispatchConfig.registrationName&&M(t._targetInst,null,t)}function I(t){f(t,S)}function R(t,e,n,r){if(n&&r)t:{for(var i=n,o=r,a=0,s=i;s;s=E(s))a++;s=0;for(var u=o;u;u=E(u))s++;for(;0<a-s;)i=E(i),a--;for(;0<s-a;)o=E(o),s--;for(;a--;){if(i===o||i===o.alternate)break t;i=E(i),o=E(o)}i=null}else i=null;for(o=i,i=[];n&&n!==o&&(null===(a=n.alternate)||a!==o);)i.push(n),n=E(n);for(n=[];r&&r!==o&&(null===(a=r.alternate)||a!==o);)n.push(r),r=E(r);for(r=0;r<i.length;r++)M(i[r],"bubbled",t);for(t=n.length;0<t--;)M(n[t],"captured",e)}function P(){return!Un&&hn.canUseDOM&&(Un="textContent"in document.documentElement?"textContent":"innerText"),Un}function N(){if(Fn._fallbackText)return Fn._fallbackText;var t,e,n=Fn._startText,r=n.length,i=D(),o=i.length;for(t=0;t<r&&n[t]===i[t];t++);var a=r-t;for(e=1;e<=a&&n[r-e]===i[o-e];e++);return Fn._fallbackText=i.slice(t,1<e?1-e:void 0),Fn._fallbackText}function D(){return"value"in Fn._root?Fn._root.value:Fn._root[P()]}function O(t,e,n,r){this.dispatchConfig=t,this._targetInst=e,this.nativeEvent=n,t=this.constructor.Interface;for(var i in t)t.hasOwnProperty(i)&&((e=t[i])?this[i]=e(n):"target"===i?this.target=r:this[i]=n[i]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?dn.thatReturnsTrue:dn.thatReturnsFalse,this.isPropagationStopped=dn.thatReturnsFalse,this}function k(t,e,n,r){if(this.eventPool.length){var i=this.eventPool.pop();return this.call(i,t,e,n,r),i}return new this(t,e,n,r)}function L(t){t instanceof this||r("223"),t.destructor(),10>this.eventPool.length&&this.eventPool.push(t)}function U(t){t.eventPool=[],t.getPooled=k,t.release=L}function F(t,e){switch(t){case"topKeyUp":return-1!==Gn.indexOf(e.keyCode);case"topKeyDown":return 229!==e.keyCode;case"topKeyPress":case"topMouseDown":case"topBlur":return!0;default:return!1}}function B(t){return t=t.detail,"object"===typeof t&&"data"in t?t.data:null}function V(t,e){switch(t){case"topCompositionEnd":return B(e);case"topKeyPress":return 32!==e.which?null:(Xn=!0,Kn);case"topTextInput":return t=e.data,t===Kn&&Xn?null:t;default:return null}}function j(t,e){if(Jn)return"topCompositionEnd"===t||!zn&&F(t,e)?(t=N(),Fn._root=null,Fn._startText=null,Fn._fallbackText=null,Jn=!1,t):null;switch(t){case"topPaste":return null;case"topKeyPress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"topCompositionEnd":return Yn?null:e.data;default:return null}}function H(t){if(t=Mn(t)){$n&&"function"===typeof $n.restoreControlledState||r("194");var e=Cn(t.stateNode);$n.restoreControlledState(t.stateNode,t.type,e)}}function G(t){er?nr?nr.push(t):nr=[t]:er=t}function z(){return null!==er||null!==nr}function W(){if(er){var t=er,e=nr;if(nr=er=null,H(t),e)for(t=0;t<e.length;t++)H(e[t])}}function q(t,e){return t(e)}function Y(t,e,n){return t(e,n)}function K(){}function Q(t,e){if(ir)return t(e);ir=!0;try{return q(t,e)}finally{ir=!1,z()&&(K(),W())}}function X(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return"input"===e?!!or[t.type]:"textarea"===e}function J(t){return t=t.target||window,t.correspondingUseElement&&(t=t.correspondingUseElement),3===t.nodeType?t.parentNode:t}function Z(t,e){return!(!hn.canUseDOM||e&&!("addEventListener"in document))&&(t="on"+t,e=t in document,e||(e=document.createElement("div"),e.setAttribute(t,"return;"),e="function"===typeof e[t]),e)}function $(t){var e=t.type;return(t=t.nodeName)&&"input"===t.toLowerCase()&&("checkbox"===e||"radio"===e)}function tt(t){var e=$(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&"function"===typeof n.get&&"function"===typeof n.set)return Object.defineProperty(t,e,{configurable:!0,get:function(){return n.get.call(this)},set:function(t){r=""+t,n.set.call(this,t)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(t){r=""+t},stopTracking:function(){t._valueTracker=null,delete t[e]}}}function et(t){t._valueTracker||(t._valueTracker=tt(t))}function nt(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=$(t)?t.checked?"true":"false":t.value),(t=r)!==n&&(e.setValue(t),!0)}function rt(t){return null===t||"undefined"===typeof t?null:(t=yr&&t[yr]||t["@@iterator"],"function"===typeof t?t:null)}function it(t){if("function"===typeof(t=t.type))return t.displayName||t.name;if("string"===typeof t)return t;switch(t){case fr:return"ReactFragment";case hr:return"ReactPortal";case cr:return"ReactCall";case lr:return"ReactReturn"}if("object"===typeof t&&null!==t)switch(t.$$typeof){case vr:return t=t.render.displayName||t.render.name||"",""!==t?"ForwardRef("+t+")":"ForwardRef"}return null}function ot(t){var e="";do{t:switch(t.tag){case 0:case 1:case 2:case 5:var n=t._debugOwner,r=t._debugSource,i=it(t),o=null;n&&(o=it(n)),n=r,i="\n    in "+(i||"Unknown")+(n?" (at "+n.fileName.replace(/^.*[\\\/]/,"")+":"+n.lineNumber+")":o?" (created by "+o+")":"");break t;default:i=""}e+=i,t=t.return}while(t);return e}function at(t){return!!wr.hasOwnProperty(t)||!br.hasOwnProperty(t)&&(_r.test(t)?wr[t]=!0:(br[t]=!0,!1))}function st(t,e,n,r){if(null!==n&&0===n.type)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return!r&&(null!==n?!n.acceptsBooleans:"data-"!==(t=t.toLowerCase().slice(0,5))&&"aria-"!==t);default:return!1}}function ut(t,e,n,r){if(null===e||"undefined"===typeof e||st(t,e,n,r))return!0;if(null!==n)switch(n.type){case 3:return!e;case 4:return!1===e;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function ct(t,e,n,r,i){this.acceptsBooleans=2===e||3===e||4===e,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=t,this.type=e}function lt(t){return t[1].toUpperCase()}function ht(t,e,n,r){var i=Er.hasOwnProperty(e)?Er[e]:null;(null!==i?0===i.type:!r&&(2<e.length&&("o"===e[0]||"O"===e[0])&&("n"===e[1]||"N"===e[1])))||(ut(e,n,i,r)&&(n=null),r||null===i?at(e)&&(null===n?t.removeAttribute(e):t.setAttribute(e,""+n)):i.mustUseProperty?t[i.propertyName]=null===n?3!==i.type&&"":n:(e=i.attributeName,r=i.attributeNamespace,null===n?t.removeAttribute(e):(i=i.type,n=3===i||4===i&&!0===n?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}function ft(t,e){var n=e.checked;return fn({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=n?n:t._wrapperState.initialChecked})}function dt(t,e){var n=null==e.defaultValue?"":e.defaultValue,r=null!=e.checked?e.checked:e.defaultChecked;n=yt(null!=e.value?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:"checkbox"===e.type||"radio"===e.type?null!=e.checked:null!=e.value}}function pt(t,e){null!=(e=e.checked)&&ht(t,"checked",e,!1)}function mt(t,e){pt(t,e);var n=yt(e.value);null!=n&&("number"===e.type?(0===n&&""===t.value||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n)),e.hasOwnProperty("value")?vt(t,e.type,n):e.hasOwnProperty("defaultValue")&&vt(t,e.type,yt(e.defaultValue)),null==e.checked&&null!=e.defaultChecked&&(t.defaultChecked=!!e.defaultChecked)}function gt(t,e){(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue"))&&(""===t.value&&(t.value=""+t._wrapperState.initialValue),t.defaultValue=""+t._wrapperState.initialValue),e=t.name,""!==e&&(t.name=""),t.defaultChecked=!t.defaultChecked,t.defaultChecked=!t.defaultChecked,""!==e&&(t.name=e)}function vt(t,e,n){"number"===e&&t.ownerDocument.activeElement===t||(null==n?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}function yt(t){switch(typeof t){case"boolean":case"number":case"object":case"string":case"undefined":return t;default:return""}}function _t(t,e,n){return t=O.getPooled(Tr.change,t,e,n),t.type="change",G(n),I(t),t}function bt(t){v(t,!1)}function wt(t){if(nt(b(t)))return t}function Et(t,e){if("topChange"===t)return e}function xt(){Sr&&(Sr.detachEvent("onpropertychange",Tt),Cr=Sr=null)}function Tt(t){"value"===t.propertyName&&wt(Cr)&&(t=_t(Cr,t,J(t)),Q(bt,t))}function St(t,e,n){"topFocus"===t?(xt(),Sr=e,Cr=n,Sr.attachEvent("onpropertychange",Tt)):"topBlur"===t&&xt()}function Ct(t){if("topSelectionChange"===t||"topKeyUp"===t||"topKeyDown"===t)return wt(Cr)}function Mt(t,e){if("topClick"===t)return wt(e)}function At(t,e){if("topInput"===t||"topChange"===t)return wt(e)}function It(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):!!(t=Rr[t])&&!!e[t]}function Rt(){return It}function Pt(t){var e=t;if(t.alternate)for(;e.return;)e=e.return;else{if(0!==(2&e.effectTag))return 1;for(;e.return;)if(e=e.return,0!==(2&e.effectTag))return 1}return 3===e.tag?2:3}function Nt(t){return!!(t=t._reactInternalFiber)&&2===Pt(t)}function Dt(t){2!==Pt(t)&&r("188")}function Ot(t){var e=t.alternate;if(!e)return e=Pt(t),3===e&&r("188"),1===e?null:t;for(var n=t,i=e;;){var o=n.return,a=o?o.alternate:null;if(!o||!a)break;if(o.child===a.child){for(var s=o.child;s;){if(s===n)return Dt(o),t;if(s===i)return Dt(o),e;s=s.sibling}r("188")}if(n.return!==i.return)n=o,i=a;else{s=!1;for(var u=o.child;u;){if(u===n){s=!0,n=o,i=a;break}if(u===i){s=!0,i=o,n=a;break}u=u.sibling}if(!s){for(u=a.child;u;){if(u===n){s=!0,n=a,i=o;break}if(u===i){s=!0,i=a,n=o;break}u=u.sibling}s||r("189")}}n.alternate!==i&&r("190")}return 3!==n.tag&&r("188"),n.stateNode.current===n?t:e}function kt(t){if(!(t=Ot(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function Lt(t){if(!(t=Ot(t)))return null;for(var e=t;;){if(5===e.tag||6===e.tag)return e;if(e.child&&4!==e.tag)e.child.return=e,e=e.child;else{if(e===t)break;for(;!e.sibling;){if(!e.return||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}}return null}function Ut(t){var e=t.keyCode;return"charCode"in t?0===(t=t.charCode)&&13===e&&(t=13):t=e,10===t&&(t=13),32<=t||13===t?t:0}function Ft(t,e){var n=t[0].toUpperCase()+t.slice(1),r="on"+n;n="top"+n,e={phasedRegistrationNames:{bubbled:r,captured:r+"Capture"},dependencies:[n],isInteractive:e},zr[t]=e,Wr[n]=e}function Bt(t){var e=t.targetInst;do{if(!e){t.ancestors.push(e);break}var n;for(n=e;n.return;)n=n.return;if(!(n=3!==n.tag?null:n.stateNode.containerInfo))break;t.ancestors.push(e),e=_(n)}while(e);for(n=0;n<t.ancestors.length;n++)e=t.ancestors[n],y(t.topLevelType,e,t.nativeEvent,J(t.nativeEvent))}function Vt(t){Qr=!!t}function jt(t,e,n){if(!n)return null;t=(Yr(t)?Gt:zt).bind(null,t),n.addEventListener(e,t,!1)}function Ht(t,e,n){if(!n)return null;t=(Yr(t)?Gt:zt).bind(null,t),n.addEventListener(e,t,!0)}function Gt(t,e){Y(zt,t,e)}function zt(t,e){if(Qr){var n=J(e);if(n=_(n),null!==n&&"number"===typeof n.tag&&2!==Pt(n)&&(n=null),Kr.length){var r=Kr.pop();r.topLevelType=t,r.nativeEvent=e,r.targetInst=n,t=r}else t={topLevelType:t,nativeEvent:e,targetInst:n,ancestors:[]};try{Q(Bt,t)}finally{t.topLevelType=null,t.nativeEvent=null,t.targetInst=null,t.ancestors.length=0,10>Kr.length&&Kr.push(t)}}}function Wt(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n["ms"+t]="MS"+e,n["O"+t]="o"+e.toLowerCase(),n}function qt(t){if(Zr[t])return Zr[t];if(!Jr[t])return t;var e,n=Jr[t];for(e in n)if(n.hasOwnProperty(e)&&e in $r)return Zr[t]=n[e];return t}function Yt(t){return Object.prototype.hasOwnProperty.call(t,ii)||(t[ii]=ri++,ni[t[ii]]={}),ni[t[ii]]}function Kt(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Qt(t,e){var n=Kt(t);t=0;for(var r;n;){if(3===n.nodeType){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}t:{for(;n;){if(n.nextSibling){n=n.nextSibling;break t}n=n.parentNode}n=void 0}n=Kt(n)}}function Xt(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&("input"===e&&"text"===t.type||"textarea"===e||"true"===t.contentEditable)}function Jt(t,e){if(li||null==si||si!==pn())return null;var n=si;return"selectionStart"in n&&Xt(n)?n={start:n.selectionStart,end:n.selectionEnd}:window.getSelection?(n=window.getSelection(),n={anchorNode:n.anchorNode,anchorOffset:n.anchorOffset,focusNode:n.focusNode,focusOffset:n.focusOffset}):n=void 0,ci&&mn(ci,n)?null:(ci=n,t=O.getPooled(ai.select,ui,t,e),t.type="select",t.target=si,I(t),t)}function Zt(t,e,n,r){this.tag=t,this.key=n,this.stateNode=this.type=null,this.sibling=this.child=this.return=null,this.index=0,this.ref=null,this.pendingProps=e,this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.effectTag=0,this.lastEffect=this.firstEffect=this.nextEffect=null,this.expirationTime=0,this.alternate=null}function $t(t,e,n){var r=t.alternate;return null===r?(r=new Zt(t.tag,e,t.key,t.mode),r.type=t.type,r.stateNode=t.stateNode,r.alternate=t,t.alternate=r):(r.pendingProps=e,r.effectTag=0,r.nextEffect=null,r.firstEffect=null,r.lastEffect=null),r.expirationTime=n,r.child=t.child,r.memoizedProps=t.memoizedProps,r.memoizedState=t.memoizedState,r.updateQueue=t.updateQueue,r.sibling=t.sibling,r.index=t.index,r.ref=t.ref,r}function te(t,e,n){var i=t.type,o=t.key;t=t.props;var a=void 0;if("function"===typeof i)a=i.prototype&&i.prototype.isReactComponent?2:0;else if("string"===typeof i)a=5;else switch(i){case fr:return ee(t.children,e,n,o);case gr:a=11,e|=3;break;case dr:a=11,e|=2;break;case cr:a=7;break;case lr:a=9;break;default:if("object"===typeof i&&null!==i)switch(i.$$typeof){case pr:a=13;break;case mr:a=12;break;case vr:a=14;break;default:if("number"===typeof i.tag)return e=i,e.pendingProps=t,e.expirationTime=n,e;r("130",null==i?i:typeof i,"")}else r("130",null==i?i:typeof i,"")}return e=new Zt(a,t,o,e),e.type=i,e.expirationTime=n,e}function ee(t,e,n,r){return t=new Zt(10,t,r,e),t.expirationTime=n,t}function ne(t,e,n){return t=new Zt(6,t,null,e),t.expirationTime=n,t}function re(t,e,n){return e=new Zt(4,null!==t.children?t.children:[],t.key,e),e.expirationTime=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function ie(t){return function(e){try{return t(e)}catch(t){}}}function oe(t){if("undefined"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__)return!1;var e=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(e.isDisabled||!e.supportsFiber)return!0;try{var n=e.inject(t);fi=ie(function(t){return e.onCommitFiberRoot(n,t)}),di=ie(function(t){return e.onCommitFiberUnmount(n,t)})}catch(t){}return!0}function ae(t){"function"===typeof fi&&fi(t)}function se(t){"function"===typeof di&&di(t)}function ue(t){return{baseState:t,expirationTime:0,first:null,last:null,callbackList:null,hasForceUpdate:!1,isInitialized:!1,capturedValues:null}}function ce(t,e){null===t.last?t.first=t.last=e:(t.last.next=e,t.last=e),(0===t.expirationTime||t.expirationTime>e.expirationTime)&&(t.expirationTime=e.expirationTime)}function le(t){pi=mi=null;var e=t.alternate,n=t.updateQueue;null===n&&(n=t.updateQueue=ue(null)),null!==e?null===(t=e.updateQueue)&&(t=e.updateQueue=ue(null)):t=null,pi=n,mi=t!==n?t:null}function he(t,e){le(t),t=pi;var n=mi;null===n?ce(t,e):null===t.last||null===n.last?(ce(t,e),ce(n,e)):(ce(t,e),n.last=e)}function fe(t,e,n,r){return t=t.partialState,"function"===typeof t?t.call(e,n,r):t}function de(t,e,n,r,i,o){null!==t&&t.updateQueue===n&&(n=e.updateQueue={baseState:n.baseState,expirationTime:n.expirationTime,first:n.first,last:n.last,isInitialized:n.isInitialized,capturedValues:n.capturedValues,callbackList:null,hasForceUpdate:!1}),n.expirationTime=0,n.isInitialized?t=n.baseState:(t=n.baseState=e.memoizedState,n.isInitialized=!0);for(var a=!0,s=n.first,u=!1;null!==s;){var c=s.expirationTime;if(c>o){var l=n.expirationTime;(0===l||l>c)&&(n.expirationTime=c),u||(u=!0,n.baseState=t)}else u||(n.first=s.next,null===n.first&&(n.last=null)),s.isReplace?(t=fe(s,r,t,i),a=!0):(c=fe(s,r,t,i))&&(t=a?fn({},t,c):fn(t,c),a=!1),s.isForced&&(n.hasForceUpdate=!0),null!==s.callback&&(c=n.callbackList,null===c&&(c=n.callbackList=[]),c.push(s)),null!==s.capturedValue&&(c=n.capturedValues,null===c?n.capturedValues=[s.capturedValue]:c.push(s.capturedValue));s=s.next}return null!==n.callbackList?e.effectTag|=32:null!==n.first||n.hasForceUpdate||null!==n.capturedValues||(e.updateQueue=null),u||(n.baseState=t),t}function pe(t,e){var n=t.callbackList;if(null!==n)for(t.callbackList=null,t=0;t<n.length;t++){var i=n[t],o=i.callback;i.callback=null,"function"!==typeof o&&r("191",o),o.call(e)}}function me(t,e,n,r,i){function o(t,e,n,r,i,o){if(null===e||null!==t.updateQueue&&t.updateQueue.hasForceUpdate)return!0;var a=t.stateNode;return t=t.type,"function"===typeof a.shouldComponentUpdate?a.shouldComponentUpdate(n,i,o):!t.prototype||!t.prototype.isPureReactComponent||(!mn(e,n)||!mn(r,i))}function a(t,e){e.updater=p,t.stateNode=e,e._reactInternalFiber=t}function s(t,e,n,r){t=e.state,"function"===typeof e.componentWillReceiveProps&&e.componentWillReceiveProps(n,r),"function"===typeof e.UNSAFE_componentWillReceiveProps&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&p.enqueueReplaceState(e,e.state,null)}function u(t,e,n,r){if(t=t.type,"function"===typeof t.getDerivedStateFromProps)return t.getDerivedStateFromProps.call(null,n,r)}var c=t.cacheContext,l=t.getMaskedContext,h=t.getUnmaskedContext,f=t.isContextConsumer,d=t.hasContextChanged,p={isMounted:Nt,enqueueSetState:function(t,r,i){t=t._reactInternalFiber,i=void 0===i?null:i;var o=n(t);he(t,{expirationTime:o,partialState:r,callback:i,isReplace:!1,isForced:!1,capturedValue:null,next:null}),e(t,o)},enqueueReplaceState:function(t,r,i){t=t._reactInternalFiber,i=void 0===i?null:i;var o=n(t);he(t,{expirationTime:o,partialState:r,callback:i,isReplace:!0,isForced:!1,capturedValue:null,next:null}),e(t,o)},enqueueForceUpdate:function(t,r){t=t._reactInternalFiber,r=void 0===r?null:r;var i=n(t);he(t,{expirationTime:i,partialState:null,callback:r,isReplace:!1,isForced:!0,capturedValue:null,next:null}),e(t,i)}};return{adoptClassInstance:a,callGetDerivedStateFromProps:u,constructClassInstance:function(t,e){var n=t.type,r=h(t),i=f(t),o=i?l(t,r):vn;n=new n(e,o);var s=null!==n.state&&void 0!==n.state?n.state:null;return a(t,n),t.memoizedState=s,e=u(t,n,e,s),null!==e&&void 0!==e&&(t.memoizedState=fn({},t.memoizedState,e)),i&&c(t,r,o),n},mountClassInstance:function(t,e){var n=t.type,r=t.alternate,i=t.stateNode,o=t.pendingProps,a=h(t);i.props=o,i.state=t.memoizedState,i.refs=vn,i.context=l(t,a),"function"===typeof n.getDerivedStateFromProps||"function"===typeof i.getSnapshotBeforeUpdate||"function"!==typeof i.UNSAFE_componentWillMount&&"function"!==typeof i.componentWillMount||(n=i.state,"function"===typeof i.componentWillMount&&i.componentWillMount(),"function"===typeof i.UNSAFE_componentWillMount&&i.UNSAFE_componentWillMount(),n!==i.state&&p.enqueueReplaceState(i,i.state,null),null!==(n=t.updateQueue)&&(i.state=de(r,t,n,i,o,e))),"function"===typeof i.componentDidMount&&(t.effectTag|=4)},resumeMountClassInstance:function(t,e){var n=t.type,a=t.stateNode;a.props=t.memoizedProps,a.state=t.memoizedState;var c=t.memoizedProps,f=t.pendingProps,p=a.context,m=h(t);m=l(t,m),(n="function"===typeof n.getDerivedStateFromProps||"function"===typeof a.getSnapshotBeforeUpdate)||"function"!==typeof a.UNSAFE_componentWillReceiveProps&&"function"!==typeof a.componentWillReceiveProps||(c!==f||p!==m)&&s(t,a,f,m),p=t.memoizedState,e=null!==t.updateQueue?de(null,t,t.updateQueue,a,f,e):p;var g=void 0;if(c!==f&&(g=u(t,a,f,e)),null!==g&&void 0!==g){e=null===e||void 0===e?g:fn({},e,g);var v=t.updateQueue;null!==v&&(v.baseState=fn({},v.baseState,g))}return c!==f||p!==e||d()||null!==t.updateQueue&&t.updateQueue.hasForceUpdate?((c=o(t,c,f,p,e,m))?(n||"function"!==typeof a.UNSAFE_componentWillMount&&"function"!==typeof a.componentWillMount||("function"===typeof a.componentWillMount&&a.componentWillMount(),"function"===typeof a.UNSAFE_componentWillMount&&a.UNSAFE_componentWillMount()),"function"===typeof a.componentDidMount&&(t.effectTag|=4)):("function"===typeof a.componentDidMount&&(t.effectTag|=4),r(t,f),i(t,e)),a.props=f,a.state=e,a.context=m,c):("function"===typeof a.componentDidMount&&(t.effectTag|=4),!1)},updateClassInstance:function(t,e,n){var a=e.type,c=e.stateNode;c.props=e.memoizedProps,c.state=e.memoizedState;var f=e.memoizedProps,p=e.pendingProps,m=c.context,g=h(e);g=l(e,g),(a="function"===typeof a.getDerivedStateFromProps||"function"===typeof c.getSnapshotBeforeUpdate)||"function"!==typeof c.UNSAFE_componentWillReceiveProps&&"function"!==typeof c.componentWillReceiveProps||(f!==p||m!==g)&&s(e,c,p,g),m=e.memoizedState,n=null!==e.updateQueue?de(t,e,e.updateQueue,c,p,n):m;var v=void 0;if(f!==p&&(v=u(e,c,p,n)),null!==v&&void 0!==v){n=null===n||void 0===n?v:fn({},n,v);var y=e.updateQueue;null!==y&&(y.baseState=fn({},y.baseState,v))}return f!==p||m!==n||d()||null!==e.updateQueue&&e.updateQueue.hasForceUpdate?((v=o(e,f,p,m,n,g))?(a||"function"!==typeof c.UNSAFE_componentWillUpdate&&"function"!==typeof c.componentWillUpdate||("function"===typeof c.componentWillUpdate&&c.componentWillUpdate(p,n,g),"function"===typeof c.UNSAFE_componentWillUpdate&&c.UNSAFE_componentWillUpdate(p,n,g)),"function"===typeof c.componentDidUpdate&&(e.effectTag|=4),"function"===typeof c.getSnapshotBeforeUpdate&&(e.effectTag|=2048)):("function"!==typeof c.componentDidUpdate||f===t.memoizedProps&&m===t.memoizedState||(e.effectTag|=4),"function"!==typeof c.getSnapshotBeforeUpdate||f===t.memoizedProps&&m===t.memoizedState||(e.effectTag|=2048),r(e,p),i(e,n)),c.props=p,c.state=n,c.context=g,v):("function"!==typeof c.componentDidUpdate||f===t.memoizedProps&&m===t.memoizedState||(e.effectTag|=4),"function"!==typeof c.getSnapshotBeforeUpdate||f===t.memoizedProps&&m===t.memoizedState||(e.effectTag|=2048),!1)}}}function ge(t,e,n){if(null!==(t=n.ref)&&"function"!==typeof t&&"object"!==typeof t){if(n._owner){n=n._owner;var i=void 0;n&&(2!==n.tag&&r("110"),i=n.stateNode),i||r("147",t);var o=""+t;return null!==e&&null!==e.ref&&e.ref._stringRef===o?e.ref:(e=function(t){var e=i.refs===vn?i.refs={}:i.refs;null===t?delete e[o]:e[o]=t},e._stringRef=o,e)}"string"!==typeof t&&r("148"),n._owner||r("254",t)}return t}function ve(t,e){"textarea"!==t.type&&r("31","[object Object]"===Object.prototype.toString.call(e)?"object with keys {"+Object.keys(e).join(", ")+"}":e,"")}function ye(t){function e(e,n){if(t){var r=e.lastEffect;null!==r?(r.nextEffect=n,e.lastEffect=n):e.firstEffect=e.lastEffect=n,n.nextEffect=null,n.effectTag=8}}function n(n,r){if(!t)return null;for(;null!==r;)e(n,r),r=r.sibling;return null}function i(t,e){for(t=new Map;null!==e;)null!==e.key?t.set(e.key,e):t.set(e.index,e),e=e.sibling;return t}function o(t,e,n){return t=$t(t,e,n),t.index=0,t.sibling=null,t}function a(e,n,r){return e.index=r,t?null!==(r=e.alternate)?(r=r.index,r<n?(e.effectTag=2,n):r):(e.effectTag=2,n):n}function s(e){return t&&null===e.alternate&&(e.effectTag=2),e}function u(t,e,n,r){return null===e||6!==e.tag?(e=ne(n,t.mode,r),e.return=t,e):(e=o(e,n,r),e.return=t,e)}function c(t,e,n,r){return null!==e&&e.type===n.type?(r=o(e,n.props,r),r.ref=ge(t,e,n),r.return=t,r):(r=te(n,t.mode,r),r.ref=ge(t,e,n),r.return=t,r)}function l(t,e,n,r){return null===e||4!==e.tag||e.stateNode.containerInfo!==n.containerInfo||e.stateNode.implementation!==n.implementation?(e=re(n,t.mode,r),e.return=t,e):(e=o(e,n.children||[],r),e.return=t,e)}function h(t,e,n,r,i){return null===e||10!==e.tag?(e=ee(n,t.mode,r,i),e.return=t,e):(e=o(e,n,r),e.return=t,e)}function f(t,e,n){if("string"===typeof e||"number"===typeof e)return e=ne(""+e,t.mode,n),e.return=t,e;if("object"===typeof e&&null!==e){switch(e.$$typeof){case ur:return n=te(e,t.mode,n),n.ref=ge(t,null,e),n.return=t,n;case hr:return e=re(e,t.mode,n),e.return=t,e}if(gi(e)||rt(e))return e=ee(e,t.mode,n,null),e.return=t,e;ve(t,e)}return null}function d(t,e,n,r){var i=null!==e?e.key:null;if("string"===typeof n||"number"===typeof n)return null!==i?null:u(t,e,""+n,r);if("object"===typeof n&&null!==n){switch(n.$$typeof){case ur:return n.key===i?n.type===fr?h(t,e,n.props.children,r,i):c(t,e,n,r):null;case hr:return n.key===i?l(t,e,n,r):null}if(gi(n)||rt(n))return null!==i?null:h(t,e,n,r,null);ve(t,n)}return null}function p(t,e,n,r,i){if("string"===typeof r||"number"===typeof r)return t=t.get(n)||null,u(e,t,""+r,i);if("object"===typeof r&&null!==r){switch(r.$$typeof){case ur:return t=t.get(null===r.key?n:r.key)||null,r.type===fr?h(e,t,r.props.children,i,r.key):c(e,t,r,i);case hr:return t=t.get(null===r.key?n:r.key)||null,l(e,t,r,i)}if(gi(r)||rt(r))return t=t.get(n)||null,h(e,t,r,i,null);ve(e,r)}return null}function m(r,o,s,u){for(var c=null,l=null,h=o,m=o=0,g=null;null!==h&&m<s.length;m++){h.index>m?(g=h,h=null):g=h.sibling;var v=d(r,h,s[m],u);if(null===v){null===h&&(h=g);break}t&&h&&null===v.alternate&&e(r,h),o=a(v,o,m),null===l?c=v:l.sibling=v,l=v,h=g}if(m===s.length)return n(r,h),c;if(null===h){for(;m<s.length;m++)(h=f(r,s[m],u))&&(o=a(h,o,m),null===l?c=h:l.sibling=h,l=h);return c}for(h=i(r,h);m<s.length;m++)(g=p(h,r,m,s[m],u))&&(t&&null!==g.alternate&&h.delete(null===g.key?m:g.key),o=a(g,o,m),null===l?c=g:l.sibling=g,l=g);return t&&h.forEach(function(t){return e(r,t)}),c}function g(o,s,u,c){var l=rt(u);"function"!==typeof l&&r("150"),null==(u=l.call(u))&&r("151");for(var h=l=null,m=s,g=s=0,v=null,y=u.next();null!==m&&!y.done;g++,y=u.next()){m.index>g?(v=m,m=null):v=m.sibling;var _=d(o,m,y.value,c);if(null===_){m||(m=v);break}t&&m&&null===_.alternate&&e(o,m),s=a(_,s,g),null===h?l=_:h.sibling=_,h=_,m=v}if(y.done)return n(o,m),l;if(null===m){for(;!y.done;g++,y=u.next())null!==(y=f(o,y.value,c))&&(s=a(y,s,g),null===h?l=y:h.sibling=y,h=y);return l}for(m=i(o,m);!y.done;g++,y=u.next())null!==(y=p(m,o,g,y.value,c))&&(t&&null!==y.alternate&&m.delete(null===y.key?g:y.key),s=a(y,s,g),null===h?l=y:h.sibling=y,h=y);return t&&m.forEach(function(t){return e(o,t)}),l}return function(t,i,a,u){"object"===typeof a&&null!==a&&a.type===fr&&null===a.key&&(a=a.props.children);var c="object"===typeof a&&null!==a;if(c)switch(a.$$typeof){case ur:t:{var l=a.key;for(c=i;null!==c;){if(c.key===l){if(10===c.tag?a.type===fr:c.type===a.type){n(t,c.sibling),i=o(c,a.type===fr?a.props.children:a.props,u),i.ref=ge(t,c,a),i.return=t,t=i;break t}n(t,c);break}e(t,c),c=c.sibling}a.type===fr?(i=ee(a.props.children,t.mode,u,a.key),i.return=t,t=i):(u=te(a,t.mode,u),u.ref=ge(t,i,a),u.return=t,t=u)}return s(t);case hr:t:{for(c=a.key;null!==i;){if(i.key===c){if(4===i.tag&&i.stateNode.containerInfo===a.containerInfo&&i.stateNode.implementation===a.implementation){n(t,i.sibling),i=o(i,a.children||[],u),i.return=t,t=i;break t}n(t,i);break}e(t,i),i=i.sibling}i=re(a,t.mode,u),i.return=t,t=i}return s(t)}if("string"===typeof a||"number"===typeof a)return a=""+a,null!==i&&6===i.tag?(n(t,i.sibling),i=o(i,a,u),i.return=t,t=i):(n(t,i),i=ne(a,t.mode,u),i.return=t,t=i),s(t);if(gi(a))return m(t,i,a,u);if(rt(a))return g(t,i,a,u);if(c&&ve(t,a),"undefined"===typeof a)switch(t.tag){case 2:case 1:u=t.type,r("152",u.displayName||u.name||"Component")}return n(t,i)}}function _e(t,e,n,i,o,a,s){function u(t,e,n){c(t,e,n,e.expirationTime)}function c(t,e,n,r){e.child=null===t?yi(e,null,n,r):vi(e,t.child,n,r)}function l(t,e){var n=e.ref;(null===t&&null!==n||null!==t&&t.ref!==n)&&(e.effectTag|=128)}function h(t,e,n,r,i,o){if(l(t,e),!n&&!i)return r&&C(e,!1),m(t,e);n=e.stateNode,ar.current=e;var a=i?null:n.render();return e.effectTag|=1,i&&(c(t,e,null,o),e.child=null),c(t,e,a,o),e.memoizedState=n.state,e.memoizedProps=n.props,r&&C(e,!0),e.child}function f(t){var e=t.stateNode;e.pendingContext?S(t,e.pendingContext,e.pendingContext!==e.context):e.context&&S(t,e.context,!1),_(t,e.containerInfo)}function d(t,e,n,r){var i=t.child;for(null!==i&&(i.return=t);null!==i;){switch(i.tag){case 12:var o=0|i.stateNode;if(i.type===e&&0!==(o&n)){for(o=i;null!==o;){var a=o.alternate;if(0===o.expirationTime||o.expirationTime>r)o.expirationTime=r,null!==a&&(0===a.expirationTime||a.expirationTime>r)&&(a.expirationTime=r);else{if(null===a||!(0===a.expirationTime||a.expirationTime>r))break;a.expirationTime=r}o=o.return}o=null}else o=i.child;break;case 13:o=i.type===t.type?null:i.child;break;default:o=i.child}if(null!==o)o.return=i;else for(o=i;null!==o;){if(o===t){o=null;break}if(null!==(i=o.sibling)){o=i;break}o=o.return}i=o}}function p(t,e,n){var r=e.type._context,i=e.pendingProps,o=e.memoizedProps;if(!x()&&o===i)return e.stateNode=0,b(e),m(t,e);var a=i.value;if(e.memoizedProps=i,null===o)a=1073741823;else if(o.value===i.value){if(o.children===i.children)return e.stateNode=0,b(e),m(t,e);a=0}else{var s=o.value;if(s===a&&(0!==s||1/s===1/a)||s!==s&&a!==a){if(o.children===i.children)return e.stateNode=0,b(e),m(t,e);a=0}else if(a="function"===typeof r._calculateChangedBits?r._calculateChangedBits(s,a):1073741823,0===(a|=0)){if(o.children===i.children)return e.stateNode=0,b(e),m(t,e)}else d(e,r,a,n)}return e.stateNode=a,b(e),u(t,e,i.children),e.child}function m(t,e){if(null!==t&&e.child!==t.child&&r("153"),null!==e.child){t=e.child;var n=$t(t,t.pendingProps,t.expirationTime);for(e.child=n,n.return=e;null!==t.sibling;)t=t.sibling,n=n.sibling=$t(t,t.pendingProps,t.expirationTime),n.return=e;n.sibling=null}return e.child}var g=t.shouldSetTextContent,v=t.shouldDeprioritizeSubtree,y=e.pushHostContext,_=e.pushHostContainer,b=i.pushProvider,w=n.getMaskedContext,E=n.getUnmaskedContext,x=n.hasContextChanged,T=n.pushContextProvider,S=n.pushTopLevelContextObject,C=n.invalidateContextProvider,M=o.enterHydrationState,A=o.resetHydrationState,I=o.tryToClaimNextHydratableInstance;t=me(n,a,s,function(t,e){t.memoizedProps=e},function(t,e){t.memoizedState=e});var R=t.adoptClassInstance,P=t.callGetDerivedStateFromProps,N=t.constructClassInstance,D=t.mountClassInstance,O=t.resumeMountClassInstance,k=t.updateClassInstance;return{beginWork:function(t,e,n){if(0===e.expirationTime||e.expirationTime>n){switch(e.tag){case 3:f(e);break;case 2:T(e);break;case 4:_(e,e.stateNode.containerInfo);break;case 13:b(e)}return null}switch(e.tag){case 0:null!==t&&r("155");var i=e.type,o=e.pendingProps,a=E(e);return a=w(e,a),i=i(o,a),e.effectTag|=1,"object"===typeof i&&null!==i&&"function"===typeof i.render&&void 0===i.$$typeof?(a=e.type,e.tag=2,e.memoizedState=null!==i.state&&void 0!==i.state?i.state:null,"function"===typeof a.getDerivedStateFromProps&&null!==(o=P(e,i,o,e.memoizedState))&&void 0!==o&&(e.memoizedState=fn({},e.memoizedState,o)),o=T(e),R(e,i),D(e,n),t=h(t,e,!0,o,!1,n)):(e.tag=1,u(t,e,i),e.memoizedProps=o,t=e.child),t;case 1:return o=e.type,n=e.pendingProps,x()||e.memoizedProps!==n?(i=E(e),i=w(e,i),o=o(n,i),e.effectTag|=1,u(t,e,o),e.memoizedProps=n,t=e.child):t=m(t,e),t;case 2:o=T(e),null===t?null===e.stateNode?(N(e,e.pendingProps),D(e,n),i=!0):i=O(e,n):i=k(t,e,n),a=!1;var s=e.updateQueue;return null!==s&&null!==s.capturedValues&&(a=i=!0),h(t,e,i,o,a,n);case 3:t:if(f(e),null!==(i=e.updateQueue)){if(a=e.memoizedState,o=de(t,e,i,null,null,n),e.memoizedState=o,null!==(i=e.updateQueue)&&null!==i.capturedValues)i=null;else{if(a===o){A(),t=m(t,e);break t}i=o.element}a=e.stateNode,(null===t||null===t.child)&&a.hydrate&&M(e)?(e.effectTag|=2,e.child=yi(e,null,i,n)):(A(),u(t,e,i)),e.memoizedState=o,t=e.child}else A(),t=m(t,e);return t;case 5:return y(e),null===t&&I(e),o=e.type,s=e.memoizedProps,i=e.pendingProps,a=null!==t?t.memoizedProps:null,x()||s!==i||((s=1&e.mode&&v(o,i))&&(e.expirationTime=1073741823),s&&1073741823===n)?(s=i.children,g(o,i)?s=null:a&&g(o,a)&&(e.effectTag|=16),l(t,e),1073741823!==n&&1&e.mode&&v(o,i)?(e.expirationTime=1073741823,e.memoizedProps=i,t=null):(u(t,e,s),e.memoizedProps=i,t=e.child)):t=m(t,e),t;case 6:return null===t&&I(e),e.memoizedProps=e.pendingProps,null;case 8:e.tag=7;case 7:return o=e.pendingProps,x()||e.memoizedProps!==o||(o=e.memoizedProps),i=o.children,e.stateNode=null===t?yi(e,e.stateNode,i,n):vi(e,t.stateNode,i,n),e.memoizedProps=o,e.stateNode;case 9:return null;case 4:return _(e,e.stateNode.containerInfo),o=e.pendingProps,x()||e.memoizedProps!==o?(null===t?e.child=vi(e,null,o,n):u(t,e,o),e.memoizedProps=o,t=e.child):t=m(t,e),t;case 14:return n=e.type.render,n=n(e.pendingProps,e.ref),u(t,e,n),e.memoizedProps=n,e.child;case 10:return n=e.pendingProps,x()||e.memoizedProps!==n?(u(t,e,n),e.memoizedProps=n,t=e.child):t=m(t,e),t;case 11:return n=e.pendingProps.children,x()||null!==n&&e.memoizedProps!==n?(u(t,e,n),e.memoizedProps=n,t=e.child):t=m(t,e),t;case 13:return p(t,e,n);case 12:t:{i=e.type,a=e.pendingProps,s=e.memoizedProps,o=i._currentValue;var c=i._changedBits;if(x()||0!==c||s!==a){e.memoizedProps=a;var S=a.unstable_observedBits;if(void 0!==S&&null!==S||(S=1073741823),e.stateNode=S,0!==(c&S))d(e,i,c,n);else if(s===a){t=m(t,e);break t}n=a.children,n=n(o),u(t,e,n),t=e.child}else t=m(t,e)}return t;default:r("156")}}}}function be(t,e,n,i,o){function a(t){t.effectTag|=4}var s=t.createInstance,u=t.createTextInstance,c=t.appendInitialChild,l=t.finalizeInitialChildren,h=t.prepareUpdate,f=t.persistence,d=e.getRootHostContainer,p=e.popHostContext,m=e.getHostContext,g=e.popHostContainer,v=n.popContextProvider,y=n.popTopLevelContextObject,_=i.popProvider,b=o.prepareToHydrateHostInstance,w=o.prepareToHydrateHostTextInstance,E=o.popHydrationState,x=void 0,T=void 0,S=void 0;return t.mutation?(x=function(){},T=function(t,e,n){(e.updateQueue=n)&&a(e)},S=function(t,e,n,r){n!==r&&a(e)}):r(f?"235":"236"),{completeWork:function(t,e,n){var i=e.pendingProps;switch(e.tag){case 1:return null;case 2:return v(e),t=e.stateNode,i=e.updateQueue,null!==i&&null!==i.capturedValues&&(e.effectTag&=-65,"function"===typeof t.componentDidCatch?e.effectTag|=256:i.capturedValues=null),null;case 3:return g(e),y(e),i=e.stateNode,i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),null!==t&&null!==t.child||(E(e),e.effectTag&=-3),x(e),t=e.updateQueue,null!==t&&null!==t.capturedValues&&(e.effectTag|=256),null;case 5:p(e),n=d();var o=e.type;if(null!==t&&null!=e.stateNode){var f=t.memoizedProps,C=e.stateNode,M=m();C=h(C,o,f,i,n,M),T(t,e,C,o,f,i,n,M),t.ref!==e.ref&&(e.effectTag|=128)}else{if(!i)return null===e.stateNode&&r("166"),null;if(t=m(),E(e))b(e,n,t)&&a(e);else{f=s(o,i,n,t,e);t:for(M=e.child;null!==M;){if(5===M.tag||6===M.tag)c(f,M.stateNode);else if(4!==M.tag&&null!==M.child){M.child.return=M,M=M.child;continue}if(M===e)break;for(;null===M.sibling;){if(null===M.return||M.return===e)break t;M=M.return}M.sibling.return=M.return,M=M.sibling}l(f,o,i,n,t)&&a(e),e.stateNode=f}null!==e.ref&&(e.effectTag|=128)}return null;case 6:if(t&&null!=e.stateNode)S(t,e,t.memoizedProps,i);else{if("string"!==typeof i)return null===e.stateNode&&r("166"),null;t=d(),n=m(),E(e)?w(e)&&a(e):e.stateNode=u(i,t,n,e)}return null;case 7:(i=e.memoizedProps)||r("165"),e.tag=8,o=[];t:for((f=e.stateNode)&&(f.return=e);null!==f;){if(5===f.tag||6===f.tag||4===f.tag)r("247");else if(9===f.tag)o.push(f.pendingProps.value);else if(null!==f.child){f.child.return=f,f=f.child;continue}for(;null===f.sibling;){if(null===f.return||f.return===e)break t;f=f.return}f.sibling.return=f.return,f=f.sibling}return f=i.handler,i=f(i.props,o),e.child=vi(e,null!==t?t.child:null,i,n),e.child;case 8:return e.tag=7,null;case 9:case 14:case 10:case 11:return null;case 4:return g(e),x(e),null;case 13:return _(e),null;case 12:return null;case 0:r("167");default:r("156")}}}}function we(t,e,n,r,i){var o=t.popHostContainer,a=t.popHostContext,s=e.popContextProvider,u=e.popTopLevelContextObject,c=n.popProvider;return{throwException:function(t,e,n){e.effectTag|=512,e.firstEffect=e.lastEffect=null,e={value:n,source:e,stack:ot(e)};do{switch(t.tag){case 3:return le(t),t.updateQueue.capturedValues=[e],void(t.effectTag|=1024);case 2:if(n=t.stateNode,0===(64&t.effectTag)&&null!==n&&"function"===typeof n.componentDidCatch&&!i(n)){le(t),n=t.updateQueue;var r=n.capturedValues;return null===r?n.capturedValues=[e]:r.push(e),void(t.effectTag|=1024)}}t=t.return}while(null!==t)},unwindWork:function(t){switch(t.tag){case 2:s(t);var e=t.effectTag;return 1024&e?(t.effectTag=-1025&e|64,t):null;case 3:return o(t),u(t),e=t.effectTag,1024&e?(t.effectTag=-1025&e|64,t):null;case 5:return a(t),null;case 4:return o(t),null;case 13:return c(t),null;default:return null}},unwindInterruptedWork:function(t){switch(t.tag){case 2:s(t);break;case 3:o(t),u(t);break;case 5:a(t);break;case 4:o(t);break;case 13:c(t)}}}}function Ee(t,e){var n=e.source;null===e.stack&&ot(n),null!==n&&it(n),e=e.value,null!==t&&2===t.tag&&it(t);try{e&&e.suppressReactErrorLogging||console.error(e)}catch(t){t&&t.suppressReactErrorLogging||console.error(t)}}function xe(t,e,n,i,o){function a(t){var n=t.ref;if(null!==n)if("function"===typeof n)try{n(null)}catch(n){e(t,n)}else n.current=null}function s(t){switch("function"===typeof se&&se(t),t.tag){case 2:a(t);var n=t.stateNode;if("function"===typeof n.componentWillUnmount)try{n.props=t.memoizedProps,n.state=t.memoizedState,n.componentWillUnmount()}catch(n){e(t,n)}break;case 5:a(t);break;case 7:u(t.stateNode);break;case 4:f&&l(t)}}function u(t){for(var e=t;;)if(s(e),null===e.child||f&&4===e.tag){if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return;e=e.return}e.sibling.return=e.return,e=e.sibling}else e.child.return=e,e=e.child}function c(t){return 5===t.tag||3===t.tag||4===t.tag}function l(t){for(var e=t,n=!1,i=void 0,o=void 0;;){if(!n){n=e.return;t:for(;;){switch(null===n&&r("160"),n.tag){case 5:i=n.stateNode,o=!1;break t;case 3:case 4:i=n.stateNode.containerInfo,o=!0;break t}n=n.return}n=!0}if(5===e.tag||6===e.tag)u(e),o?E(i,e.stateNode):w(i,e.stateNode);else if(4===e.tag?i=e.stateNode.containerInfo:s(e),null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break;for(;null===e.sibling;){if(null===e.return||e.return===t)return;e=e.return,4===e.tag&&(n=!1)}e.sibling.return=e.return,e=e.sibling}}var h=t.getPublicInstance,f=t.mutation;t=t.persistence,f||r(t?"235":"236");var d=f.commitMount,p=f.commitUpdate,m=f.resetTextContent,g=f.commitTextUpdate,v=f.appendChild,y=f.appendChildToContainer,_=f.insertBefore,b=f.insertInContainerBefore,w=f.removeChild,E=f.removeChildFromContainer;return{commitBeforeMutationLifeCycles:function(t,e){switch(e.tag){case 2:if(2048&e.effectTag&&null!==t){var n=t.memoizedProps,i=t.memoizedState;t=e.stateNode,t.props=e.memoizedProps,t.state=e.memoizedState,e=t.getSnapshotBeforeUpdate(n,i),t.__reactInternalSnapshotBeforeUpdate=e}break;case 3:case 5:case 6:case 4:break;default:r("163")}},commitResetTextContent:function(t){m(t.stateNode)},commitPlacement:function(t){t:{for(var e=t.return;null!==e;){if(c(e)){var n=e;break t}e=e.return}r("160"),n=void 0}var i=e=void 0;switch(n.tag){case 5:e=n.stateNode,i=!1;break;case 3:case 4:e=n.stateNode.containerInfo,i=!0;break;default:r("161")}16&n.effectTag&&(m(e),n.effectTag&=-17);t:e:for(n=t;;){for(;null===n.sibling;){if(null===n.return||c(n.return)){n=null;break t}n=n.return}for(n.sibling.return=n.return,n=n.sibling;5!==n.tag&&6!==n.tag;){if(2&n.effectTag)continue e;if(null===n.child||4===n.tag)continue e;n.child.return=n,n=n.child}if(!(2&n.effectTag)){n=n.stateNode;break t}}for(var o=t;;){if(5===o.tag||6===o.tag)n?i?b(e,o.stateNode,n):_(e,o.stateNode,n):i?y(e,o.stateNode):v(e,o.stateNode);else if(4!==o.tag&&null!==o.child){o.child.return=o,o=o.child;continue}if(o===t)break;for(;null===o.sibling;){if(null===o.return||o.return===t)return;o=o.return}o.sibling.return=o.return,o=o.sibling}},commitDeletion:function(t){l(t),t.return=null,t.child=null,t.alternate&&(t.alternate.child=null,t.alternate.return=null)},commitWork:function(t,e){switch(e.tag){case 2:break;case 5:var n=e.stateNode;if(null!=n){var i=e.memoizedProps;t=null!==t?t.memoizedProps:i;var o=e.type,a=e.updateQueue;e.updateQueue=null,null!==a&&p(n,a,o,t,i,e)}break;case 6:null===e.stateNode&&r("162"),n=e.memoizedProps,g(e.stateNode,null!==t?t.memoizedProps:n,n);break;case 3:break;default:r("163")}},commitLifeCycles:function(t,e,n){switch(n.tag){case 2:if(t=n.stateNode,4&n.effectTag)if(null===e)t.props=n.memoizedProps,t.state=n.memoizedState,t.componentDidMount();else{var i=e.memoizedProps;e=e.memoizedState,t.props=n.memoizedProps,t.state=n.memoizedState,t.componentDidUpdate(i,e,t.__reactInternalSnapshotBeforeUpdate)}n=n.updateQueue,null!==n&&pe(n,t);break;case 3:if(null!==(e=n.updateQueue)){if(t=null,null!==n.child)switch(n.child.tag){case 5:t=h(n.child.stateNode);break;case 2:t=n.child.stateNode}pe(e,t)}break;case 5:t=n.stateNode,null===e&&4&n.effectTag&&d(t,n.type,n.memoizedProps,n);break;case 6:case 4:break;default:r("163")}},commitErrorLogging:function(t,e){switch(t.tag){case 2:var n=t.type;e=t.stateNode;var i=t.updateQueue;(null===i||null===i.capturedValues)&&r("264");var a=i.capturedValues;for(i.capturedValues=null,"function"!==typeof n.getDerivedStateFromCatch&&o(e),e.props=t.memoizedProps,e.state=t.memoizedState,n=0;n<a.length;n++){i=a[n];var s=i.value,u=i.stack;Ee(t,i),e.componentDidCatch(s,{componentStack:null!==u?u:""})}break;case 3:for(n=t.updateQueue,(null===n||null===n.capturedValues)&&r("264"),a=n.capturedValues,n.capturedValues=null,n=0;n<a.length;n++)i=a[n],Ee(t,i),e(i.value);break;default:r("265")}},commitAttachRef:function(t){var e=t.ref;if(null!==e){var n=t.stateNode;switch(t.tag){case 5:t=h(n);break;default:t=n}"function"===typeof e?e(t):e.current=t}},commitDetachRef:function(t){null!==(t=t.ref)&&("function"===typeof t?t(null):t.current=null)}}}function Te(t,e){function n(t){return t===_i&&r("174"),t}var i=t.getChildHostContext,o=t.getRootHostContext;t=e.createCursor;var a=e.push,s=e.pop,u=t(_i),c=t(_i),l=t(_i);return{getHostContext:function(){return n(u.current)},getRootHostContainer:function(){return n(l.current)},popHostContainer:function(t){s(u,t),s(c,t),s(l,t)},popHostContext:function(t){c.current===t&&(s(u,t),s(c,t))},pushHostContainer:function(t,e){a(l,e,t),a(c,t,t),a(u,_i,t),e=o(e),s(u,t),a(u,e,t)},pushHostContext:function(t){var e=n(l.current),r=n(u.current);e=i(r,t.type,e),r!==e&&(a(c,t,t),a(u,e,t))}}}function Se(t){function e(t,e){var n=new Zt(5,null,null,0);n.type="DELETED",n.stateNode=e,n.return=t,n.effectTag=8,null!==t.lastEffect?(t.lastEffect.nextEffect=n,t.lastEffect=n):t.firstEffect=t.lastEffect=n}function n(t,e){switch(t.tag){case 5:return null!==(e=a(e,t.type,t.pendingProps))&&(t.stateNode=e,!0);case 6:return null!==(e=s(e,t.pendingProps))&&(t.stateNode=e,!0);default:return!1}}function i(t){for(t=t.return;null!==t&&5!==t.tag&&3!==t.tag;)t=t.return;f=t}var o=t.shouldSetTextContent;if(!(t=t.hydration))return{enterHydrationState:function(){return!1},resetHydrationState:function(){},tryToClaimNextHydratableInstance:function(){},prepareToHydrateHostInstance:function(){r("175")},prepareToHydrateHostTextInstance:function(){r("176")},popHydrationState:function(){return!1}};var a=t.canHydrateInstance,s=t.canHydrateTextInstance,u=t.getNextHydratableSibling,c=t.getFirstHydratableChild,l=t.hydrateInstance,h=t.hydrateTextInstance,f=null,d=null,p=!1;return{enterHydrationState:function(t){return d=c(t.stateNode.containerInfo),f=t,p=!0},resetHydrationState:function(){d=f=null,p=!1},tryToClaimNextHydratableInstance:function(t){if(p){var r=d;if(r){if(!n(t,r)){if(!(r=u(r))||!n(t,r))return t.effectTag|=2,p=!1,void(f=t);e(f,d)}f=t,d=c(r)}else t.effectTag|=2,p=!1,f=t}},prepareToHydrateHostInstance:function(t,e,n){return e=l(t.stateNode,t.type,t.memoizedProps,e,n,t),t.updateQueue=e,null!==e},prepareToHydrateHostTextInstance:function(t){return h(t.stateNode,t.memoizedProps,t)},popHydrationState:function(t){if(t!==f)return!1;if(!p)return i(t),p=!0,!1;var n=t.type;if(5!==t.tag||"head"!==n&&"body"!==n&&!o(n,t.memoizedProps))for(n=d;n;)e(t,n),n=u(n);return i(t),d=f?u(t.stateNode):null,!0}}}function Ce(t){function e(t,e,n){t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=n}function n(t){return 2===t.tag&&null!=t.type.childContextTypes}function i(t,e){var n=t.stateNode,i=t.type.childContextTypes;if("function"!==typeof n.getChildContext)return e;n=n.getChildContext();for(var o in n)o in i||r("108",it(t)||"Unknown",o);return fn({},e,n)}var o=t.createCursor,a=t.push,s=t.pop,u=o(vn),c=o(!1),l=vn;return{getUnmaskedContext:function(t){return n(t)?l:u.current},cacheContext:e,getMaskedContext:function(t,n){var r=t.type.contextTypes;if(!r)return vn;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===n)return i.__reactInternalMemoizedMaskedChildContext;var o,a={};for(o in r)a[o]=n[o];return i&&e(t,n,a),a},hasContextChanged:function(){return c.current},isContextConsumer:function(t){return 2===t.tag&&null!=t.type.contextTypes},isContextProvider:n,popContextProvider:function(t){n(t)&&(s(c,t),s(u,t))},popTopLevelContextObject:function(t){s(c,t),s(u,t)},pushTopLevelContextObject:function(t,e,n){null!=u.cursor&&r("168"),a(u,e,t),a(c,n,t)},processChildContext:i,pushContextProvider:function(t){if(!n(t))return!1;var e=t.stateNode;return e=e&&e.__reactInternalMemoizedMergedChildContext||vn,l=u.current,a(u,e,t),a(c,c.current,t),!0},invalidateContextProvider:function(t,e){var n=t.stateNode;if(n||r("169"),e){var o=i(t,l);n.__reactInternalMemoizedMergedChildContext=o,s(c,t),s(u,t),a(u,o,t)}else s(c,t);a(c,e,t)},findCurrentUnmaskedContext:function(t){for(2!==Pt(t)||2!==t.tag?r("170"):void 0;3!==t.tag;){if(n(t))return t.stateNode.__reactInternalMemoizedMergedChildContext;(t=t.return)||r("171")}return t.stateNode.context}}}function Me(t){var e=t.createCursor,n=t.push,r=t.pop,i=e(null),o=e(null),a=e(0);return{pushProvider:function(t){var e=t.type._context;n(a,e._changedBits,t),n(o,e._currentValue,t),n(i,t,t),e._currentValue=t.pendingProps.value,e._changedBits=t.stateNode},popProvider:function(t){var e=a.current,n=o.current;r(i,t),r(o,t),r(a,t),t=t.type._context,t._currentValue=n,t._changedBits=e}}}function Ae(){var t=[],e=-1;return{createCursor:function(t){return{current:t}},isEmpty:function(){return-1===e},pop:function(n){0>e||(n.current=t[e],t[e]=null,e--)},push:function(n,r){e++,t[e]=n.current,n.current=r},checkThatStackIsEmpty:function(){},resetStackAfterFatalErrorInDev:function(){}}}function Ie(t){function e(){if(null!==$)for(var t=$.return;null!==t;)N(t),t=t.return;tt=null,et=0,$=null,it=!1}function n(t){return null!==at&&at.has(t)}function i(t){for(;;){var e=t.alternate,n=t.return,r=t.sibling;if(0===(512&t.effectTag)){e=I(e,t,et);var i=t;if(1073741823===et||1073741823!==i.expirationTime){t:switch(i.tag){case 3:case 2:var o=i.updateQueue;o=null===o?0:o.expirationTime;break t;default:o=0}for(var a=i.child;null!==a;)0!==a.expirationTime&&(0===o||o>a.expirationTime)&&(o=a.expirationTime),a=a.sibling;i.expirationTime=o}if(null!==e)return e;if(null!==n&&0===(512&n.effectTag)&&(null===n.firstEffect&&(n.firstEffect=t.firstEffect),null!==t.lastEffect&&(null!==n.lastEffect&&(n.lastEffect.nextEffect=t.firstEffect),n.lastEffect=t.lastEffect),1<t.effectTag&&(null!==n.lastEffect?n.lastEffect.nextEffect=t:n.firstEffect=t,n.lastEffect=t)),null!==r)return r;if(null===n){it=!0;break}t=n}else{if(null!==(t=P(t)))return t.effectTag&=2559,t;if(null!==n&&(n.firstEffect=n.lastEffect=null,n.effectTag|=512),null!==r)return r;if(null===n)break;t=n}}return null}function o(t){var e=A(t.alternate,t,et);return null===e&&(e=i(t)),ar.current=null,e}function a(t,n,a){Z&&r("243"),Z=!0,n===et&&t===tt&&null!==$||(e(),tt=t,et=n,$=$t(tt.current,null,et),t.pendingCommitExpirationTime=0);for(var s=!1;;){try{if(a)for(;null!==$&&!E();)$=o($);else for(;null!==$;)$=o($)}catch(t){if(null===$){s=!0,x(t);break}a=$;var u=a.return;if(null===u){s=!0,x(t);break}R(u,a,t),$=i(a)}break}return Z=!1,s||null!==$?null:it?(t.pendingCommitExpirationTime=n,t.current.alternate):void r("262")}function s(t,e,n,r){t={value:n,source:t,stack:ot(t)},he(e,{expirationTime:r,partialState:null,callback:null,isReplace:!1,isForced:!1,capturedValue:t,next:null}),l(e,r)}function u(t,e){t:{Z&&!rt&&r("263");for(var i=t.return;null!==i;){switch(i.tag){case 2:var o=i.stateNode;if("function"===typeof i.type.getDerivedStateFromCatch||"function"===typeof o.componentDidCatch&&!n(o)){s(t,i,e,1),t=void 0;break t}break;case 3:s(t,i,e,1),t=void 0;break t}i=i.return}3===t.tag&&s(t,t,e,1),t=void 0}return t}function c(t){return t=0!==J?J:Z?rt?1:et:1&t.mode?wt?10*(1+((h()+15)/10|0)):25*(1+((h()+500)/25|0)):1,wt&&(0===pt||t>pt)&&(pt=t),t}function l(t,n){t:{for(;null!==t;){if((0===t.expirationTime||t.expirationTime>n)&&(t.expirationTime=n),null!==t.alternate&&(0===t.alternate.expirationTime||t.alternate.expirationTime>n)&&(t.alternate.expirationTime=n),null===t.return){if(3!==t.tag){n=void 0;break t}var i=t.stateNode;!Z&&0!==et&&n<et&&e(),Z&&!rt&&tt===i||p(i,n),Tt>xt&&r("185")}t=t.return}n=void 0}return n}function h(){return Q=H()-Y,K=2+(Q/10|0)}function f(t,e,n,r,i){var o=J;J=1;try{return t(e,n,r,i)}finally{J=o}}function d(t){if(0!==ct){if(t>ct)return;z(lt)}var e=H()-Y;ct=t,lt=G(g,{timeout:10*(t-2)-e})}function p(t,e){if(null===t.nextScheduledRoot)t.remainingExpirationTime=e,null===ut?(st=ut=t,t.nextScheduledRoot=t):(ut=ut.nextScheduledRoot=t,ut.nextScheduledRoot=st);else{var n=t.remainingExpirationTime;(0===n||e<n)&&(t.remainingExpirationTime=e)}ht||(_t?bt&&(ft=t,dt=1,b(t,1,!1)):1===e?v():d(e))}function m(){var t=0,e=null;if(null!==ut)for(var n=ut,i=st;null!==i;){var o=i.remainingExpirationTime;if(0===o){if((null===n||null===ut)&&r("244"),i===i.nextScheduledRoot){st=ut=i.nextScheduledRoot=null;break}if(i===st)st=o=i.nextScheduledRoot,ut.nextScheduledRoot=o,i.nextScheduledRoot=null;else{if(i===ut){ut=n,ut.nextScheduledRoot=st,i.nextScheduledRoot=null;break}n.nextScheduledRoot=i.nextScheduledRoot,i.nextScheduledRoot=null}i=n.nextScheduledRoot}else{if((0===t||o<t)&&(t=o,e=i),i===ut)break;n=i,i=i.nextScheduledRoot}}n=ft,null!==n&&n===e&&1===t?Tt++:Tt=0,ft=e,dt=t}function g(t){y(0,!0,t)}function v(){y(1,!1,null)}function y(t,e,n){if(yt=n,m(),e)for(;null!==ft&&0!==dt&&(0===t||t>=dt)&&(!mt||h()>=dt);)b(ft,dt,!mt),m();else for(;null!==ft&&0!==dt&&(0===t||t>=dt);)b(ft,dt,!1),m();null!==yt&&(ct=0,lt=-1),0!==dt&&d(dt),yt=null,mt=!1,_()}function _(){if(Tt=0,null!==Et){var t=Et;Et=null;for(var e=0;e<t.length;e++){var n=t[e];try{n._onComplete()}catch(t){gt||(gt=!0,vt=t)}}}if(gt)throw t=vt,vt=null,gt=!1,t}function b(t,e,n){ht&&r("245"),ht=!0,n?(n=t.finishedWork,null!==n?w(t,n,e):(t.finishedWork=null,null!==(n=a(t,e,!0))&&(E()?t.finishedWork=n:w(t,n,e)))):(n=t.finishedWork,null!==n?w(t,n,e):(t.finishedWork=null,null!==(n=a(t,e,!1))&&w(t,n,e))),ht=!1}function w(t,e,n){var i=t.firstBatch;if(null!==i&&i._expirationTime<=n&&(null===Et?Et=[i]:Et.push(i),i._defer))return t.finishedWork=e,void(t.remainingExpirationTime=0);t.finishedWork=null,rt=Z=!0,n=e.stateNode,n.current===e&&r("177"),i=n.pendingCommitExpirationTime,0===i&&r("261"),n.pendingCommitExpirationTime=0;var o=h();if(ar.current=null,1<e.effectTag)if(null!==e.lastEffect){e.lastEffect.nextEffect=e;var a=e.firstEffect}else a=e;else a=e.firstEffect;for(W(n.containerInfo),nt=a;null!==nt;){var s=!1,c=void 0;try{for(;null!==nt;)2048&nt.effectTag&&D(nt.alternate,nt),nt=nt.nextEffect}catch(t){s=!0,c=t}s&&(null===nt&&r("178"),u(nt,c),null!==nt&&(nt=nt.nextEffect))}for(nt=a;null!==nt;){s=!1,c=void 0;try{for(;null!==nt;){var l=nt.effectTag;if(16&l&&O(nt),128&l){var f=nt.alternate;null!==f&&j(f)}switch(14&l){case 2:k(nt),nt.effectTag&=-3;break;case 6:k(nt),nt.effectTag&=-3,U(nt.alternate,nt);break;case 4:U(nt.alternate,nt);break;case 8:L(nt)}nt=nt.nextEffect}}catch(t){s=!0,c=t}s&&(null===nt&&r("178"),u(nt,c),null!==nt&&(nt=nt.nextEffect))}for(q(n.containerInfo),n.current=e,nt=a;null!==nt;){l=!1,f=void 0;try{for(a=n,s=o,c=i;null!==nt;){var d=nt.effectTag;36&d&&F(a,nt.alternate,nt,s,c),256&d&&B(nt,x),128&d&&V(nt);var p=nt.nextEffect;nt.nextEffect=null,nt=p}}catch(t){l=!0,f=t}l&&(null===nt&&r("178"),u(nt,f),null!==nt&&(nt=nt.nextEffect))}Z=rt=!1,"function"===typeof ae&&ae(e.stateNode),e=n.current.expirationTime,0===e&&(at=null),t.remainingExpirationTime=e}function E(){return!(null===yt||yt.timeRemaining()>St)&&(mt=!0)}function x(t){null===ft&&r("246"),ft.remainingExpirationTime=0,gt||(gt=!0,vt=t)}var T=Ae(),S=Te(t,T),C=Ce(T);T=Me(T);var M=Se(t),A=_e(t,S,C,T,M,l,c).beginWork,I=be(t,S,C,T,M).completeWork;S=we(S,C,T,l,n);var R=S.throwException,P=S.unwindWork,N=S.unwindInterruptedWork;S=xe(t,u,l,c,function(t){null===at?at=new Set([t]):at.add(t)},h);var D=S.commitBeforeMutationLifeCycles,O=S.commitResetTextContent,k=S.commitPlacement,L=S.commitDeletion,U=S.commitWork,F=S.commitLifeCycles,B=S.commitErrorLogging,V=S.commitAttachRef,j=S.commitDetachRef,H=t.now,G=t.scheduleDeferredCallback,z=t.cancelDeferredCallback,W=t.prepareForCommit,q=t.resetAfterCommit,Y=H(),K=2,Q=Y,X=0,J=0,Z=!1,$=null,tt=null,et=0,nt=null,rt=!1,it=!1,at=null,st=null,ut=null,ct=0,lt=-1,ht=!1,ft=null,dt=0,pt=0,mt=!1,gt=!1,vt=null,yt=null,_t=!1,bt=!1,wt=!1,Et=null,xt=1e3,Tt=0,St=1;return{recalculateCurrentTime:h,computeExpirationForFiber:c,scheduleWork:l,requestWork:p,flushRoot:function(t,e){ht&&r("253"),ft=t,dt=e,b(t,e,!1),v(),_()},batchedUpdates:function(t,e){var n=_t;_t=!0;try{return t(e)}finally{(_t=n)||ht||v()}},unbatchedUpdates:function(t,e){if(_t&&!bt){bt=!0;try{return t(e)}finally{bt=!1}}return t(e)},flushSync:function(t,e){ht&&r("187");var n=_t;_t=!0;try{return f(t,e)}finally{_t=n,v()}},flushControlled:function(t){var e=_t;_t=!0;try{f(t)}finally{(_t=e)||ht||y(1,!1,null)}},deferredUpdates:function(t){var e=J;J=25*(1+((h()+500)/25|0));try{return t()}finally{J=e}},syncUpdates:f,interactiveUpdates:function(t,e,n){if(wt)return t(e,n);_t||ht||0===pt||(y(pt,!1,null),pt=0);var r=wt,i=_t;_t=wt=!0;try{return t(e,n)}finally{wt=r,(_t=i)||ht||v()}},flushInteractiveUpdates:function(){ht||0===pt||(y(pt,!1,null),pt=0)},computeUniqueAsyncExpiration:function(){var t=25*(1+((h()+500)/25|0));return t<=X&&(t=X+1),X=t},legacyContext:C}}function Re(t){function e(t,e,n,r,i,o){if(r=e.current,n){n=n._reactInternalFiber;var s=u(n);n=c(n)?l(n,s):s}else n=vn;return null===e.context?e.context=n:e.pendingContext=n,e=o,he(r,{expirationTime:i,partialState:{element:t},callback:void 0===e?null:e,isReplace:!1,isForced:!1,capturedValue:null,next:null}),a(r,i),i}var n=t.getPublicInstance;t=Ie(t);var i=t.recalculateCurrentTime,o=t.computeExpirationForFiber,a=t.scheduleWork,s=t.legacyContext,u=s.findCurrentUnmaskedContext,c=s.isContextProvider,l=s.processChildContext;return{createContainer:function(t,e,n){return e=new Zt(3,null,null,e?3:0),t={current:e,containerInfo:t,pendingChildren:null,pendingCommitExpirationTime:0,finishedWork:null,context:null,pendingContext:null,hydrate:n,remainingExpirationTime:0,firstBatch:null,nextScheduledRoot:null},e.stateNode=t},updateContainer:function(t,n,r,a){var s=n.current,u=i();return s=o(s),e(t,n,r,u,s,a)},updateContainerAtExpirationTime:function(t,n,r,o,a){return e(t,n,r,i(),o,a)},flushRoot:t.flushRoot,requestWork:t.requestWork,computeUniqueAsyncExpiration:t.computeUniqueAsyncExpiration,batchedUpdates:t.batchedUpdates,unbatchedUpdates:t.unbatchedUpdates,deferredUpdates:t.deferredUpdates,syncUpdates:t.syncUpdates,interactiveUpdates:t.interactiveUpdates,flushInteractiveUpdates:t.flushInteractiveUpdates,flushControlled:t.flushControlled,flushSync:t.flushSync,getPublicRootInstance:function(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return n(t.child.stateNode);default:return t.child.stateNode}},findHostInstance:function(t){var e=t._reactInternalFiber;return void 0===e&&("function"===typeof t.render?r("188"):r("268",Object.keys(t))),t=kt(e),null===t?null:t.stateNode},findHostInstanceWithNoPortals:function(t){return t=Lt(t),null===t?null:t.stateNode},injectIntoDevTools:function(t){var e=t.findFiberByHostInstance;return oe(fn({},t,{findHostInstanceByFiber:function(t){return t=kt(t),null===t?null:t.stateNode},findFiberByHostInstance:function(t){return e?e(t):null}}))}}}function Pe(t,e,n){var r=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:hr,key:null==r?null:""+r,children:t,containerInfo:e,implementation:n}}function Ne(t){var e="";return ln.Children.forEach(t,function(t){null==t||"string"!==typeof t&&"number"!==typeof t||(e+=t)}),e}function De(t,e){return t=fn({children:void 0},e),(e=Ne(e.children))&&(t.children=e),t}function Oe(t,e,n,r){if(t=t.options,e){e={};for(var i=0;i<n.length;i++)e["$"+n[i]]=!0;for(n=0;n<t.length;n++)i=e.hasOwnProperty("$"+t[n].value),t[n].selected!==i&&(t[n].selected=i),i&&r&&(t[n].defaultSelected=!0)}else{for(n=""+n,e=null,i=0;i<t.length;i++){if(t[i].value===n)return t[i].selected=!0,void(r&&(t[i].defaultSelected=!0));null!==e||t[i].disabled||(e=t[i])}null!==e&&(e.selected=!0)}}function ke(t,e){var n=e.value;t._wrapperState={initialValue:null!=n?n:e.defaultValue,wasMultiple:!!e.multiple}}function Le(t,e){return null!=e.dangerouslySetInnerHTML&&r("91"),fn({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function Ue(t,e){var n=e.value;null==n&&(n=e.defaultValue,e=e.children,null!=e&&(null!=n&&r("92"),Array.isArray(e)&&(1>=e.length||r("93"),e=e[0]),n=""+e),null==n&&(n="")),t._wrapperState={initialValue:""+n}}function Fe(t,e){var n=e.value;null!=n&&(n=""+n,n!==t.value&&(t.value=n),null==e.defaultValue&&(t.defaultValue=n)),null!=e.defaultValue&&(t.defaultValue=e.defaultValue)}function Be(t){var e=t.textContent;e===t._wrapperState.initialValue&&(t.value=e)}function Ve(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function je(t,e){return null==t||"http://www.w3.org/1999/xhtml"===t?Ve(e):"http://www.w3.org/2000/svg"===t&&"foreignObject"===e?"http://www.w3.org/1999/xhtml":t}function He(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&3===n.nodeType)return void(n.nodeValue=e)}t.textContent=e}function Ge(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=0===n.indexOf("--"),i=n,o=e[n];i=null==o||"boolean"===typeof o||""===o?"":r||"number"!==typeof o||0===o||Vi.hasOwnProperty(i)&&Vi[i]?(""+o).trim():o+"px","float"===n&&(n="cssFloat"),r?t.setProperty(n,i):t[n]=i}}function ze(t,e,n){e&&(Hi[t]&&(null!=e.children||null!=e.dangerouslySetInnerHTML)&&r("137",t,n()),null!=e.dangerouslySetInnerHTML&&(null!=e.children&&r("60"),"object"===typeof e.dangerouslySetInnerHTML&&"__html"in e.dangerouslySetInnerHTML||r("61")),null!=e.style&&"object"!==typeof e.style&&r("62",n()))}function We(t,e){if(-1===t.indexOf("-"))return"string"===typeof e.is;switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function qe(t,e){t=9===t.nodeType||11===t.nodeType?t:t.ownerDocument;var n=Yt(t);e=Tn[e];for(var r=0;r<e.length;r++){var i=e[r];n.hasOwnProperty(i)&&n[i]||("topScroll"===i?Ht("topScroll","scroll",t):"topFocus"===i||"topBlur"===i?(Ht("topFocus","focus",t),Ht("topBlur","blur",t),n.topBlur=!0,n.topFocus=!0):"topCancel"===i?(Z("cancel",!0)&&Ht("topCancel","cancel",t),n.topCancel=!0):"topClose"===i?(Z("close",!0)&&Ht("topClose","close",t),n.topClose=!0):ti.hasOwnProperty(i)&&jt(i,ti[i],t),n[i]=!0)}}function Ye(t,e,n,r){return n=9===n.nodeType?n:n.ownerDocument,r===Ui.html&&(r=Ve(t)),r===Ui.html?"script"===t?(t=n.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):t="string"===typeof e.is?n.createElement(t,{is:e.is}):n.createElement(t):t=n.createElementNS(r,t),t}function Ke(t,e){return(9===e.nodeType?e:e.ownerDocument).createTextNode(t)}function Qe(t,e,n,r){var i=We(e,n);switch(e){case"iframe":case"object":jt("topLoad","load",t);var o=n;break;case"video":case"audio":for(o in ei)ei.hasOwnProperty(o)&&jt(o,ei[o],t);o=n;break;case"source":jt("topError","error",t),o=n;break;case"img":case"image":case"link":jt("topError","error",t),jt("topLoad","load",t),o=n;break;case"form":jt("topReset","reset",t),jt("topSubmit","submit",t),o=n;break;case"details":jt("topToggle","toggle",t),o=n;break;case"input":dt(t,n),o=ft(t,n),jt("topInvalid","invalid",t),qe(r,"onChange");break;case"option":o=De(t,n);break;case"select":ke(t,n),o=fn({},n,{value:void 0}),jt("topInvalid","invalid",t),qe(r,"onChange");break;case"textarea":Ue(t,n),o=Le(t,n),jt("topInvalid","invalid",t),qe(r,"onChange");break;default:o=n}ze(e,o,Gi);var a,s=o;for(a in s)if(s.hasOwnProperty(a)){var u=s[a];"style"===a?Ge(t,u,Gi):"dangerouslySetInnerHTML"===a?null!=(u=u?u.__html:void 0)&&Bi(t,u):"children"===a?"string"===typeof u?("textarea"!==e||""!==u)&&He(t,u):"number"===typeof u&&He(t,""+u):"suppressContentEditableWarning"!==a&&"suppressHydrationWarning"!==a&&"autoFocus"!==a&&(xn.hasOwnProperty(a)?null!=u&&qe(r,a):null!=u&&ht(t,a,u,i))}switch(e){case"input":et(t),gt(t,n);break;case"textarea":et(t),Be(t,n);break;case"option":null!=n.value&&t.setAttribute("value",n.value);break;case"select":t.multiple=!!n.multiple,e=n.value,null!=e?Oe(t,!!n.multiple,e,!1):null!=n.defaultValue&&Oe(t,!!n.multiple,n.defaultValue,!0);break;default:"function"===typeof o.onClick&&(t.onclick=dn)}}function Xe(t,e,n,r,i){var o=null;switch(e){case"input":n=ft(t,n),r=ft(t,r),o=[];break;case"option":n=De(t,n),r=De(t,r),o=[];break;case"select":n=fn({},n,{value:void 0}),r=fn({},r,{value:void 0}),o=[];break;case"textarea":n=Le(t,n),r=Le(t,r),o=[];break;default:"function"!==typeof n.onClick&&"function"===typeof r.onClick&&(t.onclick=dn)}ze(e,r,Gi),e=t=void 0;var a=null;for(t in n)if(!r.hasOwnProperty(t)&&n.hasOwnProperty(t)&&null!=n[t])if("style"===t){var s=n[t];for(e in s)s.hasOwnProperty(e)&&(a||(a={}),a[e]="")}else"dangerouslySetInnerHTML"!==t&&"children"!==t&&"suppressContentEditableWarning"!==t&&"suppressHydrationWarning"!==t&&"autoFocus"!==t&&(xn.hasOwnProperty(t)?o||(o=[]):(o=o||[]).push(t,null));for(t in r){var u=r[t];if(s=null!=n?n[t]:void 0,r.hasOwnProperty(t)&&u!==s&&(null!=u||null!=s))if("style"===t)if(s){for(e in s)!s.hasOwnProperty(e)||u&&u.hasOwnProperty(e)||(a||(a={}),a[e]="");for(e in u)u.hasOwnProperty(e)&&s[e]!==u[e]&&(a||(a={}),a[e]=u[e])}else a||(o||(o=[]),o.push(t,a)),a=u;else"dangerouslySetInnerHTML"===t?(u=u?u.__html:void 0,s=s?s.__html:void 0,null!=u&&s!==u&&(o=o||[]).push(t,""+u)):"children"===t?s===u||"string"!==typeof u&&"number"!==typeof u||(o=o||[]).push(t,""+u):"suppressContentEditableWarning"!==t&&"suppressHydrationWarning"!==t&&(xn.hasOwnProperty(t)?(null!=u&&qe(i,t),o||s===u||(o=[])):(o=o||[]).push(t,u))}return a&&(o=o||[]).push("style",a),o}function Je(t,e,n,r,i){"input"===n&&"radio"===i.type&&null!=i.name&&pt(t,i),We(n,r),r=We(n,i);for(var o=0;o<e.length;o+=2){var a=e[o],s=e[o+1];"style"===a?Ge(t,s,Gi):"dangerouslySetInnerHTML"===a?Bi(t,s):"children"===a?He(t,s):ht(t,a,s,r)}switch(n){case"input":mt(t,i);break;case"textarea":Fe(t,i);break;case"select":t._wrapperState.initialValue=void 0,e=t._wrapperState.wasMultiple,t._wrapperState.wasMultiple=!!i.multiple,n=i.value,null!=n?Oe(t,!!i.multiple,n,!1):e!==!!i.multiple&&(null!=i.defaultValue?Oe(t,!!i.multiple,i.defaultValue,!0):Oe(t,!!i.multiple,i.multiple?[]:"",!1))}}function Ze(t,e,n,r,i){switch(e){case"iframe":case"object":jt("topLoad","load",t);break;case"video":case"audio":for(var o in ei)ei.hasOwnProperty(o)&&jt(o,ei[o],t);break;case"source":jt("topError","error",t);break;case"img":case"image":case"link":jt("topError","error",t),jt("topLoad","load",t);break;case"form":jt("topReset","reset",t),jt("topSubmit","submit",t);break;case"details":jt("topToggle","toggle",t);break;case"input":dt(t,n),jt("topInvalid","invalid",t),qe(i,"onChange");break;case"select":ke(t,n),jt("topInvalid","invalid",t),qe(i,"onChange");break;case"textarea":Ue(t,n),jt("topInvalid","invalid",t),qe(i,"onChange")}ze(e,n,Gi),r=null;for(var a in n)n.hasOwnProperty(a)&&(o=n[a],"children"===a?"string"===typeof o?t.textContent!==o&&(r=["children",o]):"number"===typeof o&&t.textContent!==""+o&&(r=["children",""+o]):xn.hasOwnProperty(a)&&null!=o&&qe(i,a));switch(e){case"input":et(t),gt(t,n);break;case"textarea":et(t),Be(t,n);break;case"select":case"option":break;default:"function"===typeof n.onClick&&(t.onclick=dn)}return r}function $e(t,e){return t.nodeValue!==e}function tn(t){this._expirationTime=Yi.computeUniqueAsyncExpiration(),this._root=t,this._callbacks=this._next=null,this._hasChildren=this._didComplete=!1,this._children=null,this._defer=!0}function en(){this._callbacks=null,this._didCommit=!1,this._onCommit=this._onCommit.bind(this)}function nn(t,e,n){this._internalRoot=Yi.createContainer(t,e,n)}function rn(t){return!(!t||1!==t.nodeType&&9!==t.nodeType&&11!==t.nodeType&&(8!==t.nodeType||" react-mount-point-unstable "!==t.nodeValue))}function on(t,e){switch(t){case"button":case"input":case"select":case"textarea":return!!e.autoFocus}return!1}function an(t,e){if(e||(e=t?9===t.nodeType?t.documentElement:t.firstChild:null,e=!(!e||1!==e.nodeType||!e.hasAttribute("data-reactroot"))),!e)for(var n;n=t.lastChild;)t.removeChild(n);return new nn(t,!1,e)}function sn(t,e,n,i,o){rn(n)||r("200");var a=n._reactRootContainer;if(a){if("function"===typeof o){var s=o;o=function(){var t=Yi.getPublicRootInstance(a._internalRoot);s.call(t)}}null!=t?a.legacy_renderSubtreeIntoContainer(t,e,o):a.render(e,o)}else{if(a=n._reactRootContainer=an(n,i),"function"===typeof o){var u=o;o=function(){var t=Yi.getPublicRootInstance(a._internalRoot);u.call(t)}}Yi.unbatchedUpdates(function(){null!=t?a.legacy_renderSubtreeIntoContainer(t,e,o):a.render(e,o)})}return Yi.getPublicRootInstance(a._internalRoot)}function un(t,e){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;return rn(e)||r("200"),Pe(t,e,null,n)}var cn=n(11),ln=n(5),hn=n(27),fn=n(4),dn=n(13),pn=n(28),mn=n(29),gn=n(30),vn=n(12);ln||r("227");var yn={_caughtError:null,_hasCaughtError:!1,_rethrowError:null,_hasRethrowError:!1,invokeGuardedCallback:function(t,e,n,r,o,a,s,u,c){i.apply(yn,arguments)},invokeGuardedCallbackAndCatchFirstError:function(t,e,n,r,i,o,a,s,u){if(yn.invokeGuardedCallback.apply(this,arguments),yn.hasCaughtError()){var c=yn.clearCaughtError();yn._hasRethrowError||(yn._hasRethrowError=!0,yn._rethrowError=c)}},rethrowCaughtError:function(){return o.apply(yn,arguments)},hasCaughtError:function(){return yn._hasCaughtError},clearCaughtError:function(){if(yn._hasCaughtError){var t=yn._caughtError;return yn._caughtError=null,yn._hasCaughtError=!1,t}r("198")}},_n=null,bn={},wn=[],En={},xn={},Tn={},Sn=Object.freeze({plugins:wn,eventNameDispatchConfigs:En,registrationNameModules:xn,registrationNameDependencies:Tn,possibleRegistrationNames:null,injectEventPluginOrder:u,injectEventPluginsByName:c}),Cn=null,Mn=null,An=null,In=null,Rn={injectEventPluginOrder:u,injectEventPluginsByName:c},Pn=Object.freeze({injection:Rn,getListener:g,runEventsInBatch:v,runExtractedEventsInBatch:y}),Nn=Math.random().toString(36).slice(2),Dn="__reactInternalInstance$"+Nn,On="__reactEventHandlers$"+Nn,kn=Object.freeze({precacheFiberNode:function(t,e){e[Dn]=t},getClosestInstanceFromNode:_,getInstanceFromNode:function(t){return t=t[Dn],!t||5!==t.tag&&6!==t.tag?null:t},getNodeFromInstance:b,getFiberCurrentPropsFromNode:w,updateFiberProps:function(t,e){t[On]=e}}),Ln=Object.freeze({accumulateTwoPhaseDispatches:I,accumulateTwoPhaseDispatchesSkipTarget:function(t){f(t,C)},accumulateEnterLeaveDispatches:R,accumulateDirectDispatches:function(t){f(t,A)}}),Un=null,Fn={_root:null,_startText:null,_fallbackText:null},Bn="dispatchConfig _targetInst nativeEvent isDefaultPrevented isPropagationStopped _dispatchListeners _dispatchInstances".split(" "),Vn={type:null,target:null,currentTarget:dn.thatReturnsNull,eventPhase:null,bubbles:null,cancelable:null,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:null,isTrusted:null};fn(O.prototype,{preventDefault:function(){this.defaultPrevented=!0;var t=this.nativeEvent;t&&(t.preventDefault?t.preventDefault():"unknown"!==typeof t.returnValue&&(t.returnValue=!1),this.isDefaultPrevented=dn.thatReturnsTrue)},stopPropagation:function(){var t=this.nativeEvent;t&&(t.stopPropagation?t.stopPropagation():"unknown"!==typeof t.cancelBubble&&(t.cancelBubble=!0),this.isPropagationStopped=dn.thatReturnsTrue)},persist:function(){this.isPersistent=dn.thatReturnsTrue},isPersistent:dn.thatReturnsFalse,destructor:function(){var t,e=this.constructor.Interface;for(t in e)this[t]=null;for(e=0;e<Bn.length;e++)this[Bn[e]]=null}}),O.Interface=Vn,O.extend=function(t){function e(){}function n(){return r.apply(this,arguments)}var r=this;e.prototype=r.prototype;var i=new e;return fn(i,n.prototype),n.prototype=i,n.prototype.constructor=n,n.Interface=fn({},r.Interface,t),n.extend=r.extend,U(n),n},U(O);var jn=O.extend({data:null}),Hn=O.extend({data:null}),Gn=[9,13,27,32],zn=hn.canUseDOM&&"CompositionEvent"in window,Wn=null;hn.canUseDOM&&"documentMode"in document&&(Wn=document.documentMode);var qn=hn.canUseDOM&&"TextEvent"in window&&!Wn,Yn=hn.canUseDOM&&(!zn||Wn&&8<Wn&&11>=Wn),Kn=String.fromCharCode(32),Qn={beforeInput:{phasedRegistrationNames:{bubbled:"onBeforeInput",captured:"onBeforeInputCapture"},dependencies:["topCompositionEnd","topKeyPress","topTextInput","topPaste"]},compositionEnd:{phasedRegistrationNames:{bubbled:"onCompositionEnd",captured:"onCompositionEndCapture"},dependencies:"topBlur topCompositionEnd topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")},compositionStart:{phasedRegistrationNames:{bubbled:"onCompositionStart",captured:"onCompositionStartCapture"},dependencies:"topBlur topCompositionStart topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")},compositionUpdate:{phasedRegistrationNames:{bubbled:"onCompositionUpdate",captured:"onCompositionUpdateCapture"},dependencies:"topBlur topCompositionUpdate topKeyDown topKeyPress topKeyUp topMouseDown".split(" ")}},Xn=!1,Jn=!1,Zn={eventTypes:Qn,extractEvents:function(t,e,n,r){var i=void 0,o=void 0;if(zn)t:{switch(t){case"topCompositionStart":i=Qn.compositionStart;break t;case"topCompositionEnd":i=Qn.compositionEnd;break t;case"topCompositionUpdate":i=Qn.compositionUpdate;break t}i=void 0}else Jn?F(t,n)&&(i=Qn.compositionEnd):"topKeyDown"===t&&229===n.keyCode&&(i=Qn.compositionStart);return i?(Yn&&(Jn||i!==Qn.compositionStart?i===Qn.compositionEnd&&Jn&&(o=N()):(Fn._root=r,Fn._startText=D(),Jn=!0)),i=jn.getPooled(i,e,n,r),o?i.data=o:null!==(o=B(n))&&(i.data=o),I(i),o=i):o=null,(t=qn?V(t,n):j(t,n))?(e=Hn.getPooled(Qn.beforeInput,e,n,r),e.data=t,I(e)):e=null,null===o?e:null===e?o:[o,e]}},$n=null,tr={injectFiberControlledHostComponent:function(t){$n=t}},er=null,nr=null,rr=Object.freeze({injection:tr,enqueueStateRestore:G,needsStateRestore:z,restoreStateIfNeeded:W}),ir=!1,or={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},ar=ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,sr="function"===typeof Symbol&&Symbol.for,ur=sr?Symbol.for("react.element"):60103,cr=sr?Symbol.for("react.call"):60104,lr=sr?Symbol.for("react.return"):60105,hr=sr?Symbol.for("react.portal"):60106,fr=sr?Symbol.for("react.fragment"):60107,dr=sr?Symbol.for("react.strict_mode"):60108,pr=sr?Symbol.for("react.provider"):60109,mr=sr?Symbol.for("react.context"):60110,gr=sr?Symbol.for("react.async_mode"):60111,vr=sr?Symbol.for("react.forward_ref"):60112,yr="function"===typeof Symbol&&Symbol.iterator,_r=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,br={},wr={},Er={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){Er[t]=new ct(t,0,!1,t,null)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];Er[e]=new ct(e,1,!1,t[1],null)}),["contentEditable","draggable","spellCheck","value"].forEach(function(t){Er[t]=new ct(t,2,!1,t.toLowerCase(),null)}),["autoReverse","externalResourcesRequired","preserveAlpha"].forEach(function(t){Er[t]=new ct(t,2,!1,t,null)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){Er[t]=new ct(t,3,!1,t.toLowerCase(),null)}),["checked","multiple","muted","selected"].forEach(function(t){Er[t]=new ct(t,3,!0,t.toLowerCase(),null)}),["capture","download"].forEach(function(t){Er[t]=new ct(t,4,!1,t.toLowerCase(),null)}),["cols","rows","size","span"].forEach(function(t){Er[t]=new ct(t,6,!1,t.toLowerCase(),null)}),["rowSpan","start"].forEach(function(t){Er[t]=new ct(t,5,!1,t.toLowerCase(),null)});var xr=/[\-:]([a-z])/g;"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(xr,lt);Er[e]=new ct(e,1,!1,t,null)}),"xlink:actuate xlink:arcrole xlink:href xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(xr,lt);Er[e]=new ct(e,1,!1,t,"http://www.w3.org/1999/xlink")}),["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(xr,lt);Er[e]=new ct(e,1,!1,t,"http://www.w3.org/XML/1998/namespace")}),Er.tabIndex=new ct("tabIndex",1,!1,"tabindex",null);var Tr={change:{phasedRegistrationNames:{bubbled:"onChange",captured:"onChangeCapture"},dependencies:"topBlur topChange topClick topFocus topInput topKeyDown topKeyUp topSelectionChange".split(" ")}},Sr=null,Cr=null,Mr=!1;hn.canUseDOM&&(Mr=Z("input")&&(!document.documentMode||9<document.documentMode));var Ar={eventTypes:Tr,_isInputEventSupported:Mr,extractEvents:function(t,e,n,r){var i=e?b(e):window,o=void 0,a=void 0,s=i.nodeName&&i.nodeName.toLowerCase();if("select"===s||"input"===s&&"file"===i.type?o=Et:X(i)?Mr?o=At:(o=Ct,a=St):(s=i.nodeName)&&"input"===s.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(o=Mt),o&&(o=o(t,e)))return _t(o,n,r);a&&a(t,i,e),"topBlur"===t&&null!=e&&(t=e._wrapperState||i._wrapperState)&&t.controlled&&"number"===i.type&&vt(i,"number",i.value)}},Ir=O.extend({view:null,detail:null}),Rr={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},Pr=Ir.extend({screenX:null,screenY:null,clientX:null,clientY:null,pageX:null,pageY:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,getModifierState:Rt,button:null,buttons:null,relatedTarget:function(t){return t.relatedTarget||(t.fromElement===t.srcElement?t.toElement:t.fromElement)}}),Nr={mouseEnter:{registrationName:"onMouseEnter",dependencies:["topMouseOut","topMouseOver"]},mouseLeave:{registrationName:"onMouseLeave",dependencies:["topMouseOut","topMouseOver"]}},Dr={eventTypes:Nr,extractEvents:function(t,e,n,r){if("topMouseOver"===t&&(n.relatedTarget||n.fromElement)||"topMouseOut"!==t&&"topMouseOver"!==t)return null;var i=r.window===r?r:(i=r.ownerDocument)?i.defaultView||i.parentWindow:window;if("topMouseOut"===t?(t=e,e=(e=n.relatedTarget||n.toElement)?_(e):null):t=null,t===e)return null;var o=null==t?i:b(t);i=null==e?i:b(e);var a=Pr.getPooled(Nr.mouseLeave,t,n,r);return a.type="mouseleave",a.target=o,a.relatedTarget=i,n=Pr.getPooled(Nr.mouseEnter,e,n,r),n.type="mouseenter",n.target=i,n.relatedTarget=o,R(a,n,t,e),[a,n]}},Or=O.extend({animationName:null,elapsedTime:null,pseudoElement:null}),kr=O.extend({clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),Lr=Ir.extend({relatedTarget:null}),Ur={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},Fr={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},Br=Ir.extend({key:function(t){if(t.key){var e=Ur[t.key]||t.key;if("Unidentified"!==e)return e}return"keypress"===t.type?(t=Ut(t),13===t?"Enter":String.fromCharCode(t)):"keydown"===t.type||"keyup"===t.type?Fr[t.keyCode]||"Unidentified":""},location:null,ctrlKey:null,shiftKey:null,altKey:null,metaKey:null,repeat:null,locale:null,getModifierState:Rt,charCode:function(t){return"keypress"===t.type?Ut(t):0},keyCode:function(t){return"keydown"===t.type||"keyup"===t.type?t.keyCode:0},which:function(t){return"keypress"===t.type?Ut(t):"keydown"===t.type||"keyup"===t.type?t.keyCode:0}}),Vr=Pr.extend({dataTransfer:null}),jr=Ir.extend({touches:null,targetTouches:null,changedTouches:null,altKey:null,metaKey:null,ctrlKey:null,shiftKey:null,getModifierState:Rt}),Hr=O.extend({propertyName:null,elapsedTime:null,pseudoElement:null}),Gr=Pr.extend({deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:null,deltaMode:null}),zr={},Wr={};"blur cancel click close contextMenu copy cut doubleClick dragEnd dragStart drop focus input invalid keyDown keyPress keyUp mouseDown mouseUp paste pause play rateChange reset seeked submit touchCancel touchEnd touchStart volumeChange".split(" ").forEach(function(t){Ft(t,!0)}),"abort animationEnd animationIteration animationStart canPlay canPlayThrough drag dragEnter dragExit dragLeave dragOver durationChange emptied encrypted ended error load loadedData loadedMetadata loadStart mouseMove mouseOut mouseOver playing progress scroll seeking stalled suspend timeUpdate toggle touchMove transitionEnd waiting wheel".split(" ").forEach(function(t){Ft(t,!1)});var qr={eventTypes:zr,isInteractiveTopLevelEventType:function(t){return void 0!==(t=Wr[t])&&!0===t.isInteractive},extractEvents:function(t,e,n,r){var i=Wr[t];if(!i)return null;switch(t){case"topKeyPress":if(0===Ut(n))return null;case"topKeyDown":case"topKeyUp":t=Br;break;case"topBlur":case"topFocus":t=Lr;break;case"topClick":if(2===n.button)return null;case"topDoubleClick":case"topMouseDown":case"topMouseMove":case"topMouseUp":case"topMouseOut":case"topMouseOver":case"topContextMenu":t=Pr;break;case"topDrag":case"topDragEnd":case"topDragEnter":case"topDragExit":case"topDragLeave":case"topDragOver":case"topDragStart":case"topDrop":t=Vr;break;case"topTouchCancel":case"topTouchEnd":case"topTouchMove":case"topTouchStart":t=jr;break;case"topAnimationEnd":case"topAnimationIteration":case"topAnimationStart":t=Or;break;case"topTransitionEnd":t=Hr;break;case"topScroll":t=Ir;break;case"topWheel":t=Gr;break;case"topCopy":case"topCut":case"topPaste":t=kr;break;default:t=O}return e=t.getPooled(i,e,n,r),I(e),e}},Yr=qr.isInteractiveTopLevelEventType,Kr=[],Qr=!0,Xr=Object.freeze({get _enabled(){return Qr},setEnabled:Vt,isEnabled:function(){return Qr},trapBubbledEvent:jt,trapCapturedEvent:Ht,dispatchEvent:zt}),Jr={animationend:Wt("Animation","AnimationEnd"),animationiteration:Wt("Animation","AnimationIteration"),animationstart:Wt("Animation","AnimationStart"),transitionend:Wt("Transition","TransitionEnd")},Zr={},$r={};hn.canUseDOM&&($r=document.createElement("div").style,"AnimationEvent"in window||(delete Jr.animationend.animation,delete Jr.animationiteration.animation,delete Jr.animationstart.animation),"TransitionEvent"in window||delete Jr.transitionend.transition);var ti={topAnimationEnd:qt("animationend"),topAnimationIteration:qt("animationiteration"),topAnimationStart:qt("animationstart"),topBlur:"blur",topCancel:"cancel",topChange:"change",topClick:"click",topClose:"close",topCompositionEnd:"compositionend",topCompositionStart:"compositionstart",topCompositionUpdate:"compositionupdate",topContextMenu:"contextmenu",topCopy:"copy",topCut:"cut",topDoubleClick:"dblclick",topDrag:"drag",topDragEnd:"dragend",topDragEnter:"dragenter",topDragExit:"dragexit",topDragLeave:"dragleave",topDragOver:"dragover",topDragStart:"dragstart",topDrop:"drop",topFocus:"focus",topInput:"input",topKeyDown:"keydown",topKeyPress:"keypress",topKeyUp:"keyup",topLoad:"load",topLoadStart:"loadstart",topMouseDown:"mousedown",topMouseMove:"mousemove",topMouseOut:"mouseout",topMouseOver:"mouseover",topMouseUp:"mouseup",topPaste:"paste",topScroll:"scroll",topSelectionChange:"selectionchange",topTextInput:"textInput",topToggle:"toggle",topTouchCancel:"touchcancel",topTouchEnd:"touchend",topTouchMove:"touchmove",topTouchStart:"touchstart",topTransitionEnd:qt("transitionend"),topWheel:"wheel"},ei={topAbort:"abort",topCanPlay:"canplay",topCanPlayThrough:"canplaythrough",topDurationChange:"durationchange",topEmptied:"emptied",topEncrypted:"encrypted",topEnded:"ended",topError:"error",topLoadedData:"loadeddata",topLoadedMetadata:"loadedmetadata",topLoadStart:"loadstart",topPause:"pause",topPlay:"play",topPlaying:"playing",topProgress:"progress",topRateChange:"ratechange",topSeeked:"seeked",topSeeking:"seeking",topStalled:"stalled",topSuspend:"suspend",topTimeUpdate:"timeupdate",topVolumeChange:"volumechange",topWaiting:"waiting"},ni={},ri=0,ii="_reactListenersID"+(""+Math.random()).slice(2),oi=hn.canUseDOM&&"documentMode"in document&&11>=document.documentMode,ai={select:{phasedRegistrationNames:{bubbled:"onSelect",captured:"onSelectCapture"},dependencies:"topBlur topContextMenu topFocus topKeyDown topKeyUp topMouseDown topMouseUp topSelectionChange".split(" ")}},si=null,ui=null,ci=null,li=!1,hi={eventTypes:ai,extractEvents:function(t,e,n,r){var i,o=r.window===r?r.document:9===r.nodeType?r:r.ownerDocument;if(!(i=!o)){t:{o=Yt(o),i=Tn.onSelect;for(var a=0;a<i.length;a++){var s=i[a];if(!o.hasOwnProperty(s)||!o[s]){o=!1;break t}}o=!0}i=!o}if(i)return null;switch(o=e?b(e):window,t){case"topFocus":(X(o)||"true"===o.contentEditable)&&(si=o,ui=e,ci=null);break;case"topBlur":ci=ui=si=null;break;case"topMouseDown":li=!0;break;case"topContextMenu":case"topMouseUp":return li=!1,Jt(n,r);case"topSelectionChange":if(oi)break;case"topKeyDown":case"topKeyUp":return Jt(n,r)}return null}};Rn.injectEventPluginOrder("ResponderEventPlugin SimpleEventPlugin TapEventPlugin EnterLeaveEventPlugin ChangeEventPlugin SelectEventPlugin BeforeInputEventPlugin".split(" ")),Cn=kn.getFiberCurrentPropsFromNode,Mn=kn.getInstanceFromNode,An=kn.getNodeFromInstance,Rn.injectEventPluginsByName({SimpleEventPlugin:qr,EnterLeaveEventPlugin:Dr,ChangeEventPlugin:Ar,SelectEventPlugin:hi,BeforeInputEventPlugin:Zn});var fi=null,di=null;new Set;var pi=void 0,mi=void 0,gi=Array.isArray,vi=ye(!0),yi=ye(!1),_i={},bi=Object.freeze({default:Re}),wi=bi&&Re||bi,Ei=wi.default?wi.default:wi,xi="object"===typeof performance&&"function"===typeof performance.now,Ti=void 0;Ti=xi?function(){return performance.now()}:function(){return Date.now()};var Si=void 0,Ci=void 0;if(hn.canUseDOM)if("function"!==typeof requestIdleCallback||"function"!==typeof cancelIdleCallback){var Mi=null,Ai=!1,Ii=-1,Ri=!1,Pi=0,Ni=33,Di=33,Oi=void 0;Oi=xi?{didTimeout:!1,timeRemaining:function(){var t=Pi-performance.now();return 0<t?t:0}}:{didTimeout:!1,timeRemaining:function(){var t=Pi-Date.now();return 0<t?t:0}};var ki="__reactIdleCallback$"+Math.random().toString(36).slice(2);window.addEventListener("message",function(t){if(t.source===window&&t.data===ki){if(Ai=!1,t=Ti(),0>=Pi-t){if(!(-1!==Ii&&Ii<=t))return void(Ri||(Ri=!0,requestAnimationFrame(Li)));Oi.didTimeout=!0}else Oi.didTimeout=!1;Ii=-1,t=Mi,Mi=null,null!==t&&t(Oi)}},!1);var Li=function(t){Ri=!1;var e=t-Pi+Di;e<Di&&Ni<Di?(8>e&&(e=8),Di=e<Ni?Ni:e):Ni=e,Pi=t+Di,Ai||(Ai=!0,window.postMessage(ki,"*"))};Si=function(t,e){return Mi=t,null!=e&&"number"===typeof e.timeout&&(Ii=Ti()+e.timeout),Ri||(Ri=!0,requestAnimationFrame(Li)),0},Ci=function(){Mi=null,Ai=!1,Ii=-1}}else Si=window.requestIdleCallback,Ci=window.cancelIdleCallback;else Si=function(t){return setTimeout(function(){t({timeRemaining:function(){return 1/0},didTimeout:!1})})},Ci=function(t){clearTimeout(t)};var Ui={html:"http://www.w3.org/1999/xhtml",mathml:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg"},Fi=void 0,Bi=function(t){return"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,n,r,i){MSApp.execUnsafeLocalFunction(function(){return t(e,n)})}:t}(function(t,e){if(t.namespaceURI!==Ui.svg||"innerHTML"in t)t.innerHTML=e;else{for(Fi=Fi||document.createElement("div"),Fi.innerHTML="<svg>"+e+"</svg>",e=Fi.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}}),Vi={animationIterationCount:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},ji=["Webkit","ms","Moz","O"];Object.keys(Vi).forEach(function(t){ji.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Vi[e]=Vi[t]})});var Hi=fn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0}),Gi=dn.thatReturns(""),zi=Object.freeze({createElement:Ye,createTextNode:Ke,setInitialProperties:Qe,diffProperties:Xe,updateProperties:Je,diffHydratedProperties:Ze,diffHydratedText:$e,warnForUnmatchedText:function(){},warnForDeletedHydratableElement:function(){},warnForDeletedHydratableText:function(){},warnForInsertedHydratedElement:function(){},warnForInsertedHydratedText:function(){},restoreControlledState:function(t,e,n){switch(e){case"input":if(mt(t,n),e=n.name,"radio"===n.type&&null!=e){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var o=w(i);o||r("90"),nt(i),mt(i,o)}}}break;case"textarea":Fe(t,n);break;case"select":null!=(e=n.value)&&Oe(t,!!n.multiple,e,!1)}}});tr.injectFiberControlledHostComponent(zi);var Wi=null,qi=null;tn.prototype.render=function(t){this._defer||r("250"),this._hasChildren=!0,this._children=t;var e=this._root._internalRoot,n=this._expirationTime,i=new en;return Yi.updateContainerAtExpirationTime(t,e,null,n,i._onCommit),i},tn.prototype.then=function(t){if(this._didComplete)t();else{var e=this._callbacks;null===e&&(e=this._callbacks=[]),e.push(t)}},tn.prototype.commit=function(){var t=this._root._internalRoot,e=t.firstBatch;if(this._defer&&null!==e||r("251"),this._hasChildren){var n=this._expirationTime;if(e!==this){this._hasChildren&&(n=this._expirationTime=e._expirationTime,this.render(this._children));for(var i=null,o=e;o!==this;)i=o,o=o._next;null===i&&r("251"),i._next=o._next,this._next=e,t.firstBatch=this}this._defer=!1,Yi.flushRoot(t,n),e=this._next,this._next=null,e=t.firstBatch=e,null!==e&&e._hasChildren&&e.render(e._children)}else this._next=null,this._defer=!1},tn.prototype._onComplete=function(){if(!this._didComplete){this._didComplete=!0;var t=this._callbacks;if(null!==t)for(var e=0;e<t.length;e++)(0,t[e])()}},en.prototype.then=function(t){if(this._didCommit)t();else{var e=this._callbacks;null===e&&(e=this._callbacks=[]),e.push(t)}},en.prototype._onCommit=function(){if(!this._didCommit){this._didCommit=!0;var t=this._callbacks;if(null!==t)for(var e=0;e<t.length;e++){var n=t[e];"function"!==typeof n&&r("191",n),n()}}},nn.prototype.render=function(t,e){var n=this._internalRoot,r=new en;return e=void 0===e?null:e,null!==e&&r.then(e),Yi.updateContainer(t,n,null,r._onCommit),r},nn.prototype.unmount=function(t){var e=this._internalRoot,n=new en;return t=void 0===t?null:t,null!==t&&n.then(t),Yi.updateContainer(null,e,null,n._onCommit),n},nn.prototype.legacy_renderSubtreeIntoContainer=function(t,e,n){var r=this._internalRoot,i=new en;return n=void 0===n?null:n,null!==n&&i.then(n),Yi.updateContainer(e,r,t,i._onCommit),i},nn.prototype.createBatch=function(){var t=new tn(this),e=t._expirationTime,n=this._internalRoot,r=n.firstBatch;if(null===r)n.firstBatch=t,t._next=null;else{for(n=null;null!==r&&r._expirationTime<=e;)n=r,r=r._next;t._next=r,null!==n&&(n._next=t)}return t};var Yi=Ei({getRootHostContext:function(t){var e=t.nodeType;switch(e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:je(null,"");break;default:e=8===e?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=je(t,e)}return t},getChildHostContext:function(t,e){return je(t,e)},getPublicInstance:function(t){return t},prepareForCommit:function(){Wi=Qr;var t=pn();if(Xt(t)){if("selectionStart"in t)var e={start:t.selectionStart,end:t.selectionEnd};else t:{var n=window.getSelection&&window.getSelection();if(n&&0!==n.rangeCount){e=n.anchorNode;var r=n.anchorOffset,i=n.focusNode;n=n.focusOffset;try{e.nodeType,i.nodeType}catch(t){e=null;break t}var o=0,a=-1,s=-1,u=0,c=0,l=t,h=null;e:for(;;){for(var f;l!==e||0!==r&&3!==l.nodeType||(a=o+r),l!==i||0!==n&&3!==l.nodeType||(s=o+n),3===l.nodeType&&(o+=l.nodeValue.length),null!==(f=l.firstChild);)h=l,l=f;for(;;){if(l===t)break e;if(h===e&&++u===r&&(a=o),h===i&&++c===n&&(s=o),null!==(f=l.nextSibling))break;l=h,h=l.parentNode}l=f}e=-1===a||-1===s?null:{start:a,end:s}}else e=null}e=e||{start:0,end:0}}else e=null;qi={focusedElem:t,selectionRange:e},Vt(!1)},resetAfterCommit:function(){var t=qi,e=pn(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&gn(document.documentElement,n)){if(Xt(n))if(e=r.start,t=r.end,void 0===t&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(window.getSelection){e=window.getSelection();var i=n[P()].length;t=Math.min(r.start,i),r=void 0===r.end?t:Math.min(r.end,i),!e.extend&&t>r&&(i=r,r=t,t=i),i=Qt(n,t);var o=Qt(n,r);if(i&&o&&(1!==e.rangeCount||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==o.node||e.focusOffset!==o.offset)){var a=document.createRange();a.setStart(i.node,i.offset),e.removeAllRanges(),t>r?(e.addRange(a),e.extend(o.node,o.offset)):(a.setEnd(o.node,o.offset),e.addRange(a))}}for(e=[],t=n;t=t.parentNode;)1===t.nodeType&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}qi=null,Vt(Wi),Wi=null},createInstance:function(t,e,n,r,i){return t=Ye(t,e,n,r),t[Dn]=i,t[On]=e,t},appendInitialChild:function(t,e){t.appendChild(e)},finalizeInitialChildren:function(t,e,n,r){return Qe(t,e,n,r),on(e,n)},prepareUpdate:function(t,e,n,r,i){return Xe(t,e,n,r,i)},shouldSetTextContent:function(t,e){return"textarea"===t||"string"===typeof e.children||"number"===typeof e.children||"object"===typeof e.dangerouslySetInnerHTML&&null!==e.dangerouslySetInnerHTML&&"string"===typeof e.dangerouslySetInnerHTML.__html},shouldDeprioritizeSubtree:function(t,e){return!!e.hidden},createTextInstance:function(t,e,n,r){return t=Ke(t,e),t[Dn]=r,t},now:Ti,mutation:{commitMount:function(t,e,n){on(e,n)&&t.focus()},commitUpdate:function(t,e,n,r,i){t[On]=i,Je(t,e,n,r,i)},resetTextContent:function(t){He(t,"")},commitTextUpdate:function(t,e,n){t.nodeValue=n},appendChild:function(t,e){t.appendChild(e)},appendChildToContainer:function(t,e){8===t.nodeType?t.parentNode.insertBefore(e,t):t.appendChild(e)},insertBefore:function(t,e,n){t.insertBefore(e,n)},insertInContainerBefore:function(t,e,n){8===t.nodeType?t.parentNode.insertBefore(e,n):t.insertBefore(e,n)},removeChild:function(t,e){t.removeChild(e)},removeChildFromContainer:function(t,e){8===t.nodeType?t.parentNode.removeChild(e):t.removeChild(e)}},hydration:{canHydrateInstance:function(t,e){return 1!==t.nodeType||e.toLowerCase()!==t.nodeName.toLowerCase()?null:t},canHydrateTextInstance:function(t,e){return""===e||3!==t.nodeType?null:t},getNextHydratableSibling:function(t){for(t=t.nextSibling;t&&1!==t.nodeType&&3!==t.nodeType;)t=t.nextSibling;return t},getFirstHydratableChild:function(t){for(t=t.firstChild;t&&1!==t.nodeType&&3!==t.nodeType;)t=t.nextSibling;return t},hydrateInstance:function(t,e,n,r,i,o){return t[Dn]=o,t[On]=n,Ze(t,e,n,i,r)},hydrateTextInstance:function(t,e,n){return t[Dn]=n,$e(t,e)},didNotMatchHydratedContainerTextInstance:function(){},didNotMatchHydratedTextInstance:function(){},didNotHydrateContainerInstance:function(){},didNotHydrateInstance:function(){},didNotFindHydratableContainerInstance:function(){},didNotFindHydratableContainerTextInstance:function(){},didNotFindHydratableInstance:function(){},didNotFindHydratableTextInstance:function(){}},scheduleDeferredCallback:Si,cancelDeferredCallback:Ci}),Ki=Yi;q=Ki.batchedUpdates,Y=Ki.interactiveUpdates,K=Ki.flushInteractiveUpdates;var Qi={createPortal:un,findDOMNode:function(t){return null==t?null:1===t.nodeType?t:Yi.findHostInstance(t)},hydrate:function(t,e,n){return sn(null,t,e,!0,n)},render:function(t,e,n){return sn(null,t,e,!1,n)},unstable_renderSubtreeIntoContainer:function(t,e,n,i){return(null==t||void 0===t._reactInternalFiber)&&r("38"),sn(t,e,n,!1,i)},unmountComponentAtNode:function(t){return rn(t)||r("40"),!!t._reactRootContainer&&(Yi.unbatchedUpdates(function(){sn(null,null,t,!1,function(){t._reactRootContainer=null})}),!0)},unstable_createPortal:function(){return un.apply(void 0,arguments)},unstable_batchedUpdates:Yi.batchedUpdates,unstable_deferredUpdates:Yi.deferredUpdates,flushSync:Yi.flushSync,unstable_flushControlled:Yi.flushControlled,__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED:{EventPluginHub:Pn,EventPluginRegistry:Sn,EventPropagators:Ln,ReactControlledComponent:rr,ReactDOMComponentTree:kn,ReactDOMEventListener:Xr},unstable_createRoot:function(t,e){return new nn(t,!0,null!=e&&!0===e.hydrate)}};Yi.injectIntoDevTools({findFiberByHostInstance:_,bundleType:0,version:"16.3.2",rendererPackageName:"react-dom"});var Xi=Object.freeze({default:Qi}),Ji=Xi&&Qi||Xi;t.exports=Ji.default?Ji.default:Ji},function(t,e,n){"use strict";var r=!("undefined"===typeof window||!window.document||!window.document.createElement),i={canUseDOM:r,canUseWorkers:"undefined"!==typeof Worker,canUseEventListeners:r&&!(!window.addEventListener&&!window.attachEvent),canUseViewport:r&&!!window.screen,isInWorker:!r};t.exports=i},function(t,e,n){"use strict";function r(t){if("undefined"===typeof(t=t||("undefined"!==typeof document?document:void 0)))return null;try{return t.activeElement||t.body}catch(e){return t.body}}t.exports=r},function(t,e,n){"use strict";function r(t,e){return t===e?0!==t||0!==e||1/t===1/e:t!==t&&e!==e}function i(t,e){if(r(t,e))return!0;if("object"!==typeof t||null===t||"object"!==typeof e||null===e)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(var a=0;a<n.length;a++)if(!o.call(e,n[a])||!r(t[n[a]],e[n[a]]))return!1;return!0}var o=Object.prototype.hasOwnProperty;t.exports=i},function(t,e,n){"use strict";function r(t,e){return!(!t||!e)&&(t===e||!i(t)&&(i(e)?r(t,e.parentNode):"contains"in t?t.contains(e):!!t.compareDocumentPosition&&!!(16&t.compareDocumentPosition(e))))}var i=n(31);t.exports=r},function(t,e,n){"use strict";function r(t){return i(t)&&3==t.nodeType}var i=n(32);t.exports=r},function(t,e,n){"use strict";function r(t){var e=t?t.ownerDocument||t:document,n=e.defaultView||window;return!(!t||!("function"===typeof n.Node?t instanceof n.Node:"object"===typeof t&&"number"===typeof t.nodeType&&"string"===typeof t.nodeName))}t.exports=r},function(t,e){},function(t,e,n){"use strict";function r(t){return function(){var e=t.apply(this,arguments);return new Promise(function(t,n){function r(i,o){try{var a=e[i](o),s=a.value}catch(t){return void n(t)}if(!a.done)return Promise.resolve(s).then(function(t){r("next",t)},function(t){r("throw",t)});t(s)}return r("next")})}}function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!==typeof e&&"function"!==typeof e?t:e}function a(t,e){if("function"!==typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}var s=n(10),u=n.n(s),c=n(5),l=n.n(c),h=n(0),f=n(35),d=n.n(f),p=n(36),m=n.n(p),g=n(38),v=n.n(g),y=n(39),_=n(41),b=n(42),w=n(44),E=n(61),x=n(62),T=(n.n(x),function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}()),S=n(63),C=n(67),M=n(69);n(83);var A=function(t){function e(t){i(this,e);var n=o(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t));n.config=m()(b.a,n.props.config),n.repo=n.config.git.repo,n.repoChanges=n.config.git.repo+"_changes",n.initFireBase(),n.currentFrame=0,n.prevAPICallFrame=0,n.OrbitControls=d()(h),n.FDG=null,n.delayAmount=n.config.FDG.delayAmount,n.userInteracting=!0;var r=0;if("undefined"!==typeof URLSearchParams){var a=new URLSearchParams(window.location.search);a.has("date")?r=C(a.get("date")).valueOf():n.config.git.commitDate&&(r=C(n.config.git.commitDate).valueOf())}return n.commitsToProcess=[],n.nodes={},n.APICalled=!1,n.loadPrevCommit=!1,n.loadNextCommit=!1,n.state={play:n.config.FDG.autoPlay,currentDate:null,currentCommitHash:"",spherize:n.config.FDG.sphereProject,currentAuthor:null,currentMsg:null,currentAdded:null,currentChanged:null,currentRemoved:null,latestTime:r,currentCommitIndex:-1,sideBarCommits:[],sidebarCurrentCommitIndex:-1},n.loadCommitHash=n.config.git.commitHash,n}return a(e,t),T(e,[{key:"anonymousSignin",value:function(){M.auth().signInAnonymously().catch(function(t){console.log(t.code),console.log(t.message)})}},{key:"setDate",value:function(t){var e=C(t).valueOf();this.setState({latestTime:e}),this.state.play?(this.setPlay(!1),this.callAPI()):this.callAPI()}},{key:"setSphereView",value:function(t){this.config.FDG.sphereProject=t,this.setState({spherize:this.config.FDG.sphereProject})}},{key:"initFireBase",value:function(){function t(){return e.apply(this,arguments)}var e=r(u.a.mark(function t(){var e;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return M.initializeApp(this.config.fireBase),e={timestampsInSnapshots:!0},M.firestore().settings(e),t.prev=3,t.next=6,M.firestore().enablePersistence();case 6:t.next=10;break;case 8:t.prev=8,t.t0=t.catch(3);case 10:this.firebaseDB=M.firestore(),this.docRef=this.firebaseDB.collection(this.config.git.repo),this.docRefChanges=this.firebaseDB.collection(this.config.git.repo+"_changes"),this.anonymousSignin(),this.callAPI(),this.emit("ready");case 16:case"end":return t.stop()}},t,this,[[3,8]])}));return t}()},{key:"componentDidMount",value:function(){this.initStage()}},{key:"initStage",value:function(){this.initScene(),this.initCamera(),this.initRenderer(),this.initPost(),this.initControls(),this.initFDG(),this.addEvents(),this.animate()}},{key:"initPost",value:function(){this.composer=new y.a(this.renderer),this.renderPass=new y.b(this.scene,this.camera),this.composer.addPass(this.renderPass),this.setPostSettings()}},{key:"setPostSettings",value:function(){this.config.post.vignette?this.vignettePass?(this.vignettePass.enabled=!0,this.renderPass.renderToScreen=!1):(this.vignettePass=new y.c(_.a),this.vignettePass.material.uniforms.bgColor.value=new h.Color(this.config.scene.bgColor),this.vignettePass.renderToScreen=!0,this.composer.addPass(this.vignettePass)):(this.vignettePass&&(this.vignettePass.enabled=!1),this.renderPass.renderToScreen=!0)}},{key:"initControls",value:function(){this.controls=new this.OrbitControls(this.camera,this.renderer.domElement),this.setControlsSettings()}},{key:"setControlsSettings",value:function(){this.controls.minDistance=200,this.controls.maxDistance=1e4,this.controls.enablePan=!1,this.controls.zoomSpeed=.7,this.controls.rotateSpeed=.07,this.controls.enableDamping=!0,this.controls.dampingFactor=.04}},{key:"initFDG",value:function(){this.FDG=new w.a(this.renderer,this.scene,this.config,this.camera)}},{key:"animate",value:function(){window.requestAnimationFrame(this.animate.bind(this)),this.renderFrame()}},{key:"renderFrame",value:function(){this.currentFrame++,this.FDG&&this.FDG.update(),this.config.scene.autoRotate&&(this.scene.rotation.y+=this.config.scene.autoRotateSpeed),this.cameraFollowTarget(),this.controls.update(),this.composer.render()}},{key:"addEvents",value:function(){var t=this;window.addEventListener("resize",this.resize.bind(this),!1),this.resize();var e=document.querySelector("#"+this.config.scene.canvasID),n=function(){var t=this;this.userInteracting=!0,clearTimeout(this.interactionTimeout),this.interactionTimeout=setTimeout(function(){t.userInteracting=!1;var e=t.camera.getWorldPosition(new h.Vector3);t.cameraPos.x=e.x,t.cameraPos.y=e.y,t.cameraPos.z=e.z,t.targetCameraPos.x=e.x,t.targetCameraPos.y=e.y,t.targetCameraPos.z=e.z},3e3)};e.addEventListener("touchstart",function(e){n.call(t)}),e.addEventListener("mousedown",function(e){n.call(t)}),e.addEventListener("wheel",function(e){n.call(t)}),e.addEventListener("mousewheel",function(e){n.call(t)})}},{key:"initScene",value:function(){this.scene=new h.Scene,this.scene.background=new h.Color(this.config.scene.bgColor)}},{key:"initCamera",value:function(){this.camera=new h.PerspectiveCamera(this.config.camera.fov,window.innerWidth/window.innerHeight,.1,2e6),this.camera.position.x=this.config.camera.initPos.x,this.camera.position.y=this.config.camera.initPos.y,this.camera.position.z=this.config.camera.initPos.z,this.cameraLerpSpeed=.03,this.cameraPos=this.camera.position.clone(),this.targetCameraPos=this.cameraPos.clone(),this.cameraLookAtPos=new h.Vector3(0,0,0),this.targetCameraLookAt=new h.Vector3(0,0,0),this.camera.lookAt(this.cameraLookAtPos),this.cameraFromQuaternion=(new h.Quaternion).copy(this.camera.quaternion);var t=(new h.Euler).copy(this.camera.rotation);this.cameraToQuaternion=(new h.Quaternion).setFromEuler(t),this.cameraMoveQuaternion=new h.Quaternion,this.camera.updateMatrixWorld(),this.setCameraSettings()}},{key:"setCameraSettings",value:function(){this.camera.fov=this.config.camera.fov,this.camera.updateMatrixWorld()}},{key:"cameraFollowTarget",value:function(){this.camera.lookAt(this.cameraLookAtPos),this.userInteracting||(this.cameraPos.lerp(this.targetCameraPos,this.cameraLerpSpeed),this.camera.position.copy(this.cameraPos),this.cameraLookAtPos.lerp(this.targetCameraLookAt,this.cameraLerpSpeed))}},{key:"initRenderer",value:function(){this.renderer=new h.WebGLRenderer({antialias:this.config.scene.antialias,canvas:document.getElementById(this.config.scene.canvasID)}),this.composer=new y.a(this.renderer)}},{key:"resize",value:function(){this.config.scene.fullScreen?(this.width=window.innerWidth,this.height=window.innerHeight):(this.width=this.config.scene.width,this.height=this.config.scene.height),this.config.scene.width=this.width,this.config.scene.height=this.height,this.camera.aspect=this.width/this.height,this.camera.updateProjectionMatrix(),this.renderer.setSize(this.width,this.height,!1),this.composer.setSize(this.width,this.height),this.FDG.resize()}},{key:"callAPI",value:function(){function t(){return e.apply(this,arguments)}var e=r(u.a.mark(function t(){var e,n,i;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e=this.callAPI,this.currentFrame!==this.prevAPICallFrame){t.next=6;break}return window.requestAnimationFrame(e.bind(this)),t.abrupt("return");case 6:window.cancelAnimationFrame(e);case 7:this.prevAPICallFrame=this.currentFrame,this.APIprocessing=!0,n=void 0,this.state.play,this.commitsToProcess=[],""!==this.loadCommitHash?(n=this.docRef.doc(this.loadCommitHash),this.loadCommitHash=""):this.loadPrevCommit?(n=this.docRef.where("index","==",this.state.currentCommitIndex-1).limit(1),this.loadPrevCommit=!1):this.loadNextCommit?(n=this.docRef.where("index","==",this.state.currentCommitIndex+1).limit(1),this.loadNextCommit=!1):this.config.git.loadLatest&&!this.state.latestTime?(n=this.docRef.orderBy("index","desc").limit(1),this.config.git.loadLatest=!1):n=this.state.latestTime?this.docRef.orderBy("date","asc").where("date",">=",this.state.latestTime).limit(1):this.docRef.where("index","==",this.state.currentCommitIndex+1).limit(1),i=[],n.onSnapshot(function(){var t=r(u.a.mark(function t(e){var o,a,s,c=this,l=function(){var t=r(u.a.mark(function t(e,n){var r;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:r=0;case 1:if(!(r<e.length)){t.next=7;break}return t.next=4,n(e[r],r,e);case 4:r++,t.next=1;break;case 7:case"end":return t.stop()}},t,this)}));return function(e,n){return t.apply(this,arguments)}}();return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(e.forEach(function(t){i.push(t),c.commitsToProcess.push(t.id)}),!this.state.latestTime||0!==i.length){t.next=9;break}return n=this.docRef.orderBy("index","desc").limit(1),t.next=5,n.get();case 5:o=t.sent,i.push(o),t.next=12;break;case 9:if(0!==i.length){t.next=12;break}return setTimeout(function(){c.callAPI()},6e4),t.abrupt("return");case 12:a=function(){var t=r(u.a.mark(function t(e){var n=this;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",new Promise(function(t,r){e.exists||(console.log("Error: Commit "+e.id+" does not exist in repo"),t());var i=e.data();i.sha=e.id,-1===n.commitsToProcess.indexOf(e.id)&&t(),setTimeout(function(){var r=JSON.parse(i.edges);if(e.ref.parent.id===n.repo)n.nodes=JSON.parse(i.nodes)[0];else{var o=JSON.parse(i.changes);o.r.forEach(function(t){for(var e in n.nodes)if(n.nodes.hasOwnProperty(e)){var r=n.nodes[e];r.p===t&&delete n.nodes[e]}});for(var a in n.nodes)n.nodes.hasOwnProperty(a)&&(-1!==o.c.indexOf(n.nodes[a].p)?n.nodes[a].u=1:delete n.nodes[a].u);n.nodes=Object.keys(n.nodes).map(function(t){return this.nodes[t]}.bind(n));for(var s in o.a)if(o.a.hasOwnProperty(s)){var u=o.a[s];u.u=1,n.nodes[s]=u}}var c={},l=JSON.parse(i.changes);c.latestTime=0,c.currentDate=C.unix(i.date/1e3).format("MM/DD/YYYY HH:mm:ss"),c.currentCommitHash=i.sha,c.currentAuthor=i.author+" <"+i.email+">",c.currentMsg=i.msg,c.currentAdded=isNaN(l.a)?Object.keys(l.a).length:l.a,c.currentChanged=isNaN(l.c)?l.c.length:l.c,c.currentRemoved=isNaN(l.r)?l.r.length:l.r,c.currentCommitIndex=i.index,n.setState(c),n.emit("commitChanged",{removed:c.currentRemoved,changed:c.currentChanged,added:c.currentAdded,msg:c.currentMsg,author:c.currentAuthor,hash:c.currentCommitHash,date:c.currentDate,index:i.index}),n.cameraAccommodateNodes(),n.FDG&&(n.FDG.firstRun?(n.FDG.init({nodeData:n.nodes,edgeData:r,nodeCount:n.config.FDG.nodeCount}),n.FDG.setFirstRun(!1)):(n.FDG.refresh(),n.FDG.init({nodeData:n.nodes,edgeData:r,nodeCount:n.config.FDG.nodeCount}))),n.populateSideBar(),n.state.play?t():n.APIprocessing=!1},n.delayAmount)}));case 1:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}(),s=function(){var t=r(u.a.mark(function t(){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,l(i,function(){var t=r(u.a.mark(function t(e){return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,a.call(c,e);case 2:case"end":return t.stop()}},t,c)}));return function(e){return t.apply(this,arguments)}}());case 2:c.APIprocessing=!1,c.callAPI();case 4:case"end":return t.stop()}},t,c)}));return function(){return t.apply(this,arguments)}}(),s();case 15:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}().bind(this));case 15:case"end":return t.stop()}},t,this)}));return t}()},{key:"cameraAccommodateNodes",value:function(){var t=this.camera.getWorldPosition(new h.Vector3).normalize(),e=Object.keys(this.nodes).length,n=1e-4*Math.pow(e,2)+1*e+this.config.camera.initPos.z;this.state.spherize&&(n=this.config.scene.width>this.config.scene.height?this.config.FDG.sphereRadius+1200:this.config.FDG.sphereRadius+1600);var r=t.multiplyScalar(n);this.targetCameraPos.x=r.x,this.targetCameraPos.y=r.y,this.targetCameraPos.z=r.z}},{key:"getGravatar",value:function(t,e){return"https://secure.gravatar.com/avatar/"+Object(E.a)(t)+".jpg?s="+e}},{key:"populateSideBar",value:function(){function t(){return e.apply(this,arguments)}var e=r(u.a.mark(function t(){var e,n,r,i,o=this;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(this.config.display.showSidebar){t.next=2;break}return t.abrupt("return");case 2:return e=this.docRefChanges,this.state.currentCommitIndex<4&&(e=this.docRef),n=e.orderBy("index","asc").where("index",">=",this.state.currentCommitIndex-2).limit(5),t.next=7,n.get();case 7:r=t.sent,i=[],r.forEach(function(t){var e=t.data();e.dateLong=C(e.date).format("dddd, MMMM Do YYYY, h:mm:ss a"),e.dateShort=C(e.date).format("MMM Do"),e.sha=t.id,e.gravatar=o.getGravatar(e.email,40),i.push(e)}),i.sort(function(t,e){return e.date-t.date}),this.setState({sideBarCommits:i,sidebarCurrentCommitIndex:this.state.currentCommitIndex});case 12:case"end":return t.stop()}},t,this)}));return t}()},{key:"toggleSpherize",value:function(){this.config.FDG.sphereProject=!this.state.spherize,this.setState({spherize:this.config.FDG.sphereProject})}},{key:"setPlay",value:function(t){var e=t;this.setState({play:e}),e||(this.APIprocessing=!1,this.commitsToProcess=[]),e&&!this.APIprocessing&&this.callAPI()}},{key:"togglePlay",value:function(){var t=!this.state.play;this.setState({play:t}),t||(this.APIprocessing=!1,this.commitsToProcess=[]),t&&!this.APIprocessing&&this.callAPI()}},{key:"loadCommit",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";""===t&&(t=this.commitInput.value.trim()),t&&(this.loadCommitHash=t,this.commitsToProcess=[t],this.setState({play:!1}),this.callAPI())}},{key:"goToPrev",value:function(){this.loadPrevCommit=!0,this.commitsToProcess=[],this.setState({play:!1}),this.callAPI()}},{key:"goToNext",value:function(){this.loadNextCommit=!0,this.commitsToProcess=[],this.setState({play:!1}),this.callAPI()}},{key:"setConfig",value:function(t){this.config=m()(this.config,t),this.setControlsSettings(),this.setPostSettings(),this.setCameraSettings(),this.FDG&&!0===this.FDG.active&&this.FDG.triggerUpdate()}},{key:"getFirstCommit",value:function(){function t(){return e.apply(this,arguments)}var e=r(u.a.mark(function t(){var e,n,r;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.firebaseDB.collection(this.repoChanges),n=e.orderBy("date","asc").limit(1),t.next=4,n.get();case 4:return r=t.sent,t.abrupt("return",r.docs[0].data());case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"getlastCommit",value:function(){function t(){return e.apply(this,arguments)}var e=r(u.a.mark(function t(){var e,n,r;return u.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return e=this.firebaseDB.collection(this.repoChanges),n=e.orderBy("date","desc").limit(1),t.next=4,n.get();case 4:return r=t.sent,t.abrupt("return",r.docs[0].data());case 6:case"end":return t.stop()}},t,this)}));return t}()},{key:"sideBar",value:function(){var t=this;if(this.config.display.showSidebar)return l.a.createElement("ol",{className:"gource-sidebar"},this.state.sideBarCommits.map(function(e){return l.a.createElement("li",{key:e.sha,className:e.index===t.state.sidebarCurrentCommitIndex?"current":"",onClick:function(){t.loadCommit(e.sha)}},l.a.createElement("div",{className:"sidebar-gravatar"},l.a.createElement("img",{src:e.gravatar,width:"40",height:"40",alt:""})),l.a.createElement("div",{className:"sidebar-details"},l.a.createElement("p",null,l.a.createElement("span",{className:"sidebar-author"},e.author)," ",l.a.createElement("span",{className:"sidebar-date",title:e.dateLong},e.dateShort),l.a.createElement("a",{className:"sidebar-github-view",target:"_blank",title:"View Commit on GitHub",href:"https://github.com/"+t.config.git.owner+"/"+t.config.git.repo+"/commit/"+e.sha},"View on GitHub")),l.a.createElement("p",null,l.a.createElement("span",{className:"sidebar-message"},e.msg))))}))}},{key:"UI",value:function(){var t=this;return this.config.display.showUI?l.a.createElement("div",{className:"gource-ui"},this.sideBar(),l.a.createElement("div",{className:"info"},l.a.createElement("div",{className:"currentAdded"},l.a.createElement("span",null,"Files Added:")," ",l.a.createElement("b",null,this.state.currentAdded)),l.a.createElement("div",{className:"currentChanged"},l.a.createElement("span",null,"Files Changed:")," ",l.a.createElement("b",null,this.state.currentChanged)),l.a.createElement("div",{className:"currentRemoved"},l.a.createElement("span",null,"Files Removed:")," ",l.a.createElement("b",null,this.state.currentRemoved)),l.a.createElement("div",{className:"currentAuthor"},l.a.createElement("span",null,"Author:")," ",l.a.createElement("b",null,this.state.currentAuthor)),l.a.createElement("div",{className:"currentMsg"},l.a.createElement("span",null,"Message:")," ",l.a.createElement("b",null,this.state.currentMsg)),l.a.createElement("div",{className:"currentDate"},l.a.createElement("span",null,"Commit Date:")," ",l.a.createElement("b",null,this.state.currentDate)),l.a.createElement("div",{className:"currentCommitHash"},l.a.createElement("span",null,"Commit Hash:")," ",l.a.createElement("b",null,this.state.currentCommitHash))),l.a.createElement("div",{className:"gource-controls"},l.a.createElement("button",{className:"previousCommit",onClick:this.goToPrev.bind(this)},"< Prev"),l.a.createElement("button",{className:"nextCommit",onClick:this.goToNext.bind(this)},"Next >"),l.a.createElement("label",null,"Play:",l.a.createElement("input",{name:"play",type:"checkbox",checked:this.state.play,onChange:this.togglePlay.bind(this)})),l.a.createElement("label",null,"Commit:",l.a.createElement("input",{ref:function(e){t.commitInput=e},name:"commitInput",type:"text"}),l.a.createElement("button",{onClick:this.loadCommit.bind(this)},"Go")),l.a.createElement("label",null,"Sphere Projection:",l.a.createElement("input",{name:"spherize",type:"checkbox",checked:this.state.spherize,onChange:this.toggleSpherize.bind(this)})))):l.a.createElement("div",{className:"gource-ui"},this.sideBar())}},{key:"render",value:function(){return l.a.createElement("div",{className:"App"},this.UI(),l.a.createElement("canvas",{width:this.config.scene.width,height:this.config.scene.height,id:this.config.scene.canvasID}))}}]),e}(S(v.a,c.Component));e.a=A},function(t,e){t.exports=function(t){function e(e,n){function r(){return 2*Math.PI/60/60*O.autoRotateSpeed}function i(){return Math.pow(.95,O.zoomSpeed)}function o(t){H.theta-=t}function a(t){H.phi-=t}function s(e){O.object instanceof t.PerspectiveCamera?G/=e:O.object instanceof t.OrthographicCamera?(O.object.zoom=Math.max(O.minZoom,Math.min(O.maxZoom,O.object.zoom*e)),O.object.updateProjectionMatrix(),W=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),O.enableZoom=!1)}function u(e){O.object instanceof t.PerspectiveCamera?G*=e:O.object instanceof t.OrthographicCamera?(O.object.zoom=Math.max(O.minZoom,Math.min(O.maxZoom,O.object.zoom/e)),O.object.updateProjectionMatrix(),W=!0):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - dolly/zoom disabled."),O.enableZoom=!1)}function c(t){q.set(t.clientX,t.clientY)}function l(t){Z.set(t.clientX,t.clientY)}function h(t){Q.set(t.clientX,t.clientY)}function f(t){Y.set(t.clientX,t.clientY),K.subVectors(Y,q);var e=O.domElement===document?O.domElement.body:O.domElement;o(2*Math.PI*K.x/e.clientWidth*O.rotateSpeed),a(2*Math.PI*K.y/e.clientHeight*O.rotateSpeed),q.copy(Y),O.update()}function d(t){$.set(t.clientX,t.clientY),tt.subVectors($,Z),tt.y>0?s(i()):tt.y<0&&u(i()),Z.copy($),O.update()}function p(t){X.set(t.clientX,t.clientY),J.subVectors(X,Q),rt(J.x,J.y),Q.copy(X),O.update()}function m(t){}function g(t){t.deltaY<0?u(i()):t.deltaY>0&&s(i()),O.update()}function v(t){switch(t.keyCode){case O.keys.UP:rt(0,O.keyPanSpeed),O.update();break;case O.keys.BOTTOM:rt(0,-O.keyPanSpeed),O.update();break;case O.keys.LEFT:rt(O.keyPanSpeed,0),O.update();break;case O.keys.RIGHT:rt(-O.keyPanSpeed,0),O.update()}}function y(t){q.set(t.touches[0].pageX,t.touches[0].pageY)}function _(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);Z.set(0,r)}function b(t){Q.set(t.touches[0].pageX,t.touches[0].pageY)}function w(t){Y.set(t.touches[0].pageX,t.touches[0].pageY),K.subVectors(Y,q);var e=O.domElement===document?O.domElement.body:O.domElement;o(2*Math.PI*K.x/e.clientWidth*O.rotateSpeed),a(2*Math.PI*K.y/e.clientHeight*O.rotateSpeed),q.copy(Y),O.update()}function E(t){var e=t.touches[0].pageX-t.touches[1].pageX,n=t.touches[0].pageY-t.touches[1].pageY,r=Math.sqrt(e*e+n*n);$.set(0,r),tt.subVectors($,Z),tt.y>0?u(i()):tt.y<0&&s(i()),Z.copy($),O.update()}function x(t){X.set(t.touches[0].pageX,t.touches[0].pageY),J.subVectors(X,Q),rt(J.x,J.y),Q.copy(X),O.update()}function T(t){}function S(t){if(!1!==O.enabled){if(t.preventDefault(),t.button===O.mouseButtons.ORBIT){if(!1===O.enableRotate)return;c(t),B=F.ROTATE}else if(t.button===O.mouseButtons.ZOOM){if(!1===O.enableZoom)return;l(t),B=F.DOLLY}else if(t.button===O.mouseButtons.PAN){if(!1===O.enablePan)return;h(t),B=F.PAN}B!==F.NONE&&(document.addEventListener("mousemove",C,!1),document.addEventListener("mouseup",M,!1),O.dispatchEvent(L))}}function C(t){if(!1!==O.enabled)if(t.preventDefault(),B===F.ROTATE){if(!1===O.enableRotate)return;f(t)}else if(B===F.DOLLY){if(!1===O.enableZoom)return;d(t)}else if(B===F.PAN){if(!1===O.enablePan)return;p(t)}}function M(t){!1!==O.enabled&&(m(t),document.removeEventListener("mousemove",C,!1),document.removeEventListener("mouseup",M,!1),O.dispatchEvent(U),B=F.NONE)}function A(t){!1===O.enabled||!1===O.enableZoom||B!==F.NONE&&B!==F.ROTATE||(t.preventDefault(),t.stopPropagation(),g(t),O.dispatchEvent(L),O.dispatchEvent(U))}function I(t){!1!==O.enabled&&!1!==O.enableKeys&&!1!==O.enablePan&&v(t)}function R(t){if(!1!==O.enabled){switch(t.touches.length){case 1:if(!1===O.enableRotate)return;y(t),B=F.TOUCH_ROTATE;break;case 2:if(!1===O.enableZoom)return;_(t),B=F.TOUCH_DOLLY;break;case 3:if(!1===O.enablePan)return;b(t),B=F.TOUCH_PAN;break;default:B=F.NONE}B!==F.NONE&&O.dispatchEvent(L)}}function P(t){if(!1!==O.enabled)switch(t.preventDefault(),t.stopPropagation(),t.touches.length){case 1:if(!1===O.enableRotate)return;if(B!==F.TOUCH_ROTATE)return;w(t);break;case 2:if(!1===O.enableZoom)return;if(B!==F.TOUCH_DOLLY)return;E(t);break;case 3:if(!1===O.enablePan)return;if(B!==F.TOUCH_PAN)return;x(t);break;default:B=F.NONE}}function N(t){!1!==O.enabled&&(T(t),O.dispatchEvent(U),B=F.NONE)}function D(t){t.preventDefault()}this.object=e,this.domElement=void 0!==n?n:document,this.enabled=!0,this.target=new t.Vector3,this.minDistance=0,this.maxDistance=1/0,this.minZoom=0,this.maxZoom=1/0,this.minPolarAngle=0,this.maxPolarAngle=Math.PI,this.minAzimuthAngle=-1/0,this.maxAzimuthAngle=1/0,this.enableDamping=!1,this.dampingFactor=.25,this.enableZoom=!0,this.zoomSpeed=1,this.enableRotate=!0,this.rotateSpeed=1,this.enablePan=!0,this.keyPanSpeed=7,this.autoRotate=!1,this.autoRotateSpeed=2,this.enableKeys=!0,this.keys={LEFT:37,UP:38,RIGHT:39,BOTTOM:40},this.mouseButtons={ORBIT:t.MOUSE.LEFT,ZOOM:t.MOUSE.MIDDLE,PAN:t.MOUSE.RIGHT},this.target0=this.target.clone(),this.position0=this.object.position.clone(),this.zoom0=this.object.zoom,this.getPolarAngle=function(){return j.phi},this.getAzimuthalAngle=function(){return j.theta},this.reset=function(){O.target.copy(O.target0),O.object.position.copy(O.position0),O.object.zoom=O.zoom0,O.object.updateProjectionMatrix(),O.dispatchEvent(k),O.update(),B=F.NONE},this.update=function(){var n=new t.Vector3,i=(new t.Quaternion).setFromUnitVectors(e.up,new t.Vector3(0,1,0)),a=i.clone().inverse(),s=new t.Vector3,u=new t.Quaternion;return function(){var t=O.object.position;return n.copy(t).sub(O.target),n.applyQuaternion(i),j.setFromVector3(n),O.autoRotate&&B===F.NONE&&o(r()),j.theta+=H.theta,j.phi+=H.phi,j.theta=Math.max(O.minAzimuthAngle,Math.min(O.maxAzimuthAngle,j.theta)),j.phi=Math.max(O.minPolarAngle,Math.min(O.maxPolarAngle,j.phi)),j.makeSafe(),j.radius*=G,j.radius=Math.max(O.minDistance,Math.min(O.maxDistance,j.radius)),O.target.add(z),n.setFromSpherical(j),n.applyQuaternion(a),t.copy(O.target).add(n),O.object.lookAt(O.target),!0===O.enableDamping?(H.theta*=1-O.dampingFactor,H.phi*=1-O.dampingFactor):H.set(0,0,0),G=1,z.set(0,0,0),!!(W||s.distanceToSquared(O.object.position)>V||8*(1-u.dot(O.object.quaternion))>V)&&(O.dispatchEvent(k),s.copy(O.object.position),u.copy(O.object.quaternion),W=!1,!0)}}(),this.dispose=function(){O.domElement.removeEventListener("contextmenu",D,!1),O.domElement.removeEventListener("mousedown",S,!1),O.domElement.removeEventListener("wheel",A,!1),O.domElement.removeEventListener("touchstart",R,!1),O.domElement.removeEventListener("touchend",N,!1),O.domElement.removeEventListener("touchmove",P,!1),document.removeEventListener("mousemove",C,!1),document.removeEventListener("mouseup",M,!1),window.removeEventListener("keydown",I,!1)};var O=this,k={type:"change"},L={type:"start"},U={type:"end"},F={NONE:-1,ROTATE:0,DOLLY:1,PAN:2,TOUCH_ROTATE:3,TOUCH_DOLLY:4,TOUCH_PAN:5},B=F.NONE,V=1e-6,j=new t.Spherical,H=new t.Spherical,G=1,z=new t.Vector3,W=!1,q=new t.Vector2,Y=new t.Vector2,K=new t.Vector2,Q=new t.Vector2,X=new t.Vector2,J=new t.Vector2,Z=new t.Vector2,$=new t.Vector2,tt=new t.Vector2,et=function(){var e=new t.Vector3;return function(t,n){e.setFromMatrixColumn(n,0),e.multiplyScalar(-t),z.add(e)}}(),nt=function(){var e=new t.Vector3;return function(t,n){e.setFromMatrixColumn(n,1),e.multiplyScalar(t),z.add(e)}}(),rt=function(){var e=new t.Vector3;return function(n,r){var i=O.domElement===document?O.domElement.body:O.domElement;if(O.object instanceof t.PerspectiveCamera){var o=O.object.position;e.copy(o).sub(O.target);var a=e.length();a*=Math.tan(O.object.fov/2*Math.PI/180),et(2*n*a/i.clientHeight,O.object.matrix),nt(2*r*a/i.clientHeight,O.object.matrix)}else O.object instanceof t.OrthographicCamera?(et(n*(O.object.right-O.object.left)/O.object.zoom/i.clientWidth,O.object.matrix),nt(r*(O.object.top-O.object.bottom)/O.object.zoom/i.clientHeight,O.object.matrix)):(console.warn("WARNING: OrbitControls.js encountered an unknown camera type - pan disabled."),O.enablePan=!1)}}();O.domElement.addEventListener("contextmenu",D,!1),O.domElement.addEventListener("mousedown",S,!1),O.domElement.addEventListener("wheel",A,!1),O.domElement.addEventListener("touchstart",R,!1),O.domElement.addEventListener("touchend",N,!1),O.domElement.addEventListener("touchmove",P,!1),window.addEventListener("keydown",I,!1),this.update()}return e.prototype=Object.create(t.EventDispatcher.prototype),e.prototype.constructor=e,Object.defineProperties(e.prototype,{center:{get:function(){return console.warn("THREE.OrbitControls: .center has been renamed to .target"),this.target}},noZoom:{get:function(){return console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),!this.enableZoom},set:function(t){console.warn("THREE.OrbitControls: .noZoom has been deprecated. Use .enableZoom instead."),this.enableZoom=!t}},noRotate:{get:function(){return console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),!this.enableRotate},set:function(t){console.warn("THREE.OrbitControls: .noRotate has been deprecated. Use .enableRotate instead."),this.enableRotate=!t}},noPan:{get:function(){return console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),!this.enablePan},set:function(t){console.warn("THREE.OrbitControls: .noPan has been deprecated. Use .enablePan instead."),this.enablePan=!t}},noKeys:{get:function(){return console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),!this.enableKeys},set:function(t){console.warn("THREE.OrbitControls: .noKeys has been deprecated. Use .enableKeys instead."),this.enableKeys=!t}},staticMoving:{get:function(){return console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),!this.enableDamping},set:function(t){console.warn("THREE.OrbitControls: .staticMoving has been deprecated. Use .enableDamping instead."),this.enableDamping=!t}},dynamicDampingFactor:{get:function(){return console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor},set:function(t){console.warn("THREE.OrbitControls: .dynamicDampingFactor has been renamed. Use .dampingFactor instead."),this.dampingFactor=t}}}),e}},function(t,e,n){"use strict";function r(t){if(null===t||void 0===t)throw new TypeError("Sources cannot be null or undefined");return Object(t)}function i(t,e,n){var r=e[n];if(void 0!==r&&null!==r){if(s.call(t,n)&&(void 0===t[n]||null===t[n]))throw new TypeError("Cannot convert undefined or null to object ("+n+")");s.call(t,n)&&a(r)?t[n]=o(Object(t[n]),e[n]):t[n]=r}}function o(t,e){if(t===e)return t;e=Object(e);for(var n in e)s.call(e,n)&&i(t,e,n);if(Object.getOwnPropertySymbols)for(var r=Object.getOwnPropertySymbols(e),o=0;o<r.length;o++)u.call(e,r[o])&&i(t,e,r[o]);return t}var a=n(37),s=Object.prototype.hasOwnProperty,u=Object.prototype.propertyIsEnumerable;t.exports=function(t){t=r(t);for(var e=1;e<arguments.length;e++)o(t,arguments[e]);return t}},function(t,e,n){"use strict";t.exports=function(t){var e=typeof t;return null!==t&&("object"===e||"function"===e)}},function(t,e,n){"use strict";function r(){}function i(t,e,n){this.fn=t,this.context=e,this.once=n||!1}function o(t,e,n,r,o){if("function"!==typeof n)throw new TypeError("The listener must be a function");var a=new i(n,r||t,o),s=c?c+e:e;return t._events[s]?t._events[s].fn?t._events[s]=[t._events[s],a]:t._events[s].push(a):(t._events[s]=a,t._eventsCount++),t}function a(t,e){0===--t._eventsCount?t._events=new r:delete t._events[e]}function s(){this._events=new r,this._eventsCount=0}var u=Object.prototype.hasOwnProperty,c="~";Object.create&&(r.prototype=Object.create(null),(new r).__proto__||(c=!1)),s.prototype.eventNames=function(){var t,e,n=[];if(0===this._eventsCount)return n;for(e in t=this._events)u.call(t,e)&&n.push(c?e.slice(1):e);return Object.getOwnPropertySymbols?n.concat(Object.getOwnPropertySymbols(t)):n},s.prototype.listeners=function(t){var e=c?c+t:t,n=this._events[e];if(!n)return[];if(n.fn)return[n.fn];for(var r=0,i=n.length,o=new Array(i);r<i;r++)o[r]=n[r].fn;return o},s.prototype.listenerCount=function(t){var e=c?c+t:t,n=this._events[e];return n?n.fn?1:n.length:0},s.prototype.emit=function(t,e,n,r,i,o){var a=c?c+t:t;if(!this._events[a])return!1;var s,u,l=this._events[a],h=arguments.length;if(l.fn){switch(l.once&&this.removeListener(t,l.fn,void 0,!0),h){case 1:return l.fn.call(l.context),!0;case 2:return l.fn.call(l.context,e),!0;case 3:return l.fn.call(l.context,e,n),!0;case 4:return l.fn.call(l.context,e,n,r),!0;case 5:return l.fn.call(l.context,e,n,r,i),!0;case 6:return l.fn.call(l.context,e,n,r,i,o),!0}for(u=1,s=new Array(h-1);u<h;u++)s[u-1]=arguments[u];l.fn.apply(l.context,s)}else{var f,d=l.length;for(u=0;u<d;u++)switch(l[u].once&&this.removeListener(t,l[u].fn,void 0,!0),h){case 1:l[u].fn.call(l[u].context);break;case 2:l[u].fn.call(l[u].context,e);break;case 3:l[u].fn.call(l[u].context,e,n);break;case 4:l[u].fn.call(l[u].context,e,n,r);break;default:if(!s)for(f=1,s=new Array(h-1);f<h;f++)s[f-1]=arguments[f];l[u].fn.apply(l[u].context,s)}}return!0},s.prototype.on=function(t,e,n){return o(this,t,e,n,!1)},s.prototype.once=function(t,e,n){return o(this,t,e,n,!0)},s.prototype.removeListener=function(t,e,n,r){var i=c?c+t:t;if(!this._events[i])return this;if(!e)return a(this,i),this;var o=this._events[i];if(o.fn)o.fn!==e||r&&!o.once||n&&o.context!==n||a(this,i);else{for(var s=0,u=[],l=o.length;s<l;s++)(o[s].fn!==e||r&&!o[s].once||n&&o[s].context!==n)&&u.push(o[s]);u.length?this._events[i]=1===u.length?u[0]:u:a(this,i)}return this},s.prototype.removeAllListeners=function(t){var e;return t?(e=c?c+t:t,this._events[e]&&a(this,e)):(this._events=new r,this._eventsCount=0),this},s.prototype.off=s.prototype.removeListener,s.prototype.addListener=s.prototype.on,s.prefixed=c,s.EventEmitter=s,t.exports=s},function(t,e,n){"use strict";n.d(e,"a",function(){return o}),n.d(e,"c",function(){return s}),n.d(e,"b",function(){return u});var r=n(0),i=n(40),o=function(t,e){if(this.renderer=t,void 0===e){var n={minFilter:r.LinearFilter,magFilter:r.LinearFilter,format:r.RGBAFormat,stencilBuffer:!1},o=t.getDrawingBufferSize();e=new r.WebGLRenderTarget(o.width,o.height,n),e.texture.name="EffectComposer.rt1"}this.renderTarget1=e,this.renderTarget2=e.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],void 0===i.a&&console.error("THREE.EffectComposer relies on THREE.CopyShader"),void 0===s&&console.error("THREE.EffectComposer relies on THREE.ShaderPass"),this.copyPass=new s(i.a)};Object.assign(o.prototype,{swapBuffers:function(){var t=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=t},addPass:function(t){this.passes.push(t);var e=this.renderer.getDrawingBufferSize();t.setSize(e.width,e.height)},insertPass:function(t,e){this.passes.splice(e,0,t)},render:function(t){var e,n,r=this.passes.length;for(n=0;n<r;n++)if(e=this.passes[n],!1!==e.enabled&&(e.render(this.renderer,this.writeBuffer,this.readBuffer,t,!1),e.needsSwap)){this.swapBuffers()}},reset:function(t){if(void 0===t){var e=this.renderer.getDrawingBufferSize();t=this.renderTarget1.clone(),t.setSize(e.width,e.height)}this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=t,this.renderTarget2=t.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(t,e){this.renderTarget1.setSize(t,e),this.renderTarget2.setSize(t,e);for(var n=0;n<this.passes.length;n++)this.passes[n].setSize(t,e)}});var a=function(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1};Object.assign(a.prototype,{setSize:function(t,e){},render:function(t,e,n,r,i){console.error("Pass: .render() must be implemented in derived pass.")}});var s=function(t,e){a.call(this),this.textureID=void 0!==e?e:"tDiffuse",t instanceof r.ShaderMaterial?(this.uniforms=t.uniforms,this.material=t):t&&(this.uniforms=r.UniformsUtils.clone(t.uniforms),this.material=new r.ShaderMaterial({defines:t.defines||{},uniforms:this.uniforms,vertexShader:t.vertexShader,fragmentShader:t.fragmentShader})),this.camera=new r.OrthographicCamera(-1,1,1,-1,0,1),this.scene=new r.Scene,this.quad=new r.Mesh(new r.PlaneBufferGeometry(2,2),null),this.quad.frustumCulled=!1,this.scene.add(this.quad)};s.prototype=Object.assign(Object.create(a.prototype),{constructor:s,render:function(t,e,n,r,i){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=n.texture),this.quad.material=this.material,this.renderToScreen?t.render(this.scene,this.camera):t.render(this.scene,this.camera,e,this.clear)}});var u=function(t,e,n,r,i){a.call(this),this.scene=t,this.camera=e,this.overrideMaterial=n,this.clearColor=r,this.clearAlpha=void 0!==i?i:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1};u.prototype=Object.assign(Object.create(a.prototype),{constructor:u,render:function(t,e,n,r,i){var o=t.autoClear;t.autoClear=!1,this.scene.overrideMaterial=this.overrideMaterial;var a,s;this.clearColor&&(a=t.getClearColor().getHex(),s=t.getClearAlpha(),t.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&t.clearDepth(),t.render(this.scene,this.camera,this.renderToScreen?null:n,this.clear),this.clearColor&&t.setClearColor(a,s),this.scene.overrideMaterial=null,t.autoClear=o}})},function(t,e,n){"use strict";var r={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")};e.a=r},function(t,e,n){"use strict";var r={uniforms:{tDiffuse:{value:null},offset:{value:2},bgColor:{value:null}},vertexShader:"\n\n    varying vec2 vUv;\n\n    void main() {\n      vUv = uv;\n      gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n    }\n\n  ",fragmentShader:"\n\n    uniform vec3 bgColor;\n    uniform float offset;\n    uniform sampler2D tDiffuse;\n\n    varying vec2 vUv;\n\n    void main() {\n\n      vec4 texel = texture2D( tDiffuse, vUv );\n      vec2 uv = ( vUv - vec2( 0.5 ) ) * vec2( offset );\n\n      vec3 result = mix( \n        texel.rgb, \n        bgColor, \n        dot( uv, uv ) \n      );\n\n      gl_FragColor = vec4( \n        clamp(\n          result, \n          bgColor,\n          vec3( 1. )\n        ),\n        texel.a \n      );\n\n    }\n\n  "};e.a=r},function(t,e,n){"use strict";var r=n(0),i=n(43),o=new i.a,a={git:{owner:"input-output-hk",repo:"cardano-sl",commitHash:"",commitDate:"",loadLatest:!0},display:{showUI:!0,showSidebar:!0},fireBase:{apiKey:"AIzaSyCwfdzrjQ5GRqyz-napBM29T7Zel_6KIUY",authDomain:"webgl-gource-1da99.firebaseapp.com",databaseURL:"https://webgl-gource-1da99.firebaseio.com",projectId:"webgl-gource-1da99",storageBucket:"webgl-gource-1da99.appspot.com",messagingSenderId:"532264380396"},FDG:{nodeSpritePath:"textures/dot.png",nodeSpritePathBlur:"textures/dot-blur.png",nodeUpdatedSpritePath:"textures/dot-concentric.png",fontTexturePath:"textures/UbuntuMono.png",nodeCount:4096,autoPlay:!0,delayAmount:1e3,sphereProject:0,sphereRadius:700,showFilePaths:!0,colorCooldownSpeed:.05,filePathCharLimit:20,cycleColors:!1,colorPalette:[]},scene:{fullScreen:!1,width:800,height:600,bgColor:1184551,antialias:!1,canvasID:"stage",autoRotate:!0,autoRotateSpeed:.3},post:{vignette:!0},camera:{fov:60,initPos:{x:0,y:0,z:800}},floatType:o.isIOS?r.HalfFloatType:r.FloatType};e.a=a},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=function t(){r(this,t),this.prefixes="Webkit Moz O ms".split(" "),this.dummyStyle=document.createElement("div").style,this.win=window,this.doc=document,this.ua=(navigator.userAgent||navigator.vendor||window.opera).toLowerCase(),this.isRetina=this.win.devicePixelRatio&&this.win.devicePixelRatio>=1.5,this.isSupportOpacity="undefined"!==typeof this.dummyStyle.opacity,this.isChrome=this.ua.indexOf("chrome")>-1,this.isFirefox=this.ua.indexOf("firefox")>-1,this.isSafari=this.ua.indexOf("safari")>-1,this.isEdge=this.ua.indexOf("edge")>-1,this.isIE=this.ua.indexOf("msie")>-1,this.isMobile=/(iPad|iPhone|Android)/i.test(this.ua),this.isIOS=/(iPad|iPhone)/i.test(this.ua)};e.a=i},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(0),o=n(6),a=n(45),s=n(48),u=n(51),c=n(55),l=n.n(c),h=n(56),f=n.n(h),d=n(57),p=n.n(d),m=n(58),g=n.n(m),v=n(59),y=n.n(v),_=n(60),b=n.n(_),w=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),E=function(){function t(e,n,i,c){r(this,t),this.renderer=e,this.scene=n,this.camera=c,this.config=i,this.frame=0,this.textureHelper=new o.a,this.nodeGeometry=new a.a(this.config),this.edgeGeometry=new s.a(this.config),this.textGeometry=new u.a(this.config),this.firstRun=!0,this.textureWidth=0,this.textureHeight=0,this.enabled=!1,this.storedPositions=new Float32Array,this.positionMaterial=null,this.nodes=null,this.edges=null,this.forceMaterial=null,this.pullGeometry=null,this.pushGeometry=null,this.text=null,this.newNodes=[],this.active=!1,this.initCamera()}return w(t,[{key:"initCamera",value:function(){this.quadCamera=new i.OrthographicCamera,this.quadCamera.position.z=1}},{key:"storePositions",value:function(){this.storedPositions=new Float32Array(this.textureWidth*this.textureHeight*4),this.renderer.readRenderTargetPixels(this.outputPositionRenderTarget,0,0,this.textureWidth,this.textureHeight,this.storedPositions),this.storedPositions=this.storedPositions.slice(0,4*this.nodeCount)}},{key:"refresh",value:function(){this.nodeGeometry.setDecayTime(0)}},{key:"init",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},e=t.nodeData,n=t.edgeData,r=t.nodeCount;this.nodeData=e,this.edgeData=n,this.nodeCount=r,this.active=!0,this.firstRun&&this.initPassThrough(),this.setTextureDimensions(),this.firstRun&&(this.positionRenderTarget1=new i.WebGLRenderTarget(this.textureWidth,this.textureHeight,{wrapS:i.ClampToEdgeWrapping,wrapT:i.ClampToEdgeWrapping,minFilter:i.NearestFilter,magFilter:i.NearestFilter,format:i.RGBAFormat,type:this.config.floatType,depthWrite:!1,depthBuffer:!1,stencilBuffer:!1}),this.positionRenderTarget2=this.positionRenderTarget1.clone(),this.pullRenderTarget=this.positionRenderTarget1.clone(),this.pushRenderTarget=this.positionRenderTarget1.clone(),this.outputPositionRenderTarget=this.positionRenderTarget1),this.firstRun&&(this.passThroughTexture(this.textureHelper.createPositionTexture({storedPositions:this.storedPositions}),this.positionRenderTarget1),this.passThroughTexture(this.positionRenderTarget1.texture,this.positionRenderTarget2)),this.initForces(),this.initPositions(),this.initEdges(),this.initNodes(),this.initText(),this.setEnabled(!0)}},{key:"setEnabled",value:function(){this.enabled=!0}},{key:"triggerUpdate",value:function(){this.refresh(),this.init({nodeData:this.nodeData,edgeData:this.edgeData,nodeCount:this.nodeCount})}},{key:"setTextureDimensions",value:function(){this.textureHelper.setTextureSize(this.nodeCount),this.textureWidth=this.textureHelper.textureWidth,this.textureHeight=this.textureHelper.textureHeight}},{key:"setFirstRun",value:function(t){this.firstRun=t}},{key:"calculatePositions",value:function(){this.frame++,this.positionMaterial.uniforms.sphereProject.value=this.config.FDG.sphereProject,this.positionMaterial.uniforms.sphereRadius.value=this.config.FDG.sphereRadius;var t=this.positionRenderTarget1;this.frame%2===0&&(t=this.positionRenderTarget2),this.pullMaterial.uniforms.positionTexture.value=t.texture,this.pushMaterial.uniforms.positionTexture.value=t.texture;var e=this.positionRenderTarget1;this.outputPositionRenderTarget=this.positionRenderTarget2,this.frame%2===0&&(e=this.positionRenderTarget2,this.outputPositionRenderTarget=this.positionRenderTarget1),this.positionMaterial.uniforms.positionTexture.value=e.texture,this.renderer.render(this.pullScene,this.quadCamera,this.pullRenderTarget,!1),this.positionMaterial.uniforms.pullTexture.value=this.pullRenderTarget.texture,this.renderer.render(this.pushScene,this.quadCamera,this.pushRenderTarget,!1),this.positionMaterial.uniforms.pushTexture.value=this.pushRenderTarget.texture,this.renderer.render(this.positionScene,this.quadCamera,this.outputPositionRenderTarget),this.nodes.material.uniforms.positionTexture.value=this.outputPositionRenderTarget.texture,this.edges.material.uniforms.positionTexture.value=this.outputPositionRenderTarget.texture,this.config.FDG.showFilePaths&&(this.text.material.uniforms.positionTexture.value=this.outputPositionRenderTarget.texture)}},{key:"update",value:function(){this.enabled&&(this.calculatePositions(),this.nodeGeometry.update(this.camera,this.frame),this.edgeGeometry.update(this.camera,this.frame),this.textGeometry.update(this.camera,this.frame))}},{key:"resize",value:function(){this.nodeGeometry.resize()}},{key:"initEdges",value:function(){this.setForceTextureLocations(),this.firstRun?(this.edges=this.edgeGeometry.create(2*this.nodeCount,this.pullGeometry.attributes.texLocation.array,this.nodeData,this.nodeCount,this.edgeData),this.scene.add(this.edges)):(this.edgeGeometry.setUpdated(this.nodeData,this.nodeCount,this.edges.geometry.attributes.updated.array,this.edgeData),this.edges.geometry.attributes.position.needsUpdate=!0,this.edges.geometry.attributes.texLocation.needsUpdate=!0,this.edges.geometry.attributes.updated.needsUpdate=!0)}},{key:"initNodes",value:function(){this.firstRun?(this.nodes=this.nodeGeometry.create(this.nodeData,this.nodeCount),this.scene.add(this.nodes)):(this.nodeGeometry.setTextureLocations(this.nodeData,this.nodeCount,this.nodes.geometry.attributes.position.array,this.nodes.geometry.attributes.color.array),this.nodes.geometry.attributes.position.needsUpdate=!0,this.nodes.geometry.attributes.color.needsUpdate=!0)}},{key:"initText",value:function(){if(!this.config.FDG.showFilePaths)return void(this.text&&this.scene.remove(this.text));this.text?(this.textGeometry.setAttributes(this.nodeData,this.text.geometry.attributes.labelPositions.array,this.text.geometry.attributes.textCoord.array,this.text.geometry.attributes.textureLocation.array,this.text.geometry.attributes.scale.array),this.text.geometry.attributes.labelPositions.needsUpdate=!0,this.text.geometry.attributes.textCoord.needsUpdate=!0,this.text.geometry.attributes.textureLocation.needsUpdate=!0,this.text.geometry.attributes.scale.needsUpdate=!0):(this.text=this.textGeometry.create(this.nodeData,this.nodeCount),this.scene.add(this.text))}},{key:"passThroughTexture",value:function(t,e){this.passThroughMaterial.uniforms.texture.value=t,this.renderer.render(this.passThroughScene,this.quadCamera,e)}},{key:"setPositionTextureLocations",value:function(){this.texLocationWidth=Object.keys(this.nodeData).length,this.texLocationHeight=1;for(var t=new Float32Array(this.texLocationWidth*this.texLocationHeight*2),e=0;e<Object.keys(this.nodeData).length;e++){var n=this.textureHelper.getNodeTextureLocation(e);t[2*e+0]=n.x,t[2*e+1]=n.y}var r=new i.DataTexture(t,this.texLocationWidth,this.texLocationHeight,i.LuminanceAlphaFormat,i.FloatType);return r.needsUpdate=!0,r.minFilter=i.NearestFilter,r.magFilter=i.NearestFilter,r.generateMipmaps=!1,r.flipY=!1,r}},{key:"initPositions",value:function(){var t=this.setPositionTextureLocations();this.positionMaterial?(this.positionMesh.material.uniforms.texLocation.value=t,this.positionMesh.material.defines={width:1/this.textureWidth.toFixed(2),height:1/this.textureHeight.toFixed(2),texLocationWidth:1/this.texLocationWidth.toFixed(2)},this.positionMesh.material.needsUpdate=!0):(this.positionMaterial=new i.ShaderMaterial({uniforms:{texLocation:{type:"t",value:t},positionTexture:{type:"t",value:null},pullTexture:{type:"t",value:null},pushTexture:{type:"t",value:null},sphereProject:{type:"f",value:0},sphereRadius:{type:"f",value:0}},defines:{texLocationWidth:1/this.texLocationWidth.toFixed(2),width:1/this.textureWidth.toFixed(2),height:1/this.textureHeight.toFixed(2)},vertexShader:y.a,fragmentShader:g.a}),this.positionScene=new i.Scene,this.positionMesh=new i.Mesh(new i.PlaneBufferGeometry(2,2),this.positionMaterial),this.positionScene.add(this.positionMesh))}},{key:"initForces",value:function(){if(this.firstRun){this.pullGeometry=new i.BufferGeometry;var t=new i.BufferAttribute(new Float32Array(2*this.nodeCount*3),3),e=new i.BufferAttribute(new Float32Array(2*this.nodeCount*4),4);this.pullGeometry.addAttribute("position",t),this.pullGeometry.addAttribute("texLocation",e),this.pullMaterial=new i.ShaderMaterial({uniforms:{positionTexture:{type:"t",value:null}},transparent:!0,blending:i.AdditiveBlending,depthWrite:!1,depthTest:!1,vertexShader:l.a,fragmentShader:p.a}),this.pullScene=new i.Scene,this.pullMesh=new i.Points(this.pullGeometry,this.pullMaterial),this.pullScene.add(this.pullMesh),this.pushGeometry=new i.BufferGeometry;var n=new i.BufferAttribute(new Float32Array(2*this.nodeCount*3),3);this.pushGeometry.addAttribute("position",n),this.pushGeometry.addAttribute("texLocation",e),this.pushMaterial=new i.ShaderMaterial({uniforms:{positionTexture:{type:"t",value:null}},transparent:!0,blending:i.AdditiveBlending,depthWrite:!1,depthTest:!1,vertexShader:f.a,fragmentShader:p.a}),this.pushScene=new i.Scene,this.pushMesh=new i.Points(this.pushGeometry,this.pushMaterial),this.pushScene.add(this.pushMesh)}this.pullGeometry.attributes.position.needsUpdate=!0,this.pullGeometry.attributes.texLocation.needsUpdate=!0,this.pushGeometry.attributes.position.needsUpdate=!0,this.pushGeometry.attributes.texLocation.needsUpdate=!0}},{key:"setForceTextureLocations",value:function(){for(var t=this.pullGeometry.attributes.texLocation.array,e=0;e<2*this.nodeCount*4;e+=2){var n={x:0,y:0},r={x:0,y:0};"undefined"!==typeof this.edgeData[e]&&(n=this.textureHelper.getNodeTextureLocation(this.edgeData[e])),"undefined"!==typeof this.edgeData[e+1]&&(r=this.textureHelper.getNodeTextureLocation(this.edgeData[e+1])),t[4*e+0]=n.x,t[4*e+1]=n.y,t[4*e+2]=r.x,t[4*e+3]=r.y}}},{key:"initPassThrough",value:function(){this.passThroughScene=new i.Scene,this.passThroughMaterial=new i.ShaderMaterial({uniforms:{texture:{type:"t",value:null}},vertexShader:y.a,fragmentShader:b.a});var t=new i.Mesh(new i.PlaneBufferGeometry(2,2),this.passThroughMaterial);this.passThroughScene.add(t)}}]),t}();e.a=E},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(0),o=n(6),a=n(46),s=n.n(a),u=n(47),c=n.n(u),l=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),h=function(){function t(e){r(this,t),this.config=e,this.textureHelper=new o.a,this.sprite=(new i.TextureLoader).load(this.config.FDG.nodeSpritePath),this.spriteBlur=(new i.TextureLoader).load(this.config.FDG.nodeSpritePathBlur),this.uSprite=(new i.TextureLoader).load(this.config.FDG.nodeUpdatedSpritePath),this.decayTime=0,this.material=null,this.geometry=null,this.baseScale=15e3;for(var n=0;n<this.config.FDG.colorPalette.length;n++)this.config.FDG.colorPalette[n]=new i.Color(this.config.FDG.colorPalette[n]);this.baseColor=this.config.FDG.colorPalette[0]}return l(t,[{key:"setTextureLocations",value:function(t,e,n,r){for(var i=0;i<e;i++){var o=t[i];if(o){var a=this.textureHelper.getNodeTextureLocation(i);if(n[3*i]=a.x,n[3*i+1]=a.y,this.config.FDG.cycleColors)r[4*i]=this.baseColor.r,r[4*i+1]=this.baseColor.g,r[4*i+2]=this.baseColor.b;else{if("/"===o.p){r[4*i]=this.baseColor.r,r[4*i+1]=this.baseColor.g,r[4*i+2]=this.baseColor.b,r[4*i+3]=1;continue}var s=o.p.split("/");if("f"===o.t&&1===s.length){r[4*i]=this.baseColor.r,r[4*i+1]=this.baseColor.g,r[4*i+2]=this.baseColor.b,r[4*i+3]=1;continue}var u=void 0;u="d"===o.t?s[s.length-1]:s[s.length-2];for(var c=0,l=0;l<u.length;l++)c+=u[l].charCodeAt(0);var h=c%(this.config.FDG.colorPalette.length-1),f=this.config.FDG.colorPalette[h];r[4*i+0]=f.r,r[4*i+1]=f.g,r[4*i+2]=f.b}o.u?r[4*i+3]=0:r[4*i+3]+=this.config.FDG.colorCooldownSpeed}else n[3*i]=99999,n[3*i+1]=99999,r[4*i]=0,r[4*i+1]=0,r[4*i+2]=0,r[4*i+3]=0}}},{key:"create",value:function(t,e){this.textureHelper.setTextureSize(e),this.geometry&&this.geometry.dispose(),this.geometry=new i.BufferGeometry;var n=new Float32Array(3*e),r=new Float32Array(4*e);this.setTextureLocations(t,e,n,r);var o=new i.BufferAttribute(n,3),a=new i.BufferAttribute(r,4);this.geometry.addAttribute("position",o),this.geometry.addAttribute("color",a);for(var u=new Float32Array(e),l=0;l<u.length;l++)u[l]=l;var h=new i.BufferAttribute(u,1);return this.geometry.addAttribute("id",h),this.material||(this.material=new i.ShaderMaterial({uniforms:{camDistToCenter:{type:"f",value:null},cycleColors:{type:"f",value:this.config.cycleColors?1:0},map:{type:"t",value:this.sprite},mapBlur:{type:"t",value:this.spriteBlur},uMap:{type:"t",value:this.uSprite},decayTime:{type:"f",value:null},uTime:{type:"f",value:null},positionTexture:{type:"t",value:null},scale:{type:"f",value:this.baseScale}},transparent:!0,blending:i.AdditiveBlending,depthWrite:!1,depthTest:!1,vertexShader:c.a,fragmentShader:s.a})),this.resize(),this.nodes=new i.Points(this.geometry,this.material),this.nodes}},{key:"setDecayTime",value:function(t){this.decayTime=t}},{key:"resize",value:function(){this.material&&(this.material.uniforms.scale.value=this.baseScale*(.001*Math.min(this.config.scene.width,this.config.scene.height)))}},{key:"update",value:function(t,e){this.decayTime++,this.material.uniforms.decayTime.value=this.decayTime,this.material.uniforms.uTime.value=e;var n=t.getWorldPosition(new i.Vector3),r=new i.Vector3(0,0,0);this.material.uniforms.camDistToCenter.value=n.distanceTo(r)}}]),t}();e.a=h},function(t,e){t.exports="#define GLSLIFY 1\nuniform sampler2D map;\nuniform sampler2D mapBlur;\nuniform sampler2D uMap;\nuniform float cycleColors;\n\nvarying float vDecay;\nvarying vec4 vColor;\nvarying float vActive;\nvarying float vDist;\nvarying float vSpriteMix;\n\nvoid main() {\n\n  if (vActive == 0.) {\n    gl_FragColor = vec4(0.);\n  } else {\n    vec4 sprite = vec4(1.);\n    vec4 spriteBlur = vec4(1.);\n    if (vDecay > 0.) {\n      sprite = texture2D(uMap, vec2(gl_PointCoord.x, 1. - gl_PointCoord.y));\n      spriteBlur = texture2D(uMap, vec2(gl_PointCoord.x, 1. - gl_PointCoord.y));\n    } else {\n      sprite = texture2D(map, vec2(gl_PointCoord.x, 1. - gl_PointCoord.y));\n      spriteBlur = texture2D(mapBlur, vec2(gl_PointCoord.x, 1. - gl_PointCoord.y));\n    }\n\n    vec4 diffuse = mix(sprite, spriteBlur, vSpriteMix);\n\n    // if (cycleColors == 1.0) {\n    //   if (vColor.a > 1.) {\n    //     float amount = min(1., vColor.a - 1.);\n    //     sprite.rgb = mix(vec3(.09, .274, .627), vec3(.7, .7, .7), amount);\n    //   } else {\n    //     sprite.rgb = mix(vColor.rgb, vec3(.09, .274, .627), vColor.a);\n    //   }\n    // } else {\n      diffuse.rgb = vColor.rgb;\n    //}\n\n    diffuse.rgb += vDecay;\n\n    diffuse.a = mix(diffuse.a, diffuse.a * (vDist * 0.005), vSpriteMix * 1.0);\n    diffuse.a = clamp(diffuse.a, 0.0, 1.0);\n\n    gl_FragColor = vec4(diffuse.rgb, diffuse.a);\n  }\n}\n"},function(t,e){t.exports="#define GLSLIFY 1\nuniform sampler2D positionTexture;\nuniform float uTime;\nuniform float decayTime;\nuniform float scale;\nuniform float cycleColors;\nuniform float camDistToCenter;\n\nattribute float id;\nattribute vec4 color;\n\nvarying vec4 vColor;\nvarying float vDecay;\nvarying float vActive;\nvarying float vDist;\nvarying float vDistSq;\nvarying float vSpriteMix;\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvoid main() {\n    vColor = color;\n\n    // if color is black, node is inactive\n    if (vColor.r == 0.) {\n\n        vActive = 0.;\n\n        gl_PointSize = 0.;\n        gl_Position = vec4(0.);\n\n    } else {\n\n        vActive = 1.;\n\n        vec3 currentPosition = texture2D(positionTexture, position.xy).xyz;\n\n        if (id == 0.0) {\n            currentPosition = vec3(0.);\n        }\n\n        vec4 mvPosition = modelViewMatrix * vec4(currentPosition, 1.);\n\n        if (vColor.a == 0.) {\n            vDecay = 1. - (decayTime * 0.05);\n            vDecay = max(0.0, vDecay);\n        }\n        \n        float decayScale = scale * ((vDecay * 0.75) + 1.0);\n\n        vDist = decayScale / length(mvPosition.xyz);\n        vDistSq = decayScale / dot(mvPosition.xyz, mvPosition.xyz);\n\n        float dofAmount = map(camDistToCenter, 0., 1000., 1., 0.);\n\n        vSpriteMix = (1.0 - clamp(pow(vDistSq, 4.0), 0.0, 1.0)) * dofAmount;\n\n        float scaledTime = uTime * 0.005;\n        if (scaledTime < 1.) {\n            vSpriteMix += (1.0 - scaledTime);\n        }\n\n        vSpriteMix = clamp(vSpriteMix, 0., 1.);\n\n        gl_PointSize = vDist;\n        gl_Position = projectionMatrix * mvPosition;\n    }\n}"},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(0),o=n(49),a=n.n(o),s=n(50),u=n.n(s),c=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),l=function(){function t(e){r(this,t),this.config=e,this.material=null,this.geometry=null}return c(t,[{key:"setUpdated",value:function(t,e,n,r){if(this.config.FDG.cycleColors)for(var i=0;i<2*e;i+=2){var o=t[r[i]],a=t[r[i+1]];o||(n[2*i+0]=0),a||(n[2*i+1]=0),o&&o.u?n[2*i+0]=0:n[2*i+0]<2&&(n[2*i+0]+=this.config.FDG.colorCooldownSpeed),a&&a.u?n[2*i+1]=0:n[2*i+1]<2&&(n[2*i+1]+=this.config.FDG.colorCooldownSpeed)}}},{key:"create",value:function(t,e,n,r,o){this.geometry&&this.geometry.dispose(),this.geometry=new i.BufferGeometry;var s=new Float32Array(2*t);this.setUpdated(n,r,s,o);var c=new i.BufferAttribute(s,1);this.geometry.addAttribute("updated",c);var l=new i.BufferAttribute(e,2);this.geometry.addAttribute("texLocation",l);var h=new i.BufferAttribute(new Float32Array(2*t*3),3);return this.geometry.addAttribute("position",h),this.material||(this.material=new i.ShaderMaterial({uniforms:{camDistToCenter:{type:"f",value:null},cycleColors:{type:"f",value:this.config.cycleColors?1:0},positionTexture:{type:"t",value:null},uTime:{type:"f",value:null}},transparent:!0,depthWrite:!0,depthTest:!0,vertexShader:u.a,fragmentShader:a.a})),this.edges=new i.LineSegments(this.geometry,this.material),this.edges}},{key:"update",value:function(t,e){var n=t.getWorldPosition(new i.Vector3),r=new i.Vector3(0,0,0);this.material.uniforms.camDistToCenter.value=n.distanceTo(r),this.material.uniforms.uTime.value=e}}]),t}();e.a=l},function(t,e){t.exports="#define GLSLIFY 1\nuniform float cycleColors;\n\nvarying float vAlpha;\nvarying float vUpdated;\n\nvoid main(){\n\n  vec3 color = vec3(1.);\n\n  /*if (cycleColors == 1.0) {\n    if (vUpdated > 1.) {\n      float amount = min(1., vUpdated - 1.);\n      color = mix(vec3(.09, .274, .627), vec3(.7, .7, .7), amount);\n    } else {\n      color = mix(vec3(0.921, 0.133, 0.337), vec3(.09, .274, .627), vUpdated);\n    }\n  }*/\n\n  float a = vAlpha;\n\n  gl_FragColor = vec4(color, a);\n}"},function(t,e){t.exports="#define GLSLIFY 1\nuniform sampler2D positionTexture;\nuniform float camDistToCenter;\nuniform float uTime;\n\nattribute float updated;\nattribute vec2 texLocation;\n\nvarying float vAlpha;\nvarying float vUpdated;\n\nfloat map(float value, float inMin, float inMax, float outMin, float outMax) {\n  return outMin + (outMax - outMin) * (value - inMin) / (inMax - inMin);\n}\n\nvoid main() {\n  vec4 currentPosition = vec4(texture2D(positionTexture, texLocation.xy));\n\n  // node index stored in w component (2.0 is root)\n  if (currentPosition.w == 2.0) {\n    currentPosition.xyz = vec3(0.);\n  }\n\n  vUpdated = updated;\n\n  currentPosition.w = 1.0;\n\n  vec4 mvPosition = modelViewMatrix * currentPosition;\n\n  vAlpha = 2000.0 / dot(mvPosition.xyz, mvPosition.xyz);\n\n  float dofAmount = clamp(map(camDistToCenter, 0., 800., 0., 1.), 0., 1.);\n\n  float scaledTime = uTime * 0.0025;\n  if (scaledTime < 1.) {\n    vAlpha -= (1.0 - scaledTime);\n  }\n\n  vAlpha = mix(vAlpha, .15, dofAmount);\n\n  gl_Position = projectionMatrix * mvPosition;\n}"},function(t,e,n){"use strict";function r(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var i=n(0),o=n(6),a=n(52),s=n.n(a),u=n(53),c=n.n(u),l=n(54),h=function(){function t(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}return function(e,n,r){return n&&t(e.prototype,n),r&&t(e,r),e}}(),f=function(){function t(e){r(this,t),this.config=e,this.textureHelper=new o.a,this.font=Object(l.a)(this.config.FDG.fontTexturePath),this.fontSize=15,this.kerning=1.5,this.textureSize=1024,this.material=null,this.geometry=null}return h(t,[{key:"setAttributes",value:function(t,e,n,r,i){for(var o=0,a=0;a<n.length;a++)n[a]=0;for(var s in t)if(t.hasOwnProperty(s)){var u=t[s],c=u.p.split("/"),l=c[c.length-1];"/"===u.p&&(l=this.config.git.repo),l.length>this.config.FDG.filePathCharLimit&&(l=l.substr(0,this.config.FDG.filePathCharLimit)+"..");for(var h=0;h<l.length;h++){var f=l[h],d=this.getCharCoordinates(f);if(d){i[2*o+0]=d.width*this.fontSize,i[2*o+1]=d.height*this.fontSize;var p=h*this.kerning;e[2*o+0]=p,e[2*o+1]=d.yOffset*this.fontSize;var m=this.textureHelper.getNodeTextureLocation(s);r[2*o+0]=m.x,r[2*o+1]=m.y,n[4*o+0]=d.left,n[4*o+1]=d.top,n[4*o+2]=d.width,n[4*o+3]=d.height,o++}}}}},{key:"create",value:function(t,e){this.textureHelper.setTextureSize(e),this.geometry&&this.geometry.dispose(),this.geometry=(new i.InstancedBufferGeometry).copy(new i.PlaneBufferGeometry(1,1));var n=new Float32Array(20*e),r=new Float32Array(20*e),o=new Float32Array(2*e*20),a=new Float32Array(20*e);this.setAttributes(t,r,o,a,n);var u=new i.InstancedBufferAttribute(n,2),l=new i.InstancedBufferAttribute(o,4),h=new i.InstancedBufferAttribute(r,2),f=new i.InstancedBufferAttribute(a,2);return this.geometry.addAttribute("scale",u),this.geometry.addAttribute("labelPositions",h),this.geometry.addAttribute("textCoord",l),this.geometry.addAttribute("textureLocation",f),this.material||(this.material=new i.ShaderMaterial({uniforms:{fontTexture:{type:"t",value:this.font.texture},positionTexture:{type:"t",value:null},uTime:{type:"f",value:null}},vertexShader:c.a,fragmentShader:s.a,blending:i.AdditiveBlending,depthTest:!1,transparent:!0})),this.text=new i.Mesh(this.geometry,this.material),this.text}},{key:"getCharCoordinates",value:function(t){var e=t.charCodeAt(0);if("undefined"===typeof this.font[e])return null;var n=this.font[e];return{left:n[0]/this.textureSize,top:n[1]/this.textureSize,width:n[2]/this.textureSize,height:n[3]/this.textureSize,xOffset:n[4]/this.textureSize,yOffset:n[5]/this.textureSize}}},{key:"update",value:function(t,e){this.material.uniforms.uTime.value=e}}]),t}();e.a=f},function(t,e){t.exports="#define GLSLIFY 1\nuniform sampler2D fontTexture;\n\nvarying vec4 vTextCoord;\nvarying vec2 vUv;\nvarying vec4 vColor;\n\nvoid main(){\n\n  if (vColor.a < 0.1) {\n    discard;\n  }\n\n  float x = vTextCoord.x + vUv.x * vTextCoord.z;\n  float y = vTextCoord.y + (1. - vUv.y) * vTextCoord.w;\n  vec4 color = texture2D(fontTexture, vec2(x,y));\n\n  color *= vColor;\n\n  gl_FragColor = color;\n}"},function(t,e){t.exports="#define GLSLIFY 1\nuniform sampler2D positionTexture;\nuniform float uTime;\n\nattribute vec2 labelPositions;\nattribute vec4 textCoord;\nattribute vec2 textureLocation;\nattribute vec2 scale;\n\nvarying vec2 vUv;\nvarying vec4 vTextCoord;\nvarying vec4 vColor;\n\nvoid main(){\n    vUv = uv;\n    vTextCoord = textCoord;\n    vec3 currentPosition = texture2D(positionTexture, textureLocation).xyz;\n    vec4 meshPosition = modelViewMatrix * vec4(currentPosition, 1.) + vec4(position.xy, 0., 0.) * vec4(scale.xy, 0., 0.);\n    meshPosition.x += labelPositions.x;\n    meshPosition.y += labelPositions.y * 0.5;\n    meshPosition.x += 3.5;\n    meshPosition.y -= 0.9;\n\n    vColor = vec4(1.);\n    vColor.a = 40000. / dot(meshPosition.xyz, meshPosition.xyz);\n\n    float scaledTime = uTime * 0.0025;\n    if (scaledTime < 1.) {\n        vColor.a -= (1.0 - scaledTime);\n    }\n\n    vColor.a = clamp(vColor.a, 0.0, 1.0);\n\n    gl_Position = projectionMatrix * meshPosition;\n}"},function(t,e,n){"use strict";var r=n(0),i=function(t){var e=(new r.TextureLoader).load(t);return e.flipY=!1,e.repeat.set(1,1),{texture:e,0:[1016,972,4,4,-1.5,1.5],8:[1016,968,4,4,-1.5,1.5],9:[1016,964,4,4,-1.5,1.5],13:[1016,960,4,4,-1.5,1.5],29:[1016,956,4,4,-1.5,1.5],32:[1016,952,4,4,-1.5,1.5],33:[719,0,25,105,27.625,101.188],34:[745,966,42,44,19.25,110.875],35:[745,631,75,103,2.875,101.188],36:[271,0,67,131,7.188,113.125],37:[458,0,78,107,1.375,103.313],38:[609,421,75,107,3.5,103.5],39:[787,966,17,47,31.813,110.875],40:[538,780,48,143,16.688,114.438],41:[538,637,48,143,16.688,114.438],42:[678,961,66,63,7.688,101.188],43:[734,107,69,74,5.875,79.125],44:[771,27,36,49,22.438,23.875],45:[538,1005,39,16,21.063,48.688],46:[842,990,27,28,27,24.188],47:[209,0,62,143,9.563,114.125],48:[609,751,69,108,5.875,103.5],49:[664,210,62,103,10.5,101.188],50:[884,313,66,106,7.688,103.5],51:[751,313,65,108,7.938,103.5],52:[944,734,73,103,4.313,101.188],53:[458,726,64,105,9.063,101.188],54:[891,421,67,106,7.188,101.563],55:[538,534,67,103,8.625,101.25],56:[609,859,68,108,6.688,103.5],57:[678,855,67,106,6.688,103.438],58:[744,0,27,80,27,76.188],59:[988,107,36,101,18.625,76.188],60:[877,955,69,68,6.375,74.625],61:[609,967,69,46,5.875,64.813],62:[947,952,69,68,6.375,74.625],63:[536,0,55,107,13.313,103.438],64:[75,0,72,127,4.938,103.438],65:[458,107,81,103,-.063,101.188],66:[684,313,67,105,7.188,102],67:[877,847,70,108,5.875,103.5],68:[684,421,69,105,7.188,102.188],69:[539,210,60,103,13.125,101.188],70:[963,631,60,103,13.125,101.188],71:[609,643,69,108,5.875,103.5],72:[895,528,70,103,5.75,101.188],73:[966,528,54,103,12.813,101.188],74:[458,831,62,105,7.188,101.188],75:[820,631,72,103,8.813,101.188],76:[601,210,63,103,13.125,101.188],77:[825,528,70,103,5.438,101.188],78:[458,416,66,103,7.375,101.188],79:[609,313,75,108,3.188,103.5],80:[458,622,65,104,10.25,102],81:[0,0,75,132,3.188,103.313],82:[822,421,69,104,7.375,102],83:[678,747,66,108,7.313,103.5],84:[892,631,71,103,4.75,101.188],85:[753,421,69,105,6.25,101.25],86:[458,313,80,103,.563,101.188],87:[754,528,71,103,5.438,101.188],88:[678,528,76,103,2.5,101.188],89:[458,210,80,103,.563,101.188],90:[816,313,68,103,7.188,101.188],91:[398,143,42,143,21.5,114.125],92:[147,0,62,143,9.75,114.125],93:[398,286,42,143,17.438,114.125],94:[648,0,71,58,4.938,101.188],95:[807,27,81,15,-.188,-13.813],96:[811,990,31,32,24.688,113.125],97:[607,107,64,82,7.813,78],98:[745,734,66,117,9.938,113.125],99:[539,107,68,82,6.375,78.063],100:[811,734,66,117,4.938,113.125],101:[947,210,70,82,4.938,78],102:[538,313,71,115,8.625,113.125],103:[958,421,66,107,4.938,55],104:[745,851,62,115,9.938,113.125],105:[880,735,63,112,7.188,109.438],106:[811,851,54,139,9.938,109.375],107:[609,528,69,115,9.938,113.188],108:[679,631,66,116,7.188,112.313],109:[875,210,72,80,5.125,77.813],110:[865,107,62,80,9.938,77.875],111:[538,923,71,82,4.938,78.063],112:[950,313,66,106,9.938,50],113:[538,428,66,106,4.938,77.875],114:[591,0,57,80,15.75,77.875],115:[671,107,63,82,9.063,78],116:[458,519,66,103,8.625,99.5],117:[803,107,62,80,9.438,76.25],118:[801,210,74,78,3.313,76.25],119:[458,936,78,78,1.5,76.25],120:[726,210,75,78,3.125,76.25],121:[947,847,72,105,4.25,55],122:[927,107,61,78,10.25,76.25],123:[398,0,60,143,11.188,114.125],124:[586,780,16,143,32.625,114.063],125:[338,0,60,143,10.25,114.125],126:[771,0,72,27,4.438,55.813]}};e.a=i},function(t,e){t.exports="#define GLSLIFY 1\nuniform sampler2D positionTexture;\n\nattribute vec4 texLocation;\n\n\nvarying vec3 vForce;\n\nvoid main() {\n  vec3 pos1 = texture2D(positionTexture, texLocation.xy).xyz;\n  vec3 pos2 = texture2D(positionTexture, texLocation.zw).xyz;\n\n  gl_PointSize = 1.;\n\n  vec3 dist = (pos2 - pos1);\n  vForce = dist * 0.01;\n  gl_Position = vec4(texLocation.x * 2. - 1., texLocation.y * 2. - 1., 0., 1.);\n  \n}"},function(t,e){t.exports="#define GLSLIFY 1\nuniform sampler2D positionTexture;\n\nattribute vec4 texLocation;\n\nvarying vec3 vForce;\n\nvoid main() {\n  vec3 pos1 = texture2D(positionTexture, texLocation.xy).xyz;\n  vec3 pos2 = texture2D(positionTexture, texLocation.zw).xyz;\n\n  gl_PointSize = 1.;\n\n  vec3 dist = (pos1 - pos2);\n  vForce = dist * 0.005;\n  gl_Position = vec4(texLocation.z * 2. - 1., texLocation.w * 2. - 1., 0., 1.);\n}"},function(t,e){t.exports="#define GLSLIFY 1\nvarying vec3 vForce;\n\nvoid main() {\n  gl_FragColor = vec4(vForce, 2.);\n}"},function(t,e){t.exports="#define GLSLIFY 1\nvarying vec2 vUv;\n\nuniform float sphereProject;\nuniform float sphereRadius;\n\nuniform sampler2D texLocation;\nuniform sampler2D positionTexture;\nuniform sampler2D pullTexture;\nuniform sampler2D pushTexture;\n\nvec3 getRepelForce (vec4 currentPosition) {\n    vec3 repelForce = vec3(0.);\n \n    for (float x = 0.0; x < 1.0; x += texLocationWidth) {\n\n      vec4 texPos = texture2D(texLocation, vec2(x, 0));\n\n      /*vec4 otherPosition = texture2D(positionTexture, vec2(texPos.x, texPos.y));\n      vec3 diff = currentPosition.xyz - otherPosition.xyz;\n      float magnitude = length(diff);\n      repelForce += (diff / (magnitude * magnitude * magnitude + 1.));*/\n\n      vec4 otherPosition2 = texture2D(positionTexture, vec2(texPos.z, texPos.w));\n      vec3 diff2 = currentPosition.xyz - otherPosition2.xyz;\n      float magnitude2 = length(diff2);\n      repelForce += (diff2 / (magnitude2 * magnitude2 * magnitude2 + 1.));\n\n    }\n\n    return repelForce;\n}\n\nvoid main() {\n  vec4 currentPosition = texture2D(positionTexture, vUv);\n\n  vec3 newPos = vec3(0.);\n\n  if (currentPosition.w == 2.0) {\n\n    gl_FragColor = vec4(vec3(0.), 2.);\n\n  } else {\n   \n      // repel this particle away from other particles\n      vec3 repelForce = getRepelForce(currentPosition);\n\n      vec3 pullForce = texture2D(pullTexture, vUv).xyz;\n      vec3 pushForce = texture2D(pushTexture, vUv).xyz;\n\n      vec3 edgeForce = (pullForce + pushForce);\n\n      vec3 force = edgeForce + repelForce * 100.;\n\n      newPos = currentPosition.xyz + force;\n\n      vec3 finalPos = mix(currentPosition.xyz, newPos, 0.5);\n      if (sphereProject == 1.0) {\n        finalPos = normalize(finalPos) * sphereRadius;\n      }\n\n      gl_FragColor = vec4(finalPos, 1.);\n\n  }\n\n}"},function(t,e){t.exports="#define GLSLIFY 1\nvarying vec2 vUv;\n\nvoid main() {\n  vUv = uv;\n  gl_Position = vec4(position, 1.);\n}"},function(t,e){t.exports="#define GLSLIFY 1\nuniform sampler2D texture;\nvarying vec2 vUv;\n\nvoid main() {\n  gl_FragColor = texture2D(texture, vUv);\n}"},function(t,e,n){"use strict";var r=function(t){function e(t,e){return t<<e|t>>>32-e}function n(t,e){var n,r,i,o,a;return i=2147483648&t,o=2147483648&e,n=1073741824&t,r=1073741824&e,a=(1073741823&t)+(1073741823&e),n&r?2147483648^a^i^o:n|r?1073741824&a?3221225472^a^i^o:1073741824^a^i^o:a^i^o}function r(t,e,n){return t&e|~t&n}function i(t,e,n){return t&n|e&~n}function o(t,e,n){return t^e^n}function a(t,e,n){return e^(t|~n)}function s(t,i,o,a,s,u,c){return t=n(t,n(n(r(i,o,a),s),c)),n(e(t,u),i)}function u(t,r,o,a,s,u,c){return t=n(t,n(n(i(r,o,a),s),c)),n(e(t,u),r)}function c(t,r,i,a,s,u,c){return t=n(t,n(n(o(r,i,a),s),c)),n(e(t,u),r)}function l(t,r,i,o,s,u,c){return t=n(t,n(n(a(r,i,o),s),c)),n(e(t,u),r)}function h(t){var e,n,r="",i="";for(n=0;n<=3;n++)e=t>>>8*n&255,i="0"+e.toString(16),r+=i.substr(i.length-2,2);return r}var f,d,p,m,g,v,y,_,b,w=[];for(t=function(t){t=t.replace(/rn/g,"n");for(var e="",n=0;n<t.length;n++){var r=t.charCodeAt(n);r<128?e+=String.fromCharCode(r):r>127&&r<2048?(e+=String.fromCharCode(r>>6|192),e+=String.fromCharCode(63&r|128)):(e+=String.fromCharCode(r>>12|224),e+=String.fromCharCode(r>>6&63|128),e+=String.fromCharCode(63&r|128))}return e}(t),w=function(t){for(var e,n=t.length,r=n+8,i=(r-r%64)/64,o=16*(i+1),a=Array(o-1),s=0,u=0;u<n;)e=(u-u%4)/4,s=u%4*8,a[e]=a[e]|t.charCodeAt(u)<<s,u++;return e=(u-u%4)/4,s=u%4*8,a[e]=a[e]|128<<s,a[o-2]=n<<3,a[o-1]=n>>>29,a}(t),v=1732584193,y=4023233417,_=2562383102,b=271733878,f=0;f<w.length;f+=16)d=v,p=y,m=_,g=b,v=s(v,y,_,b,w[f+0],7,3614090360),b=s(b,v,y,_,w[f+1],12,3905402710),_=s(_,b,v,y,w[f+2],17,606105819),y=s(y,_,b,v,w[f+3],22,3250441966),v=s(v,y,_,b,w[f+4],7,4118548399),b=s(b,v,y,_,w[f+5],12,1200080426),_=s(_,b,v,y,w[f+6],17,2821735955),y=s(y,_,b,v,w[f+7],22,4249261313),v=s(v,y,_,b,w[f+8],7,1770035416),b=s(b,v,y,_,w[f+9],12,2336552879),_=s(_,b,v,y,w[f+10],17,4294925233),y=s(y,_,b,v,w[f+11],22,2304563134),v=s(v,y,_,b,w[f+12],7,1804603682),b=s(b,v,y,_,w[f+13],12,4254626195),_=s(_,b,v,y,w[f+14],17,2792965006),y=s(y,_,b,v,w[f+15],22,1236535329),v=u(v,y,_,b,w[f+1],5,4129170786),b=u(b,v,y,_,w[f+6],9,3225465664),_=u(_,b,v,y,w[f+11],14,643717713),y=u(y,_,b,v,w[f+0],20,3921069994),v=u(v,y,_,b,w[f+5],5,3593408605),b=u(b,v,y,_,w[f+10],9,38016083),_=u(_,b,v,y,w[f+15],14,3634488961),y=u(y,_,b,v,w[f+4],20,3889429448),v=u(v,y,_,b,w[f+9],5,568446438),b=u(b,v,y,_,w[f+14],9,3275163606),_=u(_,b,v,y,w[f+3],14,4107603335),y=u(y,_,b,v,w[f+8],20,1163531501),v=u(v,y,_,b,w[f+13],5,2850285829),b=u(b,v,y,_,w[f+2],9,4243563512),_=u(_,b,v,y,w[f+7],14,1735328473),y=u(y,_,b,v,w[f+12],20,2368359562),v=c(v,y,_,b,w[f+5],4,4294588738),b=c(b,v,y,_,w[f+8],11,2272392833),_=c(_,b,v,y,w[f+11],16,1839030562),y=c(y,_,b,v,w[f+14],23,4259657740),v=c(v,y,_,b,w[f+1],4,2763975236),b=c(b,v,y,_,w[f+4],11,1272893353),_=c(_,b,v,y,w[f+7],16,4139469664),y=c(y,_,b,v,w[f+10],23,3200236656),v=c(v,y,_,b,w[f+13],4,681279174),b=c(b,v,y,_,w[f+0],11,3936430074),_=c(_,b,v,y,w[f+3],16,3572445317),y=c(y,_,b,v,w[f+6],23,76029189),v=c(v,y,_,b,w[f+9],4,3654602809),b=c(b,v,y,_,w[f+12],11,3873151461),_=c(_,b,v,y,w[f+15],16,530742520),y=c(y,_,b,v,w[f+2],23,3299628645),v=l(v,y,_,b,w[f+0],6,4096336452),b=l(b,v,y,_,w[f+7],10,1126891415),_=l(_,b,v,y,w[f+14],15,2878612391),y=l(y,_,b,v,w[f+5],21,4237533241),v=l(v,y,_,b,w[f+12],6,1700485571),b=l(b,v,y,_,w[f+3],10,2399980690),_=l(_,b,v,y,w[f+10],15,4293915773),y=l(y,_,b,v,w[f+1],21,2240044497),v=l(v,y,_,b,w[f+8],6,1873313359),b=l(b,v,y,_,w[f+15],10,4264355552),_=l(_,b,v,y,w[f+6],15,2734768916),y=l(y,_,b,v,w[f+13],21,1309151649),v=l(v,y,_,b,w[f+4],6,4149444226),b=l(b,v,y,_,w[f+11],10,3174756917),_=l(_,b,v,y,w[f+2],15,718787259),y=l(y,_,b,v,w[f+9],21,3951481745),v=n(v,d),y=n(y,p),_=n(_,m),b=n(b,g);return(h(v)+h(y)+h(_)+h(b)).toLowerCase()};e.a=r},function(t,e){},function(module,exports,__webpack_require__){function mixin(t,e){var n=t;if(t.constructors){for(var r in t.constructors)if(t.constructors[r]===e)return t;t.constructors.unshift(e)}else t.constructors=[e,t],n=t.prototype.constructor=mixin_constructor(t.name,t),n.__proto__=t;if(n.prototype=insert_proto(t.prototype,e.prototype),insert_proto(n.__proto__,e),e.hasOwnProperty("included")){var i=e.included.call(e,n);i&&(n=i)}return n}function mixin_constructor(name,ctor){var str="function __ctor() { var c = ctor.constructors; for (var i in c) { c[i].apply(this, arguments); } }";return eval(str.replace(/__ctor/,name)),eval(name)}function insert_proto(t,e){var n=copyInto({},e);n.__mixed_in=!0;for(var r=t,i=t;r.__mixed_in;i=r,r=r.__proto__);return r==t&&(r.__mixed_in=!0),n.__proto__=i.__proto__,i.__proto__=n,t}function copyInto(t,e){var n=Object.getOwnPropertyNames(e);for(var r in n){var i=n[r];if("prototype"!==i){var o=Object.getOwnPropertyDescriptor(e,i);Object.defineProperty(t,i,o)}}return t}function inspect_protos(t,e){console.log(e+" = "+util.inspect(t));for(var n=0;t.__proto__;)t=t.__proto__,console.log("  __proto__["+n+"] = "+util.inspect(t)),++n}function alias(t,e,n,r){if(t[e+"_without_"+n])throw e+"_without_"+n+" already defined.";var i=t[e];t[e+"_without_"+n]=i,t[e+"_with_"+n]=t[e]=r}var util=__webpack_require__(64);mixin.copyInto=copyInto,mixin.alias=alias,module.exports=mixin},function(t,e,n){(function(t,r){function i(t,n){var r={seen:[],stylize:a};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),m(n)?r.showHidden=n:n&&e._extend(r,n),w(r.showHidden)&&(r.showHidden=!1),w(r.depth)&&(r.depth=2),w(r.colors)&&(r.colors=!1),w(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),u(r,t,r.depth)}function o(t,e){var n=i.styles[e];return n?"\x1b["+i.colors[n][0]+"m"+t+"\x1b["+i.colors[n][1]+"m":t}function a(t,e){return t}function s(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function u(t,n,r){if(t.customInspect&&n&&C(n.inspect)&&n.inspect!==e.inspect&&(!n.constructor||n.constructor.prototype!==n)){var i=n.inspect(r,t);return _(i)||(i=u(t,i,r)),i}var o=c(t,n);if(o)return o;var a=Object.keys(n),m=s(a);if(t.showHidden&&(a=Object.getOwnPropertyNames(n)),S(n)&&(a.indexOf("message")>=0||a.indexOf("description")>=0))return l(n);if(0===a.length){if(C(n)){var g=n.name?": "+n.name:"";return t.stylize("[Function"+g+"]","special")}if(E(n))return t.stylize(RegExp.prototype.toString.call(n),"regexp");if(T(n))return t.stylize(Date.prototype.toString.call(n),"date");if(S(n))return l(n)}var v="",y=!1,b=["{","}"];if(p(n)&&(y=!0,b=["[","]"]),C(n)){v=" [Function"+(n.name?": "+n.name:"")+"]"}if(E(n)&&(v=" "+RegExp.prototype.toString.call(n)),T(n)&&(v=" "+Date.prototype.toUTCString.call(n)),S(n)&&(v=" "+l(n)),0===a.length&&(!y||0==n.length))return b[0]+v+b[1];if(r<0)return E(n)?t.stylize(RegExp.prototype.toString.call(n),"regexp"):t.stylize("[Object]","special");t.seen.push(n);var w;return w=y?h(t,n,r,m,a):a.map(function(e){return f(t,n,r,m,e,y)}),t.seen.pop(),d(w,v,b)}function c(t,e){if(w(e))return t.stylize("undefined","undefined");if(_(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return y(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}function l(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i){for(var o=[],a=0,s=e.length;a<s;++a)P(e,String(a))?o.push(f(t,e,n,r,String(a),!0)):o.push("");return i.forEach(function(i){i.match(/^\d+$/)||o.push(f(t,e,n,r,i,!0))}),o}function f(t,e,n,r,i,o){var a,s,c;if(c=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},c.get?s=c.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):c.set&&(s=t.stylize("[Setter]","special")),P(r,i)||(a="["+i+"]"),s||(t.seen.indexOf(c.value)<0?(s=g(n)?u(t,c.value,null):u(t,c.value,n-1),s.indexOf("\n")>-1&&(s=o?s.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+s.split("\n").map(function(t){return"   "+t}).join("\n"))):s=t.stylize("[Circular]","special")),w(a)){if(o&&i.match(/^\d+$/))return s;a=JSON.stringify(""+i),a.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(a=a.substr(1,a.length-2),a=t.stylize(a,"name")):(a=a.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),a=t.stylize(a,"string"))}return a+": "+s}function d(t,e,n){var r=0;return t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0)>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function p(t){return Array.isArray(t)}function m(t){return"boolean"===typeof t}function g(t){return null===t}function v(t){return null==t}function y(t){return"number"===typeof t}function _(t){return"string"===typeof t}function b(t){return"symbol"===typeof t}function w(t){return void 0===t}function E(t){return x(t)&&"[object RegExp]"===A(t)}function x(t){return"object"===typeof t&&null!==t}function T(t){return x(t)&&"[object Date]"===A(t)}function S(t){return x(t)&&("[object Error]"===A(t)||t instanceof Error)}function C(t){return"function"===typeof t}function M(t){return null===t||"boolean"===typeof t||"number"===typeof t||"string"===typeof t||"symbol"===typeof t||"undefined"===typeof t}function A(t){return Object.prototype.toString.call(t)}function I(t){return t<10?"0"+t.toString(10):t.toString(10)}function R(){var t=new Date,e=[I(t.getHours()),I(t.getMinutes()),I(t.getSeconds())].join(":");return[t.getDate(),k[t.getMonth()],e].join(" ")}function P(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var N=/%[sdj%]/g;e.format=function(t){if(!_(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,o=r.length,a=String(t).replace(N,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(t){return"[Circular]"}default:return t}}),s=r[n];n<o;s=r[++n])g(s)||!x(s)?a+=" "+s:a+=" "+i(s);return a},e.deprecate=function(n,i){function o(){if(!a){if(r.throwDeprecation)throw new Error(i);r.traceDeprecation?console.trace(i):console.error(i),a=!0}return n.apply(this,arguments)}if(w(t.process))return function(){return e.deprecate(n,i).apply(this,arguments)};if(!0===r.noDeprecation)return n;var a=!1;return o};var D,O={};e.debuglog=function(t){if(w(D)&&(D=Object({NODE_ENV:"production",PUBLIC_URL:""}).NODE_DEBUG||""),t=t.toUpperCase(),!O[t])if(new RegExp("\\b"+t+"\\b","i").test(D)){var n=r.pid;O[t]=function(){var r=e.format.apply(e,arguments);console.error("%s %d: %s",t,n,r)}}else O[t]=function(){};return O[t]},e.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},e.isArray=p,e.isBoolean=m,e.isNull=g,e.isNullOrUndefined=v,e.isNumber=y,e.isString=_,e.isSymbol=b,e.isUndefined=w,e.isRegExp=E,e.isObject=x,e.isDate=T,e.isError=S,e.isFunction=C,e.isPrimitive=M,e.isBuffer=n(65);var k=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e.log=function(){console.log("%s - %s",R(),e.format.apply(e,arguments))},e.inherits=n(66),e._extend=function(t,e){if(!e||!x(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(e,n(1),n(7))},function(t,e){t.exports=function(t){return t&&"object"===typeof t&&"function"===typeof t.copy&&"function"===typeof t.fill&&"function"===typeof t.readUInt8}},function(t,e){"function"===typeof Object.create?t.exports=function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:t.exports=function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},function(t,e,n){(function(t){!function(e,n){t.exports=n()}(0,function(){"use strict";function e(){return Mr.apply(null,arguments)}function n(t){return t instanceof Array||"[object Array]"===Object.prototype.toString.call(t)}function r(t){return null!=t&&"[object Object]"===Object.prototype.toString.call(t)}function i(t){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(t).length;var e;for(e in t)if(t.hasOwnProperty(e))return!1;return!0}function o(t){return void 0===t}function a(t){return"number"===typeof t||"[object Number]"===Object.prototype.toString.call(t)}function s(t){return t instanceof Date||"[object Date]"===Object.prototype.toString.call(t)}function u(t,e){var n,r=[];for(n=0;n<t.length;++n)r.push(e(t[n],n));return r}function c(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function l(t,e){for(var n in e)c(e,n)&&(t[n]=e[n]);return c(e,"toString")&&(t.toString=e.toString),c(e,"valueOf")&&(t.valueOf=e.valueOf),t}function h(t,e,n,r){return Te(t,e,n,r,!0).utc()}function f(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function d(t){return null==t._pf&&(t._pf=f()),t._pf}function p(t){if(null==t._isValid){var e=d(t),n=Ar.call(e.parsedDateParts,function(t){return null!=t}),r=!isNaN(t._d.getTime())&&e.overflow<0&&!e.empty&&!e.invalidMonth&&!e.invalidWeekday&&!e.weekdayMismatch&&!e.nullInput&&!e.invalidFormat&&!e.userInvalidated&&(!e.meridiem||e.meridiem&&n);if(t._strict&&(r=r&&0===e.charsLeftOver&&0===e.unusedTokens.length&&void 0===e.bigHour),null!=Object.isFrozen&&Object.isFrozen(t))return r;t._isValid=r}return t._isValid}function m(t){var e=h(NaN);return null!=t?l(d(e),t):d(e).userInvalidated=!0,e}function g(t,e){var n,r,i;if(o(e._isAMomentObject)||(t._isAMomentObject=e._isAMomentObject),o(e._i)||(t._i=e._i),o(e._f)||(t._f=e._f),o(e._l)||(t._l=e._l),o(e._strict)||(t._strict=e._strict),o(e._tzm)||(t._tzm=e._tzm),o(e._isUTC)||(t._isUTC=e._isUTC),o(e._offset)||(t._offset=e._offset),o(e._pf)||(t._pf=d(e)),o(e._locale)||(t._locale=e._locale),Ir.length>0)for(n=0;n<Ir.length;n++)r=Ir[n],i=e[r],o(i)||(t[r]=i);return t}function v(t){g(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===Rr&&(Rr=!0,e.updateOffset(this),Rr=!1)}function y(t){return t instanceof v||null!=t&&null!=t._isAMomentObject}function _(t){return t<0?Math.ceil(t)||0:Math.floor(t)}function b(t){var e=+t,n=0;return 0!==e&&isFinite(e)&&(n=_(e)),n}function w(t,e,n){var r,i=Math.min(t.length,e.length),o=Math.abs(t.length-e.length),a=0;for(r=0;r<i;r++)(n&&t[r]!==e[r]||!n&&b(t[r])!==b(e[r]))&&a++;return a+o}function E(t){!1===e.suppressDeprecationWarnings&&"undefined"!==typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function x(t,n){var r=!0;return l(function(){if(null!=e.deprecationHandler&&e.deprecationHandler(null,t),r){for(var i,o=[],a=0;a<arguments.length;a++){if(i="","object"===typeof arguments[a]){i+="\n["+a+"] ";for(var s in arguments[0])i+=s+": "+arguments[0][s]+", ";i=i.slice(0,-2)}else i=arguments[a];o.push(i)}E(t+"\nArguments: "+Array.prototype.slice.call(o).join("")+"\n"+(new Error).stack),r=!1}return n.apply(this,arguments)},n)}function T(t,n){null!=e.deprecationHandler&&e.deprecationHandler(t,n),Pr[t]||(E(n),Pr[t]=!0)}function S(t){return t instanceof Function||"[object Function]"===Object.prototype.toString.call(t)}function C(t){var e,n;for(n in t)e=t[n],S(e)?this[n]=e:this["_"+n]=e;this._config=t,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)}function M(t,e){var n,i=l({},t);for(n in e)c(e,n)&&(r(t[n])&&r(e[n])?(i[n]={},l(i[n],t[n]),l(i[n],e[n])):null!=e[n]?i[n]=e[n]:delete i[n]);for(n in t)c(t,n)&&!c(e,n)&&r(t[n])&&(i[n]=l({},i[n]));return i}function A(t){null!=t&&this.set(t)}function I(t,e,n){var r=this._calendar[t]||this._calendar.sameElse;return S(r)?r.call(e,n):r}function R(t){var e=this._longDateFormat[t],n=this._longDateFormat[t.toUpperCase()];return e||!n?e:(this._longDateFormat[t]=n.replace(/MMMM|MM|DD|dddd/g,function(t){return t.slice(1)}),this._longDateFormat[t])}function P(){return this._invalidDate}function N(t){return this._ordinal.replace("%d",t)}function D(t,e,n,r){var i=this._relativeTime[n];return S(i)?i(t,e,n,r):i.replace(/%d/i,t)}function O(t,e){var n=this._relativeTime[t>0?"future":"past"];return S(n)?n(e):n.replace(/%s/i,e)}function k(t,e){var n=t.toLowerCase();Ur[n]=Ur[n+"s"]=Ur[e]=t}function L(t){return"string"===typeof t?Ur[t]||Ur[t.toLowerCase()]:void 0}function U(t){var e,n,r={};for(n in t)c(t,n)&&(e=L(n))&&(r[e]=t[n]);return r}function F(t,e){Fr[t]=e}function B(t){var e=[];for(var n in t)e.push({unit:n,priority:Fr[n]});return e.sort(function(t,e){return t.priority-e.priority}),e}function V(t,e,n){var r=""+Math.abs(t),i=e-r.length;return(t>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+r}function j(t,e,n,r){var i=r;"string"===typeof r&&(i=function(){return this[r]()}),t&&(Hr[t]=i),e&&(Hr[e[0]]=function(){return V(i.apply(this,arguments),e[1],e[2])}),n&&(Hr[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),t)})}function H(t){return t.match(/\[[\s\S]/)?t.replace(/^\[|\]$/g,""):t.replace(/\\/g,"")}function G(t){var e,n,r=t.match(Br);for(e=0,n=r.length;e<n;e++)Hr[r[e]]?r[e]=Hr[r[e]]:r[e]=H(r[e]);return function(e){var i,o="";for(i=0;i<n;i++)o+=S(r[i])?r[i].call(e,t):r[i];return o}}function z(t,e){return t.isValid()?(e=W(e,t.localeData()),jr[e]=jr[e]||G(e),jr[e](t)):t.localeData().invalidDate()}function W(t,e){function n(t){return e.longDateFormat(t)||t}var r=5;for(Vr.lastIndex=0;r>=0&&Vr.test(t);)t=t.replace(Vr,n),Vr.lastIndex=0,r-=1;return t}function q(t,e,n){ai[t]=S(e)?e:function(t,r){return t&&n?n:e}}function Y(t,e){return c(ai,t)?ai[t](e._strict,e._locale):new RegExp(K(t))}function K(t){return Q(t.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(t,e,n,r,i){return e||n||r||i}))}function Q(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function X(t,e){var n,r=e;for("string"===typeof t&&(t=[t]),a(e)&&(r=function(t,n){n[e]=b(t)}),n=0;n<t.length;n++)si[t[n]]=r}function J(t,e){X(t,function(t,n,r,i){r._w=r._w||{},e(t,r._w,r,i)})}function Z(t,e,n){null!=e&&c(si,t)&&si[t](e,n._a,n,t)}function $(t){return tt(t)?366:365}function tt(t){return t%4===0&&t%100!==0||t%400===0}function et(){return tt(this.year())}function nt(t,n){return function(r){return null!=r?(it(this,t,r),e.updateOffset(this,n),this):rt(this,t)}}function rt(t,e){return t.isValid()?t._d["get"+(t._isUTC?"UTC":"")+e]():NaN}function it(t,e,n){t.isValid()&&!isNaN(n)&&("FullYear"===e&&tt(t.year())&&1===t.month()&&29===t.date()?t._d["set"+(t._isUTC?"UTC":"")+e](n,t.month(),ut(n,t.month())):t._d["set"+(t._isUTC?"UTC":"")+e](n))}function ot(t){return t=L(t),S(this[t])?this[t]():this}function at(t,e){if("object"===typeof t){t=U(t);for(var n=B(t),r=0;r<n.length;r++)this[n[r].unit](t[n[r].unit])}else if(t=L(t),S(this[t]))return this[t](e);return this}function st(t,e){return(t%e+e)%e}function ut(t,e){if(isNaN(t)||isNaN(e))return NaN;var n=st(e,12);return t+=(e-n)/12,1===n?tt(t)?29:28:31-n%7%2}function ct(t,e){return t?n(this._months)?this._months[t.month()]:this._months[(this._months.isFormat||_i).test(e)?"format":"standalone"][t.month()]:n(this._months)?this._months:this._months.standalone}function lt(t,e){return t?n(this._monthsShort)?this._monthsShort[t.month()]:this._monthsShort[_i.test(e)?"format":"standalone"][t.month()]:n(this._monthsShort)?this._monthsShort:this._monthsShort.standalone}function ht(t,e,n){var r,i,o,a=t.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],r=0;r<12;++r)o=h([2e3,r]),this._shortMonthsParse[r]=this.monthsShort(o,"").toLocaleLowerCase(),this._longMonthsParse[r]=this.months(o,"").toLocaleLowerCase();return n?"MMM"===e?(i=vi.call(this._shortMonthsParse,a),-1!==i?i:null):(i=vi.call(this._longMonthsParse,a),-1!==i?i:null):"MMM"===e?-1!==(i=vi.call(this._shortMonthsParse,a))?i:(i=vi.call(this._longMonthsParse,a),-1!==i?i:null):-1!==(i=vi.call(this._longMonthsParse,a))?i:(i=vi.call(this._shortMonthsParse,a),-1!==i?i:null)}function ft(t,e,n){var r,i,o;if(this._monthsParseExact)return ht.call(this,t,e,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),r=0;r<12;r++){if(i=h([2e3,r]),n&&!this._longMonthsParse[r]&&(this._longMonthsParse[r]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[r]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[r]||(o="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[r]=new RegExp(o.replace(".",""),"i")),n&&"MMMM"===e&&this._longMonthsParse[r].test(t))return r;if(n&&"MMM"===e&&this._shortMonthsParse[r].test(t))return r;if(!n&&this._monthsParse[r].test(t))return r}}function dt(t,e){var n;if(!t.isValid())return t;if("string"===typeof e)if(/^\d+$/.test(e))e=b(e);else if(e=t.localeData().monthsParse(e),!a(e))return t;return n=Math.min(t.date(),ut(t.year(),e)),t._d["set"+(t._isUTC?"UTC":"")+"Month"](e,n),t}function pt(t){return null!=t?(dt(this,t),e.updateOffset(this,!0),this):rt(this,"Month")}function mt(){return ut(this.year(),this.month())}function gt(t){return this._monthsParseExact?(c(this,"_monthsRegex")||yt.call(this),t?this._monthsShortStrictRegex:this._monthsShortRegex):(c(this,"_monthsShortRegex")||(this._monthsShortRegex=Ei),this._monthsShortStrictRegex&&t?this._monthsShortStrictRegex:this._monthsShortRegex)}function vt(t){return this._monthsParseExact?(c(this,"_monthsRegex")||yt.call(this),t?this._monthsStrictRegex:this._monthsRegex):(c(this,"_monthsRegex")||(this._monthsRegex=xi),this._monthsStrictRegex&&t?this._monthsStrictRegex:this._monthsRegex)}function yt(){function t(t,e){return e.length-t.length}var e,n,r=[],i=[],o=[];for(e=0;e<12;e++)n=h([2e3,e]),r.push(this.monthsShort(n,"")),i.push(this.months(n,"")),o.push(this.months(n,"")),o.push(this.monthsShort(n,""));for(r.sort(t),i.sort(t),o.sort(t),e=0;e<12;e++)r[e]=Q(r[e]),i[e]=Q(i[e]);for(e=0;e<24;e++)o[e]=Q(o[e]);this._monthsRegex=new RegExp("^("+o.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+r.join("|")+")","i")}function _t(t,e,n,r,i,o,a){var s=new Date(t,e,n,r,i,o,a);return t<100&&t>=0&&isFinite(s.getFullYear())&&s.setFullYear(t),s}function bt(t){var e=new Date(Date.UTC.apply(null,arguments));return t<100&&t>=0&&isFinite(e.getUTCFullYear())&&e.setUTCFullYear(t),e}function wt(t,e,n){var r=7+e-n;return-(7+bt(t,0,r).getUTCDay()-e)%7+r-1}function Et(t,e,n,r,i){var o,a,s=(7+n-r)%7,u=wt(t,r,i),c=1+7*(e-1)+s+u;return c<=0?(o=t-1,a=$(o)+c):c>$(t)?(o=t+1,a=c-$(t)):(o=t,a=c),{year:o,dayOfYear:a}}function xt(t,e,n){var r,i,o=wt(t.year(),e,n),a=Math.floor((t.dayOfYear()-o-1)/7)+1;return a<1?(i=t.year()-1,r=a+Tt(i,e,n)):a>Tt(t.year(),e,n)?(r=a-Tt(t.year(),e,n),i=t.year()+1):(i=t.year(),r=a),{week:r,year:i}}function Tt(t,e,n){var r=wt(t,e,n),i=wt(t+1,e,n);return($(t)-r+i)/7}function St(t){return xt(t,this._week.dow,this._week.doy).week}function Ct(){return this._week.dow}function Mt(){return this._week.doy}function At(t){var e=this.localeData().week(this);return null==t?e:this.add(7*(t-e),"d")}function It(t){var e=xt(this,1,4).week;return null==t?e:this.add(7*(t-e),"d")}function Rt(t,e){return"string"!==typeof t?t:isNaN(t)?(t=e.weekdaysParse(t),"number"===typeof t?t:null):parseInt(t,10)}function Pt(t,e){return"string"===typeof t?e.weekdaysParse(t)%7||7:isNaN(t)?null:t}function Nt(t,e){return t?n(this._weekdays)?this._weekdays[t.day()]:this._weekdays[this._weekdays.isFormat.test(e)?"format":"standalone"][t.day()]:n(this._weekdays)?this._weekdays:this._weekdays.standalone}function Dt(t){return t?this._weekdaysShort[t.day()]:this._weekdaysShort}function Ot(t){return t?this._weekdaysMin[t.day()]:this._weekdaysMin}function kt(t,e,n){var r,i,o,a=t.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],r=0;r<7;++r)o=h([2e3,1]).day(r),this._minWeekdaysParse[r]=this.weekdaysMin(o,"").toLocaleLowerCase(),this._shortWeekdaysParse[r]=this.weekdaysShort(o,"").toLocaleLowerCase(),this._weekdaysParse[r]=this.weekdays(o,"").toLocaleLowerCase();return n?"dddd"===e?(i=vi.call(this._weekdaysParse,a),-1!==i?i:null):"ddd"===e?(i=vi.call(this._shortWeekdaysParse,a),-1!==i?i:null):(i=vi.call(this._minWeekdaysParse,a),-1!==i?i:null):"dddd"===e?-1!==(i=vi.call(this._weekdaysParse,a))?i:-1!==(i=vi.call(this._shortWeekdaysParse,a))?i:(i=vi.call(this._minWeekdaysParse,a),-1!==i?i:null):"ddd"===e?-1!==(i=vi.call(this._shortWeekdaysParse,a))?i:-1!==(i=vi.call(this._weekdaysParse,a))?i:(i=vi.call(this._minWeekdaysParse,a),-1!==i?i:null):-1!==(i=vi.call(this._minWeekdaysParse,a))?i:-1!==(i=vi.call(this._weekdaysParse,a))?i:(i=vi.call(this._shortWeekdaysParse,a),-1!==i?i:null)}function Lt(t,e,n){var r,i,o;if(this._weekdaysParseExact)return kt.call(this,t,e,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),r=0;r<7;r++){if(i=h([2e3,1]).day(r),n&&!this._fullWeekdaysParse[r]&&(this._fullWeekdaysParse[r]=new RegExp("^"+this.weekdays(i,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[r]=new RegExp("^"+this.weekdaysShort(i,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[r]=new RegExp("^"+this.weekdaysMin(i,"").replace(".",".?")+"$","i")),this._weekdaysParse[r]||(o="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[r]=new RegExp(o.replace(".",""),"i")),n&&"dddd"===e&&this._fullWeekdaysParse[r].test(t))return r;if(n&&"ddd"===e&&this._shortWeekdaysParse[r].test(t))return r;if(n&&"dd"===e&&this._minWeekdaysParse[r].test(t))return r;if(!n&&this._weekdaysParse[r].test(t))return r}}function Ut(t){if(!this.isValid())return null!=t?this:NaN;var e=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=t?(t=Rt(t,this.localeData()),this.add(t-e,"d")):e}function Ft(t){if(!this.isValid())return null!=t?this:NaN;var e=(this.day()+7-this.localeData()._week.dow)%7;return null==t?e:this.add(t-e,"d")}function Bt(t){if(!this.isValid())return null!=t?this:NaN;if(null!=t){var e=Pt(t,this.localeData());return this.day(this.day()%7?e:e-7)}return this.day()||7}function Vt(t){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||Gt.call(this),t?this._weekdaysStrictRegex:this._weekdaysRegex):(c(this,"_weekdaysRegex")||(this._weekdaysRegex=Ai),this._weekdaysStrictRegex&&t?this._weekdaysStrictRegex:this._weekdaysRegex)}function jt(t){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||Gt.call(this),t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(c(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Ii),this._weekdaysShortStrictRegex&&t?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)}function Ht(t){return this._weekdaysParseExact?(c(this,"_weekdaysRegex")||Gt.call(this),t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(c(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=Ri),this._weekdaysMinStrictRegex&&t?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)}function Gt(){function t(t,e){return e.length-t.length}var e,n,r,i,o,a=[],s=[],u=[],c=[];for(e=0;e<7;e++)n=h([2e3,1]).day(e),r=this.weekdaysMin(n,""),i=this.weekdaysShort(n,""),o=this.weekdays(n,""),a.push(r),s.push(i),u.push(o),c.push(r),c.push(i),c.push(o);for(a.sort(t),s.sort(t),u.sort(t),c.sort(t),e=0;e<7;e++)s[e]=Q(s[e]),u[e]=Q(u[e]),c[e]=Q(c[e]);this._weekdaysRegex=new RegExp("^("+c.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+s.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function zt(){return this.hours()%12||12}function Wt(){return this.hours()||24}function qt(t,e){j(t,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),e)})}function Yt(t,e){return e._meridiemParse}function Kt(t){return"p"===(t+"").toLowerCase().charAt(0)}function Qt(t,e,n){return t>11?n?"pm":"PM":n?"am":"AM"}function Xt(t){return t?t.toLowerCase().replace("_","-"):t}function Jt(t){for(var e,n,r,i,o=0;o<t.length;){for(i=Xt(t[o]).split("-"),e=i.length,n=Xt(t[o+1]),n=n?n.split("-"):null;e>0;){if(r=Zt(i.slice(0,e).join("-")))return r;if(n&&n.length>=e&&w(i,n,!0)>=e-1)break;e--}o++}return Pi}function Zt(e){var n=null;if(!ki[e]&&"undefined"!==typeof t&&t&&t.exports)try{n=Pi._abbr;!function(){var t=new Error('Cannot find module "./locale"');throw t.code="MODULE_NOT_FOUND",t}(),$t(n)}catch(t){}return ki[e]}function $t(t,e){var n;return t&&(n=o(e)?ne(t):te(t,e),n?Pi=n:"undefined"!==typeof console&&console.warn&&console.warn("Locale "+t+" not found. Did you forget to load it?")),Pi._abbr}function te(t,e){if(null!==e){var n,r=Oi;if(e.abbr=t,null!=ki[t])T("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),r=ki[t]._config;else if(null!=e.parentLocale)if(null!=ki[e.parentLocale])r=ki[e.parentLocale]._config;else{if(null==(n=Zt(e.parentLocale)))return Li[e.parentLocale]||(Li[e.parentLocale]=[]),Li[e.parentLocale].push({name:t,config:e}),null;r=n._config}return ki[t]=new A(M(r,e)),Li[t]&&Li[t].forEach(function(t){te(t.name,t.config)}),$t(t),ki[t]}return delete ki[t],null}function ee(t,e){if(null!=e){var n,r,i=Oi;r=Zt(t),null!=r&&(i=r._config),e=M(i,e),n=new A(e),n.parentLocale=ki[t],ki[t]=n,$t(t)}else null!=ki[t]&&(null!=ki[t].parentLocale?ki[t]=ki[t].parentLocale:null!=ki[t]&&delete ki[t]);return ki[t]}function ne(t){var e;if(t&&t._locale&&t._locale._abbr&&(t=t._locale._abbr),!t)return Pi;if(!n(t)){if(e=Zt(t))return e;t=[t]}return Jt(t)}function re(){return Nr(ki)}function ie(t){var e,n=t._a;return n&&-2===d(t).overflow&&(e=n[ci]<0||n[ci]>11?ci:n[li]<1||n[li]>ut(n[ui],n[ci])?li:n[hi]<0||n[hi]>24||24===n[hi]&&(0!==n[fi]||0!==n[di]||0!==n[pi])?hi:n[fi]<0||n[fi]>59?fi:n[di]<0||n[di]>59?di:n[pi]<0||n[pi]>999?pi:-1,d(t)._overflowDayOfYear&&(e<ui||e>li)&&(e=li),d(t)._overflowWeeks&&-1===e&&(e=mi),d(t)._overflowWeekday&&-1===e&&(e=gi),d(t).overflow=e),t}function oe(t,e,n){return null!=t?t:null!=e?e:n}function ae(t){var n=new Date(e.now());return t._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}function se(t){var e,n,r,i,o,a=[];if(!t._d){for(r=ae(t),t._w&&null==t._a[li]&&null==t._a[ci]&&ue(t),null!=t._dayOfYear&&(o=oe(t._a[ui],r[ui]),(t._dayOfYear>$(o)||0===t._dayOfYear)&&(d(t)._overflowDayOfYear=!0),n=bt(o,0,t._dayOfYear),t._a[ci]=n.getUTCMonth(),t._a[li]=n.getUTCDate()),e=0;e<3&&null==t._a[e];++e)t._a[e]=a[e]=r[e];for(;e<7;e++)t._a[e]=a[e]=null==t._a[e]?2===e?1:0:t._a[e];24===t._a[hi]&&0===t._a[fi]&&0===t._a[di]&&0===t._a[pi]&&(t._nextDay=!0,t._a[hi]=0),t._d=(t._useUTC?bt:_t).apply(null,a),i=t._useUTC?t._d.getUTCDay():t._d.getDay(),null!=t._tzm&&t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),t._nextDay&&(t._a[hi]=24),t._w&&"undefined"!==typeof t._w.d&&t._w.d!==i&&(d(t).weekdayMismatch=!0)}}function ue(t){var e,n,r,i,o,a,s,u;if(e=t._w,null!=e.GG||null!=e.W||null!=e.E)o=1,a=4,n=oe(e.GG,t._a[ui],xt(Se(),1,4).year),r=oe(e.W,1),((i=oe(e.E,1))<1||i>7)&&(u=!0);else{o=t._locale._week.dow,a=t._locale._week.doy;var c=xt(Se(),o,a);n=oe(e.gg,t._a[ui],c.year),r=oe(e.w,c.week),null!=e.d?((i=e.d)<0||i>6)&&(u=!0):null!=e.e?(i=e.e+o,(e.e<0||e.e>6)&&(u=!0)):i=o}r<1||r>Tt(n,o,a)?d(t)._overflowWeeks=!0:null!=u?d(t)._overflowWeekday=!0:(s=Et(n,r,i,o,a),t._a[ui]=s.year,t._dayOfYear=s.dayOfYear)}function ce(t){var e,n,r,i,o,a,s=t._i,u=Ui.exec(s)||Fi.exec(s);if(u){for(d(t).iso=!0,e=0,n=Vi.length;e<n;e++)if(Vi[e][1].exec(u[1])){i=Vi[e][0],r=!1!==Vi[e][2];break}if(null==i)return void(t._isValid=!1);if(u[3]){for(e=0,n=ji.length;e<n;e++)if(ji[e][1].exec(u[3])){o=(u[2]||" ")+ji[e][0];break}if(null==o)return void(t._isValid=!1)}if(!r&&null!=o)return void(t._isValid=!1);if(u[4]){if(!Bi.exec(u[4]))return void(t._isValid=!1);a="Z"}t._f=i+(o||"")+(a||""),ve(t)}else t._isValid=!1}function le(t,e,n,r,i,o){var a=[he(t),wi.indexOf(e),parseInt(n,10),parseInt(r,10),parseInt(i,10)];return o&&a.push(parseInt(o,10)),a}function he(t){var e=parseInt(t,10);return e<=49?2e3+e:e<=999?1900+e:e}function fe(t){return t.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}function de(t,e,n){if(t){if(Ci.indexOf(t)!==new Date(e[0],e[1],e[2]).getDay())return d(n).weekdayMismatch=!0,n._isValid=!1,!1}return!0}function pe(t,e,n){if(t)return zi[t];if(e)return 0;var r=parseInt(n,10),i=r%100;return(r-i)/100*60+i}function me(t){var e=Gi.exec(fe(t._i));if(e){var n=le(e[4],e[3],e[2],e[5],e[6],e[7]);if(!de(e[1],n,t))return;t._a=n,t._tzm=pe(e[8],e[9],e[10]),t._d=bt.apply(null,t._a),t._d.setUTCMinutes(t._d.getUTCMinutes()-t._tzm),d(t).rfc2822=!0}else t._isValid=!1}function ge(t){var n=Hi.exec(t._i);if(null!==n)return void(t._d=new Date(+n[1]));ce(t),!1===t._isValid&&(delete t._isValid,me(t),!1===t._isValid&&(delete t._isValid,e.createFromInputFallback(t)))}function ve(t){if(t._f===e.ISO_8601)return void ce(t);if(t._f===e.RFC_2822)return void me(t);t._a=[],d(t).empty=!0;var n,r,i,o,a,s=""+t._i,u=s.length,c=0;for(i=W(t._f,t._locale).match(Br)||[],n=0;n<i.length;n++)o=i[n],r=(s.match(Y(o,t))||[])[0],r&&(a=s.substr(0,s.indexOf(r)),a.length>0&&d(t).unusedInput.push(a),s=s.slice(s.indexOf(r)+r.length),c+=r.length),Hr[o]?(r?d(t).empty=!1:d(t).unusedTokens.push(o),Z(o,r,t)):t._strict&&!r&&d(t).unusedTokens.push(o);d(t).charsLeftOver=u-c,s.length>0&&d(t).unusedInput.push(s),t._a[hi]<=12&&!0===d(t).bigHour&&t._a[hi]>0&&(d(t).bigHour=void 0),d(t).parsedDateParts=t._a.slice(0),d(t).meridiem=t._meridiem,t._a[hi]=ye(t._locale,t._a[hi],t._meridiem),se(t),ie(t)}function ye(t,e,n){var r;return null==n?e:null!=t.meridiemHour?t.meridiemHour(e,n):null!=t.isPM?(r=t.isPM(n),r&&e<12&&(e+=12),r||12!==e||(e=0),e):e}function _e(t){var e,n,r,i,o;if(0===t._f.length)return d(t).invalidFormat=!0,void(t._d=new Date(NaN));for(i=0;i<t._f.length;i++)o=0,e=g({},t),null!=t._useUTC&&(e._useUTC=t._useUTC),e._f=t._f[i],ve(e),p(e)&&(o+=d(e).charsLeftOver,o+=10*d(e).unusedTokens.length,d(e).score=o,(null==r||o<r)&&(r=o,n=e));l(t,n||e)}function be(t){if(!t._d){var e=U(t._i);t._a=u([e.year,e.month,e.day||e.date,e.hour,e.minute,e.second,e.millisecond],function(t){return t&&parseInt(t,10)}),se(t)}}function we(t){var e=new v(ie(Ee(t)));return e._nextDay&&(e.add(1,"d"),e._nextDay=void 0),e}function Ee(t){var e=t._i,r=t._f;return t._locale=t._locale||ne(t._l),null===e||void 0===r&&""===e?m({nullInput:!0}):("string"===typeof e&&(t._i=e=t._locale.preparse(e)),y(e)?new v(ie(e)):(s(e)?t._d=e:n(r)?_e(t):r?ve(t):xe(t),p(t)||(t._d=null),t))}function xe(t){var i=t._i;o(i)?t._d=new Date(e.now()):s(i)?t._d=new Date(i.valueOf()):"string"===typeof i?ge(t):n(i)?(t._a=u(i.slice(0),function(t){return parseInt(t,10)}),se(t)):r(i)?be(t):a(i)?t._d=new Date(i):e.createFromInputFallback(t)}function Te(t,e,o,a,s){var u={};return!0!==o&&!1!==o||(a=o,o=void 0),(r(t)&&i(t)||n(t)&&0===t.length)&&(t=void 0),u._isAMomentObject=!0,u._useUTC=u._isUTC=s,u._l=o,u._i=t,u._f=e,u._strict=a,we(u)}function Se(t,e,n,r){return Te(t,e,n,r,!1)}function Ce(t,e){var r,i;if(1===e.length&&n(e[0])&&(e=e[0]),!e.length)return Se();for(r=e[0],i=1;i<e.length;++i)e[i].isValid()&&!e[i][t](r)||(r=e[i]);return r}function Me(){return Ce("isBefore",[].slice.call(arguments,0))}function Ae(){return Ce("isAfter",[].slice.call(arguments,0))}function Ie(t){for(var e in t)if(-1===vi.call(Ki,e)||null!=t[e]&&isNaN(t[e]))return!1;for(var n=!1,r=0;r<Ki.length;++r)if(t[Ki[r]]){if(n)return!1;parseFloat(t[Ki[r]])!==b(t[Ki[r]])&&(n=!0)}return!0}function Re(){return this._isValid}function Pe(){return Xe(NaN)}function Ne(t){var e=U(t),n=e.year||0,r=e.quarter||0,i=e.month||0,o=e.week||0,a=e.day||0,s=e.hour||0,u=e.minute||0,c=e.second||0,l=e.millisecond||0;this._isValid=Ie(e),this._milliseconds=+l+1e3*c+6e4*u+1e3*s*60*60,this._days=+a+7*o,this._months=+i+3*r+12*n,this._data={},this._locale=ne(),this._bubble()}function De(t){return t instanceof Ne}function Oe(t){return t<0?-1*Math.round(-1*t):Math.round(t)}function ke(t,e){j(t,0,0,function(){var t=this.utcOffset(),n="+";return t<0&&(t=-t,n="-"),n+V(~~(t/60),2)+e+V(~~t%60,2)})}function Le(t,e){var n=(e||"").match(t);if(null===n)return null;var r=n[n.length-1]||[],i=(r+"").match(Qi)||["-",0,0],o=60*i[1]+b(i[2]);return 0===o?0:"+"===i[0]?o:-o}function Ue(t,n){var r,i;return n._isUTC?(r=n.clone(),i=(y(t)||s(t)?t.valueOf():Se(t).valueOf())-r.valueOf(),r._d.setTime(r._d.valueOf()+i),e.updateOffset(r,!1),r):Se(t).local()}function Fe(t){return 15*-Math.round(t._d.getTimezoneOffset()/15)}function Be(t,n,r){var i,o=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null!=t){if("string"===typeof t){if(null===(t=Le(ri,t)))return this}else Math.abs(t)<16&&!r&&(t*=60);return!this._isUTC&&n&&(i=Fe(this)),this._offset=t,this._isUTC=!0,null!=i&&this.add(i,"m"),o!==t&&(!n||this._changeInProgress?en(this,Xe(t-o,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?o:Fe(this)}function Ve(t,e){return null!=t?("string"!==typeof t&&(t=-t),this.utcOffset(t,e),this):-this.utcOffset()}function je(t){return this.utcOffset(0,t)}function He(t){return this._isUTC&&(this.utcOffset(0,t),this._isUTC=!1,t&&this.subtract(Fe(this),"m")),this}function Ge(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"===typeof this._i){var t=Le(ni,this._i);null!=t?this.utcOffset(t):this.utcOffset(0,!0)}return this}function ze(t){return!!this.isValid()&&(t=t?Se(t).utcOffset():0,(this.utcOffset()-t)%60===0)}function We(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()}function qe(){if(!o(this._isDSTShifted))return this._isDSTShifted;var t={};if(g(t,this),t=Ee(t),t._a){var e=t._isUTC?h(t._a):Se(t._a);this._isDSTShifted=this.isValid()&&w(t._a,e.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted}function Ye(){return!!this.isValid()&&!this._isUTC}function Ke(){return!!this.isValid()&&this._isUTC}function Qe(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function Xe(t,e){var n,r,i,o=t,s=null;return De(t)?o={ms:t._milliseconds,d:t._days,M:t._months}:a(t)?(o={},e?o[e]=t:o.milliseconds=t):(s=Xi.exec(t))?(n="-"===s[1]?-1:1,o={y:0,d:b(s[li])*n,h:b(s[hi])*n,m:b(s[fi])*n,s:b(s[di])*n,ms:b(Oe(1e3*s[pi]))*n}):(s=Ji.exec(t))?(n="-"===s[1]?-1:(s[1],1),o={y:Je(s[2],n),M:Je(s[3],n),w:Je(s[4],n),d:Je(s[5],n),h:Je(s[6],n),m:Je(s[7],n),s:Je(s[8],n)}):null==o?o={}:"object"===typeof o&&("from"in o||"to"in o)&&(i=$e(Se(o.from),Se(o.to)),o={},o.ms=i.milliseconds,o.M=i.months),r=new Ne(o),De(t)&&c(t,"_locale")&&(r._locale=t._locale),r}function Je(t,e){var n=t&&parseFloat(t.replace(",","."));return(isNaN(n)?0:n)*e}function Ze(t,e){var n={milliseconds:0,months:0};return n.months=e.month()-t.month()+12*(e.year()-t.year()),t.clone().add(n.months,"M").isAfter(e)&&--n.months,n.milliseconds=+e-+t.clone().add(n.months,"M"),n}function $e(t,e){var n;return t.isValid()&&e.isValid()?(e=Ue(e,t),t.isBefore(e)?n=Ze(t,e):(n=Ze(e,t),n.milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function tn(t,e){return function(n,r){var i,o;return null===r||isNaN(+r)||(T(e,"moment()."+e+"(period, number) is deprecated. Please use moment()."+e+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),o=n,n=r,r=o),n="string"===typeof n?+n:n,i=Xe(n,r),en(this,i,t),this}}function en(t,n,r,i){var o=n._milliseconds,a=Oe(n._days),s=Oe(n._months);t.isValid()&&(i=null==i||i,s&&dt(t,rt(t,"Month")+s*r),a&&it(t,"Date",rt(t,"Date")+a*r),o&&t._d.setTime(t._d.valueOf()+o*r),i&&e.updateOffset(t,a||s))}function nn(t,e){var n=t.diff(e,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"}function rn(t,n){var r=t||Se(),i=Ue(r,this).startOf("day"),o=e.calendarFormat(this,i)||"sameElse",a=n&&(S(n[o])?n[o].call(this,r):n[o]);return this.format(a||this.localeData().calendar(o,this,Se(r)))}function on(){return new v(this)}function an(t,e){var n=y(t)?t:Se(t);return!(!this.isValid()||!n.isValid())&&(e=L(o(e)?"millisecond":e),"millisecond"===e?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(e).valueOf())}function sn(t,e){var n=y(t)?t:Se(t);return!(!this.isValid()||!n.isValid())&&(e=L(o(e)?"millisecond":e),"millisecond"===e?this.valueOf()<n.valueOf():this.clone().endOf(e).valueOf()<n.valueOf())}function un(t,e,n,r){return r=r||"()",("("===r[0]?this.isAfter(t,n):!this.isBefore(t,n))&&(")"===r[1]?this.isBefore(e,n):!this.isAfter(e,n))}function cn(t,e){var n,r=y(t)?t:Se(t);return!(!this.isValid()||!r.isValid())&&(e=L(e||"millisecond"),"millisecond"===e?this.valueOf()===r.valueOf():(n=r.valueOf(),this.clone().startOf(e).valueOf()<=n&&n<=this.clone().endOf(e).valueOf()))}function ln(t,e){return this.isSame(t,e)||this.isAfter(t,e)}function hn(t,e){return this.isSame(t,e)||this.isBefore(t,e)}function fn(t,e,n){var r,i,o;if(!this.isValid())return NaN;if(r=Ue(t,this),!r.isValid())return NaN;switch(i=6e4*(r.utcOffset()-this.utcOffset()),e=L(e)){case"year":o=dn(this,r)/12;break;case"month":o=dn(this,r);break;case"quarter":o=dn(this,r)/3;break;case"second":o=(this-r)/1e3;break;case"minute":o=(this-r)/6e4;break;case"hour":o=(this-r)/36e5;break;case"day":o=(this-r-i)/864e5;break;case"week":o=(this-r-i)/6048e5;break;default:o=this-r}return n?o:_(o)}function dn(t,e){var n,r,i=12*(e.year()-t.year())+(e.month()-t.month()),o=t.clone().add(i,"months");return e-o<0?(n=t.clone().add(i-1,"months"),r=(e-o)/(o-n)):(n=t.clone().add(i+1,"months"),r=(e-o)/(n-o)),-(i+r)||0}function pn(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")}function mn(t){if(!this.isValid())return null;var e=!0!==t,n=e?this.clone().utc():this;return n.year()<0||n.year()>9999?z(n,e?"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYYYY-MM-DD[T]HH:mm:ss.SSSZ"):S(Date.prototype.toISOString)?e?this.toDate().toISOString():new Date(this.valueOf()+60*this.utcOffset()*1e3).toISOString().replace("Z",z(n,"Z")):z(n,e?"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]":"YYYY-MM-DD[T]HH:mm:ss.SSSZ")}function gn(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var t="moment",e="";this.isLocal()||(t=0===this.utcOffset()?"moment.utc":"moment.parseZone",e="Z");var n="["+t+'("]',r=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i=e+'[")]';return this.format(n+r+"-MM-DD[T]HH:mm:ss.SSS"+i)}function vn(t){t||(t=this.isUtc()?e.defaultFormatUtc:e.defaultFormat);var n=z(this,t);return this.localeData().postformat(n)}function yn(t,e){return this.isValid()&&(y(t)&&t.isValid()||Se(t).isValid())?Xe({to:this,from:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function _n(t){return this.from(Se(),t)}function bn(t,e){return this.isValid()&&(y(t)&&t.isValid()||Se(t).isValid())?Xe({from:this,to:t}).locale(this.locale()).humanize(!e):this.localeData().invalidDate()}function wn(t){return this.to(Se(),t)}function En(t){var e;return void 0===t?this._locale._abbr:(e=ne(t),null!=e&&(this._locale=e),this)}function xn(){return this._locale}function Tn(t){switch(t=L(t)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===t&&this.weekday(0),"isoWeek"===t&&this.isoWeekday(1),"quarter"===t&&this.month(3*Math.floor(this.month()/3)),this}function Sn(t){return void 0===(t=L(t))||"millisecond"===t?this:("date"===t&&(t="day"),this.startOf(t).add(1,"isoWeek"===t?"week":t).subtract(1,"ms"))}function Cn(){return this._d.valueOf()-6e4*(this._offset||0)}function Mn(){return Math.floor(this.valueOf()/1e3)}function An(){return new Date(this.valueOf())}function In(){var t=this;return[t.year(),t.month(),t.date(),t.hour(),t.minute(),t.second(),t.millisecond()]}function Rn(){var t=this;return{years:t.year(),months:t.month(),date:t.date(),hours:t.hours(),minutes:t.minutes(),seconds:t.seconds(),milliseconds:t.milliseconds()}}function Pn(){return this.isValid()?this.toISOString():null}function Nn(){return p(this)}function Dn(){return l({},d(this))}function On(){return d(this).overflow}function kn(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}}function Ln(t,e){j(0,[t,t.length],0,e)}function Un(t){return jn.call(this,t,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)}function Fn(t){return jn.call(this,t,this.isoWeek(),this.isoWeekday(),1,4)}function Bn(){return Tt(this.year(),1,4)}function Vn(){var t=this.localeData()._week;return Tt(this.year(),t.dow,t.doy)}function jn(t,e,n,r,i){var o;return null==t?xt(this,r,i).year:(o=Tt(t,r,i),e>o&&(e=o),Hn.call(this,t,e,n,r,i))}function Hn(t,e,n,r,i){var o=Et(t,e,n,r,i),a=bt(o.year,0,o.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function Gn(t){return null==t?Math.ceil((this.month()+1)/3):this.month(3*(t-1)+this.month()%3)}function zn(t){var e=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==t?e:this.add(t-e,"d")}function Wn(t,e){e[pi]=b(1e3*("0."+t))}function qn(){return this._isUTC?"UTC":""}function Yn(){return this._isUTC?"Coordinated Universal Time":""}function Kn(t){return Se(1e3*t)}function Qn(){return Se.apply(null,arguments).parseZone()}function Xn(t){return t}function Jn(t,e,n,r){var i=ne(),o=h().set(r,e);return i[n](o,t)}function Zn(t,e,n){if(a(t)&&(e=t,t=void 0),t=t||"",null!=e)return Jn(t,e,n,"month");var r,i=[];for(r=0;r<12;r++)i[r]=Jn(t,r,n,"month");return i}function $n(t,e,n,r){"boolean"===typeof t?(a(e)&&(n=e,e=void 0),e=e||""):(e=t,n=e,t=!1,a(e)&&(n=e,e=void 0),e=e||"");var i=ne(),o=t?i._week.dow:0;if(null!=n)return Jn(e,(n+o)%7,r,"day");var s,u=[];for(s=0;s<7;s++)u[s]=Jn(e,(s+o)%7,r,"day");return u}function tr(t,e){return Zn(t,e,"months")}function er(t,e){return Zn(t,e,"monthsShort")}function nr(t,e,n){return $n(t,e,n,"weekdays")}function rr(t,e,n){return $n(t,e,n,"weekdaysShort")}function ir(t,e,n){return $n(t,e,n,"weekdaysMin")}function or(){var t=this._data;return this._milliseconds=uo(this._milliseconds),this._days=uo(this._days),this._months=uo(this._months),t.milliseconds=uo(t.milliseconds),t.seconds=uo(t.seconds),t.minutes=uo(t.minutes),t.hours=uo(t.hours),t.months=uo(t.months),t.years=uo(t.years),this}function ar(t,e,n,r){var i=Xe(e,n);return t._milliseconds+=r*i._milliseconds,t._days+=r*i._days,t._months+=r*i._months,t._bubble()}function sr(t,e){return ar(this,t,e,1)}function ur(t,e){return ar(this,t,e,-1)}function cr(t){return t<0?Math.floor(t):Math.ceil(t)}function lr(){var t,e,n,r,i,o=this._milliseconds,a=this._days,s=this._months,u=this._data;return o>=0&&a>=0&&s>=0||o<=0&&a<=0&&s<=0||(o+=864e5*cr(fr(s)+a),a=0,s=0),u.milliseconds=o%1e3,t=_(o/1e3),u.seconds=t%60,e=_(t/60),u.minutes=e%60,n=_(e/60),u.hours=n%24,a+=_(n/24),i=_(hr(a)),s+=i,a-=cr(fr(i)),r=_(s/12),s%=12,u.days=a,u.months=s,u.years=r,this}function hr(t){return 4800*t/146097}function fr(t){return 146097*t/4800}function dr(t){if(!this.isValid())return NaN;var e,n,r=this._milliseconds;if("month"===(t=L(t))||"year"===t)return e=this._days+r/864e5,n=this._months+hr(e),"month"===t?n:n/12;switch(e=this._days+Math.round(fr(this._months)),t){case"week":return e/7+r/6048e5;case"day":return e+r/864e5;case"hour":return 24*e+r/36e5;case"minute":return 1440*e+r/6e4;case"second":return 86400*e+r/1e3;case"millisecond":return Math.floor(864e5*e)+r;default:throw new Error("Unknown unit "+t)}}function pr(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*b(this._months/12):NaN}function mr(t){return function(){return this.as(t)}}function gr(){return Xe(this)}function vr(t){return t=L(t),this.isValid()?this[t+"s"]():NaN}function yr(t){return function(){return this.isValid()?this._data[t]:NaN}}function _r(){return _(this.days()/7)}function br(t,e,n,r,i){return i.relativeTime(e||1,!!n,t,r)}function wr(t,e,n){var r=Xe(t).abs(),i=So(r.as("s")),o=So(r.as("m")),a=So(r.as("h")),s=So(r.as("d")),u=So(r.as("M")),c=So(r.as("y")),l=i<=Co.ss&&["s",i]||i<Co.s&&["ss",i]||o<=1&&["m"]||o<Co.m&&["mm",o]||a<=1&&["h"]||a<Co.h&&["hh",a]||s<=1&&["d"]||s<Co.d&&["dd",s]||u<=1&&["M"]||u<Co.M&&["MM",u]||c<=1&&["y"]||["yy",c];return l[2]=e,l[3]=+t>0,l[4]=n,br.apply(null,l)}function Er(t){return void 0===t?So:"function"===typeof t&&(So=t,!0)}function xr(t,e){return void 0!==Co[t]&&(void 0===e?Co[t]:(Co[t]=e,"s"===t&&(Co.ss=e-1),!0))}function Tr(t){if(!this.isValid())return this.localeData().invalidDate();var e=this.localeData(),n=wr(this,!t,e);return t&&(n=e.pastFuture(+this,n)),e.postformat(n)}function Sr(t){return(t>0)-(t<0)||+t}function Cr(){if(!this.isValid())return this.localeData().invalidDate();var t,e,n,r=Mo(this._milliseconds)/1e3,i=Mo(this._days),o=Mo(this._months);t=_(r/60),e=_(t/60),r%=60,t%=60,n=_(o/12),o%=12;var a=n,s=o,u=i,c=e,l=t,h=r?r.toFixed(3).replace(/\.?0+$/,""):"",f=this.asSeconds();if(!f)return"P0D";var d=f<0?"-":"",p=Sr(this._months)!==Sr(f)?"-":"",m=Sr(this._days)!==Sr(f)?"-":"",g=Sr(this._milliseconds)!==Sr(f)?"-":"";return d+"P"+(a?p+a+"Y":"")+(s?p+s+"M":"")+(u?m+u+"D":"")+(c||l||h?"T":"")+(c?g+c+"H":"")+(l?g+l+"M":"")+(h?g+h+"S":"")}var Mr,Ar;Ar=Array.prototype.some?Array.prototype.some:function(t){for(var e=Object(this),n=e.length>>>0,r=0;r<n;r++)if(r in e&&t.call(this,e[r],r,e))return!0;return!1};var Ir=e.momentProperties=[],Rr=!1,Pr={};e.suppressDeprecationWarnings=!1,e.deprecationHandler=null;var Nr;Nr=Object.keys?Object.keys:function(t){var e,n=[];for(e in t)c(t,e)&&n.push(e);return n};var Dr={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Or={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},kr=/\d{1,2}/,Lr={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Ur={},Fr={},Br=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Vr=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,jr={},Hr={},Gr=/\d/,zr=/\d\d/,Wr=/\d{3}/,qr=/\d{4}/,Yr=/[+-]?\d{6}/,Kr=/\d\d?/,Qr=/\d\d\d\d?/,Xr=/\d\d\d\d\d\d?/,Jr=/\d{1,3}/,Zr=/\d{1,4}/,$r=/[+-]?\d{1,6}/,ti=/\d+/,ei=/[+-]?\d+/,ni=/Z|[+-]\d\d:?\d\d/gi,ri=/Z|[+-]\d\d(?::?\d\d)?/gi,ii=/[+-]?\d+(\.\d{1,3})?/,oi=/[0-9]{0,256}['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFF07\uFF10-\uFFEF]{1,256}|[\u0600-\u06FF\/]{1,256}(\s*?[\u0600-\u06FF]{1,256}){1,2}/i,ai={},si={},ui=0,ci=1,li=2,hi=3,fi=4,di=5,pi=6,mi=7,gi=8;j("Y",0,0,function(){var t=this.year();return t<=9999?""+t:"+"+t}),j(0,["YY",2],0,function(){return this.year()%100}),j(0,["YYYY",4],0,"year"),j(0,["YYYYY",5],0,"year"),j(0,["YYYYYY",6,!0],0,"year"),k("year","y"),F("year",1),q("Y",ei),q("YY",Kr,zr),q("YYYY",Zr,qr),q("YYYYY",$r,Yr),q("YYYYYY",$r,Yr),X(["YYYYY","YYYYYY"],ui),X("YYYY",function(t,n){n[ui]=2===t.length?e.parseTwoDigitYear(t):b(t)}),X("YY",function(t,n){n[ui]=e.parseTwoDigitYear(t)}),X("Y",function(t,e){e[ui]=parseInt(t,10)}),e.parseTwoDigitYear=function(t){return b(t)+(b(t)>68?1900:2e3)};var vi,yi=nt("FullYear",!0);vi=Array.prototype.indexOf?Array.prototype.indexOf:function(t){var e;for(e=0;e<this.length;++e)if(this[e]===t)return e;return-1},j("M",["MM",2],"Mo",function(){return this.month()+1}),j("MMM",0,0,function(t){return this.localeData().monthsShort(this,t)}),j("MMMM",0,0,function(t){return this.localeData().months(this,t)}),k("month","M"),F("month",8),q("M",Kr),q("MM",Kr,zr),q("MMM",function(t,e){return e.monthsShortRegex(t)}),q("MMMM",function(t,e){return e.monthsRegex(t)}),X(["M","MM"],function(t,e){e[ci]=b(t)-1}),X(["MMM","MMMM"],function(t,e,n,r){var i=n._locale.monthsParse(t,r,n._strict);null!=i?e[ci]=i:d(n).invalidMonth=t});var _i=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,bi="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),wi="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Ei=oi,xi=oi;j("w",["ww",2],"wo","week"),j("W",["WW",2],"Wo","isoWeek"),k("week","w"),k("isoWeek","W"),F("week",5),F("isoWeek",5),q("w",Kr),q("ww",Kr,zr),q("W",Kr),q("WW",Kr,zr),J(["w","ww","W","WW"],function(t,e,n,r){e[r.substr(0,1)]=b(t)});var Ti={dow:0,doy:6};j("d",0,"do","day"),j("dd",0,0,function(t){return this.localeData().weekdaysMin(this,t)}),j("ddd",0,0,function(t){return this.localeData().weekdaysShort(this,t)}),j("dddd",0,0,function(t){return this.localeData().weekdays(this,t)}),j("e",0,0,"weekday"),j("E",0,0,"isoWeekday"),k("day","d"),k("weekday","e"),k("isoWeekday","E"),F("day",11),F("weekday",11),F("isoWeekday",11),q("d",Kr),q("e",Kr),q("E",Kr),q("dd",function(t,e){return e.weekdaysMinRegex(t)}),q("ddd",function(t,e){return e.weekdaysShortRegex(t)}),q("dddd",function(t,e){return e.weekdaysRegex(t)}),J(["dd","ddd","dddd"],function(t,e,n,r){var i=n._locale.weekdaysParse(t,r,n._strict);null!=i?e.d=i:d(n).invalidWeekday=t}),J(["d","e","E"],function(t,e,n,r){e[r]=b(t)});var Si="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Ci="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),Mi="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),Ai=oi,Ii=oi,Ri=oi;j("H",["HH",2],0,"hour"),j("h",["hh",2],0,zt),j("k",["kk",2],0,Wt),j("hmm",0,0,function(){return""+zt.apply(this)+V(this.minutes(),2)}),j("hmmss",0,0,function(){return""+zt.apply(this)+V(this.minutes(),2)+V(this.seconds(),2)}),j("Hmm",0,0,function(){return""+this.hours()+V(this.minutes(),2)}),j("Hmmss",0,0,function(){return""+this.hours()+V(this.minutes(),2)+V(this.seconds(),2)}),qt("a",!0),qt("A",!1),k("hour","h"),F("hour",13),q("a",Yt),q("A",Yt),q("H",Kr),q("h",Kr),q("k",Kr),q("HH",Kr,zr),q("hh",Kr,zr),q("kk",Kr,zr),q("hmm",Qr),q("hmmss",Xr),q("Hmm",Qr),q("Hmmss",Xr),X(["H","HH"],hi),X(["k","kk"],function(t,e,n){var r=b(t);e[hi]=24===r?0:r}),X(["a","A"],function(t,e,n){n._isPm=n._locale.isPM(t),n._meridiem=t}),X(["h","hh"],function(t,e,n){e[hi]=b(t),d(n).bigHour=!0}),X("hmm",function(t,e,n){var r=t.length-2;e[hi]=b(t.substr(0,r)),e[fi]=b(t.substr(r)),d(n).bigHour=!0}),X("hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[hi]=b(t.substr(0,r)),e[fi]=b(t.substr(r,2)),e[di]=b(t.substr(i)),d(n).bigHour=!0}),X("Hmm",function(t,e,n){var r=t.length-2;e[hi]=b(t.substr(0,r)),e[fi]=b(t.substr(r))}),X("Hmmss",function(t,e,n){var r=t.length-4,i=t.length-2;e[hi]=b(t.substr(0,r)),e[fi]=b(t.substr(r,2)),e[di]=b(t.substr(i))});var Pi,Ni=/[ap]\.?m?\.?/i,Di=nt("Hours",!0),Oi={calendar:Dr,longDateFormat:Or,invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:kr,relativeTime:Lr,months:bi,monthsShort:wi,week:Ti,weekdays:Si,weekdaysMin:Mi,weekdaysShort:Ci,meridiemParse:Ni},ki={},Li={},Ui=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Fi=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Bi=/Z|[+-]\d\d(?::?\d\d)?/,Vi=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],ji=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],Hi=/^\/?Date\((\-?\d+)/i,Gi=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,zi={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};e.createFromInputFallback=x("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(t){t._d=new Date(t._i+(t._useUTC?" UTC":""))}),e.ISO_8601=function(){},e.RFC_2822=function(){};var Wi=x("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Se.apply(null,arguments);return this.isValid()&&t.isValid()?t<this?this:t:m()}),qi=x("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var t=Se.apply(null,arguments);return this.isValid()&&t.isValid()?t>this?this:t:m()}),Yi=function(){return Date.now?Date.now():+new Date},Ki=["year","quarter","month","week","day","hour","minute","second","millisecond"];ke("Z",":"),ke("ZZ",""),q("Z",ri),q("ZZ",ri),X(["Z","ZZ"],function(t,e,n){n._useUTC=!0,n._tzm=Le(ri,t)});var Qi=/([\+\-]|\d\d)/gi;e.updateOffset=function(){};var Xi=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Ji=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;Xe.fn=Ne.prototype,Xe.invalid=Pe;var Zi=tn(1,"add"),$i=tn(-1,"subtract");e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var to=x("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(t){return void 0===t?this.localeData():this.locale(t)});j(0,["gg",2],0,function(){return this.weekYear()%100}),j(0,["GG",2],0,function(){return this.isoWeekYear()%100}),Ln("gggg","weekYear"),Ln("ggggg","weekYear"),Ln("GGGG","isoWeekYear"),Ln("GGGGG","isoWeekYear"),k("weekYear","gg"),k("isoWeekYear","GG"),F("weekYear",1),F("isoWeekYear",1),q("G",ei),q("g",ei),q("GG",Kr,zr),q("gg",Kr,zr),q("GGGG",Zr,qr),q("gggg",Zr,qr),q("GGGGG",$r,Yr),q("ggggg",$r,Yr),J(["gggg","ggggg","GGGG","GGGGG"],function(t,e,n,r){e[r.substr(0,2)]=b(t)}),J(["gg","GG"],function(t,n,r,i){n[i]=e.parseTwoDigitYear(t)}),j("Q",0,"Qo","quarter"),k("quarter","Q"),F("quarter",7),q("Q",Gr),X("Q",function(t,e){e[ci]=3*(b(t)-1)}),j("D",["DD",2],"Do","date"),k("date","D"),F("date",9),q("D",Kr),q("DD",Kr,zr),q("Do",function(t,e){return t?e._dayOfMonthOrdinalParse||e._ordinalParse:e._dayOfMonthOrdinalParseLenient}),X(["D","DD"],li),X("Do",function(t,e){e[li]=b(t.match(Kr)[0])});var eo=nt("Date",!0);j("DDD",["DDDD",3],"DDDo","dayOfYear"),k("dayOfYear","DDD"),F("dayOfYear",4),q("DDD",Jr),q("DDDD",Wr),X(["DDD","DDDD"],function(t,e,n){n._dayOfYear=b(t)}),j("m",["mm",2],0,"minute"),k("minute","m"),F("minute",14),q("m",Kr),q("mm",Kr,zr),X(["m","mm"],fi);var no=nt("Minutes",!1);j("s",["ss",2],0,"second"),k("second","s"),F("second",15),q("s",Kr),q("ss",Kr,zr),X(["s","ss"],di);var ro=nt("Seconds",!1);j("S",0,0,function(){return~~(this.millisecond()/100)}),j(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),j(0,["SSS",3],0,"millisecond"),j(0,["SSSS",4],0,function(){return 10*this.millisecond()}),j(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),j(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),j(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),j(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),j(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),k("millisecond","ms"),F("millisecond",16),q("S",Jr,Gr),q("SS",Jr,zr),q("SSS",Jr,Wr);var io;for(io="SSSS";io.length<=9;io+="S")q(io,ti);for(io="S";io.length<=9;io+="S")X(io,Wn);var oo=nt("Milliseconds",!1);j("z",0,0,"zoneAbbr"),j("zz",0,0,"zoneName");var ao=v.prototype;ao.add=Zi,ao.calendar=rn,ao.clone=on,ao.diff=fn,ao.endOf=Sn,ao.format=vn,ao.from=yn,ao.fromNow=_n,ao.to=bn,ao.toNow=wn,ao.get=ot,ao.invalidAt=On,ao.isAfter=an,ao.isBefore=sn,ao.isBetween=un,ao.isSame=cn,ao.isSameOrAfter=ln,ao.isSameOrBefore=hn,ao.isValid=Nn,ao.lang=to,ao.locale=En,ao.localeData=xn,ao.max=qi,ao.min=Wi,ao.parsingFlags=Dn,ao.set=at,ao.startOf=Tn,ao.subtract=$i,ao.toArray=In,ao.toObject=Rn,ao.toDate=An,ao.toISOString=mn,ao.inspect=gn,ao.toJSON=Pn,ao.toString=pn,ao.unix=Mn,ao.valueOf=Cn,ao.creationData=kn,ao.year=yi,ao.isLeapYear=et,ao.weekYear=Un,ao.isoWeekYear=Fn,ao.quarter=ao.quarters=Gn,ao.month=pt,ao.daysInMonth=mt,ao.week=ao.weeks=At,ao.isoWeek=ao.isoWeeks=It,ao.weeksInYear=Vn,ao.isoWeeksInYear=Bn,ao.date=eo,ao.day=ao.days=Ut,ao.weekday=Ft,ao.isoWeekday=Bt,ao.dayOfYear=zn,ao.hour=ao.hours=Di,ao.minute=ao.minutes=no,ao.second=ao.seconds=ro,ao.millisecond=ao.milliseconds=oo,ao.utcOffset=Be,ao.utc=je,ao.local=He,ao.parseZone=Ge,ao.hasAlignedHourOffset=ze,ao.isDST=We,ao.isLocal=Ye,ao.isUtcOffset=Ke,ao.isUtc=Qe,ao.isUTC=Qe,ao.zoneAbbr=qn,ao.zoneName=Yn,ao.dates=x("dates accessor is deprecated. Use date instead.",eo),ao.months=x("months accessor is deprecated. Use month instead",pt),ao.years=x("years accessor is deprecated. Use year instead",yi),ao.zone=x("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",Ve),ao.isDSTShifted=x("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",qe);var so=A.prototype;so.calendar=I,so.longDateFormat=R,so.invalidDate=P,so.ordinal=N,so.preparse=Xn,so.postformat=Xn,so.relativeTime=D,so.pastFuture=O,so.set=C,so.months=ct,so.monthsShort=lt,so.monthsParse=ft,so.monthsRegex=vt,so.monthsShortRegex=gt,so.week=St,so.firstDayOfYear=Mt,so.firstDayOfWeek=Ct,so.weekdays=Nt,so.weekdaysMin=Ot,so.weekdaysShort=Dt,so.weekdaysParse=Lt,so.weekdaysRegex=Vt,so.weekdaysShortRegex=jt,so.weekdaysMinRegex=Ht,so.isPM=Kt,so.meridiem=Qt,$t("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(t){var e=t%10;return t+(1===b(t%100/10)?"th":1===e?"st":2===e?"nd":3===e?"rd":"th")}}),e.lang=x("moment.lang is deprecated. Use moment.locale instead.",$t),e.langData=x("moment.langData is deprecated. Use moment.localeData instead.",ne);var uo=Math.abs,co=mr("ms"),lo=mr("s"),ho=mr("m"),fo=mr("h"),po=mr("d"),mo=mr("w"),go=mr("M"),vo=mr("y"),yo=yr("milliseconds"),_o=yr("seconds"),bo=yr("minutes"),wo=yr("hours"),Eo=yr("days"),xo=yr("months"),To=yr("years"),So=Math.round,Co={ss:44,s:45,m:45,h:22,d:26,M:11},Mo=Math.abs,Ao=Ne.prototype;return Ao.isValid=Re,Ao.abs=or,Ao.add=sr,Ao.subtract=ur,Ao.as=dr,Ao.asMilliseconds=co,Ao.asSeconds=lo,Ao.asMinutes=ho,Ao.asHours=fo,Ao.asDays=po,Ao.asWeeks=mo,Ao.asMonths=go,Ao.asYears=vo,Ao.valueOf=pr,Ao._bubble=lr,Ao.clone=gr,Ao.get=vr,Ao.milliseconds=yo,Ao.seconds=_o,Ao.minutes=bo,Ao.hours=wo,Ao.days=Eo,Ao.weeks=_r,Ao.months=xo,Ao.years=To,Ao.humanize=Tr,Ao.toISOString=Cr,Ao.toString=Cr,Ao.toJSON=Cr,Ao.locale=En,Ao.localeData=xn,Ao.toIsoString=x("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Cr),Ao.lang=to,j("X",0,0,"unix"),j("x",0,0,"valueOf"),q("x",ei),q("X",ii),X("X",function(t,e,n){n._d=new Date(1e3*parseFloat(t,10))}),X("x",function(t,e,n){n._d=new Date(b(t))}),e.version="2.22.1",function(t){Mr=t}(Se),e.fn=ao,e.min=Me,e.max=Ae,e.now=Yi,e.utc=h,e.unix=Kn,e.months=tr,e.isDate=s,e.locale=$t,e.invalid=m,e.duration=Xe,e.isMoment=y,e.weekdays=nr,e.parseZone=Qn,e.localeData=ne,e.isDuration=De,e.monthsShort=er,e.weekdaysMin=ir,e.defineLocale=te,e.updateLocale=ee,e.locales=re,e.weekdaysShort=rr,e.normalizeUnits=L,e.relativeTimeRounding=Er,e.relativeTimeThreshold=xr,e.calendarFormat=nn,e.prototype=ao,e.HTML5_FMT={DATETIME_LOCAL:"YYYY-MM-DDTHH:mm",DATETIME_LOCAL_SECONDS:"YYYY-MM-DDTHH:mm:ss",DATETIME_LOCAL_MS:"YYYY-MM-DDTHH:mm:ss.SSS",DATE:"YYYY-MM-DD",TIME:"HH:mm",TIME_SECONDS:"HH:mm:ss",TIME_MS:"HH:mm:ss.SSS",WEEK:"YYYY-[W]WW",MONTH:"YYYY-MM"},e})}).call(e,n(68)(t))},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,n){var r=n(70);n(75),n(77),n(79),n(81),t.exports=r},function(t,e,n){n(71),t.exports=n(2).default},function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),function(t,e){function r(){}function i(t,e){return function(){t.apply(e,arguments)}}function o(t){if(!(this instanceof o))throw new TypeError("Promises must be constructed via new");if("function"!==typeof t)throw new TypeError("not a function");this._state=0,this._handled=!1,this._value=void 0,this._deferreds=[],h(t,this)}function a(t,e){for(;3===t._state;)t=t._value;if(0===t._state)return void t._deferreds.push(e);t._handled=!0,o._immediateFn(function(){var n=1===t._state?e.onFulfilled:e.onRejected;if(null===n)return void(1===t._state?s:u)(e.promise,t._value);var r;try{r=n(t._value)}catch(t){return void u(e.promise,t)}s(e.promise,r)})}function s(t,e){try{if(e===t)throw new TypeError("A promise cannot be resolved with itself.");if(e&&("object"===typeof e||"function"===typeof e)){var n=e.then;if(e instanceof o)return t._state=3,t._value=e,void c(t);if("function"===typeof n)return void h(i(n,e),t)}t._state=1,t._value=e,c(t)}catch(e){u(t,e)}}function u(t,e){t._state=2,t._value=e,c(t)}function c(t){2===t._state&&0===t._deferreds.length&&o._immediateFn(function(){t._handled||o._unhandledRejectionFn(t._value)});for(var e=0,n=t._deferreds.length;e<n;e++)a(t,t._deferreds[e]);t._deferreds=null}function l(t,e,n){this.onFulfilled="function"===typeof t?t:null,this.onRejected="function"===typeof e?e:null,this.promise=n}function h(t,e){var n=!1;try{t(function(t){n||(n=!0,s(e,t))},function(t){n||(n=!0,u(e,t))})}catch(t){if(n)return;n=!0,u(e,t)}}function f(t,e){return e={exports:{}},t(e,e.exports),e.exports}var d=n(74),p=(n.n(d),setTimeout);o.prototype.catch=function(t){return this.then(null,t)},o.prototype.then=function(t,e){var n=new this.constructor(r);return a(this,new l(t,e,n)),n},o.prototype.finally=function(t){var e=this.constructor;return this.then(function(n){return e.resolve(t()).then(function(){return n})},function(n){return e.resolve(t()).then(function(){return e.reject(n)})})},o.all=function(t){return new o(function(e,n){function r(t,a){try{if(a&&("object"===typeof a||"function"===typeof a)){var s=a.then;if("function"===typeof s)return void s.call(a,function(e){r(t,e)},n)}i[t]=a,0===--o&&e(i)}catch(t){n(t)}}if(!t||"undefined"===typeof t.length)throw new TypeError("Promise.all accepts an array");var i=Array.prototype.slice.call(t);if(0===i.length)return e([]);for(var o=i.length,a=0;a<i.length;a++)r(a,i[a])})},o.resolve=function(t){return t&&"object"===typeof t&&t.constructor===o?t:new o(function(e){e(t)})},o.reject=function(t){return new o(function(e,n){n(t)})},o.race=function(t){return new o(function(e,n){for(var r=0,i=t.length;r<i;r++)t[r].then(e,n)})},o._immediateFn="function"===typeof t&&function(e){t(e)}||function(t){p(t,0)},o._unhandledRejectionFn=function(t){"undefined"!==typeof console&&console&&console.warn("Possible Unhandled Promise Rejection:",t)};var m=function(){if("undefined"!==typeof self)return self;if("undefined"!==typeof window)return window;if("undefined"!==typeof e)return e;throw new Error("unable to locate global object")}();m.Promise||(m.Promise=o);var g=f(function(t){var e=t.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=e)}),v=f(function(t){var e=t.exports={version:"2.5.5"};"number"==typeof __e&&(__e=e)}),y=(v.version,function(t){return"object"===typeof t?null!==t:"function"===typeof t}),_=function(t){if(!y(t))throw TypeError(t+" is not an object!");return t},b=function(t){try{return!!t()}catch(t){return!0}},w=!b(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a}),E=g.document,x=y(E)&&y(E.createElement),T=function(t){return x?E.createElement(t):{}},S=!w&&!b(function(){return 7!=Object.defineProperty(T("div"),"a",{get:function(){return 7}}).a}),C=function(t,e){if(!y(t))return t;var n,r;if(e&&"function"==typeof(n=t.toString)&&!y(r=n.call(t)))return r;if("function"==typeof(n=t.valueOf)&&!y(r=n.call(t)))return r;if(!e&&"function"==typeof(n=t.toString)&&!y(r=n.call(t)))return r;throw TypeError("Can't convert object to primitive value")},M=Object.defineProperty,A=w?Object.defineProperty:function(t,e,n){if(_(t),e=C(e,!0),_(n),S)try{return M(t,e,n)}catch(t){}if("get"in n||"set"in n)throw TypeError("Accessors not supported!");return"value"in n&&(t[e]=n.value),t},I={f:A},R=function(t,e){return{enumerable:!(1&t),configurable:!(2&t),writable:!(4&t),value:e}},P=w?function(t,e,n){return I.f(t,e,R(1,n))}:function(t,e,n){return t[e]=n,t},N={}.hasOwnProperty,D=function(t,e){return N.call(t,e)},O=0,k=Math.random(),L=function(t){return"Symbol(".concat(void 0===t?"":t,")_",(++O+k).toString(36))},U=f(function(t){var e=L("src"),n=Function.toString,r=(""+n).split("toString");v.inspectSource=function(t){return n.call(t)},(t.exports=function(t,n,i,o){var a="function"==typeof i;a&&(D(i,"name")||P(i,"name",n)),t[n]!==i&&(a&&(D(i,e)||P(i,e,t[n]?""+t[n]:r.join(String(n)))),t===g?t[n]=i:o?t[n]?t[n]=i:P(t,n,i):(delete t[n],P(t,n,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[e]||n.call(this)})}),F=function(t){if("function"!=typeof t)throw TypeError(t+" is not a function!");return t},B=function(t,e,n){if(F(t),void 0===e)return t;switch(n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)}}return function(){return t.apply(e,arguments)}},V=function(t,e,n){var r,i,o,a,s=t&V.F,u=t&V.G,c=t&V.S,l=t&V.P,h=t&V.B,f=u?g:c?g[e]||(g[e]={}):(g[e]||{}).prototype,d=u?v:v[e]||(v[e]={}),p=d.prototype||(d.prototype={});u&&(n=e);for(r in n)i=!s&&f&&void 0!==f[r],o=(i?f:n)[r],a=h&&i?B(o,g):l&&"function"==typeof o?B(Function.call,o):o,f&&U(f,r,o,t&V.U),d[r]!=o&&P(d,r,a),l&&p[r]!=o&&(p[r]=o)};g.core=v,V.F=1,V.G=2,V.S=4,V.P=8,V.B=16,V.W=32,V.U=64,V.R=128;var j=V,H={}.toString,G=function(t){return H.call(t).slice(8,-1)},z=Object("z").propertyIsEnumerable(0)?Object:function(t){return"String"==G(t)?t.split(""):Object(t)},W=function(t){if(void 0==t)throw TypeError("Can't call method on  "+t);return t},q=function(t){return Object(W(t))},Y=Math.ceil,K=Math.floor,Q=function(t){return isNaN(t=+t)?0:(t>0?K:Y)(t)},X=Math.min,J=function(t){return t>0?X(Q(t),9007199254740991):0},Z=Array.isArray||function(t){return"Array"==G(t)},$=g["__core-js_shared__"]||(g["__core-js_shared__"]={}),tt=function(t){return $[t]||($[t]={})},et=f(function(t){var e=tt("wks"),n=g.Symbol,r="function"==typeof n;(t.exports=function(t){return e[t]||(e[t]=r&&n[t]||(r?n:L)("Symbol."+t))}).store=e}),nt=et("species"),rt=function(t){var e;return Z(t)&&(e=t.constructor,"function"!=typeof e||e!==Array&&!Z(e.prototype)||(e=void 0),y(e)&&null===(e=e[nt])&&(e=void 0)),void 0===e?Array:e},it=function(t,e){return new(rt(t))(e)},ot=function(t,e){var n=1==t,r=2==t,i=3==t,o=4==t,a=6==t,s=5==t||a,u=e||it;return function(e,c,l){for(var h,f,d=q(e),p=z(d),m=B(c,l,3),g=J(p.length),v=0,y=n?u(e,g):r?u(e,0):void 0;g>v;v++)if((s||v in p)&&(h=p[v],f=m(h,v,d),t))if(n)y[v]=f;else if(f)switch(t){case 3:return!0;case 5:return h;case 6:return v;case 2:y.push(h)}else if(o)return!1;return a?-1:i||o?o:y}},at=et("unscopables"),st=Array.prototype;void 0==st[at]&&P(st,at,{});var ut=function(t){st[at][t]=!0},ct=ot(5),lt=!0;"find"in[]&&Array(1).find(function(){lt=!1}),j(j.P+j.F*lt,"Array",{find:function(t){return ct(this,t,arguments.length>1?arguments[1]:void 0)}}),ut("find");var ht=(v.Array.find,ot(6)),ft=!0;"findIndex"in[]&&Array(1).findIndex(function(){ft=!1}),j(j.P+j.F*ft,"Array",{findIndex:function(t){return ht(this,t,arguments.length>1?arguments[1]:void 0)}}),ut("findIndex");var dt=(v.Array.findIndex,et("match")),pt=function(t){var e;return y(t)&&(void 0!==(e=t[dt])?!!e:"RegExp"==G(t))},mt=function(t,e,n){if(pt(e))throw TypeError("String#"+n+" doesn't accept regex!");return String(W(t))},gt=et("match"),vt="".startsWith;j(j.P+j.F*function(t){var e=/./;try{"/./"[t](e)}catch(n){try{return e[gt]=!1,!"/./"[t](e)}catch(t){}}return!0}("startsWith"),"String",{startsWith:function(t){var e=mt(this,t,"startsWith"),n=J(Math.min(arguments.length>1?arguments[1]:void 0,e.length)),r=String(t);return vt?vt.call(e,r,n):e.slice(n,n+r.length)===r}});v.String.startsWith}.call(e,n(72).setImmediate,n(1))},function(t,e,n){(function(t){function r(t,e){this._id=t,this._clearFn=e}var i="undefined"!==typeof t&&t||"undefined"!==typeof self&&self||window,o=Function.prototype.apply;e.setTimeout=function(){return new r(o.call(setTimeout,i,arguments),clearTimeout)},e.setInterval=function(){return new r(o.call(setInterval,i,arguments),clearInterval)},e.clearTimeout=e.clearInterval=function(t){t&&t.close()},r.prototype.unref=r.prototype.ref=function(){},r.prototype.close=function(){this._clearFn.call(i,this._id)},e.enroll=function(t,e){clearTimeout(t._idleTimeoutId),t._idleTimeout=e},e.unenroll=function(t){clearTimeout(t._idleTimeoutId),t._idleTimeout=-1},e._unrefActive=e.active=function(t){clearTimeout(t._idleTimeoutId);var e=t._idleTimeout;e>=0&&(t._idleTimeoutId=setTimeout(function(){t._onTimeout&&t._onTimeout()},e))},n(73),e.setImmediate="undefined"!==typeof self&&self.setImmediate||"undefined"!==typeof t&&t.setImmediate||this&&this.setImmediate,e.clearImmediate="undefined"!==typeof self&&self.clearImmediate||"undefined"!==typeof t&&t.clearImmediate||this&&this.clearImmediate}).call(e,n(1))},function(t,e,n){(function(t,e){!function(t,n){"use strict";function r(t){"function"!==typeof t&&(t=new Function(""+t));for(var e=new Array(arguments.length-1),n=0;n<e.length;n++)e[n]=arguments[n+1];var r={callback:t,args:e};return c[u]=r,s(u),u++}function i(t){delete c[t]}function o(t){var e=t.callback,r=t.args;switch(r.length){case 0:e();break;case 1:e(r[0]);break;case 2:e(r[0],r[1]);break;case 3:e(r[0],r[1],r[2]);break;default:e.apply(n,r)}}function a(t){if(l)setTimeout(a,0,t);else{var e=c[t];if(e){l=!0;try{o(e)}finally{i(t),l=!1}}}}if(!t.setImmediate){var s,u=1,c={},l=!1,h=t.document,f=Object.getPrototypeOf&&Object.getPrototypeOf(t);f=f&&f.setTimeout?f:t,"[object process]"==={}.toString.call(t.process)?function(){s=function(t){e.nextTick(function(){a(t)})}}():function(){if(t.postMessage&&!t.importScripts){var e=!0,n=t.onmessage;return t.onmessage=function(){e=!1},t.postMessage("","*"),t.onmessage=n,e}}()?function(){var e="setImmediate$"+Math.random()+"$",n=function(n){n.source===t&&"string"===typeof n.data&&0===n.data.indexOf(e)&&a(+n.data.slice(e.length))};t.addEventListener?t.addEventListener("message",n,!1):t.attachEvent("onmessage",n),s=function(n){t.postMessage(e+n,"*")}}():t.MessageChannel?function(){var t=new MessageChannel;t.port1.onmessage=function(t){a(t.data)},s=function(e){t.port2.postMessage(e)}}():h&&"onreadystatechange"in h.createElement("script")?function(){var t=h.documentElement;s=function(e){var n=h.createElement("script");n.onreadystatechange=function(){a(e),n.onreadystatechange=null,t.removeChild(n),n=null},t.appendChild(n)}}():function(){s=function(t){setTimeout(a,0,t)}}(),f.setImmediate=r,f.clearImmediate=i}}("undefined"===typeof self?"undefined"===typeof t?this:t:self)}).call(e,n(1),n(7))},function(t,e){!function(t){"use strict";function e(t){if("string"!==typeof t&&(t=String(t)),/[^a-z0-9\-#$%&'*+.\^_`|~]/i.test(t))throw new TypeError("Invalid character in header field name");return t.toLowerCase()}function n(t){return"string"!==typeof t&&(t=String(t)),t}function r(t){var e={next:function(){var e=t.shift();return{done:void 0===e,value:e}}};return v.iterable&&(e[Symbol.iterator]=function(){return e}),e}function i(t){this.map={},t instanceof i?t.forEach(function(t,e){this.append(e,t)},this):Array.isArray(t)?t.forEach(function(t){this.append(t[0],t[1])},this):t&&Object.getOwnPropertyNames(t).forEach(function(e){this.append(e,t[e])},this)}function o(t){if(t.bodyUsed)return Promise.reject(new TypeError("Already read"));t.bodyUsed=!0}function a(t){return new Promise(function(e,n){t.onload=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function s(t){var e=new FileReader,n=a(e);return e.readAsArrayBuffer(t),n}function u(t){var e=new FileReader,n=a(e);return e.readAsText(t),n}function c(t){for(var e=new Uint8Array(t),n=new Array(e.length),r=0;r<e.length;r++)n[r]=String.fromCharCode(e[r]);return n.join("")}function l(t){if(t.slice)return t.slice(0);var e=new Uint8Array(t.byteLength);return e.set(new Uint8Array(t)),e.buffer}function h(){return this.bodyUsed=!1,this._initBody=function(t){if(this._bodyInit=t,t)if("string"===typeof t)this._bodyText=t;else if(v.blob&&Blob.prototype.isPrototypeOf(t))this._bodyBlob=t;else if(v.formData&&FormData.prototype.isPrototypeOf(t))this._bodyFormData=t;else if(v.searchParams&&URLSearchParams.prototype.isPrototypeOf(t))this._bodyText=t.toString();else if(v.arrayBuffer&&v.blob&&_(t))this._bodyArrayBuffer=l(t.buffer),this._bodyInit=new Blob([this._bodyArrayBuffer]);else{if(!v.arrayBuffer||!ArrayBuffer.prototype.isPrototypeOf(t)&&!b(t))throw new Error("unsupported BodyInit type");this._bodyArrayBuffer=l(t)}else this._bodyText="";this.headers.get("content-type")||("string"===typeof t?this.headers.set("content-type","text/plain;charset=UTF-8"):this._bodyBlob&&this._bodyBlob.type?this.headers.set("content-type",this._bodyBlob.type):v.searchParams&&URLSearchParams.prototype.isPrototypeOf(t)&&this.headers.set("content-type","application/x-www-form-urlencoded;charset=UTF-8"))},v.blob&&(this.blob=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return Promise.resolve(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(new Blob([this._bodyArrayBuffer]));if(this._bodyFormData)throw new Error("could not read FormData body as blob");return Promise.resolve(new Blob([this._bodyText]))},this.arrayBuffer=function(){return this._bodyArrayBuffer?o(this)||Promise.resolve(this._bodyArrayBuffer):this.blob().then(s)}),this.text=function(){var t=o(this);if(t)return t;if(this._bodyBlob)return u(this._bodyBlob);if(this._bodyArrayBuffer)return Promise.resolve(c(this._bodyArrayBuffer));if(this._bodyFormData)throw new Error("could not read FormData body as text");return Promise.resolve(this._bodyText)},v.formData&&(this.formData=function(){return this.text().then(p)}),this.json=function(){return this.text().then(JSON.parse)},this}function f(t){var e=t.toUpperCase();return w.indexOf(e)>-1?e:t}function d(t,e){e=e||{};var n=e.body;if(t instanceof d){if(t.bodyUsed)throw new TypeError("Already read");this.url=t.url,this.credentials=t.credentials,e.headers||(this.headers=new i(t.headers)),this.method=t.method,this.mode=t.mode,n||null==t._bodyInit||(n=t._bodyInit,t.bodyUsed=!0)}else this.url=String(t);if(this.credentials=e.credentials||this.credentials||"omit",!e.headers&&this.headers||(this.headers=new i(e.headers)),this.method=f(e.method||this.method||"GET"),this.mode=e.mode||this.mode||null,this.referrer=null,("GET"===this.method||"HEAD"===this.method)&&n)throw new TypeError("Body not allowed for GET or HEAD requests");this._initBody(n)}function p(t){var e=new FormData;return t.trim().split("&").forEach(function(t){if(t){var n=t.split("="),r=n.shift().replace(/\+/g," "),i=n.join("=").replace(/\+/g," ");e.append(decodeURIComponent(r),decodeURIComponent(i))}}),e}function m(t){var e=new i;return t.replace(/\r?\n[\t ]+/g," ").split(/\r?\n/).forEach(function(t){var n=t.split(":"),r=n.shift().trim();if(r){var i=n.join(":").trim();e.append(r,i)}}),e}function g(t,e){e||(e={}),this.type="default",this.status=void 0===e.status?200:e.status,this.ok=this.status>=200&&this.status<300,this.statusText="statusText"in e?e.statusText:"OK",this.headers=new i(e.headers),this.url=e.url||"",this._initBody(t)}if(!t.fetch){var v={searchParams:"URLSearchParams"in t,iterable:"Symbol"in t&&"iterator"in Symbol,blob:"FileReader"in t&&"Blob"in t&&function(){try{return new Blob,!0}catch(t){return!1}}(),formData:"FormData"in t,arrayBuffer:"ArrayBuffer"in t};if(v.arrayBuffer)var y=["[object Int8Array]","[object Uint8Array]","[object Uint8ClampedArray]","[object Int16Array]","[object Uint16Array]","[object Int32Array]","[object Uint32Array]","[object Float32Array]","[object Float64Array]"],_=function(t){return t&&DataView.prototype.isPrototypeOf(t)},b=ArrayBuffer.isView||function(t){return t&&y.indexOf(Object.prototype.toString.call(t))>-1};i.prototype.append=function(t,r){t=e(t),r=n(r);var i=this.map[t];this.map[t]=i?i+","+r:r},i.prototype.delete=function(t){delete this.map[e(t)]},i.prototype.get=function(t){return t=e(t),this.has(t)?this.map[t]:null},i.prototype.has=function(t){return this.map.hasOwnProperty(e(t))},i.prototype.set=function(t,r){this.map[e(t)]=n(r)},i.prototype.forEach=function(t,e){for(var n in this.map)this.map.hasOwnProperty(n)&&t.call(e,this.map[n],n,this)},i.prototype.keys=function(){var t=[];return this.forEach(function(e,n){t.push(n)}),r(t)},i.prototype.values=function(){var t=[];return this.forEach(function(e){t.push(e)}),r(t)},i.prototype.entries=function(){var t=[];return this.forEach(function(e,n){t.push([n,e])}),r(t)},v.iterable&&(i.prototype[Symbol.iterator]=i.prototype.entries);var w=["DELETE","GET","HEAD","OPTIONS","POST","PUT"];d.prototype.clone=function(){return new d(this,{body:this._bodyInit})},h.call(d.prototype),h.call(g.prototype),g.prototype.clone=function(){return new g(this._bodyInit,{status:this.status,statusText:this.statusText,headers:new i(this.headers),url:this.url})},g.error=function(){var t=new g(null,{status:0,statusText:""});return t.type="error",t};var E=[301,302,303,307,308];g.redirect=function(t,e){if(-1===E.indexOf(e))throw new RangeError("Invalid status code");return new g(null,{status:e,headers:{location:t}})},t.Headers=i,t.Request=d,t.Response=g,t.fetch=function(t,e){return new Promise(function(n,r){var i=new d(t,e),o=new XMLHttpRequest;o.onload=function(){var t={status:o.status,statusText:o.statusText,headers:m(o.getAllResponseHeaders()||"")};t.url="responseURL"in o?o.responseURL:t.headers.get("X-Request-URL");var e="response"in o?o.response:o.responseText;n(new g(e,t))},o.onerror=function(){r(new TypeError("Network request failed"))},o.ontimeout=function(){r(new TypeError("Network request failed"))},o.open(i.method,i.url,!0),"include"===i.credentials?o.withCredentials=!0:"omit"===i.credentials&&(o.withCredentials=!1),"responseType"in o&&v.blob&&(o.responseType="blob"),i.headers.forEach(function(t,e){o.setRequestHeader(e,t)}),o.send("undefined"===typeof i._bodyInit?null:i._bodyInit)})},t.fetch.polyfill=!0}}("undefined"!==typeof self?self:this)},function(t,e,n){n(76)},function(t,e,n){(function(t){(function(){function t(t){return"string"==typeof t}function e(t){return"boolean"==typeof t}function r(){}function i(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&"undefined"==typeof t.call)return"object";return e}function o(t){return null===t}function a(t){return"array"==i(t)}function s(t){var e=i(t);return"array"==e||"object"==e&&"number"==typeof t.length}function u(t){return"function"==i(t)}function c(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function l(t,e,n){return t.call.apply(t.bind,arguments)}function h(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function f(t,e,n){return f=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?l:h,f.apply(null,arguments)}function d(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function p(t,e){function n(){}n.prototype=e.prototype,t.lb=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.ad=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function m(t){t.prototype.then=t.prototype.then,t.prototype.$goog_Thenable=!0}function g(t){if(!t)return!1;try{return!!t.$goog_Thenable}catch(t){return!1}}function v(t){if(Error.captureStackTrace)Error.captureStackTrace(this,v);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function y(t,e){t=t.split("%s");for(var n="",r=t.length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");v.call(this,n+t[r])}function _(t,e){throw new y("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function b(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function w(t,e){t.f(e),100>t.b&&(t.b++,e.next=t.a,t.a=e)}function E(){this.b=this.a=null}function x(){var t=Fu,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function T(){this.next=this.b=this.a=null}function S(e,n){var r=e.length,i=t(e)?e.split(""):e;for(--r;0<=r;--r)r in i&&n.call(void 0,i[r],r,e)}function C(e){t:{for(var n=Gr,r=e.length,i=t(e)?e.split(""):e,o=0;o<r;o++)if(o in i&&n.call(void 0,i[o],o,e)){n=o;break t}n=-1}return 0>n?null:t(e)?e.charAt(n):e[n]}function M(t,e){return 0<=bu(t,e)}function A(t,e){e=bu(t,e);var n;return(n=0<=e)&&Array.prototype.splice.call(t,e,1),n}function I(t,e){var n=0;S(t,function(r,i){e.call(void 0,r,i,t)&&1==Array.prototype.splice.call(t,i,1).length&&n++})}function R(t){return Array.prototype.concat.apply([],arguments)}function P(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function N(t,e){for(var n=t.split("%s"),r="",i=Array.prototype.slice.call(arguments,1);i.length&&1<n.length;)r+=n.shift()+i.shift();return r+n.join("%s")}function D(t){return Pu.test(t)?(-1!=t.indexOf("&")&&(t=t.replace(Su,"&amp;")),-1!=t.indexOf("<")&&(t=t.replace(Cu,"&lt;")),-1!=t.indexOf(">")&&(t=t.replace(Mu,"&gt;")),-1!=t.indexOf('"')&&(t=t.replace(Au,"&quot;")),-1!=t.indexOf("'")&&(t=t.replace(Iu,"&#39;")),-1!=t.indexOf("\0")&&(t=t.replace(Ru,"&#0;")),t):t}function O(t,e){return-1!=t.indexOf(e)}function k(t,e){return t<e?-1:t>e?1:0}function L(t){return O(_u,t)}function U(t,e){for(var n in t)e.call(void 0,t[n],n,t)}function F(t){for(var e in t)return!1;return!0}function B(t){var e,n={};for(e in t)n[e]=t[e];return n}function V(t,e){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(var o=0;o<Lu.length;o++)n=Lu[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function j(t){pu.setTimeout(function(){throw t},0)}function H(){var t=pu.MessageChannel;if("undefined"===typeof t&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!L("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;t=e.document,t.open(),t.write(""),t.close();var n="callImmediate"+Math.random(),r="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=f(function(t){"*"!=r&&t.origin!=r||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,r)}}}),"undefined"!==typeof t&&!L("Trident")&&!L("MSIE")){var e=new t,n={},r=n;return e.port1.onmessage=function(){if(void 0!==n.next){n=n.next;var t=n.rb;n.rb=null,t()}},function(t){r.next={rb:t},r=r.next,e.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){pu.setTimeout(t,0)}}function G(t,e){ku||z(),Uu||(ku(),Uu=!0),Fu.add(t,e)}function z(){if(pu.Promise&&pu.Promise.resolve){var t=pu.Promise.resolve(void 0);ku=function(){t.then(W)}}else ku=function(){var t=W;!u(pu.setImmediate)||pu.Window&&pu.Window.prototype&&!L("Edge")&&pu.Window.prototype.setImmediate==pu.setImmediate?(Ou||(Ou=H()),Ou(t)):pu.setImmediate(t)}}function W(){for(var t;t=x();){try{t.a.call(t.b)}catch(t){j(t)}w(yu,t)}Uu=!1}function q(t,e){if(this.a=Bu,this.j=void 0,this.f=this.b=this.c=null,this.g=this.h=!1,t!=r)try{var n=this;t.call(e,function(t){rt(n,Vu,t)},function(t){if(!(t instanceof ht))try{if(t instanceof Error)throw t;throw Error("Promise rejected.")}catch(t){}rt(n,ju,t)})}catch(t){rt(this,ju,t)}}function Y(){this.next=this.f=this.b=this.g=this.a=null,this.c=!1}function K(t,e,n){var r=Hu.get();return r.g=t,r.b=e,r.f=n,r}function Q(t){if(t instanceof q)return t;var e=new q(r);return rt(e,Vu,t),e}function X(t){return new q(function(e,n){n(t)})}function J(t,e,n){it(t,e,n,null)||G(d(e,t))}function Z(t){return new q(function(e,n){var r=t.length,i=[];if(r)for(var o,a=function(t,n){r--,i[t]=n,0==r&&e(i)},s=function(t){n(t)},u=0;u<t.length;u++)o=t[u],J(o,d(a,u),s);else e(i)})}function $(t){return new q(function(e){var n=t.length,r=[];if(n)for(var i,o=function(t,i,o){n--,r[t]=i?{Zb:!0,value:o}:{Zb:!1,reason:o},0==n&&e(r)},a=0;a<t.length;a++)i=t[a],J(i,d(o,a,!0),d(o,a,!1));else e(r)})}function tt(t,e){if(t.a==Bu)if(t.c){var n=t.c;if(n.b){for(var r=0,i=null,o=null,a=n.b;a&&(a.c||(r++,a.a==t&&(i=a),!(i&&1<r)));a=a.next)i||(o=a);i&&(n.a==Bu&&1==r?tt(n,e):(o?(r=o,r.next==n.f&&(n.f=r),r.next=r.next.next):st(n),ut(n,i,ju,e)))}t.c=null}else rt(t,ju,e)}function et(t,e){t.b||t.a!=Vu&&t.a!=ju||at(t),t.f?t.f.next=e:t.b=e,t.f=e}function nt(t,e,n,r){var i=K(null,null,null);return i.a=new q(function(t,o){i.g=e?function(n){try{var i=e.call(r,n);t(i)}catch(t){o(t)}}:t,i.b=n?function(e){try{var i=n.call(r,e);void 0===i&&e instanceof ht?o(e):t(i)}catch(t){o(t)}}:o}),i.a.c=t,et(t,i),i.a}function rt(t,e,n){t.a==Bu&&(t===n&&(e=ju,n=new TypeError("Promise cannot resolve to itself")),t.a=1,it(n,t.Kc,t.Lc,t)||(t.j=n,t.a=e,t.c=null,at(t),e!=ju||n instanceof ht||lt(t,n)))}function it(t,e,n,i){if(t instanceof q)return et(t,K(e||r,n||null,i)),!0;if(g(t))return t.then(e,n,i),!0;if(c(t))try{var o=t.then;if(u(o))return ot(t,o,e,n,i),!0}catch(t){return n.call(i,t),!0}return!1}function ot(t,e,n,r,i){function o(t){s||(s=!0,r.call(i,t))}function a(t){s||(s=!0,n.call(i,t))}var s=!1;try{e.call(t,a,o)}catch(t){o(t)}}function at(t){t.h||(t.h=!0,G(t.Ub,t))}function st(t){var e=null;return t.b&&(e=t.b,t.b=e.next,e.next=null),t.b||(t.f=null),e}function ut(t,e,n,r){if(n==ju&&e.b&&!e.c)for(;t&&t.g;t=t.c)t.g=!1;if(e.a)e.a.c=null,ct(e,n,r);else try{e.c?e.g.call(e.f):ct(e,n,r)}catch(t){Gu.call(null,t)}w(Hu,e)}function ct(t,e,n){e==Vu?t.g.call(t.f,n):t.b&&t.b.call(t.f,n)}function lt(t,e){t.g=!0,G(function(){t.g&&Gu.call(null,e)})}function ht(t){v.call(this,t)}function ft(){0!=zu&&(Wu[this[mu]||(this[mu]=++gu)]=this),this.pa=this.pa,this.oa=this.oa}function dt(t){if(!t.pa&&(t.pa=!0,t.ua(),0!=zu)){var e=t[mu]||(t[mu]=++gu);if(0!=zu&&t.oa&&0<t.oa.length)throw Error(t+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete Wu[e]}}function pt(t){return pt[" "](t),t}function mt(t,e){var n=rc;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}function gt(){var t=pu.document;return t?t.documentMode:void 0}function vt(t){return mt(t,function(){for(var e=0,n=Tu(String(qu)).split("."),r=Tu(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=k(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||k(0==a[2].length,0==s[2].length)||k(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}function yt(t,e){this.type=t,this.b=this.target=e,this.Eb=!0}function _t(e,n){if(yt.call(this,e?e.type:""),this.relatedTarget=this.b=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.a=null,e){var r=this.type=e.type,i=e.changedTouches?e.changedTouches[0]:null;if(this.target=e.target||e.srcElement,this.b=n,n=e.relatedTarget){if(Ju){t:{try{pt(n.nodeName);var o=!0;break t}catch(t){}o=!1}o||(n=null)}}else"mouseover"==r?n=e.fromElement:"mouseout"==r&&(n=e.toElement);this.relatedTarget=n,null===i?(this.clientX=void 0!==e.clientX?e.clientX:e.pageX,this.clientY=void 0!==e.clientY?e.clientY:e.pageY,this.screenX=e.screenX||0,this.screenY=e.screenY||0):(this.clientX=void 0!==i.clientX?i.clientX:i.pageX,this.clientY=void 0!==i.clientY?i.clientY:i.pageY,this.screenX=i.screenX||0,this.screenY=i.screenY||0),this.button=e.button,this.key=e.key||"",this.ctrlKey=e.ctrlKey,this.altKey=e.altKey,this.shiftKey=e.shiftKey,this.metaKey=e.metaKey,this.pointerId=e.pointerId||0,this.pointerType=t(e.pointerType)?e.pointerType:cc[e.pointerType]||"",this.a=e,e.defaultPrevented&&this.preventDefault()}}function bt(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.La=i,this.key=++hc,this.ma=this.Ha=!1}function wt(t){t.ma=!0,t.listener=null,t.proxy=null,t.src=null,t.La=null}function Et(t){this.src=t,this.a={},this.b=0}function xt(t,e){var n=e.type;n in t.a&&A(t.a[n],e)&&(wt(e),0==t.a[n].length&&(delete t.a[n],t.b--))}function Tt(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.ma&&o.listener==e&&o.capture==!!n&&o.La==r)return i}return-1}function St(t,e,n,r,i){if(r&&r.once)At(t,e,n,r,i);else if(a(e))for(var o=0;o<e.length;o++)St(t,e[o],n,r,i);else n=Lt(n),t&&t[lc]?Ft(t,e,n,c(r)?!!r.capture:!!r,i):Ct(t,e,n,!1,r,i)}function Ct(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=c(i)?!!i.capture:!!i,s=kt(t);if(s||(t[fc]=s=new Et(t)),n=s.add(e,n,r,a,o),!n.proxy){if(r=Mt(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)uc||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(Pt(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}pc++}}function Mt(){var t=Ot,e=ac?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}function At(t,e,n,r,i){if(a(e))for(var o=0;o<e.length;o++)At(t,e[o],n,r,i);else n=Lt(n),t&&t[lc]?Bt(t,e,n,c(r)?!!r.capture:!!r,i):Ct(t,e,n,!0,r,i)}function It(t,e,n,r,i){if(a(e))for(var o=0;o<e.length;o++)It(t,e[o],n,r,i);else r=c(r)?!!r.capture:!!r,n=Lt(n),t&&t[lc]?(t=t.u,(e=String(e).toString())in t.a&&(o=t.a[e],-1<(n=Tt(o,n,r,i))&&(wt(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=kt(t))&&(e=t.a[e.toString()],t=-1,e&&(t=Tt(e,n,r,i)),(n=-1<t?e[t]:null)&&Rt(n))}function Rt(t){if("number"!=typeof t&&t&&!t.ma){var e=t.src;if(e&&e[lc])xt(e.u,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(Pt(n),r):e.addListener&&e.removeListener&&e.removeListener(r),pc--,(n=kt(e))?(xt(n,t),0==n.b&&(n.src=null,e[fc]=null)):wt(t)}}}function Pt(t){return t in dc?dc[t]:dc[t]="on"+t}function Nt(t,e,n,r){var i=!0;if((t=kt(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.ma&&(o=Dt(o,r),i=i&&!1!==o)}return i}function Dt(t,e){var n=t.listener,r=t.La||t.src;return t.Ha&&Rt(t),n.call(r,e)}function Ot(t,e){if(t.ma)return!0;if(!ac){if(!e)t:{e=["window","event"];for(var n=pu,r=0;r<e.length;r++)if(null==(n=n[e[r]])){e=null;break t}e=n}if(r=e,e=new _t(r,this),n=!0,!(0>r.keyCode||void 0!=r.returnValue)){t:{var i=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){i=!0}(i||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],i=e.b;i;i=i.parentNode)r.push(i);for(t=t.type,i=r.length-1;0<=i;i--){e.b=r[i];var o=Nt(r[i],t,!0,e);n=n&&o}for(i=0;i<r.length;i++)e.b=r[i],o=Nt(r[i],t,!1,e),n=n&&o}return n}return Dt(t,new _t(e,this))}function kt(t){return t=t[fc],t instanceof Et?t:null}function Lt(t){return u(t)?t:(t[mc]||(t[mc]=function(e){return t.handleEvent(e)}),t[mc])}function Ut(){ft.call(this),this.u=new Et(this),this.Mb=this,this.Ta=null}function Ft(t,e,n,r,i){t.u.add(String(e),n,!1,r,i)}function Bt(t,e,n,r,i){t.u.add(String(e),n,!0,r,i)}function Vt(t,e,n,r){if(!(e=t.u.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.ma&&a.capture==n){var s=a.listener,u=a.La||a.src;a.Ha&&xt(t.u,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Eb}function jt(t,e,n){if(u(t))n&&(t=f(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=f(t.handleEvent,t)}return 2147483647<Number(e)?-1:pu.setTimeout(t,e||0)}function Ht(t){var e=null;return new q(function(n,r){-1==(e=jt(function(){n(void 0)},t))&&r(Error("Failed to schedule timer."))}).m(function(t){throw pu.clearTimeout(e),t})}function Gt(e){if(e.S&&"function"==typeof e.S)return e.S();if(t(e))return e.split("");if(s(e)){for(var n=[],r=e.length,i=0;i<r;i++)n.push(e[i]);return n}n=[],r=0;for(i in e)n[r++]=e[i];return n}function zt(e){if(e.U&&"function"==typeof e.U)return e.U();if(!e.S||"function"!=typeof e.S){if(s(e)||t(e)){var n=[];e=e.length;for(var r=0;r<e;r++)n.push(r);return n}n=[],r=0;for(var i in e)n[r++]=i;return n}}function Wt(e,n){if(e.forEach&&"function"==typeof e.forEach)e.forEach(n,void 0);else if(s(e)||t(e))wu(e,n,void 0);else for(var r=zt(e),i=Gt(e),o=i.length,a=0;a<o;a++)n.call(void 0,i[a],r&&r[a],e)}function qt(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof qt)for(n=t.U(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function Yt(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];Kt(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],Kt(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function Kt(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function Qt(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Xt(t,e){if(this.b=this.l=this.c="",this.j=null,this.h=this.g="",this.f=!1,t instanceof Xt){this.f=void 0!==e?e:t.f,Jt(this,t.c),this.l=t.l,this.b=t.b,Zt(this,t.j),this.g=t.g,e=t.a;var n=new se;n.c=e.c,e.a&&(n.a=new qt(e.a),n.b=e.b),$t(this,n),this.h=t.h}else t&&(n=String(t).match(gc))?(this.f=!!e,Jt(this,n[1]||"",!0),this.l=ie(n[2]||""),this.b=ie(n[3]||"",!0),Zt(this,n[4]),this.g=ie(n[5]||"",!0),$t(this,n[6]||"",!0),this.h=ie(n[7]||"")):(this.f=!!e,this.a=new se(null,this.f))}function Jt(t,e,n){t.c=n?ie(e,!0):e,t.c&&(t.c=t.c.replace(/:$/,""))}function Zt(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.j=e}else t.j=null}function $t(t,e,n){e instanceof se?(t.a=e,pe(t.a,t.f)):(n||(e=oe(e,bc)),t.a=new se(e,t.f))}function te(t,e,n){t.a.set(e,n)}function ee(t,e){return t.a.get(e)}function ne(t){return t instanceof Xt?new Xt(t):new Xt(t,void 0)}function re(t,e){var n=new Xt(null,void 0);return Jt(n,"https"),t&&(n.b=t),e&&(n.g=e),n}function ie(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function oe(e,n,r){return t(e)?(e=encodeURI(e).replace(n,ae),r&&(e=e.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),e):null}function ae(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)}function se(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function ue(t){t.a||(t.a=new qt,t.b=0,t.c&&Qt(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function ce(t){var e=zt(t);if("undefined"==typeof e)throw Error("Keys are undefined");var n=new se(null,void 0);t=Gt(t);for(var r=0;r<e.length;r++){var i=e[r],o=t[r];a(o)?fe(n,i,o):n.add(i,o)}return n}function le(t,e){ue(t),e=de(t,e),Kt(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,t=t.a,Kt(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&Yt(t)))}function he(t,e){return ue(t),e=de(t,e),Kt(t.a.b,e)}function fe(t,e,n){le(t,e),0<n.length&&(t.c=null,t.a.set(de(t,e),P(n)),t.b+=n.length)}function de(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function pe(t,e){e&&!t.f&&(ue(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(le(this,e),fe(this,n,t))},t)),t.f=e}function me(){this.a="",this.b=xc}function ge(t){return t instanceof me&&t.constructor===me&&t.b===xc?t.a:(_("expected object of type Const, got '"+t+"'"),"type_error:Const")}function ve(t){var e=new me;return e.a=t,e}function ye(){this.a="",this.b=Cc}function _e(t){return t instanceof ye&&t.constructor===ye&&t.b===Cc?t.a:(_("expected object of type TrustedResourceUrl, got '"+t+"' of type "+i(t)),"type_error:TrustedResourceUrl")}function be(t,e){var n=ge(t);if(!Sc.test(n))throw Error("Invalid TrustedResourceUrl format: "+n);return t=n.replace(Tc,function(t,r){if(!Object.prototype.hasOwnProperty.call(e,r))throw Error('Found marker, "'+r+'", in format string, "'+n+'", but no valid label mapping found in args: '+JSON.stringify(e));return t=e[r],t instanceof me?ge(t):encodeURIComponent(String(t))}),we(t)}function we(t){var e=new ye;return e.a=t,e}function Ee(){this.a="",this.b=Ac}function xe(t){return t instanceof Ee&&t.constructor===Ee&&t.b===Ac?t.a:(_("expected object of type SafeUrl, got '"+t+"' of type "+i(t)),"type_error:SafeUrl")}function Te(t){return t instanceof Ee?t:(t=t.la?t.ja():String(t),Mc.test(t)||(t="about:invalid#zClosurez"),Se(t))}function Se(t){var e=new Ee;return e.a=t,e}function Ce(){this.a="",this.b=Ic}function Me(t){return t instanceof Ce&&t.constructor===Ce&&t.b===Ic?t.a:(_("expected object of type SafeHtml, got '"+t+"' of type "+i(t)),"type_error:SafeHtml")}function Ae(t){var e=new Ce;return e.a=t,e}function Ie(e){var n=document;return t(e)?n.getElementById(e):e}function Re(t,e){U(e,function(e,n){e&&e.la&&(e=e.ja()),"style"==n?t.style.cssText=e:"class"==n?t.className=e:"for"==n?t.htmlFor=e:Rc.hasOwnProperty(n)?t.setAttribute(Rc[n],e):0==n.lastIndexOf("aria-",0)||0==n.lastIndexOf("data-",0)?t.setAttribute(n,e):t[n]=e})}function Pe(e,n,r){var i=arguments,o=document,s=String(i[0]),u=i[1];if(!Ec&&u&&(u.name||u.type)){if(s=["<",s],u.name&&s.push(' name="',D(u.name),'"'),u.type){s.push(' type="',D(u.type),'"');var c={};V(c,u),delete c.type,u=c}s.push(">"),s=s.join("")}return s=o.createElement(s),u&&(t(u)?s.className=u:a(u)?s.className=u.join(" "):Re(s,u)),2<i.length&&Ne(o,s,i),s}function Ne(e,n,r){function i(r){r&&n.appendChild(t(r)?e.createTextNode(r):r)}for(var o=2;o<r.length;o++){var a=r[o];!s(a)||c(a)&&0<a.nodeType?i(a):wu(De(a)?P(a):a,i)}}function De(t){if(t&&"number"==typeof t.length){if(c(t))return"function"==typeof t.item||"string"==typeof t.item;if(u(t))return"function"==typeof t.item}return!1}function Oe(t){var e=[];return Le(new ke,t,e),e.join("")}function ke(){}function Le(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(a(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),Le(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){n.push("{"),i="";for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&"function"!=typeof(o=e[r])&&(n.push(i),Ue(r,n),n.push(":"),Le(t,o,n),i=",");return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":Ue(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}function Ue(t,e){e.push('"',t.replace(Nc,function(t){var e=Pc[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Pc[t]=e),e}),'"')}function Fe(){var t=nn();return Ku&&!!nc&&11==nc||/Edge\/\d+/.test(t)}function Be(){return pu.window&&pu.window.location.href||self&&self.location&&self.location.href||""}function Ve(t,e){e=e||pu.window;var n="about:blank";t&&(n=xe(Te(t))),e.location.href=n}function je(t,e){var n,r=[];for(n in t)if(n in e)if(typeof t[n]!=typeof e[n])r.push(n);else if(a(t[n])){t:{var i=void 0,o=t[n],s=e[n];for(i in o)if(!(i in s)||o[i]!==s[i]){i=!1;break t}for(i in s)if(!(i in o)){i=!1;break t}i=!0}i||r.push(n)}else"object"==typeof t[n]&&null!=t[n]&&null!=e[n]?0<je(t[n],e[n]).length&&r.push(n):t[n]!==e[n]&&r.push(n);else r.push(n);for(n in e)n in t||r.push(n);return r}function He(){var t=nn();return!((t=tn(t)!=kc?null:(t=t.match(/\sChrome\/(\d+)/i))&&2==t.length?parseInt(t[1],10):null)&&30>t)&&(!Ku||!nc||9<nc)}function Ge(t){return t=(t||nn()).toLowerCase(),!!(t.match(/android/)||t.match(/webos/)||t.match(/iphone|ipad|ipod/)||t.match(/blackberry/)||t.match(/windows phone/)||t.match(/iemobile/))}function ze(t){t=t||pu.window;try{t.close()}catch(t){}}function We(t,e,n){var r=Math.floor(1e9*Math.random()).toString();e=e||500,n=n||600;var i=(window.screen.availHeight-n)/2,o=(window.screen.availWidth-e)/2;e={width:e,height:n,top:0<i?i:0,left:0<o?o:0,location:!0,resizable:!0,statusbar:!0,toolbar:!1},n=nn().toLowerCase(),r&&(e.target=r,O(n,"crios/")&&(e.target="_blank")),tn(nn())==Oc&&(t=t||"http://localhost",e.scrollbars=!0),n=t||"",(t=e)||(t={}),r=window,e=n instanceof Ee?n:Te("undefined"!=typeof n.href?n.href:String(n)),n=t.target||n.target,i=[];for(a in t)switch(a){case"width":case"height":case"top":case"left":i.push(a+"="+t[a]);break;case"target":case"noopener":case"noreferrer":break;default:i.push(a+"="+(t[a]?1:0))}var a=i.join(",");if((L("iPhone")&&!L("iPod")&&!L("iPad")||L("iPad")||L("iPod"))&&r.navigator&&r.navigator.standalone&&n&&"_self"!=n?(a=r.document.createElement("A"),e instanceof Ee||e instanceof Ee||(e=e.la?e.ja():String(e),Mc.test(e)||(e="about:invalid#zClosurez"),e=Se(e)),a.href=xe(e),a.setAttribute("target",n),t.noreferrer&&a.setAttribute("rel","noreferrer"),t=document.createEvent("MouseEvent"),t.initMouseEvent("click",!0,!0,r,1),a.dispatchEvent(t),a={}):t.noreferrer?(a=r.open("",n,a),t=xe(e),a&&(Xu&&O(t,";")&&(t="'"+t.replace(/'/g,"%27")+"'"),a.opener=null,ve("b/12014412, meta tag with sanitized URL"),t='<meta name="referrer" content="no-referrer"><meta http-equiv="refresh" content="0; url='+D(t)+'">',t=Ae(t),a.document.write(Me(t)),a.document.close())):(a=r.open(xe(e),n,a))&&t.noopener&&(a.opener=null),a)try{a.focus()}catch(t){}return a}function qe(t){return new q(function(e){function n(){Ht(2e3).then(function(){if(t&&!t.closed)return n();e()})}return n()})}function Ye(){var t=null;return new q(function(e){"complete"==pu.document.readyState?e():(t=function(){e()},At(window,"load",t))}).m(function(e){throw It(window,"load",t),e})}function Ke(){return Qe(void 0)?Ye().then(function(){return new q(function(t,e){var n=pu.document,r=setTimeout(function(){e(Error("Cordova framework is not ready."))},1e3);n.addEventListener("deviceready",function(){clearTimeout(r),t()},!1)})}):X(Error("Cordova must run in an Android or iOS file scheme."))}function Qe(t){return t=t||nn(),!("file:"!==un()||!t.toLowerCase().match(/iphone|ipad|ipod|android/))}function Xe(){var t=pu.window;try{return!(!t||t==t.top)}catch(t){return!1}}function Je(){return"object"!==typeof pu.window&&"function"===typeof pu.importScripts}function Ze(){return fu.INTERNAL.hasOwnProperty("reactNative")?"ReactNative":fu.INTERNAL.hasOwnProperty("node")?"Node":Je()?"Worker":"Browser"}function $e(){var t=Ze();return"ReactNative"===t||"Node"===t}function tn(t){var e=t.toLowerCase();return O(e,"opera/")||O(e,"opr/")||O(e,"opios/")?"Opera":O(e,"iemobile")?"IEMobile":O(e,"msie")||O(e,"trident/")?"IE":O(e,"edge/")?"Edge":O(e,"firefox/")?Oc:O(e,"silk/")?"Silk":O(e,"blackberry")?"Blackberry":O(e,"webos")?"Webos":!O(e,"safari/")||O(e,"chrome/")||O(e,"crios/")||O(e,"android")?!O(e,"chrome/")&&!O(e,"crios/")||O(e,"edge/")?O(e,"android")?"Android":(t=t.match(/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/))&&2==t.length?t[1]:"Other":kc:"Safari"}function en(t,e){e=e||[];var n,r=[],i={};for(n in Lc)i[Lc[n]]=!0;for(n=0;n<e.length;n++)"undefined"!==typeof i[e[n]]&&(delete i[e[n]],r.push(e[n]));return r.sort(),e=r,e.length||(e=["FirebaseCore-web"]),r=Ze(),"Browser"===r?(i=nn(),r=tn(i)):"Worker"===r&&(i=nn(),r=tn(i)+"-"+r),r+"/JsCore/"+t+"/"+e.join(",")}function nn(){return pu.navigator&&pu.navigator.userAgent||""}function rn(t,e){t=t.split("."),e=e||pu;for(var n=0;n<t.length&&"object"==typeof e&&null!=e;n++)e=e[t[n]];return n!=t.length&&(e=void 0),e}function on(){try{var t=pu.localStorage,e=dn();if(t)return t.setItem(e,"1"),t.removeItem(e),!Fe()||!!pu.indexedDB}catch(t){return Je()&&!!pu.indexedDB}return!1}function an(){return(sn()||"chrome-extension:"===un()||Qe())&&!$e()&&on()&&!Je()}function sn(){return"http:"===un()||"https:"===un()}function un(){return pu.location&&pu.location.protocol||null}function cn(t){return t=t||nn(),!Ge(t)&&tn(t)!=Oc}function ln(t){return"undefined"===typeof t?null:Oe(t)}function hn(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&null!==t[e]&&void 0!==t[e]&&(n[e]=t[e]);return n}function fn(t){if(null!==t)return JSON.parse(t)}function dn(t){return t||Math.floor(1e9*Math.random()).toString()}function pn(t){return t=t||nn(),"Safari"!=tn(t)&&!t.toLowerCase().match(/iphone|ipad|ipod/)}function mn(){var t=pu.___jsl;if(t&&t.H)for(var e in t.H)if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=t.H[e].L.concat(),t.CP)for(var n=0;n<t.CP.length;n++)t.CP[n]=null}function gn(t,e){if(t>e)throw Error("Short delay should be less than long delay!");this.a=t,this.c=e,t=nn(),e=Ze(),this.b=Ge(t)||"ReactNative"===e}function vn(){var t=pu.document;return!t||"undefined"===typeof t.visibilityState||"visible"==t.visibilityState}function yn(){var t=pu.document,e=null;return vn()||!t?Q():new q(function(n){e=function(){vn()&&(t.removeEventListener("visibilitychange",e,!1),n())},t.addEventListener("visibilitychange",e,!1)}).m(function(n){throw t.removeEventListener("visibilitychange",e,!1),n})}function _n(t){try{var e=new Date(parseInt(t,10));if(!isNaN(e.getTime())&&!/[^0-9]/.test(t))return e.toUTCString()}catch(t){}return null}function bn(){return!(!rn("fireauth.oauthhelper",pu)&&!rn("fireauth.iframe",pu))}function wn(t,e,n){Uc?Object.defineProperty(t,e,{configurable:!0,enumerable:!0,value:n}):t[e]=n}function En(t,e){if(e)for(var n in e)e.hasOwnProperty(n)&&wn(t,n,e[n])}function xn(t){var e={};return En(e,t),e}function Tn(t){var e,n={};for(e in t)t.hasOwnProperty(e)&&(n[e]=t[e]);return n}function Sn(t,e){if(!e||!e.length)return!0;if(!t)return!1;for(var n=0;n<e.length;n++){var r=t[e[n]];if(void 0===r||null===r||""===r)return!1}return!0}function Cn(t){var e=t;if("object"==typeof t&&null!=t){e="length"in t?[]:{};for(var n in t)wn(e,n,Cn(t[n]))}return e}function Mn(t){var e={},n=t[jc],r=t[Hc];if(!(t=t[Gc])||t!=Vc&&!n)throw Error("Invalid provider user info!");e[Wc]=r||null,e[zc]=n||null,wn(this,Yc,t),wn(this,qc,Cn(e))}function An(t,e){this.code=Kc+t,this.message=e||Qc[t]||""}function In(t){var e=t&&t.code;return e?new An(e.substring(Kc.length),t.message):null}function Rn(t){var e=t[$c];if("undefined"===typeof e)throw new An("missing-continue-uri");if("string"!==typeof e||"string"===typeof e&&!e.length)throw new An("invalid-continue-uri");this.h=e,this.b=this.a=null,this.g=!1;var n=t[Xc];if(n&&"object"===typeof n){e=n[nl];var r=n[tl];if(n=n[el],"string"===typeof e&&e.length){if(this.a=e,"undefined"!==typeof r&&"boolean"!==typeof r)throw new An("argument-error",tl+" property must be a boolean when specified.");if(this.g=!!r,"undefined"!==typeof n&&("string"!==typeof n||"string"===typeof n&&!n.length))throw new An("argument-error",el+" property must be a non empty string when specified.");this.b=n||null}else{if("undefined"!==typeof e)throw new An("argument-error",nl+" property must be a non empty string when specified.");if("undefined"!==typeof r||"undefined"!==typeof n)throw new An("missing-android-pkg-name")}}else if("undefined"!==typeof n)throw new An("argument-error",Xc+" property must be a non null object when specified.");if(this.f=null,(e=t[Zc])&&"object"===typeof e){if("string"===typeof(e=e[rl])&&e.length)this.f=e;else if("undefined"!==typeof e)throw new An("argument-error",rl+" property must be a non empty string when specified.")}else if("undefined"!==typeof e)throw new An("argument-error",Zc+" property must be a non null object when specified.");if("undefined"!==typeof(t=t[Jc])&&"boolean"!==typeof t)throw new An("argument-error",Jc+" property must be a boolean when specified.");this.c=!!t}function Pn(t){var e={};e.continueUrl=t.h,e.canHandleCodeInApp=t.c,(e.androidPackageName=t.a)&&(e.androidMinimumVersion=t.b,e.androidInstallApp=t.g),e.iOSBundleId=t.f;for(var n in e)null===e[n]&&delete e[n];return e}function Nn(t){return Eu(t,function(t){return t=t.toString(16),1<t.length?t:"0"+t}).join("")}function Dn(t){var e="";return On(t,function(t){e+=String.fromCharCode(t)}),e}function On(t,e){function n(e){for(;r<t.length;){var n=t.charAt(r++),i=ol[n];if(null!=i)return i;if(!/^[\s\xa0]*$/.test(n))throw Error("Unknown base64 encoding at char: "+n)}return e}kn();for(var r=0;;){var i=n(-1),o=n(0),a=n(64),s=n(64);if(64===s&&-1===i)break;e(i<<2|o>>4),64!=a&&(e(o<<4&240|a>>2),64!=s&&e(a<<6&192|s))}}function kn(){if(!il){il={},ol={};for(var t=0;65>t;t++)il[t]="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=".charAt(t),ol[il[t]]=t,62<=t&&(ol["ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_.".charAt(t)]=t)}}function Ln(t){this.c=t.sub,vu(),this.a=t.provider_id||t.firebase&&t.firebase.sign_in_provider||null,this.b=!!t.is_anonymous||"anonymous"==this.a}function Un(t){return(t=Fn(t))&&t.sub&&t.iss&&t.aud&&t.exp?new Ln(t):null}function Fn(t){if(!t)return null;if(t=t.split("."),3!=t.length)return null;t=t[1];for(var e=(4-t.length%4)%4,n=0;n<e;n++)t+=".";try{return JSON.parse(Dn(t))}catch(t){}return null}function Bn(t){for(var e in ul)if(ul[e].Na==t)return ul[e];return null}function Vn(t){var e={};e["facebook.com"]=Gn,e["google.com"]=Wn,e["github.com"]=zn,e["twitter.com"]=qn;var n=t&&t[ll];try{if(n)return e[n]?new e[n](t):new Hn(t);if("undefined"!==typeof t[cl])return new jn(t)}catch(t){}return null}function jn(t){var e=t[ll];if(!e&&t[cl]){var n=Un(t[cl]);n&&n.a&&(e=n.a)}if(!e)throw Error("Invalid additional user info!");"anonymous"!=e&&"custom"!=e||(e=null),n=!1,"undefined"!==typeof t.isNewUser?n=!!t.isNewUser:"identitytoolkit#SignupNewUserResponse"===t.kind&&(n=!0),wn(this,"providerId",e),wn(this,"isNewUser",n)}function Hn(t){jn.call(this,t),t=fn(t.rawUserInfo||"{}"),wn(this,"profile",Cn(t||{}))}function Gn(t){if(Hn.call(this,t),"facebook.com"!=this.providerId)throw Error("Invalid provider ID!")}function zn(t){if(Hn.call(this,t),"github.com"!=this.providerId)throw Error("Invalid provider ID!");wn(this,"username",this.profile&&this.profile.login||null)}function Wn(t){if(Hn.call(this,t),"google.com"!=this.providerId)throw Error("Invalid provider ID!")}function qn(t){if(Hn.call(this,t),"twitter.com"!=this.providerId)throw Error("Invalid provider ID!");wn(this,"username",t.screenName||null)}function Yn(t){this.a=ne(t)}function Kn(t){var e=ne(t),n=ee(e,"link"),r=ee(ne(n),"link");return e=ee(e,"deep_link_id"),ee(ne(e),"link")||e||r||n||t}function Qn(t,e){return t.then(function(t){if(t[Il]){var n=Un(t[Il]);if(!n||e!=n.c)throw new An("user-mismatch");return t}throw new An("user-mismatch")}).m(function(t){throw t&&t.code&&t.code==Kc+"user-not-found"?new An("user-mismatch"):t})}function Xn(t,e,n){if(e.idToken||e.accessToken)e.idToken&&wn(this,"idToken",e.idToken),e.accessToken&&wn(this,"accessToken",e.accessToken);else{if(!e.oauthToken||!e.oauthTokenSecret)throw new An("internal-error","failed to construct a credential");wn(this,"accessToken",e.oauthToken),wn(this,"secret",e.oauthTokenSecret)}wn(this,"providerId",t),wn(this,"signInMethod",n)}function Jn(t){var e={};return t.idToken&&(e.id_token=t.idToken),t.accessToken&&(e.access_token=t.accessToken),t.secret&&(e.oauth_token_secret=t.secret),e.providerId=t.providerId,{postBody:ce(e).toString(),requestUri:"http://localhost"}}function Zn(t,e){this.Ac=e||[],En(this,{providerId:t,isOAuthProvider:!0}),this.tb={},this.Za=(Bn(t)||{}).Ma||null,this.Xa=null}function $n(t){Zn.call(this,t,sl),this.a=[]}function tr(){$n.call(this,"facebook.com")}function er(t){if(!t)throw new An("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return c(t)&&(e=t.accessToken),(new tr).credential(null,e)}function nr(){$n.call(this,"github.com")}function rr(t){if(!t)throw new An("argument-error","credential failed: expected 1 argument (the OAuth access token).");var e=t;return c(t)&&(e=t.accessToken),(new nr).credential(null,e)}function ir(){$n.call(this,"google.com"),this.ta("profile")}function or(t,e){var n=t;return c(t)&&(n=t.idToken,e=t.accessToken),(new ir).credential(n,e)}function ar(){Zn.call(this,"twitter.com",al)}function sr(t,e){var n=t;if(c(n)||(n={oauthToken:t,oauthTokenSecret:e}),!n.oauthToken||!n.oauthTokenSecret)throw new An("argument-error","credential failed: expected 2 arguments (the OAuth access token and secret).");return new Xn("twitter.com",n,"twitter.com")}function ur(t,e,n){this.a=t,this.b=e,wn(this,"providerId","password"),wn(this,"signInMethod",n===cr.EMAIL_LINK_SIGN_IN_METHOD?cr.EMAIL_LINK_SIGN_IN_METHOD:cr.EMAIL_PASSWORD_SIGN_IN_METHOD)}function cr(){En(this,{providerId:"password",isOAuthProvider:!1})}function lr(t,e){if(!(e=hr(e)))throw new An("argument-error","Invalid email link!");return new ur(t,e,cr.EMAIL_LINK_SIGN_IN_METHOD)}function hr(t){t=Kn(t),t=new Yn(t);var e=ee(t.a,"oobCode")||null;return"signIn"===(ee(t.a,"mode")||null)&&e?e:null}function fr(t){if(!(t.Ra&&t.Qa||t.Ea&&t.Z))throw new An("internal-error");this.a=t,wn(this,"providerId","phone"),wn(this,"signInMethod","phone")}function dr(t){return t.a.Ea&&t.a.Z?{temporaryProof:t.a.Ea,phoneNumber:t.a.Z}:{sessionInfo:t.a.Ra,code:t.a.Qa}}function pr(t){try{this.a=t||fu.auth()}catch(t){throw new An("argument-error","Either an instance of firebase.auth.Auth must be passed as an argument to the firebase.auth.PhoneAuthProvider constructor, or the default firebase App instance must be initialized via firebase.initializeApp().")}En(this,{providerId:"phone",isOAuthProvider:!1})}function mr(t,e){if(!t)throw new An("missing-verification-id");if(!e)throw new An("missing-verification-code");return new fr({Ra:t,Qa:e})}function gr(t){if(t.temporaryProof&&t.phoneNumber)return new fr({Ea:t.temporaryProof,Z:t.phoneNumber});var e=t&&t.providerId;if(!e||"password"===e)return null;var n=t&&t.oauthAccessToken,r=t&&t.oauthTokenSecret;t=t&&t.oauthIdToken;try{switch(e){case"google.com":return or(t,n);case"facebook.com":return er(n);case"github.com":return rr(n);case"twitter.com":return sr(n,r);default:return new $n(e).credential(t,n)}}catch(t){return null}}function vr(t){if(!t.isOAuthProvider)throw new An("invalid-oauth-provider")}function yr(t,e,n,r,i){if(this.b=t,this.c=e||null,this.f=n||null,this.g=r||null,this.a=i||null,!this.f&&!this.a)throw new An("invalid-auth-event");if(this.f&&this.a)throw new An("invalid-auth-event");if(this.f&&!this.g)throw new An("invalid-auth-event")}function _r(t){return t=t||{},t.type?new yr(t.type,t.eventId,t.urlResponse,t.sessionId,t.error&&In(t.error)):null}function br(){this.b=null,this.a=[]}function wr(t){var e="unauthorized-domain",n=void 0,r=ne(t);t=r.b,r=r.c,"chrome-extension"==r?n=N("This chrome extension ID (chrome-extension://%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):"http"==r||"https"==r?n=N("This domain (%s) is not authorized to run this operation. Add it to the OAuth redirect domains list in the Firebase console -> Auth section -> Sign in method tab.",t):e="operation-not-supported-in-this-environment",An.call(this,e,n)}function Er(t,e,n){An.call(this,t,n),t=e||{},t.ub&&wn(this,"email",t.ub),t.Z&&wn(this,"phoneNumber",t.Z),t.credential&&wn(this,"credential",t.credential)}function xr(t){if(t.code){var e=t.code||"";0==e.indexOf(Kc)&&(e=e.substring(Kc.length));var n={credential:gr(t)};if(t.email)n.ub=t.email;else{if(!t.phoneNumber)return new An(e,t.message||void 0);n.Z=t.phoneNumber}return new Er(e,n,t.message)}return null}function Tr(){}function Sr(t){return t.c||(t.c=t.b())}function Cr(){}function Mr(t){if(!t.f&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.f=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.f}function Ar(){}function Ir(){this.a=new XDomainRequest,this.readyState=0,this.onreadystatechange=null,this.responseText="",this.status=-1,this.statusText="",this.a.onload=f(this.bc,this),this.a.onerror=f(this.zb,this),this.a.onprogress=f(this.cc,this),this.a.ontimeout=f(this.fc,this)}function Rr(t,e){t.readyState=e,t.onreadystatechange&&t.onreadystatechange()}function Pr(t,e,n){this.reset(t,e,n,void 0,void 0)}function Nr(t){this.f=t,this.b=this.c=this.a=null}function Dr(t,e){this.name=t,this.value=e}function Or(t){return t.c?t.c:t.a?Or(t.a):(_("Root logger has no level set."),null)}function kr(t){bl||(bl=new Nr(""),_l[""]=bl,bl.c=vl);var e;if(!(e=_l[t])){e=new Nr(t);var n=t.lastIndexOf("."),r=t.substr(n+1);n=kr(t.substr(0,n)),n.b||(n.b={}),n.b[r]=e,e.a=n,_l[t]=e}return e}function Lr(t,e){t&&t.log(yl,e,void 0)}function Ur(t){this.f=t}function Fr(t){Ut.call(this),this.j=t,this.readyState=wl,this.status=0,this.responseText=this.statusText="",this.onreadystatechange=null,this.g=new Headers,this.b=null,this.h="GET",this.c="",this.a=!1,this.f=kr("goog.net.FetchXmlHttp")}function Br(t){t.onreadystatechange&&t.onreadystatechange.call(t)}function Vr(t){Ut.call(this),this.headers=new qt,this.D=t||null,this.c=!1,this.B=this.a=null,this.h=this.N=this.l="",this.f=this.I=this.j=this.G=!1,this.g=0,this.s=null,this.o=El,this.v=this.O=!1}function jr(t,e,n,r,i){if(t.a)throw Error("[goog.net.XhrIo] Object is active with another request="+t.l+"; newUri="+e);n=n?n.toUpperCase():"GET",t.l=e,t.h="",t.N=n,t.G=!1,t.c=!0,t.a=t.D?t.D.a():dl.a(),t.B=Sr(t.D?t.D:dl),t.a.onreadystatechange=f(t.Db,t);try{Lr(t.b,Zr(t,"Opening Xhr")),t.I=!0,t.a.open(n,String(e),!0),t.I=!1}catch(e){return Lr(t.b,Zr(t,"Error opening Xhr: "+e.message)),void zr(t,e)}e=r||"";var o=new qt(t.headers);i&&Wt(i,function(t,e){o.set(e,t)}),i=C(o.U()),r=pu.FormData&&e instanceof pu.FormData,!M(Tl,n)||i||r||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},t),t.o&&(t.a.responseType=t.o),"withCredentials"in t.a&&t.a.withCredentials!==t.O&&(t.a.withCredentials=t.O);try{Kr(t),0<t.g&&(t.v=Hr(t.a),Lr(t.b,Zr(t,"Will abort after "+t.g+"ms if incomplete, xhr2 "+t.v)),t.v?(t.a.timeout=t.g,t.a.ontimeout=f(t.Fa,t)):t.s=jt(t.Fa,t.g,t)),Lr(t.b,Zr(t,"Sending request")),t.j=!0,t.a.send(e),t.j=!1}catch(e){Lr(t.b,Zr(t,"Send error: "+e.message)),zr(t,e)}}function Hr(t){return Ku&&vt(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function Gr(t){return"content-type"==t.toLowerCase()}function zr(t,e){t.c=!1,t.a&&(t.f=!0,t.a.abort(),t.f=!1),t.h=e,Wr(t),Yr(t)}function Wr(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function qr(t){if(t.c&&"undefined"!=typeof du)if(t.B[1]&&4==Qr(t)&&2==Xr(t))Lr(t.b,Zr(t,"Local request error detected and ignored"));else if(t.j&&4==Qr(t))jt(t.Db,0,t);else if(t.dispatchEvent("readystatechange"),4==Qr(t)){Lr(t.b,Zr(t,"Request complete")),t.c=!1;try{var e=Xr(t);t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break t;default:n=!1}var r;if(!(r=n)){var i;if(i=0===e){var o=String(t.l).match(gc)[1]||null;if(!o&&pu.self&&pu.self.location){var a=pu.self.location.protocol;o=a.substr(0,a.length-1)}i=!xl.test(o?o.toLowerCase():"")}r=i}if(r)t.dispatchEvent("complete"),t.dispatchEvent("success");else{try{var s=2<Qr(t)?t.a.statusText:""}catch(e){Lr(t.b,"Can not get status: "+e.message),s=""}t.h=s+" ["+Xr(t)+"]",Wr(t)}}finally{Yr(t)}}}function Yr(t,e){if(t.a){Kr(t);var n=t.a,i=t.B[0]?r:null;t.a=null,t.B=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=i}catch(e){(t=t.b)&&t.log(ml,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function Kr(t){t.a&&t.v&&(t.a.ontimeout=null),t.s&&(pu.clearTimeout(t.s),t.s=null)}function Qr(t){return t.a?t.a.readyState:0}function Xr(t){try{return 2<Qr(t)?t.a.status:-1}catch(t){return-1}}function Jr(t){try{return t.a?t.a.responseText:""}catch(e){return Lr(t.b,"Can not get responseText: "+e.message),""}}function Zr(t,e){return e+" ["+t.N+" "+t.l+" "+Xr(t)+"]"}function $r(t,e){this.g=[],this.v=t,this.s=e||null,this.f=this.a=!1,this.c=void 0,this.u=this.B=this.j=!1,this.h=0,this.b=null,this.l=0}function ti(t,e,n){t.a=!0,t.c=n,t.f=!e,oi(t)}function ei(t){if(t.a){if(!t.u)throw new ai(t);t.u=!1}}function ni(t,e){ri(t,null,e,void 0)}function ri(t,e,n,r){t.g.push([e,n,r]),t.a&&oi(t)}function ii(t){return xu(t.g,function(t){return u(t[1])})}function oi(t){if(t.h&&t.a&&ii(t)){var e=t.h,n=Sl[e];n&&(pu.clearTimeout(n.a),delete Sl[e]),t.h=0}t.b&&(t.b.l--,delete t.b),e=t.c;for(var r=n=!1;t.g.length&&!t.j;){var i=t.g.shift(),o=i[0],a=i[1];if(i=i[2],o=t.f?a:o)try{var s=o.call(i||t.s,e);void 0!==s&&(t.f=t.f&&(s==e||s instanceof Error),t.c=e=s),(g(e)||"function"===typeof pu.Promise&&e instanceof pu.Promise)&&(r=!0,t.j=!0)}catch(r){e=r,t.f=!0,ii(t)||(n=!0)}}t.c=e,r&&(s=f(t.o,t,!0),r=f(t.o,t,!1),e instanceof $r?(ri(e,s,r),e.B=!0):e.then(s,r)),n&&(e=new ui(e),Sl[e.a]=e,t.h=e.a)}function ai(){v.call(this)}function si(){v.call(this)}function ui(t){this.a=pu.setTimeout(f(this.c,this),0),this.b=t}function ci(t){var e={},n=e.document||document,r=_e(t),i=document.createElement("SCRIPT"),o={Fb:i,Fa:void 0},a=new $r(hi,o),s=null,u=null!=e.timeout?e.timeout:5e3;return 0<u&&(s=window.setTimeout(function(){fi(i,!0);var t=new di(Ml,"Timeout reached for loading script "+r);ei(a),ti(a,!1,t)},u),o.Fa=s),i.onload=i.onreadystatechange=function(){i.readyState&&"loaded"!=i.readyState&&"complete"!=i.readyState||(fi(i,e.bd||!1,s),a.D())},i.onerror=function(){fi(i,!0,s);var t=new di(Cl,"Error while loading script "+r);ei(a),ti(a,!1,t)},o=e.attributes||{},V(o,{type:"text/javascript",charset:"UTF-8"}),Re(i,o),i.src=_e(t),li(n).appendChild(i),a}function li(t){var e;return(e=(t||document).getElementsByTagName("HEAD"))&&0!=e.length?e[0]:t.documentElement}function hi(){if(this&&this.Fb){var t=this.Fb;t&&"SCRIPT"==t.tagName&&fi(t,!0,this.Fa)}}function fi(t,e,n){null!=n&&pu.clearTimeout(n),t.onload=r,t.onerror=r,t.onreadystatechange=r,e&&window.setTimeout(function(){t&&t.parentNode&&t.parentNode.removeChild(t)},0)}function di(t,e){var n="Jsloader error (code #"+t+")";e&&(n+=": "+e),v.call(this,n),this.code=t}function pi(t){this.f=t}function mi(t,e,n){if(this.b=t,t=e||{},this.j=t.secureTokenEndpoint||"https://securetoken.googleapis.com/v1/token",this.l=t.secureTokenTimeout||Rl,this.f=B(t.secureTokenHeaders||Pl),this.g=t.firebaseEndpoint||"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",this.h=t.firebaseTimeout||Nl,this.a=B(t.firebaseHeaders||Dl),n&&(this.a["X-Client-Version"]=n,this.f["X-Client-Version"]=n),n="Node"==Ze(),!(n=pu.XMLHttpRequest||n&&fu.INTERNAL.node&&fu.INTERNAL.node.XMLHttpRequest)&&!Je())throw new An("internal-error","The XMLHttpRequest compatibility library was not found.");this.c=void 0,Je()?this.c=new Ur(self):$e()?this.c=new pi(n):this.c=new Ar}function gi(t,e){e?t.a["X-Firebase-Locale"]=e:delete t.a["X-Firebase-Locale"]}function vi(t,e){e?(t.a["X-Client-Version"]=e,t.f["X-Client-Version"]=e):(delete t.a["X-Client-Version"],delete t.f["X-Client-Version"])}function yi(t,e,n,r,i,o,a){He()||Je()?t=f(t.o,t):(Al||(Al=new q(function(t,e){_i(t,e)})),t=f(t.u,t)),t(e,n,r,i,o,a)}function _i(t,e){if(((window.gapi||{}).client||{}).request)t();else{pu[kl]=function(){((window.gapi||{}).client||{}).request?t():e(Error("CORS_UNSUPPORTED"))};ni(ci(be(Ol,{onload:kl})),function(){e(Error("CORS_UNSUPPORTED"))})}}function bi(t,e){return new q(function(n,r){"refresh_token"==e.grant_type&&e.refresh_token||"authorization_code"==e.grant_type&&e.code?yi(t,t.j+"?key="+encodeURIComponent(t.b),function(t){t?t.error?r(Bi(t)):t.access_token&&t.refresh_token?n(t):r(new An("internal-error")):r(new An("network-request-failed"))},"POST",ce(e).toString(),t.f,t.l.get()):r(new An("internal-error"))})}function wi(t,e,n,r,i,o){var a=ne(t.g+e);te(a,"key",t.b),o&&te(a,"cb",vu().toString());var s="GET"==n;if(s)for(var u in r)r.hasOwnProperty(u)&&te(a,u,r[u]);return new q(function(e,o){yi(t,a.toString(),function(t){t?t.error?o(Bi(t,i||{})):e(t):o(new An("network-request-failed"))},n,s?void 0:Oe(hn(r)),t.a,t.h.get())})}function Ei(t){if(!fl.test(t.email))throw new An("invalid-email")}function xi(t){"email"in t&&Ei(t)}function Ti(t,e){return Ui(t,jl,{identifier:e,continueUri:sn()?Be():"http://localhost"}).then(function(t){return t.allProviders||[]})}function Si(t,e){return Ui(t,jl,{identifier:e,continueUri:sn()?Be():"http://localhost"}).then(function(t){return t.signinMethods||[]})}function Ci(t){return Ui(t,Xl,{}).then(function(t){return t.authorizedDomains||[]})}function Mi(t){if(!t[Il])throw new An("internal-error")}function Ai(t){if(t.phoneNumber||t.temporaryProof){if(!t.phoneNumber||!t.temporaryProof)throw new An("internal-error")}else{if(!t.sessionInfo)throw new An("missing-verification-id");if(!t.code)throw new An("missing-verification-code")}}function Ii(t,e){return Ui(t,$l,e)}function Ri(t,e,n){return Ui(t,Gl,{idToken:e,deleteProvider:n})}function Pi(t){if(!t.requestUri||!t.sessionId&&!t.postBody)throw new An("internal-error")}function Ni(t){var e=null;if(t.needConfirmation?(t.code="account-exists-with-different-credential",e=xr(t)):"FEDERATED_USER_ID_ALREADY_LINKED"==t.errorMessage?(t.code="credential-already-in-use",e=xr(t)):"EMAIL_EXISTS"==t.errorMessage?(t.code="email-already-in-use",e=xr(t)):t.errorMessage&&(e=Fi(t.errorMessage)),e)throw e;if(!t[Il])throw new An("internal-error")}function Di(t,e){return e.returnIdpCredential=!0,Ui(t,rh,e)}function Oi(t,e){return e.returnIdpCredential=!0,Ui(t,oh,e)}function ki(t,e){return e.returnIdpCredential=!0,e.autoCreate=!1,Ui(t,ih,e)}function Li(t){if(!t.oobCode)throw new An("invalid-action-code")}function Ui(t,e,n){if(!Sn(n,e.T))return X(new An("internal-error"));var r,i=e.Cb||"POST";return Q(n).then(e.A).then(function(){return e.R&&(n.returnSecureToken=!0),wi(t,e.endpoint,i,n,e.Tb,e.pb||!1)}).then(function(t){return r=t}).then(e.J).then(function(){if(!e.ba)return r;if(!(e.ba in r))throw new An("internal-error");return r[e.ba]})}function Fi(t){return Bi({error:{errors:[{message:t}],code:400,message:t}})}function Bi(t,e){var n=(t.error&&t.error.errors&&t.error.errors[0]||{}).reason||"",r={keyInvalid:"invalid-api-key",ipRefererBlocked:"app-not-authorized"};if(n=r[n]?new An(r[n]):null)return n;n=t.error&&t.error.message||"",r={INVALID_CUSTOM_TOKEN:"invalid-custom-token",CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_EMAIL:"invalid-email",INVALID_PASSWORD:"wrong-password",USER_DISABLED:"user-disabled",MISSING_PASSWORD:"internal-error",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",INVALID_MESSAGE_PAYLOAD:"invalid-message-payload",INVALID_RECIPIENT_EMAIL:"invalid-recipient-email",INVALID_SENDER:"invalid-sender",EMAIL_NOT_FOUND:"user-not-found",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",CORS_UNSUPPORTED:"cors-unsupported",DYNAMIC_LINK_NOT_ACTIVATED:"dynamic-link-not-activated",INVALID_APP_ID:"invalid-app-id",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",WEAK_PASSWORD:"weak-password",OPERATION_NOT_ALLOWED:"operation-not-allowed",USER_CANCELLED:"user-cancelled",CAPTCHA_CHECK_FAILED:"captcha-check-failed",INVALID_APP_CREDENTIAL:"invalid-app-credential",INVALID_CODE:"invalid-verification-code",INVALID_PHONE_NUMBER:"invalid-phone-number",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_APP_CREDENTIAL:"missing-app-credential",MISSING_CODE:"missing-verification-code",MISSING_PHONE_NUMBER:"missing-phone-number",MISSING_SESSION_INFO:"missing-verification-id",QUOTA_EXCEEDED:"quota-exceeded",SESSION_EXPIRED:"code-expired",INVALID_CONTINUE_URI:"invalid-continue-uri",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",MISSING_IOS_BUNDLE_ID:"missing-ios-bundle-id",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",INVALID_CERT_HASH:"invalid-cert-hash"},V(r,e||{}),e=(e=n.match(/^[^\s]+\s*:\s*(.*)$/))&&1<e.length?e[1]:void 0;for(var i in r)if(0===n.indexOf(i))return new An(r[i],e);return!e&&t&&(e=ln(t)),new An("internal-error",e)}function Vi(t){for(var e in hh)if(hh[e].id===t)return t=hh[e],{firebaseEndpoint:t.Ya,secureTokenEndpoint:t.eb};return null}function ji(t){this.b=t,this.a=null,this.ab=Hi(this)}function Hi(t){return Wi().then(function(){return new q(function(e,n){rn("gapi.iframes.getContext")().open({where:document.body,url:t.b,messageHandlersFilter:rn("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"),attributes:{style:{position:"absolute",top:"-100px",width:"1px",height:"1px"}},dontclear:!0},function(r){function i(){clearTimeout(o),e()}t.a=r,t.a.restyle({setHideOnLeave:!1});var o=setTimeout(function(){n(Error("Network Error"))},ph.get());r.ping(i).then(i,function(){n(Error("Network Error"))})})})})}function Gi(t,e){return t.ab.then(function(){return new q(function(n){t.a.send(e.type,e,n,rn("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})})}function zi(t,e){t.ab.then(function(){t.a.register("authEvent",e,rn("gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER"))})}function Wi(){return mh||(mh=new q(function(t,e){function n(){mn(),rn("gapi.load")("gapi.iframes",{callback:t,ontimeout:function(){mn(),e(Error("Network Error"))},timeout:dh.get()})}if(rn("gapi.iframes.Iframe"))t();else if(rn("gapi.load"))n();else{var r="__iframefcb"+Math.floor(1e6*Math.random()).toString();pu[r]=function(){rn("gapi.load")?n():e(Error("Network Error"))},r=be(fh,{onload:r}),Q(ci(r)).m(function(){e(Error("Network Error"))})}}).m(function(t){throw mh=null,t}))}function qi(t,e,n){this.j=t,this.g=e,this.h=n,this.f=null,this.a=re(this.j,"/__/auth/iframe"),te(this.a,"apiKey",this.g),te(this.a,"appName",this.h),this.b=null,this.c=[]}function Yi(t,e,n,r,i){this.o=t,this.u=e,this.c=n,this.l=r,this.h=this.g=this.j=null,this.a=i,this.f=null}function Ki(t){try{return fu.app(t).auth().Ka()}catch(t){return[]}}function Qi(t,e,n,r,i){this.u=t,this.f=e,this.b=n,this.c=r||null,this.h=i||null,this.o=this.s=this.v=null,this.g=[],this.l=this.a=null}function Xi(t){var e=Be();return Ci(t).then(function(t){t:{var n=ne(e),r=n.c;n=n.b;for(var i=0;i<t.length;i++){var o=t[i],a=n,s=r;if(0==o.indexOf("chrome-extension://")?a=ne(o).b==a&&"chrome-extension"==s:"http"!=s&&"https"!=s?a=!1:Dc.test(o)?a=a==o:(o=o.split(".").join("\\."),a=new RegExp("^(.+\\."+o+"|"+o+")$","i").test(a)),a){t=!0;break t}}t=!1}if(!t)throw new wr(Be())})}function Ji(t){return t.l?t.l:(t.l=Ye().then(function(){if(!t.s){var e=t.c,n=t.h,r=Ki(t.b),i=new qi(t.u,t.f,t.b);i.f=e,i.b=n,i.c=P(r||[]),t.s=i.toString()}t.j=new ji(t.s),to(t)}),t.l)}function Zi(t){return t.o||(t.v=t.c?en(t.c,Ki(t.b)):null,t.o=new mi(t.f,Vi(t.h),t.v)),t.o}function $i(t,e,n,r,i,o,a,s,u,c){return t=new Yi(t,e,n,r,i),t.j=o,t.g=a,t.h=s,t.b=B(u||null),t.f=c,t.toString()}function to(t){if(!t.j)throw Error("IfcHandler must be initialized!");zi(t.j,function(e){var n={};if(e&&e.authEvent){var r=!1;for(e=_r(e.authEvent),n=0;n<t.g.length;n++)r=t.g[n](e)||r;return n={},n.status=r?"ACK":"ERROR",Q(n)}return n.status="ERROR",Q(n)})}function eo(t){var e={type:"webStorageSupport"};return Ji(t).then(function(){return Gi(t.j,e)}).then(function(t){if(t&&t.length&&"undefined"!==typeof t[0].webStorageSupport)return t[0].webStorageSupport;throw Error()})}function no(t){if(this.a=t||fu.INTERNAL.reactNative&&fu.INTERNAL.reactNative.AsyncStorage,!this.a)throw new An("internal-error","The React Native compatibility library was not found.");this.type="asyncStorage"}function ro(){if(!so())throw new An("web-storage-unsupported");this.f={},this.a=[],this.b=0,this.g=pu.indexedDB,this.type="indexedDB"}function io(t){return new q(function(e,n){var r=t.g.deleteDatabase("firebaseLocalStorageDb");r.onsuccess=function(){e()},r.onerror=function(t){n(Error(t.target.error))}})}function oo(t){return new q(function(e,n){var r=t.g.open("firebaseLocalStorageDb",1);r.onerror=function(t){try{t.preventDefault()}catch(t){}n(Error(t.target.error))},r.onupgradeneeded=function(t){t=t.target.result;try{t.createObjectStore("firebaseLocalStorage",{keyPath:"fbase_key"})}catch(t){n(t)}},r.onsuccess=function(r){r=r.target.result,r.objectStoreNames.contains("firebaseLocalStorage")?e(r):io(t).then(function(){return oo(t)}).then(function(t){e(t)}).m(function(t){n(t)})}})}function ao(t){return t.h||(t.h=oo(t)),t.h}function so(){try{return!!pu.indexedDB}catch(t){return!1}}function uo(t){return t.objectStore("firebaseLocalStorage")}function co(t,e){return t.transaction(["firebaseLocalStorage"],e?"readwrite":"readonly")}function lo(t){return new q(function(e,n){t.onsuccess=function(t){t&&t.target?e(t.target.result):e()},t.onerror=function(t){n(Error(t.target.errorCode))}})}function ho(t){function e(){return t.c=Ht(800).then(f(t.Jc,t)).then(function(e){0<e.length&&wu(t.a,function(t){t(e)})}).then(e).m(function(t){"STOP_EVENT"!=t.message&&e()}),t.c}t.c&&t.c.cancel("STOP_EVENT"),e()}function fo(t){var e=this,n=null;this.a=[],this.type="indexedDB",this.c=t,this.b=Q().then(function(){return so()?(gh||(gh=new ro),n=gh,n.set("__sak","!").then(function(){return n.get("__sak")}).then(function(t){if("!"!==t)throw Error("indexedDB not supported!");return n.P("__sak")}).then(function(){return n}).m(function(){return e.c})):e.c}).then(function(t){return e.type=t.type,t.Y(function(t){wu(e.a,function(e){e(t)})}),t})}function po(){this.a={},this.type="inMemory"}function mo(){if(!vo()){if("Node"==Ze())throw new An("internal-error","The LocalStorage compatibility library was not found.");throw new An("web-storage-unsupported")}this.a=go()||fu.INTERNAL.node.localStorage,this.type="localStorage"}function go(){try{var t=pu.localStorage,e=dn();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function vo(){var t="Node"==Ze();if(!(t=go()||t&&fu.INTERNAL.node&&fu.INTERNAL.node.localStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}function yo(){this.type="nullStorage"}function _o(){if(!wo()){if("Node"==Ze())throw new An("internal-error","The SessionStorage compatibility library was not found.");throw new An("web-storage-unsupported")}this.a=bo()||fu.INTERNAL.node.sessionStorage,this.type="sessionStorage"}function bo(){try{var t=pu.sessionStorage,e=dn();return t&&(t.setItem(e,"1"),t.removeItem(e)),t}catch(t){return null}}function wo(){var t="Node"==Ze();if(!(t=bo()||t&&fu.INTERNAL.node&&fu.INTERNAL.node.sessionStorage))return!1;try{return t.setItem("__sak","1"),t.removeItem("__sak"),!0}catch(t){return!1}}function Eo(){var t={};t.Browser=_h,t.Node=bh,t.ReactNative=wh,t.Worker=Eh,this.a=t[Ze()]}function xo(t){var e=new An("invalid-persistence-type"),n=new An("unsupported-persistence-type");t:{for(r in xh)if(xh[r]==t){var r=!0;break t}r=!1}if(!r||"string"!==typeof t)throw e;switch(Ze()){case"ReactNative":if("session"===t)throw n;break;case"Node":if("none"!==t)throw n;break;default:if(!on()&&"none"!==t)throw n}}function To(){var t=!(pn(nn())||!Xe()),e=cn(),n=on();this.o=t,this.h=e,this.l=n,this.a={},vh||(vh=new Eo),t=vh;try{this.g=!Fe()&&bn()||!pu.indexedDB?new t.a.w:new fo(Je()?new po:new t.a.w)}catch(t){this.g=new po,this.h=!0}try{this.j=new t.a.Pa}catch(t){this.j=new po}this.u=new po,this.f=f(this.Kb,this),this.b={}}function So(){return yh||(yh=new To),yh}function Co(t,e){switch(e){case"session":return t.j;case"none":return t.u;default:return t.g}}function Mo(t,e){return"firebase:"+t.name+(e?":"+e:"")}function Ao(t,e,n){var r=Mo(e,n),i=Co(t,e.w);return t.get(e,n).then(function(o){var a=null;try{a=fn(pu.localStorage.getItem(r))}catch(t){}if(a&&!o)return pu.localStorage.removeItem(r),t.set(e,a,n);a&&o&&"localStorage"!=i.type&&pu.localStorage.removeItem(r)})}function Io(t,e,n){return n=Mo(e,n),"local"==e.w&&(t.b[n]=null),Co(t,e.w).P(n)}function Ro(t){Po(t),t.c=setInterval(function(){for(var e in t.a){var n=pu.localStorage.getItem(e),r=t.b[e];n!=r&&(t.b[e]=n,n=new _t({type:"storage",key:e,target:window,oldValue:r,newValue:n,a:!0}),t.Kb(n))}},1e3)}function Po(t){t.c&&(clearInterval(t.c),t.c=null)}function No(t){this.a=t,this.b=So()}function Do(t){return t.b.get(Sh,t.a).then(function(t){return _r(t)})}function Oo(){this.a=So()}function ko(){this.b=-1}function Lo(t,e){this.b=-1,this.b=Ch,this.f=pu.Uint8Array?new Uint8Array(this.b):Array(this.b),this.g=this.c=0,this.a=[],this.j=t,this.h=e,this.l=pu.Int32Array?new Int32Array(64):Array(64),void 0!==Th||(Th=pu.Int32Array?new Int32Array(Ph):Ph),this.reset()}function Uo(t){for(var e=t.f,n=t.l,r=0,i=0;i<e.length;)n[r++]=e[i]<<24|e[i+1]<<16|e[i+2]<<8|e[i+3],i=4*r;for(e=16;64>e;e++){i=0|n[e-15],r=0|n[e-2];var o=(0|n[e-16])+((i>>>7|i<<25)^(i>>>18|i<<14)^i>>>3)|0,a=(0|n[e-7])+((r>>>17|r<<15)^(r>>>19|r<<13)^r>>>10)|0;n[e]=o+a|0}r=0|t.a[0],i=0|t.a[1];var s=0|t.a[2],u=0|t.a[3],c=0|t.a[4],l=0|t.a[5],h=0|t.a[6];for(o=0|t.a[7],e=0;64>e;e++){var f=((r>>>2|r<<30)^(r>>>13|r<<19)^(r>>>22|r<<10))+(r&i^r&s^i&s)|0;a=c&l^~c&h,o=o+((c>>>6|c<<26)^(c>>>11|c<<21)^(c>>>25|c<<7))|0,a=a+(0|Th[e])|0,a=o+(a+(0|n[e])|0)|0,o=h,h=l,l=c,c=u+a|0,u=s,s=i,i=r,r=a+f|0}t.a[0]=t.a[0]+r|0,t.a[1]=t.a[1]+i|0,t.a[2]=t.a[2]+s|0,t.a[3]=t.a[3]+u|0,t.a[4]=t.a[4]+c|0,t.a[5]=t.a[5]+l|0,t.a[6]=t.a[6]+h|0,t.a[7]=t.a[7]+o|0}function Fo(e,n,r){void 0===r&&(r=n.length);var i=0,o=e.c;if(t(n))for(;i<r;)e.f[o++]=n.charCodeAt(i++),o==e.b&&(Uo(e),o=0);else{if(!s(n))throw Error("message must be string or array");for(;i<r;){var a=n[i++];if(!("number"==typeof a&&0<=a&&255>=a&&a==(0|a)))throw Error("message must be a byte array");e.f[o++]=a,o==e.b&&(Uo(e),o=0)}}e.c=o,e.g+=r}function Bo(){Lo.call(this,8,Nh)}function Vo(t,e,n,r,i){this.u=t,this.j=e,this.l=n,this.o=r||null,this.s=i||null,this.h=e+":"+n,this.v=new Oo,this.g=new No(this.h),this.f=null,this.b=[],this.a=this.c=null}function jo(t){return new An("invalid-cordova-configuration",t)}function Ho(){for(var t=20,e=[];0<t;)e.push("1234567890abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".charAt(Math.floor(62*Math.random()))),t--;return e.join("")}function Go(t){var e=new Bo;Fo(e,t),t=[];var n=8*e.g;56>e.c?Fo(e,Rh,56-e.c):Fo(e,Rh,e.b-(e.c-56));for(var r=63;56<=r;r--)e.f[r]=255&n,n/=256;for(Uo(e),r=n=0;r<e.j;r++)for(var i=24;0<=i;i-=8)t[n++]=e.a[r]>>i&255;return Nn(t)}function zo(t,e,n,r){var i=Ho(),o=new yr(e,r,null,i,new An("no-auth-event")),a=rn("BuildInfo.packageName",pu);if("string"!==typeof a)throw new An("invalid-cordova-configuration");var s=rn("BuildInfo.displayName",pu),u={};if(nn().toLowerCase().match(/iphone|ipad|ipod/))u.ibi=a;else{if(!nn().toLowerCase().match(/android/))return X(new An("operation-not-supported-in-this-environment"));u.apn=a}s&&(u.appDisplayName=s),i=Go(i),u.sessionId=i;var c=$i(t.u,t.j,t.l,e,n,null,r,t.o,u,t.s);return t.ea().then(function(){var e=t.h;return t.v.a.set(Sh,o.C(),e)}).then(function(){var e=rn("cordova.plugins.browsertab.isAvailable",pu);if("function"!==typeof e)throw new An("invalid-cordova-configuration");var n=null;e(function(e){if(e){if("function"!==typeof(n=rn("cordova.plugins.browsertab.openUrl",pu)))throw new An("invalid-cordova-configuration");n(c)}else{if("function"!==typeof(n=rn("cordova.InAppBrowser.open",pu)))throw new An("invalid-cordova-configuration");e=nn(),e=!(!e.match(/(iPad|iPhone|iPod).*OS 7_\d/i)&&!e.match(/(iPad|iPhone|iPod).*OS 8_\d/i)),t.a=n(c,e?"_blank":"_system","location=yes")}})})}function Wo(t,e){for(var n=0;n<t.b.length;n++)try{t.b[n](e)}catch(t){}}function qo(t){return t.f||(t.f=t.ea().then(function(){return new q(function(e){function n(r){return e(r),t.Ja(n),!1}t.va(n),Ko(t)})})),t.f}function Yo(t){var e=null;return Do(t.g).then(function(n){return e=n,n=t.g,Io(n.b,Sh,n.a)}).then(function(){return e})}function Ko(t){function e(e){r=!0,i&&i.cancel(),Yo(t).then(function(r){var i=n;if(r&&e&&e.url){var o=null;i=Kn(e.url),-1!=i.indexOf("/__/auth/callback")&&(o=ne(i),o=fn(ee(o,"firebaseError")||null),o=(o="object"===typeof o?In(o):null)?new yr(r.b,r.c,null,null,o):new yr(r.b,r.c,i,r.g)),i=o||n}Wo(t,i)})}var n=new yr("unknown",null,null,null,new An("no-auth-event")),r=!1,i=Ht(500).then(function(){return Yo(t).then(function(){r||Wo(t,n)})}),o=pu.handleOpenURL;pu.handleOpenURL=function(t){if(0==t.toLowerCase().indexOf(rn("BuildInfo.packageName",pu).toLowerCase()+"://")&&e({url:t}),"function"===typeof o)try{o(t)}catch(t){console.error(t)}},hl||(hl=new br),hl.subscribe(e)}function Qo(t){this.a=t,this.b=So()}function Xo(t){return t.b.set(Dh,"pending",t.a)}function Jo(t){return Io(t.b,Dh,t.a)}function Zo(t){return t.b.get(Dh,t.a).then(function(t){return"pending"==t})}function $o(t,e,n){this.v=t,this.l=e,this.u=n,this.h=[],this.f=!1,this.j=f(this.o,this),this.c=new aa,this.s=new da,this.g=new Qo(this.l+":"+this.u),this.b={},this.b.unknown=this.c,this.b.signInViaRedirect=this.c,this.b.linkViaRedirect=this.c,this.b.reauthViaRedirect=this.c,this.b.signInViaPopup=this.s,this.b.linkViaPopup=this.s,this.b.reauthViaPopup=this.s,this.a=ta(this.v,this.l,this.u,Ul)}function ta(t,e,n,r){var i=fu.SDK_VERSION||null;return Qe()?new Vo(t,e,n,i,r):new Qi(t,e,n,i,r)}function ea(t){t.f||(t.f=!0,t.a.va(t.j));var e=t.a;return t.a.ea().m(function(n){throw t.a==e&&t.reset(),n})}function na(t){t.a.Gb()&&ea(t).m(function(e){var n=new yr("unknown",null,null,null,new An("operation-not-supported-in-this-environment"));ia(e)&&t.o(n)}),t.a.Bb()||sa(t.c)}function ra(t,e,n,r,i,o){return t.a.xb(e,n,r,function(){t.f||(t.f=!0,t.a.va(t.j))},function(){t.reset()},i,o)}function ia(t){return!(!t||"auth/cordova-not-ready"!=t.code)}function oa(t,e,n){var r=e+":"+n;return Lh[r]||(Lh[r]=new $o(t,e,n)),Lh[r]}function aa(){this.b=null,this.f=[],this.c=[],this.a=null,this.g=!1}function sa(t){t.g||(t.g=!0,ha(t,!1,null,null))}function ua(t,e,n){n=n.wa(e.b,e.c);var r=e.f,i=e.g,o=!!e.b.match(/Redirect$/);n(r,i).then(function(e){ha(t,o,e,null)}).m(function(e){ha(t,o,null,e)})}function ca(t,e){if(t.b=function(){return X(e)},t.c.length)for(var n=0;n<t.c.length;n++)t.c[n](e)}function la(t,e){if(t.b=function(){return Q(e)},t.f.length)for(var n=0;n<t.f.length;n++)t.f[n](e)}function ha(t,e,n,r){e?r?ca(t,r):la(t,n):la(t,{user:null}),t.f=[],t.c=[]}function fa(t){var e=new An("timeout");t.a&&t.a.cancel(),t.a=Ht(kh.get()).then(function(){t.b||ha(t,!0,null,e)})}function da(){}function pa(t,e){var n=t.c,r=t.b;e.wa(r,n)(t.f,t.g).then(function(t){e.ga(r,t,null,n)}).m(function(t){e.ga(r,null,t,n)})}function ma(t,e){this.a=e,wn(this,"verificationId",t)}function ga(t,e,n,r){return new pr(t).Sa(e,n).then(function(t){return new ma(t,r)})}function va(t){var e=Fn(t);if(!(e&&e.exp&&e.auth_time&&e.iat))throw new An("internal-error","An internal error occurred. The token obtained by Firebase appears to be malformed. Please retry the operation.");En(this,{token:t,expirationTime:_n(1e3*e.exp),authTime:_n(1e3*e.auth_time),issuedAtTime:_n(1e3*e.iat),signInProvider:e.firebase&&e.firebase.sign_in_provider?e.firebase.sign_in_provider:null,claims:e})}function ya(t,e,n){if(this.h=t,this.j=e,this.g=n,this.c=3e4,this.f=96e4,this.b=null,this.a=this.c,this.f<this.c)throw Error("Proactive refresh lower bound greater than upper bound!")}function _a(t,e){return e?(t.a=t.c,t.g()):(e=t.a,t.a*=2,t.a>t.f&&(t.a=t.f),e)}function ba(t,e){t.stop(),t.b=Ht(_a(t,e)).then(function(){return yn()}).then(function(){return t.h()}).then(function(){ba(t,!0)}).m(function(e){t.j(e)&&ba(t,!1)})}function wa(t){this.f=t,this.b=this.a=null,this.c=0}function Ea(t,e){var n=e[Il],r=e.refreshToken;e=xa(e.expiresIn),t.b=n,t.c=e,t.a=r}function xa(t){return vu()+1e3*parseInt(t,10)}function Ta(t,e){return bi(t.f,e).then(function(e){return t.b=e.access_token,t.c=xa(e.expires_in),t.a=e.refresh_token,{accessToken:t.b,expirationTime:t.c,refreshToken:t.a}}).m(function(e){throw"auth/user-token-expired"==e.code&&(t.a=null),e})}function Sa(t,e){this.a=t||null,this.b=e||null,En(this,{lastSignInTime:_n(e||null),creationTime:_n(t||null)})}function Ca(t){return new Sa(t.a,t.b)}function Ma(t,e,n,r,i,o){En(this,{uid:t,displayName:r||null,photoURL:i||null,email:n||null,phoneNumber:o||null,providerId:e})}function Aa(t,e){yt.call(this,t);for(var n in e)this[n]=e[n]}function Ia(t,e,n){this.D=[],this.G=t.apiKey,this.s=t.appName,this.B=t.authDomain||null,t=fu.SDK_VERSION?en(fu.SDK_VERSION):null,this.b=new mi(this.G,Vi(Ul),t),this.h=new wa(this.b),Ua(this,e[Il]),Ea(this.h,e),wn(this,"refreshToken",this.h.a),ja(this,n||{}),Ut.call(this),this.I=!1,this.B&&an()&&(this.a=oa(this.B,this.G,this.s)),this.N=[],this.j=null,this.l=Oa(this),this.V=f(this.Ga,this);var r=this;this.ia=null,this.sa=function(t){r.na(t.g)},this.X=null,this.O=[],this.ra=function(t){Pa(r,t.c)},this.W=null}function Ra(t,e){t.X&&It(t.X,"languageCodeChanged",t.sa),(t.X=e)&&St(e,"languageCodeChanged",t.sa)}function Pa(t,e){t.O=e,vi(t.b,fu.SDK_VERSION?en(fu.SDK_VERSION,t.O):null)}function Na(t,e){t.W&&It(t.W,"frameworkChanged",t.ra),(t.W=e)&&St(e,"frameworkChanged",t.ra)}function Da(t){try{return fu.app(t.s).auth()}catch(e){throw new An("internal-error","No firebase.auth.Auth instance is available for the Firebase App '"+t.s+"'!")}}function Oa(t){return new ya(function(){return t.F(!0)},function(t){return!(!t||"auth/network-request-failed"!=t.code)},function(){var e=t.h.c-vu()-3e5;return 0<e?e:0})}function ka(t){t.o||t.l.b||(t.l.start(),It(t,"tokenChanged",t.V),St(t,"tokenChanged",t.V))}function La(t){It(t,"tokenChanged",t.V),t.l.stop()}function Ua(t,e){t.qa=e,wn(t,"_lat",e)}function Fa(t,e){I(t.N,function(t){return t==e})}function Ba(t){for(var e=[],n=0;n<t.N.length;n++)e.push(t.N[n](t));return $(e).then(function(){return t})}function Va(t){t.a&&!t.I&&(t.I=!0,t.a.subscribe(t))}function ja(t,e){En(t,{uid:e.uid,displayName:e.displayName||null,photoURL:e.photoURL||null,email:e.email||null,emailVerified:e.emailVerified||!1,phoneNumber:e.phoneNumber||null,isAnonymous:e.isAnonymous||!1,metadata:new Sa(e.createdAt,e.lastLoginAt),providerData:[]})}function Ha(){}function Ga(t){return Q().then(function(){if(t.o)throw new An("app-deleted")})}function za(t){return Eu(t.providerData,function(t){return t.providerId})}function Wa(t,e){e&&(qa(t,e.providerId),t.providerData.push(e))}function qa(t,e){I(t.providerData,function(t){return t.providerId==e})}function Ya(t,e,n){("uid"!=e||n)&&t.hasOwnProperty(e)&&wn(t,e,n)}function Ka(t,e){t!=e&&(En(t,{uid:e.uid,displayName:e.displayName,photoURL:e.photoURL,email:e.email,emailVerified:e.emailVerified,phoneNumber:e.phoneNumber,isAnonymous:e.isAnonymous,providerData:[]}),e.metadata?wn(t,"metadata",Ca(e.metadata)):wn(t,"metadata",new Sa),wu(e.providerData,function(e){Wa(t,e)}),t.h=e.h,wn(t,"refreshToken",t.h.a))}function Qa(t){return t.F().then(function(e){var n=t.isAnonymous;return Ja(t,e).then(function(){return n||Ya(t,"isAnonymous",!1),e})})}function Xa(t,e){e[Il]&&t.qa!=e[Il]&&(Ea(t.h,e),t.dispatchEvent(new Aa("tokenChanged")),Ua(t,e[Il]),Ya(t,"refreshToken",t.h.a))}function Ja(t,e){return Ui(t.b,ql,{idToken:e}).then(f(t.uc,t))}function Za(t){return(t=t.providerUserInfo)&&t.length?Eu(t,function(t){return new Ma(t.rawId,t.providerId,t.email,t.displayName,t.photoUrl,t.phoneNumber)}):[]}function $a(t,e){return Qa(t).then(function(){if(M(za(t),e))return Ba(t).then(function(){throw new An("provider-already-linked")})})}function ts(t,e,n){var r=gr(e);return e=Vn(e),xn({user:t,credential:r,additionalUserInfo:e,operationType:n})}function es(t,e){return Xa(t,e),t.reload().then(function(){return t})}function ns(t,e,n,r,i){if(!an())return X(new An("operation-not-supported-in-this-environment"));if(t.j&&!i)return X(t.j);var o=Bn(n.providerId),a=dn(t.uid+":::"),s=null;(!cn()||Xe())&&t.B&&n.isOAuthProvider&&(s=$i(t.B,t.G,t.s,e,n,null,a,fu.SDK_VERSION||null));var u=We(s,o&&o.Aa,o&&o.za);return r=r().then(function(){if(is(t),!i)return t.F().then(function(){})}).then(function(){return ra(t.a,u,e,n,a,!!s)}).then(function(){return new q(function(n,r){t.ga(e,null,new An("cancelled-popup-request"),t.g||null),t.f=n,t.v=r,t.g=a,t.c=t.a.Da(t,e,u,a)})}).then(function(t){return u&&ze(u),t?xn(t):null}).m(function(t){throw u&&ze(u),t}),os(t,r,i)}function rs(t,e,n,r,i){if(!an())return X(new An("operation-not-supported-in-this-environment"));if(t.j&&!i)return X(t.j);var o=null,a=dn(t.uid+":::");return r=r().then(function(){if(is(t),!i)return t.F().then(function(){})}).then(function(){return t.$=a,Ba(t)}).then(function(e){return t.fa&&(e=t.fa,e=e.b.set(Uh,t.C(),e.a)),e}).then(function(){return t.a.Ba(e,n,a)}).m(function(e){if(o=e,t.fa)return ls(t.fa);throw o}).then(function(){if(o)throw o}),os(t,r,i)}function is(t){if(!t.a||!t.I){if(t.a&&!t.I)throw new An("internal-error");throw new An("auth-domain-config-required")}}function os(t,e,n){var r=as(t,e,n);return t.D.push(r),r.ha(function(){A(t.D,r)}),r}function as(t,e,n){return t.j&&!n?(e.cancel(),X(t.j)):e.m(function(e){throw!e||"auth/user-disabled"!=e.code&&"auth/user-token-expired"!=e.code||(t.j||t.dispatchEvent(new Aa("userInvalidated")),t.j=e),e})}function ss(t){if(!t.apiKey)return null;var e={apiKey:t.apiKey,authDomain:t.authDomain,appName:t.appName},n={};if(!(t.stsTokenManager&&t.stsTokenManager.accessToken&&t.stsTokenManager.expirationTime))return null;n[Il]=t.stsTokenManager.accessToken,n.refreshToken=t.stsTokenManager.refreshToken||null,n.expiresIn=(t.stsTokenManager.expirationTime-vu())/1e3;var r=new Ia(e,n,t);return t.providerData&&wu(t.providerData,function(t){t&&Wa(r,xn(t))}),t.redirectEventId&&(r.$=t.redirectEventId),r}function us(t,e,n,r){var i=new Ia(t,e);return n&&(i.fa=n),r&&Pa(i,r),i.reload().then(function(){return i})}function cs(t){this.a=t,this.b=So()}function ls(t){return Io(t.b,Uh,t.a)}function hs(t,e){return t.b.get(Uh,t.a).then(function(t){return t&&e&&(t.authDomain=e),ss(t||{})})}function fs(t){this.a=t,this.b=So(),this.c=null,this.f=ps(this),this.b.addListener(ms("local"),this.a,f(this.g,this))}function ds(t,e){var n,r=[];for(n in xh)xh[n]!==e&&r.push(Io(t.b,ms(xh[n]),t.a));return r.push(Io(t.b,Fh,t.a)),Z(r)}function ps(t){var e=ms("local"),n=ms("session"),r=ms("none");return Ao(t.b,e,t.a).then(function(){return t.b.get(n,t.a)}).then(function(i){return i?n:t.b.get(r,t.a).then(function(n){return n?r:t.b.get(e,t.a).then(function(n){return n?e:t.b.get(Fh,t.a).then(function(t){return t?ms(t):e})})})}).then(function(e){return t.c=e,ds(t,e.w)}).m(function(){t.c||(t.c=e)})}function ms(t){return{name:"authUser",w:t}}function gs(t){return bs(t,function(){return t.b.set(Fh,t.c.w,t.a)})}function vs(t,e){return bs(t,function(){return t.b.set(t.c,e.C(),t.a)})}function ys(t){return bs(t,function(){return Io(t.b,t.c,t.a)})}function _s(t,e){return bs(t,function(){return t.b.get(t.c,t.a).then(function(t){return t&&e&&(t.authDomain=e),ss(t||{})})})}function bs(t,e){return t.f=t.f.then(e,e),t.f}function ws(t){if(this.l=!1,wn(this,"app",t),!Ds(this).options||!Ds(this).options.apiKey)throw new An("invalid-api-key");t=fu.SDK_VERSION?en(fu.SDK_VERSION):null,this.b=new mi(Ds(this).options&&Ds(this).options.apiKey,Vi(Ul),t),this.N=[],this.o=[],this.I=[],this.Ob=fu.INTERNAL.createSubscribe(f(this.ic,this)),this.O=void 0,this.Pb=fu.INTERNAL.createSubscribe(f(this.jc,this)),As(this,null),this.h=new fs(Ds(this).options.apiKey+":"+Ds(this).name),this.G=new cs(Ds(this).options.apiKey+":"+Ds(this).name),this.V=Fs(this,Rs(this)),this.j=Fs(this,Ps(this)),this.X=!1,this.ia=f(this.Ic,this),this.Ga=f(this.ka,this),this.qa=f(this.Yb,this),this.ra=f(this.gc,this),this.sa=f(this.hc,this),Cs(this),this.INTERNAL={},this.INTERNAL.delete=f(this.delete,this),this.INTERNAL.logFramework=f(this.qc,this),this.s=0,Ut.call(this),Ts(this),this.D=[]}function Es(t){yt.call(this,"languageCodeChanged"),this.g=t}function xs(t){yt.call(this,"frameworkChanged"),this.c=t}function Ts(t){Object.defineProperty(t,"lc",{get:function(){return this.ca()},set:function(t){this.na(t)},enumerable:!1}),t.W=null}function Ss(t){return t.Nb||X(new An("auth-domain-config-required"))}function Cs(t){var e=Ds(t).options.authDomain,n=Ds(t).options.apiKey;e&&an()&&(t.Nb=t.V.then(function(){if(!t.l){if(t.a=oa(e,n,Ds(t).name),t.a.subscribe(t),Os(t)&&Va(Os(t)),t.B){Va(t.B);var r=t.B;r.na(t.ca()),Ra(r,t),r=t.B,Pa(r,t.D),Na(r,t),t.B=null}return t.a}}))}function Ms(t,e){var n={};return n.apiKey=Ds(t).options.apiKey,n.authDomain=Ds(t).options.authDomain,n.appName=Ds(t).name,t.V.then(function(){return us(n,e,t.G,t.Ka())}).then(function(e){return Os(t)&&e.uid==Os(t).uid?(Ka(Os(t),e),t.ka(e)):(As(t,e),Va(e),t.ka(e))}).then(function(){Ls(t)})}function As(t,e){Os(t)&&(Fa(Os(t),t.Ga),It(Os(t),"tokenChanged",t.qa),It(Os(t),"userDeleted",t.ra),It(Os(t),"userInvalidated",t.sa),La(Os(t))),e&&(e.N.push(t.Ga),St(e,"tokenChanged",t.qa),St(e,"userDeleted",t.ra),St(e,"userInvalidated",t.sa),0<t.s&&ka(e)),wn(t,"currentUser",e),e&&(e.na(t.ca()),Ra(e,t),Pa(e,t.D),Na(e,t))}function Is(t){var e=hs(t.G,Ds(t).options.authDomain).then(function(e){return(t.B=e)&&(e.fa=t.G),ls(t.G)});return Fs(t,e)}function Rs(t){var e=Ds(t).options.authDomain,n=Is(t).then(function(){return _s(t.h,e)}).then(function(e){return e?(e.fa=t.G,t.B&&(t.B.$||null)==(e.$||null)?e:e.reload().then(function(){return vs(t.h,e).then(function(){return e})}).m(function(n){return"auth/network-request-failed"==n.code?e:ys(t.h)})):null}).then(function(e){As(t,e||null)});return Fs(t,n)}function Ps(t){return t.V.then(function(){return t.da()}).m(function(){}).then(function(){if(!t.l)return t.ia()}).m(function(){}).then(function(){if(!t.l){t.X=!0;var e=t.h;e.b.addListener(ms("local"),e.a,t.ia)}})}function Ns(t,e){var n=null,r=null;return Fs(t,e.then(function(e){return n=gr(e),r=Vn(e),Ms(t,e)}).then(function(){return xn({user:Os(t),credential:n,additionalUserInfo:r,operationType:"signIn"})}))}function Ds(t){return t.app}function Os(t){return t.currentUser}function ks(t){return Os(t)&&Os(t)._lat||null}function Ls(t){if(t.X){for(var e=0;e<t.o.length;e++)t.o[e]&&t.o[e](ks(t));if(t.O!==t.getUid()&&t.I.length)for(t.O=t.getUid(),e=0;e<t.I.length;e++)t.I[e]&&t.I[e](ks(t))}}function Us(t,e){t.I.push(e),Fs(t,t.j.then(function(){!t.l&&M(t.I,e)&&t.O!==t.getUid()&&(t.O=t.getUid(),e(ks(t)))}))}function Fs(t,e){return t.N.push(e),e.ha(function(){A(t.N,e)}),e}function Bs(t,e,n,r,i,o){if(wn(this,"type","recaptcha"),this.b=this.c=null,this.o=!1,this.l=e,this.a=n||{theme:"light",type:"image"},this.g=[],this.a[jh])throw new An("argument-error","sitekey should not be provided for reCAPTCHA as one is automatically provisioned for the current project.");if(this.h="invisible"===this.a[Hh],!pu.document)throw new An("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment with DOM support.");if(!Ie(e)||!this.h&&Ie(e).hasChildNodes())throw new An("argument-error","reCAPTCHA container is either not found or already contains inner elements!");this.u=new mi(t,o||null,i||null),this.s=r||function(){return null};var a=this;this.j=[];var s=this.a[Bh];this.a[Bh]=function(t){if(Vs(a,t),"function"===typeof s)s(t);else if("string"===typeof s){var e=rn(s,pu);"function"===typeof e&&e(t)}};var u=this.a[Vh];this.a[Vh]=function(){if(Vs(a,null),"function"===typeof u)u();else if("string"===typeof u){var t=rn(u,pu);"function"===typeof t&&t()}}}function Vs(t,e){for(var n=0;n<t.j.length;n++)try{t.j[n](e)}catch(t){}}function js(t,e){I(t.j,function(t){return t==e})}function Hs(t,e){return t.g.push(e),e.ha(function(){A(t.g,e)}),e}function Gs(t){if(t.o)throw new An("internal-error","RecaptchaVerifier instance has been destroyed.")}function zs(){this.b=pu.grecaptcha?1/0:0,this.c=null,this.a="__rcb"+Math.floor(1e6*Math.random()).toString()}function Ws(t,e){return new q(function(n,r){var i=setTimeout(function(){r(new An("network-request-failed"))},zh.get());if(!pu.grecaptcha||e!==t.c&&!t.b){pu[t.a]=function(){if(pu.grecaptcha){t.c=e;var o=pu.grecaptcha.render;pu.grecaptcha.render=function(e,n){return e=o(e,n),t.b++,e},clearTimeout(i),n()}else clearTimeout(i),r(new An("internal-error"));delete pu[t.a]};Q(ci(be(Gh,{onload:t.a,hl:e||""}))).m(function(){clearTimeout(i),r(new An("internal-error","Unable to load external reCAPTCHA dependencies!"))})}else clearTimeout(i),n()})}function qs(){return Wh||(Wh=new zs),Wh}function Ys(t,e,n){try{this.f=n||fu.app()}catch(t){throw new An("argument-error","No firebase.app.App instance is currently initialized.")}if(!this.f.options||!this.f.options.apiKey)throw new An("invalid-api-key");n=this.f.options.apiKey;var r=this,i=null;try{i=this.f.auth().Ka()}catch(t){}i=fu.SDK_VERSION?en(fu.SDK_VERSION,i):null,Bs.call(this,n,t,e,function(){try{var t=r.f.auth().ca()}catch(e){t=null}return t},i,Vi(Ul))}function Ks(t,e,n,r){t:{n=Array.prototype.slice.call(n);for(var i=0,o=!1,a=0;a<e.length;a++)if(e[a].optional)o=!0;else{if(o)throw new An("internal-error","Argument validator encountered a required argument after an optional argument.");i++}if(o=e.length,n.length<i||o<n.length)r="Expected "+(i==o?1==i?"1 argument":i+" arguments":i+"-"+o+" arguments")+" but got "+n.length+".";else{for(i=0;i<n.length;i++)if(o=e[i].optional&&void 0===n[i],!e[i].M(n[i])&&!o){if(e=e[i],0>i||i>=qh.length)throw new An("internal-error","Argument validator received an unsupported number of arguments.");n=qh[i],r=(r?"":n+" argument ")+(e.name?'"'+e.name+'" ':"")+"must be "+e.K+".";break t}r=null}}if(r)throw new An("argument-error",t+" failed: "+r)}function Qs(e,n){return{name:e||"",K:"a valid string",optional:!!n,M:t}}function Xs(){return{name:"opt_forceRefresh",K:"a boolean",optional:!0,M:e}}function Js(t,e){return{name:t||"",K:"a valid object",optional:!!e,M:c}}function Zs(t,e){return{name:t||"",K:"a function",optional:!!e,M:u}}function $s(t,e){return{name:t||"",K:"null",optional:!!e,M:o}}function tu(){return{name:"",K:"an HTML element",optional:!1,M:function(t){return!!(t&&t instanceof Element)}}}function eu(){return{name:"auth",K:"an instance of Firebase Auth",optional:!0,M:function(t){return!!(t&&t instanceof ws)}}}function nu(){return{name:"app",K:"an instance of Firebase App",optional:!0,M:function(t){return!!(t&&t instanceof fu.app.App)}}}function ru(t){return{name:t?t+"Credential":"credential",K:t?"a valid "+t+" credential":"a valid credential",optional:!1,M:function(e){if(!e)return!1;var n=!t||e.providerId===t;return!(!e.xa||!n)}}}function iu(){return{name:"authProvider",K:"a valid Auth provider",optional:!1,M:function(t){return!!(t&&t.providerId&&t.hasOwnProperty&&t.hasOwnProperty("isOAuthProvider"))}}}function ou(){return{name:"applicationVerifier",K:"an implementation of firebase.auth.ApplicationVerifier",optional:!1,M:function(e){return!!(e&&t(e.type)&&u(e.verify))}}}function au(t,e,n,r){return{name:n||"",K:t.K+" or "+e.K,optional:!!r,M:function(n){return t.M(n)||e.M(n)}}}function su(t,e){for(var n in e){var r=e[n].name;t[r]=cu(r,t[n],e[n].i)}}function uu(t,e,n,r){t[e]=cu(e,n,r)}function cu(t,e,n){function r(){var t=Array.prototype.slice.call(arguments);return Ks(o,n,t),e.apply(this,t)}if(!n)return e;var i,o=lu(t);for(i in e)r[i]=e[i];for(i in e.prototype)r.prototype[i]=e.prototype[i];return r}function lu(t){return t=t.split("."),t[t.length-1]}var hu,fu=n(2).default,du=du||{},pu=this,mu="closure_uid_"+(1e9*Math.random()>>>0),gu=0,vu=Date.now||function(){return+new Date};p(v,Error),v.prototype.name="CustomError",p(y,v),y.prototype.name="AssertionError",b.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var yu=new b(function(){return new T},function(t){t.reset()});E.prototype.add=function(t,e){var n=yu.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},T.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},T.prototype.reset=function(){this.next=this.b=this.a=null};var _u,bu=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(e,n){if(t(e))return t(n)&&1==n.length?e.indexOf(n,0):-1;for(var r=0;r<e.length;r++)if(r in e&&e[r]===n)return r;return-1},wu=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(e,n,r){for(var i=e.length,o=t(e)?e.split(""):e,a=0;a<i;a++)a in o&&n.call(r,o[a],a,e)},Eu=Array.prototype.map?function(t,e){return Array.prototype.map.call(t,e,void 0)}:function(e,n){for(var r=e.length,i=Array(r),o=t(e)?e.split(""):e,a=0;a<r;a++)a in o&&(i[a]=n.call(void 0,o[a],a,e));return i},xu=Array.prototype.some?function(t,e){return Array.prototype.some.call(t,e,void 0)}:function(e,n){for(var r=e.length,i=t(e)?e.split(""):e,o=0;o<r;o++)if(o in i&&n.call(void 0,i[o],o,e))return!0;return!1},Tu=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},Su=/&/g,Cu=/</g,Mu=/>/g,Au=/"/g,Iu=/'/g,Ru=/\x00/g,Pu=/[\x00&<>"']/;t:{var Nu=pu.navigator;if(Nu){var Du=Nu.userAgent;if(Du){_u=Du;break t}}_u=""}var Ou,ku,Lu="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" "),Uu=!1,Fu=new E,Bu=0,Vu=2,ju=3;Y.prototype.reset=function(){this.f=this.b=this.g=this.a=null,this.c=!1};var Hu=new b(function(){return new Y},function(t){t.reset()});q.prototype.then=function(t,e,n){return nt(this,u(t)?t:null,u(e)?e:null,n)},m(q),hu=q.prototype,hu.ha=function(t,e){return t=K(t,t,e),t.c=!0,et(this,t),this},hu.m=function(t,e){return nt(this,null,t,e)},hu.cancel=function(t){this.a==Bu&&G(function(){tt(this,new ht(t))},this)},hu.Kc=function(t){this.a=Bu,rt(this,Vu,t)},hu.Lc=function(t){this.a=Bu,rt(this,ju,t)},hu.Ub=function(){for(var t;t=st(this);)ut(this,t,this.a,this.j);this.h=!1};var Gu=j;p(ht,v),ht.prototype.name="cancel";var zu=0,Wu={};ft.prototype.pa=!1,ft.prototype.ua=function(){if(this.oa)for(;this.oa.length;)this.oa.shift()()},pt[" "]=r;var qu,Yu=L("Opera"),Ku=L("Trident")||L("MSIE"),Qu=L("Edge"),Xu=Qu||Ku,Ju=L("Gecko")&&!(O(_u.toLowerCase(),"webkit")&&!L("Edge"))&&!(L("Trident")||L("MSIE"))&&!L("Edge"),Zu=O(_u.toLowerCase(),"webkit")&&!L("Edge");t:{var $u="",tc=function(){var t=_u;return Ju?/rv:([^\);]+)(\)|;)/.exec(t):Qu?/Edge\/([\d\.]+)/.exec(t):Ku?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Zu?/WebKit\/(\S+)/.exec(t):Yu?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(tc&&($u=tc?tc[1]:""),Ku){var ec=gt();if(null!=ec&&ec>parseFloat($u)){qu=String(ec);break t}}qu=$u}var nc,rc={},ic=pu.document;nc=ic&&Ku?gt()||("CSS1Compat"==ic.compatMode?parseInt(qu,10):5):void 0;var oc=Object.freeze||function(t){return t},ac=!Ku||9<=Number(nc),sc=Ku&&!vt("9"),uc=function(){if(!pu.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return pu.addEventListener("test",r,e),pu.removeEventListener("test",r,e),t}();yt.prototype.preventDefault=function(){this.Eb=!1},p(_t,yt);var cc=oc({2:"touch",3:"pen",4:"mouse"});_t.prototype.preventDefault=function(){_t.lb.preventDefault.call(this);var t=this.a;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,sc)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}},_t.prototype.f=function(){return this.a};var lc="closure_listenable_"+(1e6*Math.random()|0),hc=0;Et.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=Tt(t,e,r,i);return-1<a?(e=t[a],n||(e.Ha=!1)):(e=new bt(e,this.src,o,!!r,i),e.Ha=n,t.push(e)),e};var fc="closure_lm_"+(1e6*Math.random()|0),dc={},pc=0,mc="__closure_events_fn_"+(1e9*Math.random()>>>0);p(Ut,ft),Ut.prototype[lc]=!0,Ut.prototype.addEventListener=function(t,e,n,r){St(this,t,e,n,r)},Ut.prototype.removeEventListener=function(t,e,n,r){It(this,t,e,n,r)},Ut.prototype.dispatchEvent=function(e){var n,r=this.Ta;if(r)for(n=[];r;r=r.Ta)n.push(r);r=this.Mb;var i=e.type||e;if(t(e))e=new yt(e,r);else if(e instanceof yt)e.target=e.target||r;else{var o=e;e=new yt(i,r),V(e,o)}if(o=!0,n)for(var a=n.length-1;0<=a;a--){var s=e.b=n[a];o=Vt(s,i,!0,e)&&o}if(s=e.b=r,o=Vt(s,i,!0,e)&&o,o=Vt(s,i,!1,e)&&o,n)for(a=0;a<n.length;a++)s=e.b=n[a],o=Vt(s,i,!1,e)&&o;return o},Ut.prototype.ua=function(){if(Ut.lb.ua.call(this),this.u){var t,e=this.u,n=0;for(t in e.a){for(var r=e.a[t],i=0;i<r.length;i++)++n,wt(r[i]);delete e.a[t],e.b--}}this.Ta=null},hu=qt.prototype,hu.S=function(){Yt(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},hu.U=function(){return Yt(this),this.a.concat()},hu.clear=function(){this.b={},this.c=this.a.length=0},hu.get=function(t,e){return Kt(this.b,t)?this.b[t]:e},hu.set=function(t,e){Kt(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},hu.forEach=function(t,e){for(var n=this.U(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var gc=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;Xt.prototype.toString=function(){var t=[],e=this.c;e&&t.push(oe(e,vc,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.l)&&t.push(oe(e,vc,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.j)&&t.push(":",String(n))),(n=this.g)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(oe(n,"/"==n.charAt(0)?_c:yc,!0))),(n=this.a.toString())&&t.push("?",n),(n=this.h)&&t.push("#",oe(n,wc)),t.join("")};var vc=/[#\/\?@]/g,yc=/[#\?:]/g,_c=/[#\?]/g,bc=/[#\?@]/g,wc=/#/g;hu=se.prototype,hu.add=function(t,e){ue(this),this.c=null,t=de(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},hu.clear=function(){this.a=this.c=null,this.b=0},hu.forEach=function(t,e){ue(this),this.a.forEach(function(n,r){wu(n,function(n){t.call(e,n,r,this)},this)},this)},hu.U=function(){ue(this);for(var t=this.a.S(),e=this.a.U(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},hu.S=function(e){ue(this);var n=[];if(t(e))he(this,e)&&(n=R(n,this.a.get(de(this,e))));else{e=this.a.S();for(var r=0;r<e.length;r++)n=R(n,e[r])}return n},hu.set=function(t,e){return ue(this),this.c=null,t=de(this,t),he(this,t)&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},hu.get=function(t,e){return t=t?this.S(t):[],0<t.length?String(t[0]):e},hu.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.U(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.S(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var Ec=!Ku||9<=Number(nc);me.prototype.la=!0,me.prototype.ja=function(){return this.a},me.prototype.toString=function(){return"Const{"+this.a+"}"};var xc={};ve(""),ye.prototype.la=!0,ye.prototype.ja=function(){return this.a},ye.prototype.toString=function(){return"TrustedResourceUrl{"+this.a+"}"};var Tc=/%{(\w+)}/g,Sc=/^(?:https:)?\/\/[0-9a-z.:[\]-]+\/|^\/[^\/\\]|^about:blank#/i,Cc={};Ee.prototype.la=!0,Ee.prototype.ja=function(){return this.a},Ee.prototype.toString=function(){return"SafeUrl{"+this.a+"}"};var Mc=/^(?:(?:https?|mailto|ftp):|[^:\/?#]*(?:[\/?#]|$))/i,Ac={};Se("about:blank"),Ce.prototype.la=!0,Ce.prototype.ja=function(){return this.a},Ce.prototype.toString=function(){return"SafeHtml{"+this.a+"}"};var Ic={};Ae("<!DOCTYPE html>"),Ae(""),Ae("<br>");var Rc={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",frameborder:"frameBorder",height:"height",maxlength:"maxLength",nonce:"nonce",role:"role",rowspan:"rowSpan",type:"type",usemap:"useMap",valign:"vAlign",width:"width"},Pc={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Nc=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g,Dc=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,Oc="Firefox",kc="Chrome",Lc={Qc:"FirebaseCore-web",Sc:"FirebaseUI-web"};gn.prototype.get=function(){var t=pu.navigator;return(t&&"boolean"===typeof t.onLine&&(sn()||"chrome-extension:"===un()||"undefined"!==typeof t.connection)?t.onLine:1)?this.b?this.c:this.a:Math.min(5e3,this.a)};var Uc,Fc={};try{var Bc={};Object.defineProperty(Bc,"abcd",{configurable:!0,enumerable:!0,value:1}),Object.defineProperty(Bc,"abcd",{configurable:!0,enumerable:!0,value:2}),Uc=2==Bc.abcd}catch(t){Uc=!1}var Vc="EMAIL_SIGNIN",jc="email",Hc="newEmail",Gc="requestType",zc="email",Wc="fromEmail",qc="data",Yc="operation";p(An,Error),An.prototype.C=function(){return{code:this.code,message:this.message}},An.prototype.toJSON=function(){return this.C()};var Kc="auth/",Qc={"argument-error":"","app-not-authorized":"This app, identified by the domain where it's hosted, is not authorized to use Firebase Authentication with the provided API key. Review your key configuration in the Google API console.","app-not-installed":"The requested mobile application corresponding to the identifier (Android package name or iOS bundle ID) provided is not installed on this device.","captcha-check-failed":"The reCAPTCHA response token provided is either invalid, expired, already used or the domain associated with it does not match the list of whitelisted domains.","code-expired":"The SMS code has expired. Please re-send the verification code to try again.","cordova-not-ready":"Cordova framework is not ready.","cors-unsupported":"This browser is not supported.","credential-already-in-use":"This credential is already associated with a different user account.","custom-token-mismatch":"The custom token corresponds to a different audience.","requires-recent-login":"This operation is sensitive and requires recent authentication. Log in again before retrying this request.","dynamic-link-not-activated":"Please activate Dynamic Links in the Firebase Console and agree to the terms and conditions.","email-already-in-use":"The email address is already in use by another account.","expired-action-code":"The action code has expired. ","cancelled-popup-request":"This operation has been cancelled due to another conflicting popup being opened.","internal-error":"An internal error has occurred.","invalid-app-credential":"The phone verification request contains an invalid application verifier. The reCAPTCHA token response is either invalid or expired.","invalid-app-id":"The mobile app identifier is not registed for the current project.","invalid-user-token":"This user's credential isn't valid for this project. This can happen if the user's token has been tampered with, or if the user isn't for the project associated with this API key.","invalid-auth-event":"An internal error has occurred.","invalid-verification-code":"The SMS verification code used to create the phone auth credential is invalid. Please resend the verification code sms and be sure use the verification code provided by the user.","invalid-continue-uri":"The continue URL provided in the request is invalid.","invalid-cordova-configuration":"The following Cordova plugins must be installed to enable OAuth sign-in: cordova-plugin-buildinfo, cordova-universal-links-plugin, cordova-plugin-browsertab, cordova-plugin-inappbrowser and cordova-plugin-customurlscheme.","invalid-custom-token":"The custom token format is incorrect. Please check the documentation.","invalid-email":"The email address is badly formatted.","invalid-api-key":"Your API key is invalid, please check you have copied it correctly.","invalid-cert-hash":"The SHA-1 certificate hash provided is invalid.","invalid-credential":"The supplied auth credential is malformed or has expired.","invalid-persistence-type":"The specified persistence type is invalid. It can only be local, session or none.","invalid-message-payload":"The email template corresponding to this action contains invalid characters in its message. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-oauth-provider":"EmailAuthProvider is not supported for this operation. This operation only supports OAuth providers.","invalid-oauth-client-id":"The OAuth client ID provided is either invalid or does not match the specified API key.","unauthorized-domain":"This domain is not authorized for OAuth operations for your Firebase project. Edit the list of authorized domains from the Firebase console.","invalid-action-code":"The action code is invalid. This can happen if the code is malformed, expired, or has already been used.","wrong-password":"The password is invalid or the user does not have a password.","invalid-phone-number":"The format of the phone number provided is incorrect. Please enter the phone number in a format that can be parsed into E.164 format. E.164 phone numbers are written in the format [+][country code][subscriber number including area code].","invalid-recipient-email":"The email corresponding to this action failed to send as the provided recipient email address is invalid.","invalid-sender":"The email template corresponding to this action contains an invalid sender email or name. Please fix by going to the Auth email templates section in the Firebase Console.","invalid-verification-id":"The verification ID used to create the phone auth credential is invalid.","missing-android-pkg-name":"An Android Package Name must be provided if the Android App is required to be installed.","auth-domain-config-required":"Be sure to include authDomain when calling firebase.initializeApp(), by following the instructions in the Firebase console.","missing-app-credential":"The phone verification request is missing an application verifier assertion. A reCAPTCHA response token needs to be provided.","missing-verification-code":"The phone auth credential was created with an empty SMS verification code.","missing-continue-uri":"A continue URL must be provided in the request.","missing-iframe-start":"An internal error has occurred.","missing-ios-bundle-id":"An iOS Bundle ID must be provided if an App Store ID is provided.","missing-phone-number":"To send verification codes, provide a phone number for the recipient.","missing-verification-id":"The phone auth credential was created with an empty verification ID.","app-deleted":"This instance of FirebaseApp has been deleted.","account-exists-with-different-credential":"An account already exists with the same email address but different sign-in credentials. Sign in using a provider associated with this email address.","network-request-failed":"A network error (such as timeout, interrupted connection or unreachable host) has occurred.","no-auth-event":"An internal error has occurred.","no-such-provider":"User was not linked to an account with the given provider.","operation-not-allowed":"The given sign-in provider is disabled for this Firebase project. Enable it in the Firebase console, under the sign-in method tab of the Auth section.","operation-not-supported-in-this-environment":'This operation is not supported in the environment this application is running on. "location.protocol" must be http, https or chrome-extension and web storage must be enabled.',"popup-blocked":"Unable to establish a connection with the popup. It may have been blocked by the browser.","popup-closed-by-user":"The popup has been closed by the user before finalizing the operation.","provider-already-linked":"User can only be linked to one identity for the given provider.","quota-exceeded":"The project's quota for this operation has been exceeded.","redirect-cancelled-by-user":"The redirect operation has been cancelled by the user before finalizing.","redirect-operation-pending":"A redirect sign-in operation is already pending.",timeout:"The operation has timed out.","user-token-expired":"The user's credential is no longer valid. The user must sign in again.","too-many-requests":"We have blocked all requests from this device due to unusual activity. Try again later.","unauthorized-continue-uri":"The domain of the continue URL is not whitelisted.  Please whitelist the domain in the Firebase console.","unsupported-persistence-type":"The current environment does not support the specified persistence type.","user-cancelled":"User did not grant your application the permissions it requested.","user-not-found":"There is no user record corresponding to this identifier. The user may have been deleted.","user-disabled":"The user account has been disabled by an administrator.","user-mismatch":"The supplied credentials do not correspond to the previously signed in user.","user-signed-out":"","weak-password":"The password must be 6 characters long or more.","web-storage-unsupported":"This browser is not supported or 3rd party cookies and data may be disabled."},Xc="android",Jc="handleCodeInApp",Zc="iOS",$c="url",tl="installApp",el="minimumVersion",nl="packageName",rl="bundleId",il=null,ol=null;Ln.prototype.f=function(){return this.b};var al="oauth_consumer_key oauth_nonce oauth_signature oauth_signature_method oauth_timestamp oauth_token oauth_version".split(" "),sl=["client_id","response_type","scope","redirect_uri","state"],ul={Rc:{Ma:"locale",Aa:500,za:600,Na:"facebook.com",cb:sl},Tc:{Ma:null,Aa:500,za:620,Na:"github.com",cb:sl},Uc:{Ma:"hl",Aa:515,za:680,Na:"google.com",cb:sl},$c:{Ma:"lang",Aa:485,za:705,Na:"twitter.com",cb:al}},cl="idToken",ll="providerId";p(Hn,jn),p(Gn,Hn),p(zn,Hn),p(Wn,Hn),p(qn,Hn),Xn.prototype.xa=function(t){return Di(t,Jn(this))},Xn.prototype.c=function(t,e){var n=Jn(this);return n.idToken=e,Oi(t,n)},Xn.prototype.f=function(t,e){return Qn(ki(t,Jn(this)),e)},Xn.prototype.C=function(){var t={providerId:this.providerId,signInMethod:this.signInMethod};return this.idToken&&(t.oauthIdToken=this.idToken),this.accessToken&&(t.oauthAccessToken=this.accessToken),this.secret&&(t.oauthTokenSecret=this.secret),t},Zn.prototype.Ca=function(t){return this.tb=B(t),this},p($n,Zn),$n.prototype.ta=function(t){return M(this.a,t)||this.a.push(t),this},$n.prototype.yb=function(){return P(this.a)},$n.prototype.credential=function(t,e){if(!t&&!e)throw new An("argument-error","credential failed: must provide the ID token and/or the access token.");return new Xn(this.providerId,{idToken:t||null,accessToken:e||null},this.providerId)},p(tr,$n),wn(tr,"PROVIDER_ID","facebook.com"),wn(tr,"FACEBOOK_SIGN_IN_METHOD","facebook.com"),p(nr,$n),wn(nr,"PROVIDER_ID","github.com"),wn(nr,"GITHUB_SIGN_IN_METHOD","github.com"),p(ir,$n),wn(ir,"PROVIDER_ID","google.com"),wn(ir,"GOOGLE_SIGN_IN_METHOD","google.com"),p(ar,Zn),wn(ar,"PROVIDER_ID","twitter.com"),wn(ar,"TWITTER_SIGN_IN_METHOD","twitter.com"),ur.prototype.xa=function(t){return this.signInMethod==cr.EMAIL_LINK_SIGN_IN_METHOD?Ui(t,zl,{email:this.a,oobCode:this.b}):Ui(t,sh,{email:this.a,password:this.b})},ur.prototype.c=function(t,e){return this.signInMethod==cr.EMAIL_LINK_SIGN_IN_METHOD?Ui(t,Wl,{idToken:e,email:this.a,oobCode:this.b}):Ui(t,eh,{idToken:e,email:this.a,password:this.b})},ur.prototype.f=function(t,e){return Qn(this.xa(t),e)},ur.prototype.C=function(){return{email:this.a,password:this.b,signInMethod:this.signInMethod}},En(cr,{PROVIDER_ID:"password"}),En(cr,{EMAIL_LINK_SIGN_IN_METHOD:"emailLink"}),En(cr,{EMAIL_PASSWORD_SIGN_IN_METHOD:"password"}),fr.prototype.xa=function(t){return t.Sa(dr(this))},fr.prototype.c=function(t,e){var n=dr(this);return n.idToken=e,Ui(t,ch,n)},fr.prototype.f=function(t,e){var n=dr(this);return n.operation="REAUTH",t=Ui(t,lh,n),Qn(t,e)},fr.prototype.C=function(){var t={providerId:"phone"};return this.a.Ra&&(t.verificationId=this.a.Ra),this.a.Qa&&(t.verificationCode=this.a.Qa),this.a.Ea&&(t.temporaryProof=this.a.Ea),this.a.Z&&(t.phoneNumber=this.a.Z),t},pr.prototype.Sa=function(e,n){var r=this.a.b;return Q(n.verify()).then(function(i){if(!t(i))throw new An("argument-error","An implementation of firebase.auth.ApplicationVerifier.prototype.verify() must return a firebase.Promise that resolves with a string.");switch(n.type){case"recaptcha":return Ii(r,{phoneNumber:e,recaptchaToken:i}).then(function(t){return"function"===typeof n.reset&&n.reset(),t},function(t){throw"function"===typeof n.reset&&n.reset(),t});default:throw new An("argument-error",'Only firebase.auth.ApplicationVerifiers with type="recaptcha" are currently supported.')}})},En(pr,{PROVIDER_ID:"phone"}),En(pr,{PHONE_SIGN_IN_METHOD:"phone"}),yr.prototype.C=function(){return{type:this.b,eventId:this.c,urlResponse:this.f,sessionId:this.g,error:this.a&&this.a.C()}};var hl=null;br.prototype.subscribe=function(t){var e=this;this.a.push(t),this.b||(this.b=function(t){for(var n=0;n<e.a.length;n++)e.a[n](t)},"function"===typeof(t=rn("universalLinks.subscribe",pu))&&t(null,this.b))},br.prototype.unsubscribe=function(t){I(this.a,function(e){return e==t})},p(wr,An),p(Er,An),Er.prototype.C=function(){var t={code:this.code,message:this.message};this.email&&(t.email=this.email),this.phoneNumber&&(t.phoneNumber=this.phoneNumber);var e=this.credential&&this.credential.C();return e&&V(t,e),t},Er.prototype.toJSON=function(){return this.C()};var fl=/^[+a-zA-Z0-9_.!#$%&'*\/=?^`{|}~-]+@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,63}$/;Tr.prototype.c=null;var dl;p(Cr,Tr),Cr.prototype.a=function(){var t=Mr(this);return t?new ActiveXObject(t):new XMLHttpRequest},Cr.prototype.b=function(){var t={};return Mr(this)&&(t[0]=!0,t[1]=!0),t},dl=new Cr,p(Ar,Tr),Ar.prototype.a=function(){var t=new XMLHttpRequest;if("withCredentials"in t)return t;if("undefined"!=typeof XDomainRequest)return new Ir;throw Error("Unsupported browser")},Ar.prototype.b=function(){return{}},hu=Ir.prototype,hu.open=function(t,e,n){if(null!=n&&!n)throw Error("Only async requests are supported.");this.a.open(t,e)},hu.send=function(t){if(t){if("string"!=typeof t)throw Error("Only string data is supported");this.a.send(t)}else this.a.send()},hu.abort=function(){this.a.abort()},hu.setRequestHeader=function(){},hu.getResponseHeader=function(t){return"content-type"==t.toLowerCase()?this.a.contentType:""},hu.bc=function(){this.status=200,this.responseText=this.a.responseText,Rr(this,4)},hu.zb=function(){this.status=500,this.responseText="",Rr(this,4)},hu.fc=function(){this.zb()},hu.cc=function(){this.status=200,Rr(this,1)},hu.getAllResponseHeaders=function(){return"content-type: "+this.a.contentType},Pr.prototype.a=null;var pl=0;Pr.prototype.reset=function(t,e,n,r,i){"number"==typeof i||pl++,r||vu(),delete this.a},Dr.prototype.toString=function(){return this.name};var ml=new Dr("SEVERE",1e3),gl=new Dr("WARNING",900),vl=new Dr("CONFIG",700),yl=new Dr("FINE",500);Nr.prototype.log=function(t,e,n){if(t.value>=Or(this).value)for(u(e)&&(e=e()),t=new Pr(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var _l={},bl=null;p(Ur,Tr),Ur.prototype.a=function(){return new Fr(this.f)},Ur.prototype.b=function(t){return function(){return t}}({}),p(Fr,Ut);var wl=0;hu=Fr.prototype,hu.open=function(t,e){if(this.readyState!=wl)throw this.abort(),Error("Error reopening a connection");this.h=t,this.c=e,this.readyState=1,Br(this)},hu.send=function(t){if(1!=this.readyState)throw this.abort(),Error("need to call open() first. ");this.a=!0;var e={headers:this.g,method:this.h,credentials:void 0,cache:void 0};t&&(e.body=t),this.j.fetch(new Request(this.c,e)).then(this.ec.bind(this),this.Ab.bind(this))},hu.abort=function(){this.responseText="",this.g=new Headers,this.status=0,1<=this.readyState&&this.a&&4!=this.readyState&&(this.readyState=4,this.a=!1,Br(this)),this.readyState=wl},hu.ec=function(t){this.a&&(this.b||(this.b=t.headers,this.readyState=2,Br(this)),this.a&&(this.readyState=3,Br(this),this.a&&t.text().then(this.dc.bind(this,t),this.Ab.bind(this))))},hu.dc=function(t,e){this.a&&(this.status=t.status,this.statusText=t.statusText,this.responseText=e,this.readyState=4,Br(this))},hu.Ab=function(t){var e=this.f;e&&e.log(gl,"Failed to fetch url "+this.c,t instanceof Error?t:Error(t)),this.a&&(this.readyState=4,Br(this))},hu.setRequestHeader=function(t,e){this.g.append(t,e)},hu.getResponseHeader=function(t){return this.b?this.b.get(t.toLowerCase())||"":((t=this.f)&&t.log(gl,"Attempting to get response header but no headers have been received for url: "+this.c,void 0),"")},hu.getAllResponseHeaders=function(){if(!this.b){var t=this.f;return t&&t.log(gl,"Attempting to get all response headers but no headers have been received for url: "+this.c,void 0),""}t=[];for(var e=this.b.entries(),n=e.next();!n.done;)n=n.value,t.push(n[0]+": "+n[1]),n=e.next();return t.join("\r\n")},p(Vr,Ut);var El="";Vr.prototype.b=kr("goog.net.XhrIo");var xl=/^https?$/i,Tl=["POST","PUT"];hu=Vr.prototype,hu.Fa=function(){"undefined"!=typeof du&&this.a&&(this.h="Timed out after "+this.g+"ms, aborting",Lr(this.b,Zr(this,this.h)),this.dispatchEvent("timeout"),this.abort(8))},hu.abort=function(){this.a&&this.c&&(Lr(this.b,Zr(this,"Aborting")),this.c=!1,this.f=!0,this.a.abort(),this.f=!1,this.dispatchEvent("complete"),this.dispatchEvent("abort"),Yr(this))},hu.ua=function(){this.a&&(this.c&&(this.c=!1,this.f=!0,this.a.abort(),this.f=!1),Yr(this,!0)),Vr.lb.ua.call(this)},hu.Db=function(){this.pa||(this.I||this.j||this.f?qr(this):this.tc())},hu.tc=function(){qr(this)},hu.getResponse=function(){try{if(!this.a)return null;if("response"in this.a)return this.a.response;switch(this.o){case El:case"text":return this.a.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in this.a)return this.a.mozResponseArrayBuffer}var t=this.b;return t&&t.log(ml,"Response type "+this.o+" is not supported on this browser",void 0),null}catch(t){return Lr(this.b,"Can not get response: "+t.message),null}},$r.prototype.cancel=function(t){if(this.a)this.c instanceof $r&&this.c.cancel();else{if(this.b){var e=this.b;delete this.b,t?e.cancel(t):0>=--e.l&&e.cancel()}this.v?this.v.call(this.s,this):this.u=!0,this.a||(t=new si(this),ei(this),ti(this,!1,t))}},$r.prototype.o=function(t,e){this.j=!1,ti(this,t,e)},$r.prototype.D=function(){ei(this),ti(this,!0,null)},$r.prototype.then=function(t,e,n){var r,i,o=new q(function(t,e){r=t,i=e});return ri(this,r,function(t){t instanceof si?o.cancel():i(t)}),o.then(t,e,n)},m($r),p(ai,v),ai.prototype.message="Deferred has already fired",ai.prototype.name="AlreadyCalledError",p(si,v),si.prototype.message="Deferred was canceled",si.prototype.name="CanceledError",ui.prototype.c=function(){throw delete Sl[this.a],this.b};var Sl={},Cl=0,Ml=1;p(di,v),p(pi,Tr),pi.prototype.a=function(){return new this.f},pi.prototype.b=function(){return{}};var Al,Il="idToken",Rl=new gn(3e4,6e4),Pl={"Content-Type":"application/x-www-form-urlencoded"},Nl=new gn(3e4,6e4),Dl={"Content-Type":"application/json"};mi.prototype.o=function(t,e,n,r,i,o){if(Je()&&("undefined"===typeof pu.fetch||"undefined"===typeof pu.Headers||"undefined"===typeof pu.Request))throw new An("operation-not-supported-in-this-environment","fetch, Headers and Request native APIs or equivalent Polyfills must be available to support HTTP requests from a Worker environment.");var a=new Vr(this.c);if(o){a.g=Math.max(0,o);var s=setTimeout(function(){a.dispatchEvent("timeout")},o)}Ft(a,"complete",function(){s&&clearTimeout(s);var t=null;try{t=JSON.parse(Jr(this))||null}catch(e){t=null}e&&e(t)}),Bt(a,"ready",function(){s&&clearTimeout(s),dt(this)}),Bt(a,"timeout",function(){s&&clearTimeout(s),dt(this),e&&e(null)}),jr(a,t,n,r,i)};var Ol=ve("https://apis.google.com/js/client.js?onload=%{onload}"),kl="__fcb"+Math.floor(1e6*Math.random()).toString();mi.prototype.u=function(t,e,n,r,i){var o=this;Al.then(function(){window.gapi.client.setApiKey(o.b);var a=window.gapi.auth.getToken();window.gapi.auth.setToken(null),window.gapi.client.request({path:t,method:n,body:r,headers:i,authType:"none",callback:function(t){window.gapi.auth.setToken(a),e&&e(t)}})}).m(function(t){e&&e({error:{message:t&&t.message||"CORS_UNSUPPORTED"}})})},mi.prototype.jb=function(){return Ui(this,nh,{})},mi.prototype.mb=function(t,e){return Ui(this,th,{idToken:t,email:e})},mi.prototype.nb=function(t,e){return Ui(this,eh,{idToken:t,password:e})};var Ll={displayName:"DISPLAY_NAME",photoUrl:"PHOTO_URL"};hu=mi.prototype,hu.ob=function(t,e){var n={idToken:t},r=[];return U(Ll,function(t,i){var o=e[i];null===o?r.push(t):i in e&&(n[i]=o)}),r.length&&(n.deleteAttribute=r),Ui(this,th,n)},hu.gb=function(t,e){return t={requestType:"PASSWORD_RESET",email:t},V(t,e),Ui(this,Ql,t)},hu.hb=function(t,e){return t={requestType:"EMAIL_SIGNIN",email:t},V(t,e),Ui(this,Yl,t)},hu.fb=function(t,e){return t={requestType:"VERIFY_EMAIL",idToken:t},V(t,e),Ui(this,Kl,t)},hu.Sa=function(t){return Ui(this,uh,t)},hu.Wa=function(t,e){return Ui(this,Zl,{oobCode:t,newPassword:e})},hu.Ia=function(t){return Ui(this,Bl,{oobCode:t})},hu.Ua=function(t){return Ui(this,Fl,{oobCode:t})};var Ul,Fl={endpoint:"setAccountInfo",A:Li,ba:"email"},Bl={endpoint:"resetPassword",A:Li,J:function(t){var e=t.requestType;if(!e||!t.email&&"EMAIL_SIGNIN"!=e)throw new An("internal-error")}},Vl={endpoint:"signupNewUser",A:function(t){if(Ei(t),!t.password)throw new An("weak-password")},J:Mi,R:!0},jl={endpoint:"createAuthUri"},Hl={endpoint:"deleteAccount",T:["idToken"]},Gl={endpoint:"setAccountInfo",T:["idToken","deleteProvider"],A:function(t){if(!a(t.deleteProvider))throw new An("internal-error")}},zl={endpoint:"emailLinkSignin",T:["email","oobCode"],A:Ei,J:Mi,R:!0},Wl={endpoint:"emailLinkSignin",T:["idToken","email","oobCode"],A:Ei,J:Mi,R:!0},ql={endpoint:"getAccountInfo"},Yl={endpoint:"getOobConfirmationCode",T:["requestType"],A:function(t){if("EMAIL_SIGNIN"!=t.requestType)throw new An("internal-error");Ei(t)},ba:"email"},Kl={endpoint:"getOobConfirmationCode",T:["idToken","requestType"],A:function(t){if("VERIFY_EMAIL"!=t.requestType)throw new An("internal-error")},ba:"email"},Ql={endpoint:"getOobConfirmationCode",T:["requestType"],A:function(t){if("PASSWORD_RESET"!=t.requestType)throw new An("internal-error");Ei(t)},ba:"email"},Xl={pb:!0,endpoint:"getProjectConfig",Cb:"GET"},Jl={pb:!0,endpoint:"getRecaptchaParam",Cb:"GET",J:function(t){if(!t.recaptchaSiteKey)throw new An("internal-error")}},Zl={endpoint:"resetPassword",A:Li,ba:"email"},$l={endpoint:"sendVerificationCode",T:["phoneNumber","recaptchaToken"],ba:"sessionInfo"},th={endpoint:"setAccountInfo",T:["idToken"],A:xi,R:!0},eh={endpoint:"setAccountInfo",T:["idToken"],A:function(t){if(xi(t),!t.password)throw new An("weak-password")},J:Mi,R:!0},nh={endpoint:"signupNewUser",J:Mi,R:!0},rh={endpoint:"verifyAssertion",A:Pi,J:Ni,R:!0},ih={endpoint:"verifyAssertion",A:Pi,J:function(t){if(t.errorMessage&&"USER_NOT_FOUND"==t.errorMessage)throw new An("user-not-found");if(t.errorMessage)throw Fi(t.errorMessage);if(!t[Il])throw new An("internal-error")},R:!0},oh={endpoint:"verifyAssertion",A:function(t){if(Pi(t),!t.idToken)throw new An("internal-error")},J:Ni,R:!0},ah={endpoint:"verifyCustomToken",A:function(t){if(!t.token)throw new An("invalid-custom-token")},J:Mi,R:!0},sh={endpoint:"verifyPassword",A:function(t){if(Ei(t),!t.password)throw new An("wrong-password")},J:Mi,R:!0},uh={endpoint:"verifyPhoneNumber",A:Ai,J:Mi},ch={endpoint:"verifyPhoneNumber",A:function(t){if(!t.idToken)throw new An("internal-error");Ai(t)},J:function(t){if(t.temporaryProof)throw t.code="credential-already-in-use",xr(t);Mi(t)}},lh={Tb:{USER_NOT_FOUND:"user-not-found"},endpoint:"verifyPhoneNumber",A:Ai,J:Mi},hh={Wc:{Ya:"https://www.googleapis.com/identitytoolkit/v3/relyingparty/",eb:"https://securetoken.googleapis.com/v1/token",id:"p"},Yc:{Ya:"https://staging-www.sandbox.googleapis.com/identitytoolkit/v3/relyingparty/",eb:"https://staging-securetoken.sandbox.googleapis.com/v1/token",id:"s"},Zc:{Ya:"https://www-googleapis-test.sandbox.google.com/identitytoolkit/v3/relyingparty/",eb:"https://test-securetoken.sandbox.googleapis.com/v1/token",id:"t"}};Ul=Vi("__EID__")?"__EID__":void 0;var fh=ve("https://apis.google.com/js/api.js?onload=%{onload}"),dh=new gn(3e4,6e4),ph=new gn(5e3,15e3),mh=null;qi.prototype.toString=function(){return this.f?te(this.a,"v",this.f):le(this.a.a,"v"),this.b?te(this.a,"eid",this.b):le(this.a.a,"eid"),this.c.length?te(this.a,"fw",this.c.join(",")):le(this.a.a,"fw"),this.a.toString()},Yi.prototype.toString=function(){var t=re(this.o,"/__/auth/handler");if(te(t,"apiKey",this.u),te(t,"appName",this.c),te(t,"authType",this.l),this.a.isOAuthProvider){var e=this.a;try{var n=fu.app(this.c).auth().ca()}catch(t){n=null}e.Xa=n,te(t,"providerId",this.a.providerId),e=this.a,n=hn(e.tb);for(var r in n)n[r]=n[r].toString();r=e.Ac,n=B(n);for(var i=0;i<r.length;i++){var o=r[i];o in n&&delete n[o]}e.Za&&e.Xa&&!n[e.Za]&&(n[e.Za]=e.Xa),F(n)||te(t,"customParameters",ln(n))}if("function"===typeof this.a.yb&&(e=this.a.yb(),e.length&&te(t,"scopes",e.join(","))),this.j?te(t,"redirectUrl",this.j):le(t.a,"redirectUrl"),this.g?te(t,"eventId",this.g):le(t.a,"eventId"),this.h?te(t,"v",this.h):le(t.a,"v"),this.b)for(var a in this.b)this.b.hasOwnProperty(a)&&!ee(t,a)&&te(t,a,this.b[a]);return this.f?te(t,"eid",this.f):le(t.a,"eid"),a=Ki(this.c),a.length&&te(t,"fw",a.join(",")),t.toString()},hu=Qi.prototype,hu.Da=function(t,e,n){var r=new An("popup-closed-by-user"),i=new An("web-storage-unsupported"),o=this,a=!1;return this.ea().then(function(){eo(o).then(function(n){n||(t&&ze(t),e(i),a=!0)})}).m(function(){}).then(function(){if(!a)return qe(t)}).then(function(){if(!a)return Ht(n).then(function(){e(r)})})},hu.Gb=function(){var t=nn();return!cn(t)&&!pn(t)},hu.Bb=function(){return!1},hu.xb=function(t,e,n,r,i,o,a){if(!t)return X(new An("popup-blocked"));if(a&&!cn())return this.ea().m(function(e){ze(t),i(e)}),r(),Q();this.a||(this.a=Xi(Zi(this)));var s=this;return this.a.then(function(){var e=s.ea().m(function(e){throw ze(t),i(e),e});return r(),e}).then(function(){if(vr(n),!a){Ve($i(s.u,s.f,s.b,e,n,null,o,s.c,void 0,s.h),t)}}).m(function(t){throw"auth/network-request-failed"==t.code&&(s.a=null),t})},hu.Ba=function(t,e,n){this.a||(this.a=Xi(Zi(this)));var r=this;return this.a.then(function(){vr(e),Ve($i(r.u,r.f,r.b,t,e,Be(),n,r.c,void 0,r.h))}).m(function(t){throw"auth/network-request-failed"==t.code&&(r.a=null),t})},hu.ea=function(){var t=this;return Ji(this).then(function(){return t.j.ab}).m(function(){throw t.a=null,new An("network-request-failed")})},hu.Lb=function(){return!0},hu.va=function(t){this.g.push(t)},hu.Ja=function(t){I(this.g,function(e){return e==t})},hu=no.prototype,hu.get=function(t){return Q(this.a.getItem(t)).then(function(t){return t&&fn(t)})},hu.set=function(t,e){return Q(this.a.setItem(t,ln(e)))},hu.P=function(t){return Q(this.a.removeItem(t))},hu.Y=function(){},hu.aa=function(){};var gh;hu=ro.prototype,hu.set=function(t,e){var n,r=!1,i=this;return ao(this).then(function(e){return n=e,e=uo(co(n,!0)),lo(e.get(t))}).then(function(o){var a=uo(co(n,!0));return o?(o.value=e,lo(a.put(o))):(i.b++,r=!0,o={},o.fbase_key=t,o.value=e,lo(a.add(o)))}).then(function(){i.f[t]=e}).ha(function(){r&&i.b--})},hu.get=function(t){return ao(this).then(function(e){return lo(uo(co(e,!1)).get(t))}).then(function(t){return t&&t.value})},hu.P=function(t){var e=!1,n=this;return ao(this).then(function(r){return e=!0,n.b++,lo(uo(co(r,!0)).delete(t))}).then(function(){delete n.f[t]}).ha(function(){e&&n.b--})},hu.Jc=function(){var t=this;return ao(this).then(function(t){var e=uo(co(t,!1));return e.getAll?lo(e.getAll()):new q(function(t,n){var r=[],i=e.openCursor();i.onsuccess=function(e){(e=e.target.result)?(r.push(e.value),e.continue()):t(r)},i.onerror=function(t){n(Error(t.target.errorCode))}})}).then(function(e){var n={},r=[];if(0==t.b){for(r=0;r<e.length;r++)n[e[r].fbase_key]=e[r].value;r=je(t.f,n),t.f=n}return r})},hu.Y=function(t){0==this.a.length&&ho(this),this.a.push(t)},hu.aa=function(t){I(this.a,function(e){return e==t}),0==this.a.length&&this.c&&this.c.cancel("STOP_EVENT")},hu=fo.prototype,hu.get=function(t){return this.b.then(function(e){return e.get(t)})},hu.set=function(t,e){return this.b.then(function(n){return n.set(t,e)})},hu.P=function(t){return this.b.then(function(e){return e.P(t)})},hu.Y=function(t){this.a.push(t)},hu.aa=function(t){I(this.a,function(e){return e==t})},hu=po.prototype,hu.get=function(t){return Q(this.a[t])},hu.set=function(t,e){return this.a[t]=e,Q()},hu.P=function(t){return delete this.a[t],Q()},hu.Y=function(){},hu.aa=function(){},hu=mo.prototype,hu.get=function(t){var e=this;return Q().then(function(){return fn(e.a.getItem(t))})},hu.set=function(t,e){var n=this;return Q().then(function(){var r=ln(e);null===r?n.P(t):n.a.setItem(t,r)})},hu.P=function(t){var e=this;return Q().then(function(){e.a.removeItem(t)})},hu.Y=function(t){pu.window&&St(pu.window,"storage",t)},hu.aa=function(t){pu.window&&It(pu.window,"storage",t)},hu=yo.prototype,hu.get=function(){return Q(null)},hu.set=function(){return Q()},hu.P=function(){return Q()},hu.Y=function(){},hu.aa=function(){},hu=_o.prototype,hu.get=function(t){var e=this;return Q().then(function(){return fn(e.a.getItem(t))})},hu.set=function(t,e){var n=this;return Q().then(function(){var r=ln(e);null===r?n.P(t):n.a.setItem(t,r)})},hu.P=function(t){var e=this;return Q().then(function(){e.a.removeItem(t)})},hu.Y=function(){},hu.aa=function(){};var vh,yh,_h={w:mo,Pa:_o},bh={w:mo,Pa:_o},wh={w:no,Pa:yo},Eh={w:mo,Pa:yo},xh={Vc:"local",NONE:"none",Xc:"session"};hu=To.prototype,hu.get=function(t,e){return Co(this,t.w).get(Mo(t,e))},hu.set=function(t,e,n){var r=Mo(t,n),i=this,o=Co(this,t.w);return o.set(r,e).then(function(){return o.get(r)}).then(function(e){"local"==t.w&&(i.b[r]=e)})},hu.addListener=function(t,e,n){t=Mo(t,e),this.l&&(this.b[t]=pu.localStorage.getItem(t)),F(this.a)&&(Co(this,"local").Y(this.f),this.h||(Fe()||!bn())&&pu.indexedDB||!this.l||Ro(this)),this.a[t]||(this.a[t]=[]),this.a[t].push(n)},hu.removeListener=function(t,e,n){t=Mo(t,e),this.a[t]&&(I(this.a[t],function(t){return t==n}),0==this.a[t].length&&delete this.a[t]),F(this.a)&&(Co(this,"local").aa(this.f),Po(this))},hu.Kb=function(t){if(t&&t.f){var e=t.a.key;if(null==e)for(var n in this.a){var r=this.b[n];"undefined"===typeof r&&(r=null);var i=pu.localStorage.getItem(n);i!==r&&(this.b[n]=i,this.Va(n))}else if(0==e.indexOf("firebase:")&&this.a[e]){if("undefined"!==typeof t.a.a?Co(this,"local").aa(this.f):Po(this),this.o)if(n=pu.localStorage.getItem(e),(r=t.a.newValue)!==n)null!==r?pu.localStorage.setItem(e,r):pu.localStorage.removeItem(e);else if(this.b[e]===r&&"undefined"===typeof t.a.a)return;var o=this;n=function(){"undefined"===typeof t.a.a&&o.b[e]===pu.localStorage.getItem(e)||(o.b[e]=pu.localStorage.getItem(e),o.Va(e))},Ku&&nc&&10==nc&&pu.localStorage.getItem(e)!==t.a.newValue&&t.a.newValue!==t.a.oldValue?setTimeout(n,10):n()}}else wu(t,f(this.Va,this))},hu.Va=function(t){this.a[t]&&wu(this.a[t],function(t){t()})};var Th,Sh={name:"authEvent",w:"local"};p(Lo,ko);for(var Ch=64,Mh=Ch-1,Ah=[],Ih=0;Ih<Mh;Ih++)Ah[Ih]=0;var Rh=R(128,Ah);Lo.prototype.reset=function(){this.g=this.c=0,this.a=pu.Int32Array?new Int32Array(this.h):P(this.h)};var Ph=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];p(Bo,Lo);var Nh=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225];hu=Vo.prototype,hu.ea=function(){return this.ya?this.ya:this.ya=Ke().then(function(){if("function"!==typeof rn("universalLinks.subscribe",pu))throw jo("cordova-universal-links-plugin is not installed");if("undefined"===typeof rn("BuildInfo.packageName",pu))throw jo("cordova-plugin-buildinfo is not installed");if("function"!==typeof rn("cordova.plugins.browsertab.openUrl",pu))throw jo("cordova-plugin-browsertab is not installed");if("function"!==typeof rn("cordova.InAppBrowser.open",pu))throw jo("cordova-plugin-inappbrowser is not installed")},function(){throw new An("cordova-not-ready")})},hu.Da=function(t,e){return e(new An("operation-not-supported-in-this-environment")),Q()},hu.xb=function(){return X(new An("operation-not-supported-in-this-environment"))},hu.Lb=function(){return!1},hu.Gb=function(){return!0},hu.Bb=function(){return!0},hu.Ba=function(t,e,n){if(this.c)return X(new An("redirect-operation-pending"));var r=this,i=pu.document,o=null,a=null,s=null,u=null;return this.c=Q().then(function(){return vr(e),qo(r)}).then(function(){return zo(r,t,e,n)}).then(function(){return new q(function(t,e){a=function(){var e=rn("cordova.plugins.browsertab.close",pu);return t(),"function"===typeof e&&e(),r.a&&"function"===typeof r.a.close&&(r.a.close(),r.a=null),!1},r.va(a),s=function(){o||(o=Ht(2e3).then(function(){e(new An("redirect-cancelled-by-user"))}))},u=function(){vn()&&s()},i.addEventListener("resume",s,!1),nn().toLowerCase().match(/android/)||i.addEventListener("visibilitychange",u,!1)}).m(function(t){return Yo(r).then(function(){throw t})})}).ha(function(){s&&i.removeEventListener("resume",s,!1),u&&i.removeEventListener("visibilitychange",u,!1),o&&o.cancel(),a&&r.Ja(a),r.c=null})},hu.va=function(t){this.b.push(t),qo(this).m(function(e){"auth/invalid-cordova-configuration"===e.code&&(e=new yr("unknown",null,null,null,new An("no-auth-event")),t(e))})},hu.Ja=function(t){I(this.b,function(e){return e==t})};var Dh={name:"pendingRedirect",w:"session"};$o.prototype.reset=function(){this.f=!1,this.a.Ja(this.j),this.a=ta(this.v,this.l,this.u)},$o.prototype.subscribe=function(t){if(M(this.h,t)||this.h.push(t),!this.f){var e=this;Zo(this.g).then(function(t){t?Jo(e.g).then(function(){ea(e).m(function(t){var n=new yr("unknown",null,null,null,new An("operation-not-supported-in-this-environment"));ia(t)&&e.o(n)})}):na(e)}).m(function(){na(e)})}},$o.prototype.unsubscribe=function(t){I(this.h,function(e){return e==t})},$o.prototype.o=function(t){if(!t)throw new An("invalid-auth-event");for(var e=!1,n=0;n<this.h.length;n++){var r=this.h[n];if(r.qb(t.b,t.c)){(e=this.b[t.b])&&e.h(t,r),e=!0;break}}return sa(this.c),e};var Oh=new gn(2e3,1e4),kh=new gn(3e4,6e4);$o.prototype.da=function(){return this.c.da()},$o.prototype.Ba=function(t,e,n){var r,i=this;return Xo(this.g).then(function(){return i.a.Ba(t,e,n).m(function(t){if(ia(t))throw new An("operation-not-supported-in-this-environment");return r=t,Jo(i.g).then(function(){throw r})}).then(function(){return i.a.Lb()?new q(function(){}):Jo(i.g).then(function(){return i.da()}).then(function(){}).m(function(){})})})},$o.prototype.Da=function(t,e,n,r){return this.a.Da(n,function(n){t.ga(e,null,n,r)},Oh.get())};var Lh={};aa.prototype.reset=function(){this.b=null,this.a&&(this.a.cancel(),this.a=null)},aa.prototype.h=function(t,e){if(t){this.reset(),this.g=!0;var n=t.b,r=t.c,i=t.a&&"auth/web-storage-unsupported"==t.a.code,o=t.a&&"auth/operation-not-supported-in-this-environment"==t.a.code;"unknown"!=n||i||o?t.a?(ha(this,!0,null,t.a),Q()):e.wa(n,r)?ua(this,t,e):X(new An("invalid-auth-event")):(ha(this,!1,null,null),Q())}else X(new An("invalid-auth-event"))},aa.prototype.da=function(){var t=this;return new q(function(e,n){t.b?t.b().then(e,n):(t.f.push(e),t.c.push(n),fa(t))})},da.prototype.h=function(t,e){if(t){var n=t.b,r=t.c;t.a?(e.ga(t.b,null,t.a,t.c),Q()):e.wa(n,r)?pa(t,e):X(new An("invalid-auth-event"))}else X(new An("invalid-auth-event"))},ma.prototype.confirm=function(t){return t=mr(this.verificationId,t),this.a(t)},ya.prototype.start=function(){this.a=this.c,ba(this,!0)},ya.prototype.stop=function(){this.b&&(this.b.cancel(),this.b=null)},wa.prototype.C=function(){return{apiKey:this.f.b,refreshToken:this.a,accessToken:this.b,expirationTime:this.c}},wa.prototype.getToken=function(t){return t=!!t,this.b&&!this.a?X(new An("user-token-expired")):t||!this.b||vu()>this.c-3e4?this.a?Ta(this,{grant_type:"refresh_token",refresh_token:this.a}):Q(null):Q({accessToken:this.b,expirationTime:this.c,refreshToken:this.a})},Sa.prototype.C=function(){return{lastLoginAt:this.b,createdAt:this.a}},p(Aa,yt),p(Ia,Ut),Ia.prototype.na=function(t){this.ia=t,gi(this.b,t)},Ia.prototype.ca=function(){return this.ia},Ia.prototype.Ka=function(){return P(this.O)},Ia.prototype.Ga=function(){this.l.b&&(this.l.stop(),this.l.start())},wn(Ia.prototype,"providerId","firebase"),hu=Ia.prototype,hu.reload=function(){var t=this;return os(this,Ga(this).then(function(){return Qa(t).then(function(){return Ba(t)}).then(Ha)}))},hu.ac=function(t){return this.F(t).then(function(t){return new va(t)})},hu.F=function(t){var e=this;return os(this,Ga(this).then(function(){return e.h.getToken(t)}).then(function(t){if(!t)throw new An("internal-error");return t.accessToken!=e.qa&&(Ua(e,t.accessToken),e.dispatchEvent(new Aa("tokenChanged"))),Ya(e,"refreshToken",t.refreshToken),t.accessToken}))},hu.getToken=function(t){return Fc["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]||(Fc["firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead."]=!0,"undefined"!==typeof console&&"function"===typeof console.warn&&console.warn("firebase.User.prototype.getToken is deprecated. Please use firebase.User.prototype.getIdToken instead.")),this.F(t)},hu.uc=function(t){if(!(t=t.users)||!t.length)throw new An("internal-error");t=t[0],ja(this,{uid:t.localId,displayName:t.displayName,photoURL:t.photoUrl,email:t.email,emailVerified:!!t.emailVerified,phoneNumber:t.phoneNumber,lastLoginAt:t.lastLoginAt,createdAt:t.createdAt});for(var e=Za(t),n=0;n<e.length;n++)Wa(this,e[n]);Ya(this,"isAnonymous",!(this.email&&t.passwordHash)&&!(this.providerData&&this.providerData.length))},hu.bb=function(t){var e=this,n=null;return os(this,t.f(this.b,this.uid).then(function(t){return Xa(e,t),n=ts(e,t,"reauthenticate"),e.j=null,e.reload()}).then(function(){return n}),!0)},hu.vc=function(t){return this.bb(t).then(function(){})},hu.$a=function(t){var e=this,n=null;return os(this,$a(this,t.providerId).then(function(){return e.F()}).then(function(n){return t.c(e.b,n)}).then(function(t){return n=ts(e,t,"link"),es(e,t)}).then(function(){return n}))},hu.mc=function(t){return this.$a(t).then(function(t){return t.user})},hu.nc=function(t,e){var n=this;return os(this,$a(this,"phone").then(function(){return ga(Da(n),t,e,f(n.$a,n))}))},hu.wc=function(t,e){var n=this;return os(this,Q().then(function(){return ga(Da(n),t,e,f(n.bb,n))}),!0)},hu.mb=function(t){var e=this;return os(this,this.F().then(function(n){return e.b.mb(n,t)}).then(function(t){return Xa(e,t),e.reload()}))},hu.Nc=function(t){var e=this;return os(this,this.F().then(function(n){return t.c(e.b,n)}).then(function(t){return Xa(e,t),e.reload()}))},hu.nb=function(t){var e=this;return os(this,this.F().then(function(n){return e.b.nb(n,t)}).then(function(t){return Xa(e,t),e.reload()}))},hu.ob=function(t){if(void 0===t.displayName&&void 0===t.photoURL)return Ga(this);var e=this;return os(this,this.F().then(function(n){return e.b.ob(n,{displayName:t.displayName,photoUrl:t.photoURL})}).then(function(t){return Xa(e,t),Ya(e,"displayName",t.displayName||null),Ya(e,"photoURL",t.photoUrl||null),wu(e.providerData,function(t){"password"===t.providerId&&(wn(t,"displayName",e.displayName),wn(t,"photoURL",e.photoURL))}),Ba(e)}).then(Ha))},hu.Mc=function(t){var e=this;return os(this,Qa(this).then(function(n){return M(za(e),t)?Ri(e.b,n,[t]).then(function(t){var n={};return wu(t.providerUserInfo||[],function(t){n[t.providerId]=!0}),wu(za(e),function(t){n[t]||qa(e,t)}),n[pr.PROVIDER_ID]||wn(e,"phoneNumber",null),Ba(e)}):Ba(e).then(function(){throw new An("no-such-provider")})}))},hu.delete=function(){var t=this;return os(this,this.F().then(function(e){return Ui(t.b,Hl,{idToken:e})}).then(function(){t.dispatchEvent(new Aa("userDeleted"))})).then(function(){for(var e=0;e<t.D.length;e++)t.D[e].cancel("app-deleted");Ra(t,null),Na(t,null),t.D=[],t.o=!0,La(t),wn(t,"refreshToken",null),t.a&&t.a.unsubscribe(t)})},hu.qb=function(t,e){return!!("linkViaPopup"==t&&(this.g||null)==e&&this.f||"reauthViaPopup"==t&&(this.g||null)==e&&this.f||"linkViaRedirect"==t&&(this.$||null)==e||"reauthViaRedirect"==t&&(this.$||null)==e)},hu.ga=function(t,e,n,r){"linkViaPopup"!=t&&"reauthViaPopup"!=t||r!=(this.g||null)||(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},hu.wa=function(t,e){return"linkViaPopup"==t&&e==(this.g||null)?f(this.vb,this):"reauthViaPopup"==t&&e==(this.g||null)?f(this.wb,this):"linkViaRedirect"==t&&(this.$||null)==e?f(this.vb,this):"reauthViaRedirect"==t&&(this.$||null)==e?f(this.wb,this):null},hu.oc=function(t){var e=this;return ns(this,"linkViaPopup",t,function(){return $a(e,t.providerId).then(function(){return Ba(e)})},!1)},hu.xc=function(t){return ns(this,"reauthViaPopup",t,function(){return Q()},!0)},hu.pc=function(t){var e=this;return rs(this,"linkViaRedirect",t,function(){return $a(e,t.providerId)},!1)},hu.yc=function(t){return rs(this,"reauthViaRedirect",t,function(){return Q()},!0)},hu.vb=function(t,e){var n=this;this.c&&(this.c.cancel(),this.c=null);var r=null;return os(this,this.F().then(function(r){return Oi(n.b,{requestUri:t,sessionId:e,idToken:r})}).then(function(t){return r=ts(n,t,"link"),es(n,t)}).then(function(){return r}))},hu.wb=function(t,e){var n=this;this.c&&(this.c.cancel(),this.c=null);var r=null;return os(this,Q().then(function(){return Qn(ki(n.b,{requestUri:t,sessionId:e}),n.uid)}).then(function(t){return r=ts(n,t,"reauthenticate"),Xa(n,t),n.j=null,n.reload()}).then(function(){return r}),!0)},hu.fb=function(t){var e=this,n=null;return os(this,this.F().then(function(e){return n=e,"undefined"===typeof t||F(t)?{}:Pn(new Rn(t))}).then(function(t){return e.b.fb(n,t)}).then(function(t){if(e.email!=t)return e.reload()}).then(function(){}))},hu.toJSON=function(){return this.C()},hu.C=function(){var t={uid:this.uid,displayName:this.displayName,photoURL:this.photoURL,email:this.email,emailVerified:this.emailVerified,phoneNumber:this.phoneNumber,isAnonymous:this.isAnonymous,providerData:[],apiKey:this.G,appName:this.s,authDomain:this.B,stsTokenManager:this.h.C(),redirectEventId:this.$||null};return this.metadata&&V(t,this.metadata.C()),wu(this.providerData,function(e){t.providerData.push(Tn(e))}),t};var Uh={name:"redirectUser",w:"session"};fs.prototype.g=function(){var t=this,e=ms("local");bs(this,function(){return Q().then(function(){return t.c&&"local"!=t.c.w?t.b.get(e,t.a):null}).then(function(n){if(n)return ds(t,"local").then(function(){t.c=e})})})};var Fh={name:"persistence",w:"session"};fs.prototype.ib=function(t){var e=null,n=this;return xo(t),bs(this,function(){return t!=n.c.w?n.b.get(n.c,n.a).then(function(r){return e=r,ds(n,t)}).then(function(){if(n.c=ms(t),e)return n.b.set(n.c,e,n.a)}):Q()})},p(ws,Ut),p(Es,yt),p(xs,yt),hu=ws.prototype,hu.ib=function(t){return t=this.h.ib(t),Fs(this,t)},hu.na=function(t){this.W===t||this.l||(this.W=t,gi(this.b,this.W),this.dispatchEvent(new Es(this.ca())))},hu.ca=function(){return this.W},hu.Oc=function(){var t=pu.navigator;this.na(t?t.languages&&t.languages[0]||t.language||t.userLanguage||null:null)},hu.qc=function(t){this.D.push(t),vi(this.b,fu.SDK_VERSION?en(fu.SDK_VERSION,this.D):null),this.dispatchEvent(new xs(this.D))},hu.Ka=function(){return P(this.D)},hu.toJSON=function(){return{apiKey:Ds(this).options.apiKey,authDomain:Ds(this).options.authDomain,appName:Ds(this).name,currentUser:Os(this)&&Os(this).C()}},hu.qb=function(t,e){switch(t){case"unknown":case"signInViaRedirect":return!0;case"signInViaPopup":return this.g==e&&!!this.f;default:return!1}},hu.ga=function(t,e,n,r){"signInViaPopup"==t&&this.g==r&&(n&&this.v?this.v(n):e&&!n&&this.f&&this.f(e),this.c&&(this.c.cancel(),this.c=null),delete this.f,delete this.v)},hu.wa=function(t,e){return"signInViaRedirect"==t||"signInViaPopup"==t&&this.g==e&&this.f?f(this.Xb,this):null},hu.Xb=function(t,e){var n=this;t={requestUri:t,sessionId:e},this.c&&(this.c.cancel(),this.c=null);var r=null,i=null,o=Di(n.b,t).then(function(t){return r=gr(t),i=Vn(t),t});return t=n.V.then(function(){return o}).then(function(t){return Ms(n,t)}).then(function(){return xn({user:Os(n),credential:r,additionalUserInfo:i,operationType:"signIn"})}),Fs(this,t)},hu.Gc=function(t){if(!an())return X(new An("operation-not-supported-in-this-environment"));var e=this,n=Bn(t.providerId),r=dn(),i=null;(!cn()||Xe())&&Ds(this).options.authDomain&&t.isOAuthProvider&&(i=$i(Ds(this).options.authDomain,Ds(this).options.apiKey,Ds(this).name,"signInViaPopup",t,null,r,fu.SDK_VERSION||null));var o=We(i,n&&n.Aa,n&&n.za);return n=Ss(this).then(function(e){return ra(e,o,"signInViaPopup",t,r,!!i)}).then(function(){return new q(function(t,n){e.ga("signInViaPopup",null,new An("cancelled-popup-request"),e.g),e.f=t,e.v=n,e.g=r,e.c=e.a.Da(e,"signInViaPopup",o,r)})}).then(function(t){return o&&ze(o),t?xn(t):null}).m(function(t){throw o&&ze(o),t}),Fs(this,n)},hu.Hc=function(t){if(!an())return X(new An("operation-not-supported-in-this-environment"));var e=this;return Fs(this,Ss(this).then(function(){return gs(e.h)}).then(function(){return e.a.Ba("signInViaRedirect",t)}))},hu.da=function(){if(!an())return X(new An("operation-not-supported-in-this-environment"));var t=this;return Fs(this,Ss(this).then(function(){return t.a.da()}).then(function(t){return t?xn(t):null}))},hu.kb=function(){var t=this;return Fs(this,this.j.then(function(){return Os(t)?(As(t,null),ys(t.h).then(function(){Ls(t)})):Q()}))},hu.Ic=function(){var t=this;return _s(this.h,Ds(this).options.authDomain).then(function(e){if(!t.l){var n;if(n=Os(t)&&e){n=Os(t).uid;var r=e.uid;n=void 0!==n&&null!==n&&""!==n&&void 0!==r&&null!==r&&""!==r&&n==r}if(n)return Ka(Os(t),e),Os(t).F();(Os(t)||e)&&(As(t,e),e&&(Va(e),e.fa=t.G),t.a&&t.a.subscribe(t),Ls(t))}})},hu.ka=function(t){return vs(this.h,t)},hu.Yb=function(){Ls(this),this.ka(Os(this))},hu.gc=function(){this.kb()},hu.hc=function(){this.kb()},hu.ic=function(t){var e=this;this.addAuthTokenListener(function(){t.next(Os(e))})},hu.jc=function(t){var e=this;Us(this,function(){t.next(Os(e))})},hu.sc=function(t,e,n){var r=this;return this.X&&fu.Promise.resolve().then(function(){u(t)?t(Os(r)):u(t.next)&&t.next(Os(r))}),this.Ob(t,e,n)},hu.rc=function(t,e,n){var r=this;return this.X&&fu.Promise.resolve().then(function(){r.O=r.getUid(),u(t)?t(Os(r)):u(t.next)&&t.next(Os(r))}),this.Pb(t,e,n)},hu.$b=function(t){var e=this;return Fs(this,this.j.then(function(){return Os(e)?Os(e).F(t).then(function(t){return{accessToken:t}}):null}))},hu.Cc=function(t){return this.Hb(t).then(function(t){return t.user})},hu.Hb=function(t){var e=this;return this.j.then(function(){return Ns(e,Ui(e.b,ah,{token:t}))}).then(function(t){var n=t.user;return Ya(n,"isAnonymous",!1),e.ka(n),t})},hu.Ib=function(t,e){var n=this;return this.j.then(function(){return Ns(n,Ui(n.b,sh,{email:t,password:e}))})},hu.Dc=function(t,e){return this.Ib(t,e).then(function(t){return t.user})},hu.Sb=function(t,e){return this.sb(t,e).then(function(t){return t.user})},hu.sb=function(t,e){var n=this;return this.j.then(function(){return Ns(n,Ui(n.b,Vl,{email:t,password:e}))})},hu.Bc=function(t){return this.Oa(t).then(function(t){return t.user})},hu.Oa=function(t){var e=this;return this.j.then(function(){return Ns(e,t.xa(e.b))})},hu.jb=function(){return this.Jb().then(function(t){return t.user})},hu.Jb=function(){var t=this;return this.j.then(function(){var e=Os(t);if(e&&e.isAnonymous){return xn({user:e,credential:null,additionalUserInfo:xn({providerId:null,isNewUser:!1}),operationType:"signIn"})}return Ns(t,t.b.jb()).then(function(e){var n=e.user;return Ya(n,"isAnonymous",!0),t.ka(n),e})})},hu.getUid=function(){return Os(this)&&Os(this).uid||null},hu.Qb=function(t){this.addAuthTokenListener(t),0<++this.s&&Os(this)&&ka(Os(this))},hu.zc=function(t){var e=this;wu(this.o,function(n){n==t&&e.s--}),0>this.s&&(this.s=0),0==this.s&&Os(this)&&La(Os(this)),this.removeAuthTokenListener(t)},hu.addAuthTokenListener=function(t){var e=this;this.o.push(t),Fs(this,this.j.then(function(){e.l||M(e.o,t)&&t(ks(e))}))},hu.removeAuthTokenListener=function(t){I(this.o,function(e){return e==t})},hu.delete=function(){this.l=!0;for(var t=0;t<this.N.length;t++)this.N[t].cancel("app-deleted");return this.N=[],this.h&&(t=this.h,t.b.removeListener(ms("local"),t.a,this.ia)),this.a&&this.a.unsubscribe(this),fu.Promise.resolve()},hu.Vb=function(t){return Fs(this,Ti(this.b,t))},hu.Wb=function(t){return Fs(this,Si(this.b,t))},hu.kc=function(t){return!!hr(t)},hu.hb=function(t,e){var n=this;return Fs(this,Q().then(function(){var t=new Rn(e);if(!t.c)throw new An("argument-error",Jc+" must be true when sending sign in link to email");return Pn(t)}).then(function(e){return n.b.hb(t,e)}).then(function(){}))},hu.Pc=function(t){return this.Ia(t).then(function(t){return t.data.email})},hu.Wa=function(t,e){return Fs(this,this.b.Wa(t,e).then(function(){}))},hu.Ia=function(t){return Fs(this,this.b.Ia(t).then(function(t){return new Mn(t)}))},hu.Ua=function(t){return Fs(this,this.b.Ua(t).then(function(){}))},hu.gb=function(t,e){var n=this;return Fs(this,Q().then(function(){return"undefined"===typeof e||F(e)?{}:Pn(new Rn(e))}).then(function(e){return n.b.gb(t,e)}).then(function(){}))},hu.Fc=function(t,e){return Fs(this,ga(this,t,e,f(this.Oa,this)))},hu.Ec=function(t,e){var n=this;return Fs(this,Q().then(function(){var r=lr(t,e||Be());return n.Oa(r)}))};var Bh="callback",Vh="expired-callback",jh="sitekey",Hh="size";hu=Bs.prototype,hu.ya=function(){var t=this;return this.c?this.c:this.c=Hs(this,Q().then(function(){if(sn()&&!Je())return Ye();throw new An("operation-not-supported-in-this-environment","RecaptchaVerifier is only supported in a browser HTTP/HTTPS environment.")}).then(function(){return Ws(qs(),t.s())}).then(function(){return Ui(t.u,Jl,{})}).then(function(e){t.a[jh]=e.recaptchaSiteKey}).m(function(e){throw t.c=null,e}))},hu.render=function(){Gs(this);var t=this;return Hs(this,this.ya().then(function(){if(null===t.b){var e=t.l;if(!t.h){var n=Ie(e);e=Pe("DIV"),n.appendChild(e)}t.b=grecaptcha.render(e,t.a)}return t.b}))},hu.verify=function(){Gs(this);var t=this;return Hs(this,this.render().then(function(e){return new q(function(n){var r=grecaptcha.getResponse(e);if(r)n(r);else{var i=function(e){e&&(js(t,i),n(e))};t.j.push(i),t.h&&grecaptcha.execute(t.b)}})}))},hu.reset=function(){Gs(this),null!==this.b&&grecaptcha.reset(this.b)},hu.clear=function(){Gs(this),this.o=!0,qs().b--;for(var t=0;t<this.g.length;t++)this.g[t].cancel("RecaptchaVerifier instance has been destroyed.");if(!this.h){t=Ie(this.l);for(var e;e=t.firstChild;)t.removeChild(e)}};var Gh=ve("https://www.google.com/recaptcha/api.js?onload=%{onload}&render=explicit&hl=%{hl}"),zh=new gn(3e4,6e4),Wh=null;p(Ys,Bs);var qh="First Second Third Fourth Fifth Sixth Seventh Eighth Ninth".split(" ");su(ws.prototype,{Ua:{name:"applyActionCode",i:[Qs("code")]},Ia:{name:"checkActionCode",i:[Qs("code")]},Wa:{name:"confirmPasswordReset",i:[Qs("code"),Qs("newPassword")]},Sb:{name:"createUserWithEmailAndPassword",i:[Qs("email"),Qs("password")]},sb:{name:"createUserAndRetrieveDataWithEmailAndPassword",i:[Qs("email"),Qs("password")]},Vb:{name:"fetchProvidersForEmail",i:[Qs("email")]},Wb:{name:"fetchSignInMethodsForEmail",i:[Qs("email")]},da:{name:"getRedirectResult",i:[]},kc:{name:"isSignInWithEmailLink",i:[Qs("emailLink")]},rc:{name:"onAuthStateChanged",i:[au(Js(),Zs(),"nextOrObserver"),Zs("opt_error",!0),Zs("opt_completed",!0)]},sc:{name:"onIdTokenChanged",i:[au(Js(),Zs(),"nextOrObserver"),Zs("opt_error",!0),Zs("opt_completed",!0)]},gb:{name:"sendPasswordResetEmail",i:[Qs("email"),au(Js("opt_actionCodeSettings",!0),$s(null,!0),"opt_actionCodeSettings",!0)]},hb:{name:"sendSignInLinkToEmail",i:[Qs("email"),Js("actionCodeSettings")]},ib:{name:"setPersistence",i:[Qs("persistence")]},Oa:{name:"signInAndRetrieveDataWithCredential",i:[ru()]},jb:{name:"signInAnonymously",i:[]},Jb:{name:"signInAnonymouslyAndRetrieveData",i:[]},Bc:{name:"signInWithCredential",i:[ru()]},Cc:{name:"signInWithCustomToken",i:[Qs("token")]},Hb:{name:"signInAndRetrieveDataWithCustomToken",i:[Qs("token")]},Dc:{name:"signInWithEmailAndPassword",i:[Qs("email"),Qs("password")]},Ec:{name:"signInWithEmailLink",i:[Qs("email"),Qs("emailLink",!0)]},Ib:{name:"signInAndRetrieveDataWithEmailAndPassword",i:[Qs("email"),Qs("password")]},Fc:{name:"signInWithPhoneNumber",i:[Qs("phoneNumber"),ou()]},Gc:{name:"signInWithPopup",i:[iu()]},Hc:{name:"signInWithRedirect",i:[iu()]},kb:{name:"signOut",i:[]},toJSON:{name:"toJSON",i:[Qs(null,!0)]},Oc:{name:"useDeviceLanguage",i:[]},Pc:{name:"verifyPasswordResetCode",i:[Qs("code")]}}),function(t,e){for(var n in e){var r=e[n].name;if(r!==n){var i=e[n].Rb;Object.defineProperty(t,r,{get:function(){return this[n]},set:function(t){Ks(r,[i],[t],!0),this[n]=t},enumerable:!0})}}}(ws.prototype,{lc:{name:"languageCode",Rb:au(Qs(),$s(),"languageCode")}}),ws.Persistence=xh,ws.Persistence.LOCAL="local",ws.Persistence.SESSION="session",ws.Persistence.NONE="none",su(Ia.prototype,{delete:{name:"delete",i:[]},ac:{name:"getIdTokenResult",i:[Xs()]},F:{name:"getIdToken",i:[Xs()]},getToken:{name:"getToken",i:[Xs()]},$a:{name:"linkAndRetrieveDataWithCredential",i:[ru()]},mc:{name:"linkWithCredential",i:[ru()]},nc:{name:"linkWithPhoneNumber",i:[Qs("phoneNumber"),ou()]},oc:{name:"linkWithPopup",i:[iu()]},pc:{name:"linkWithRedirect",i:[iu()]},bb:{name:"reauthenticateAndRetrieveDataWithCredential",i:[ru()]},vc:{name:"reauthenticateWithCredential",i:[ru()]},wc:{name:"reauthenticateWithPhoneNumber",i:[Qs("phoneNumber"),ou()]},xc:{name:"reauthenticateWithPopup",i:[iu()]},yc:{name:"reauthenticateWithRedirect",i:[iu()]},reload:{name:"reload",i:[]},fb:{name:"sendEmailVerification",i:[au(Js("opt_actionCodeSettings",!0),$s(null,!0),"opt_actionCodeSettings",!0)]},toJSON:{name:"toJSON",i:[Qs(null,!0)]},Mc:{name:"unlink",i:[Qs("provider")]},mb:{name:"updateEmail",i:[Qs("email")]},nb:{name:"updatePassword",i:[Qs("password")]},Nc:{name:"updatePhoneNumber",i:[ru("phone")]},ob:{name:"updateProfile",i:[Js("profile")]}}),su(q.prototype,{ha:{name:"finally"},m:{name:"catch"},then:{name:"then"}}),su(ma.prototype,{confirm:{name:"confirm",i:[Qs("verificationCode")]}}),uu(cr,"credential",function(t,e){return new ur(t,e)},[Qs("email"),Qs("password")]),su(tr.prototype,{ta:{name:"addScope",i:[Qs("scope")]},Ca:{name:"setCustomParameters",i:[Js("customOAuthParameters")]}}),uu(tr,"credential",er,[au(Qs(),Js(),"token")]),uu(cr,"credentialWithLink",lr,[Qs("email"),Qs("emailLink")]),su(nr.prototype,{ta:{name:"addScope",i:[Qs("scope")]},Ca:{name:"setCustomParameters",i:[Js("customOAuthParameters")]}}),uu(nr,"credential",rr,[au(Qs(),Js(),"token")]),su(ir.prototype,{ta:{name:"addScope",i:[Qs("scope")]},Ca:{name:"setCustomParameters",i:[Js("customOAuthParameters")]}}),uu(ir,"credential",or,[au(Qs(),au(Js(),$s()),"idToken"),au(Qs(),$s(),"accessToken",!0)]),su(ar.prototype,{Ca:{name:"setCustomParameters",i:[Js("customOAuthParameters")]}}),uu(ar,"credential",sr,[au(Qs(),Js(),"token"),Qs("secret",!0)]),su($n.prototype,{ta:{name:"addScope",i:[Qs("scope")]},credential:{name:"credential",i:[au(Qs(),$s(),"idToken",!0),au(Qs(),$s(),"accessToken",!0)]},Ca:{name:"setCustomParameters",i:[Js("customOAuthParameters")]}}),uu(pr,"credential",mr,[Qs("verificationId"),Qs("verificationCode")]),su(pr.prototype,{Sa:{name:"verifyPhoneNumber",i:[Qs("phoneNumber"),ou()]}}),su(An.prototype,{toJSON:{name:"toJSON",i:[Qs(null,!0)]}}),su(Er.prototype,{toJSON:{name:"toJSON",i:[Qs(null,!0)]}}),su(wr.prototype,{toJSON:{name:"toJSON",i:[Qs(null,!0)]}}),su(Ys.prototype,{clear:{name:"clear",i:[]},render:{name:"render",i:[]},verify:{name:"verify",i:[]}}),function(){if("undefined"===typeof fu||!fu.INTERNAL||!fu.INTERNAL.registerService)throw Error("Cannot find the firebase namespace; be sure to include firebase-app.js before this library.");var t={Auth:ws,Error:An};uu(t,"EmailAuthProvider",cr,[]),uu(t,"FacebookAuthProvider",tr,[]),uu(t,"GithubAuthProvider",nr,[]),uu(t,"GoogleAuthProvider",ir,[]),uu(t,"TwitterAuthProvider",ar,[]),uu(t,"OAuthProvider",$n,[Qs("providerId")]),uu(t,"PhoneAuthProvider",pr,[eu()]),uu(t,"RecaptchaVerifier",Ys,[au(Qs(),tu(),"recaptchaContainer"),Js("recaptchaParameters",!0),nu()]),fu.INTERNAL.registerService("auth",function(t,e){return t=new ws(t),e({INTERNAL:{getUid:f(t.getUid,t),getToken:f(t.$b,t),addAuthTokenListener:f(t.Qb,t),removeAuthTokenListener:f(t.zc,t)}}),t},t,function(t,e){if("create"===t)try{e.auth()}catch(t){}}),fu.INTERNAL.extendNamespace({User:Ia})}()}).call("undefined"!==typeof t?t:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})}).call(e,n(1))},function(t,e,n){t.exports=n(78)},function(t,e,n){"use strict";(function(r){function i(t){for(var e="",n=t.split("/"),r=0;r<n.length;r++)if(n[r].length>0){var i=n[r];try{i=decodeURIComponent(i.replace(/\+/g," "))}catch(t){}e+="/"+i}return e}function o(t){var e={};t.startsWith("?")&&(t=t.substring(1));for(var n=0,r=t.split("&");n<r.length;n++){var i=r[n];if(0!==i.length){var o=i.split("=");2===o.length?e[decodeURIComponent(o[0])]=decodeURIComponent(o[1]):U("Invalid query segment '"+i+"' in query '"+t+"'")}}return e}function a(t,e){return G(t.name,e.name)}function s(t,e){return G(t,e)}function u(t,e){if(void 0===e&&(e=null),null===t)return Qt.EMPTY_NODE;if("object"===typeof t&&".priority"in t&&(e=t[".priority"]),v.assert(null===e||"string"===typeof e||"number"===typeof e||"object"===typeof e&&".sv"in e,"Invalid priority type found: "+typeof e),"object"===typeof t&&".value"in t&&null!==t[".value"]&&(t=t[".value"]),"object"!==typeof t||".sv"in t){return new Ut(t,u(e))}if(t instanceof Array||!Zt){var n=Qt.EMPTY_NODE,r=t;return v.forEach(r,function(t,e){if(v.contains(r,t)&&"."!==t.substring(0,1)){var i=u(e);!i.isLeafNode()&&i.isEmpty()||(n=n.updateImmediateChild(t,i))}}),n.updatePriority(u(e))}var i=[],o=!1,c=t;if(v.forEach(c,function(t,e){if("string"!==typeof t||"."!==t.substring(0,1)){var n=u(c[t]);n.isEmpty()||(o=o||!n.getPriority().isEmpty(),i.push(new Pt(t,n)))}}),0==i.length)return Qt.EMPTY_NODE;var l=qt(i,a,function(t){return t.name},s);if(o){var h=qt(i,Bt.getCompare());return new Qt(l,u(e),new Kt({".priority":h},{".priority":Bt}))}return new Qt(l,u(e),Kt.Default)}function c(e){var n=e.INTERNAL.registerService("database",function(t,e,n){return Sn.getInstance().databaseFromApp(t,n)},{Reference:bn,Query:ce,Database:Cn,enableLogging:N,INTERNAL:Ln,ServerValue:Wn,TEST_ACCESS:zn},null,!0);v.isNodeSdk()&&(t.exports=n)}Object.defineProperty(e,"__esModule",{value:!0});var l,h,f,d,p,m,g,v=n(8),y=n(14),_=n(3),b=function(t){return t&&"object"===typeof t&&"default"in t?t.default:t}(n(2)),w=function(){function t(t){this.domStorage_=t,this.prefix_="firebase:"}return t.prototype.set=function(t,e){null==e?this.domStorage_.removeItem(this.prefixedName_(t)):this.domStorage_.setItem(this.prefixedName_(t),v.stringify(e))},t.prototype.get=function(t){var e=this.domStorage_.getItem(this.prefixedName_(t));return null==e?null:v.jsonEval(e)},t.prototype.remove=function(t){this.domStorage_.removeItem(this.prefixedName_(t))},t.prototype.prefixedName_=function(t){return this.prefix_+t},t.prototype.toString=function(){return this.domStorage_.toString()},t}(),E=function(){function t(){this.cache_={},this.isInMemoryStorage=!0}return t.prototype.set=function(t,e){null==e?delete this.cache_[t]:this.cache_[t]=e},t.prototype.get=function(t){return v.contains(this.cache_,t)?this.cache_[t]:null},t.prototype.remove=function(t){delete this.cache_[t]},t}(),x=function(t){try{if("undefined"!==typeof window&&"undefined"!==typeof window[t]){var e=window[t];return e.setItem("firebase:sentinel","cache"),e.removeItem("firebase:sentinel"),new w(e)}}catch(t){}return new E},T=x("localStorage"),S=x("sessionStorage"),C=new y.Logger("@firebase/database"),M=function(){var t=1;return function(){return t++}}(),A=function(t){var e=v.stringToByteArray(t),n=new v.Sha1;n.update(e);var r=n.digest();return v.base64.encodeByteArray(r)},I=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];for(var n="",r=0;r<t.length;r++)Array.isArray(t[r])||t[r]&&"object"===typeof t[r]&&"number"===typeof t[r].length?n+=I.apply(null,t[r]):"object"===typeof t[r]?n+=v.stringify(t[r]):n+=t[r],n+=" ";return n},R=null,P=!0,N=function(t,e){v.assert(!e||!0===t||!1===t,"Can't turn on custom loggers persistently."),!0===t?(C.logLevel=y.LogLevel.VERBOSE,R=C.log.bind(C),e&&S.set("logging_enabled",!0)):"function"===typeof t?R=t:(R=null,S.remove("logging_enabled"))},D=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];if(!0===P&&(P=!1,null===R&&!0===S.get("logging_enabled")&&N(!0)),R){var n=I.apply(null,t);R(n)}},O=function(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];D.apply(void 0,[t].concat(e))}},k=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE INTERNAL ERROR: "+I.apply(void 0,t);C.error(n)},L=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE FATAL ERROR: "+I.apply(void 0,t);throw C.error(n),new Error(n)},U=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="FIREBASE WARNING: "+I.apply(void 0,t);C.warn(n)},F=function(){"undefined"!==typeof window&&window.location&&window.location.protocol&&-1!==window.location.protocol.indexOf("https:")&&U("Insecure Firebase access from a secure page. Please use https in calls to new Firebase().")},B=function(t){return"number"===typeof t&&(t!=t||t==Number.POSITIVE_INFINITY||t==Number.NEGATIVE_INFINITY)},V=function(t){if(v.isNodeSdk()||"complete"===document.readyState)t();else{var e=!1,n=function(){if(!document.body)return void setTimeout(n,Math.floor(10));e||(e=!0,t())};document.addEventListener?(document.addEventListener("DOMContentLoaded",n,!1),window.addEventListener("load",n,!1)):document.attachEvent&&(document.attachEvent("onreadystatechange",function(){"complete"===document.readyState&&n()}),window.attachEvent("onload",n))}},j="[MIN_NAME]",H="[MAX_NAME]",G=function(t,e){if(t===e)return 0;if(t===j||e===H)return-1;if(e===j||t===H)return 1;var n=tt(t),r=tt(e);return null!==n?null!==r?n-r==0?t.length-e.length:n-r:-1:null!==r?1:t<e?-1:1},z=function(t,e){return t===e?0:t<e?-1:1},W=function(t,e){if(e&&t in e)return e[t];throw new Error("Missing required key ("+t+") in object: "+v.stringify(e))},q=function(t){if("object"!==typeof t||null===t)return v.stringify(t);var e=[];for(var n in t)e.push(n);e.sort();for(var r="{",i=0;i<e.length;i++)0!==i&&(r+=","),r+=v.stringify(e[i]),r+=":",r+=q(t[e[i]]);return r+="}"},Y=function(t,e){var n=t.length;if(n<=e)return[t];for(var r=[],i=0;i<n;i+=e)i+e>n?r.push(t.substring(i,n)):r.push(t.substring(i,i+e));return r},K=function(t,e){if(Array.isArray(t))for(var n=0;n<t.length;++n)e(n,t[n]);else v.forEach(t,function(t,n){return e(n,t)})},Q=function(t){v.assert(!B(t),"Invalid JSON number");var e,n,r,i,o,a,s;for(0===t?(n=0,r=0,e=1/t===-1/0?1:0):(e=t<0,t=Math.abs(t),t>=Math.pow(2,-1022)?(i=Math.min(Math.floor(Math.log(t)/Math.LN2),1023),n=i+1023,r=Math.round(t*Math.pow(2,52-i)-Math.pow(2,52))):(n=0,r=Math.round(t/Math.pow(2,-1074)))),a=[],o=52;o;o-=1)a.push(r%2?1:0),r=Math.floor(r/2);for(o=11;o;o-=1)a.push(n%2?1:0),n=Math.floor(n/2);a.push(e?1:0),a.reverse(),s=a.join("");var u="";for(o=0;o<64;o+=8){var c=parseInt(s.substr(o,8),2).toString(16);1===c.length&&(c="0"+c),u+=c}return u.toLowerCase()},X=function(){return!("object"!==typeof window||!window.chrome||!window.chrome.extension||/^chrome/.test(window.location.href))},J=function(){return"object"===typeof Windows&&"object"===typeof Windows.UI},Z=function(t,e){var n="Unknown Error";"too_big"===t?n="The data requested exceeds the maximum size that can be accessed with a single request.":"permission_denied"==t?n="Client doesn't have permission to access the desired data.":"unavailable"==t&&(n="The service is unavailable");var r=new Error(t+" at "+e.path.toString()+": "+n);return r.code=t.toUpperCase(),r},$=new RegExp("^-?\\d{1,10}$"),tt=function(t){if($.test(t)){var e=Number(t);if(e>=-2147483648&&e<=2147483647)return e}return null},et=function(t){try{t()}catch(t){setTimeout(function(){var e=t.stack||"";throw U("Exception was thrown by user callback.",e),t},Math.floor(0))}},nt=function(){return("object"===typeof window&&window.navigator&&window.navigator.userAgent||"").search(/googlebot|google webmaster tools|bingbot|yahoo! slurp|baiduspider|yandexbot|duckduckbot/i)>=0},rt=function(t,e){var n=setTimeout(t,e);return"object"===typeof n&&n.unref&&n.unref(),n},it=function(){function t(t,e){if(void 0===e){this.pieces_=t.split("/");for(var n=0,r=0;r<this.pieces_.length;r++)this.pieces_[r].length>0&&(this.pieces_[n]=this.pieces_[r],n++);this.pieces_.length=n,this.pieceNum_=0}else this.pieces_=t,this.pieceNum_=e}return Object.defineProperty(t,"Empty",{get:function(){return new t("")},enumerable:!0,configurable:!0}),t.prototype.getFront=function(){return this.pieceNum_>=this.pieces_.length?null:this.pieces_[this.pieceNum_]},t.prototype.getLength=function(){return this.pieces_.length-this.pieceNum_},t.prototype.popFront=function(){var e=this.pieceNum_;return e<this.pieces_.length&&e++,new t(this.pieces_,e)},t.prototype.getBack=function(){return this.pieceNum_<this.pieces_.length?this.pieces_[this.pieces_.length-1]:null},t.prototype.toString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+this.pieces_[e]);return t||"/"},t.prototype.toUrlEncodedString=function(){for(var t="",e=this.pieceNum_;e<this.pieces_.length;e++)""!==this.pieces_[e]&&(t+="/"+encodeURIComponent(String(this.pieces_[e])));return t||"/"},t.prototype.slice=function(t){return void 0===t&&(t=0),this.pieces_.slice(this.pieceNum_+t)},t.prototype.parent=function(){if(this.pieceNum_>=this.pieces_.length)return null;for(var e=[],n=this.pieceNum_;n<this.pieces_.length-1;n++)e.push(this.pieces_[n]);return new t(e,0)},t.prototype.child=function(e){for(var n=[],r=this.pieceNum_;r<this.pieces_.length;r++)n.push(this.pieces_[r]);if(e instanceof t)for(var r=e.pieceNum_;r<e.pieces_.length;r++)n.push(e.pieces_[r]);else for(var i=e.split("/"),r=0;r<i.length;r++)i[r].length>0&&n.push(i[r]);return new t(n,0)},t.prototype.isEmpty=function(){return this.pieceNum_>=this.pieces_.length},t.relativePath=function(e,n){var r=e.getFront(),i=n.getFront();if(null===r)return n;if(r===i)return t.relativePath(e.popFront(),n.popFront());throw new Error("INTERNAL ERROR: innerPath ("+n+") is not within outerPath ("+e+")")},t.comparePaths=function(t,e){for(var n=t.slice(),r=e.slice(),i=0;i<n.length&&i<r.length;i++){var o=G(n[i],r[i]);if(0!==o)return o}return n.length===r.length?0:n.length<r.length?-1:1},t.prototype.equals=function(t){if(this.getLength()!==t.getLength())return!1;for(var e=this.pieceNum_,n=t.pieceNum_;e<=this.pieces_.length;e++,n++)if(this.pieces_[e]!==t.pieces_[n])return!1;return!0},t.prototype.contains=function(t){var e=this.pieceNum_,n=t.pieceNum_;if(this.getLength()>t.getLength())return!1;for(;e<this.pieces_.length;){if(this.pieces_[e]!==t.pieces_[n])return!1;++e,++n}return!0},t}(),ot=function(){function t(t,e){this.errorPrefix_=e,this.parts_=t.slice(),this.byteLength_=Math.max(1,this.parts_.length);for(var n=0;n<this.parts_.length;n++)this.byteLength_+=v.stringLength(this.parts_[n]);this.checkValid_()}return Object.defineProperty(t,"MAX_PATH_DEPTH",{get:function(){return 32},enumerable:!0,configurable:!0}),Object.defineProperty(t,"MAX_PATH_LENGTH_BYTES",{get:function(){return 768},enumerable:!0,configurable:!0}),t.prototype.push=function(t){this.parts_.length>0&&(this.byteLength_+=1),this.parts_.push(t),this.byteLength_+=v.stringLength(t),this.checkValid_()},t.prototype.pop=function(){var t=this.parts_.pop();this.byteLength_-=v.stringLength(t),this.parts_.length>0&&(this.byteLength_-=1)},t.prototype.checkValid_=function(){if(this.byteLength_>t.MAX_PATH_LENGTH_BYTES)throw new Error(this.errorPrefix_+"has a key path longer than "+t.MAX_PATH_LENGTH_BYTES+" bytes ("+this.byteLength_+").");if(this.parts_.length>t.MAX_PATH_DEPTH)throw new Error(this.errorPrefix_+"path specified exceeds the maximum depth that can be written ("+t.MAX_PATH_DEPTH+") or object contains a cycle "+this.toErrorString())},t.prototype.toErrorString=function(){return 0==this.parts_.length?"":"in property '"+this.parts_.join(".")+"'"},t}(),at="long_polling",st=function(){function t(t,e,n,r,i){void 0===i&&(i=""),this.secure=e,this.namespace=n,this.webSocketOnly=r,this.persistenceKey=i,this.host=t.toLowerCase(),this.domain=this.host.substr(this.host.indexOf(".")+1),this.internalHost=T.get("host:"+t)||this.host}return t.prototype.needsQueryParam=function(){return this.host!==this.internalHost||this.isCustomHost()},t.prototype.isCacheableHost=function(){return"s-"===this.internalHost.substr(0,2)},t.prototype.isDemoHost=function(){return"firebaseio-demo.com"===this.domain},t.prototype.isCustomHost=function(){return"firebaseio.com"!==this.domain&&"firebaseio-demo.com"!==this.domain},t.prototype.updateHost=function(t){t!==this.internalHost&&(this.internalHost=t,this.isCacheableHost()&&T.set("host:"+this.host,this.internalHost))},t.prototype.connectionURL=function(t,e){v.assert("string"===typeof t,"typeof type must == string"),v.assert("object"===typeof e,"typeof params must == object");var n;if("websocket"===t)n=(this.secure?"wss://":"ws://")+this.internalHost+"/.ws?";else{if(t!==at)throw new Error("Unknown connection type: "+t);n=(this.secure?"https://":"http://")+this.internalHost+"/.lp?"}this.needsQueryParam()&&(e.ns=this.namespace);var r=[];return v.forEach(e,function(t,e){r.push(t+"="+e)}),n+r.join("&")},t.prototype.toString=function(){var t=this.toURLString();return this.persistenceKey&&(t+="<"+this.persistenceKey+">"),t},t.prototype.toURLString=function(){return(this.secure?"https://":"http://")+this.host},t}(),ut=function(t){var e=ct(t),n=e.subdomain;"firebase"===e.domain&&L(e.host+" is no longer supported. Please use <YOUR FIREBASE>.firebaseio.com instead"),n&&"undefined"!=n||"localhost"===e.domain||L("Cannot parse Firebase url. Please use https://<YOUR FIREBASE>.firebaseio.com"),e.secure||F();var r="ws"===e.scheme||"wss"===e.scheme;return{repoInfo:new st(e.host,e.secure,n,r),path:new it(e.pathString)}},ct=function(t){var e="",n="",r="",a="",s=!0,u="https",c=443;if("string"===typeof t){var l=t.indexOf("//");l>=0&&(u=t.substring(0,l-1),t=t.substring(l+2));var h=t.indexOf("/");-1===h&&(h=t.length);var f=t.indexOf("?");-1===f&&(f=t.length),e=t.substring(0,Math.min(h,f)),h<f&&(a=i(t.substring(h,f)));var d=o(t.substring(Math.min(t.length,f)));l=e.indexOf(":"),l>=0?(s="https"===u||"wss"===u,c=parseInt(e.substring(l+1),10)):l=t.length;var p=e.split(".");3===p.length?(n=p[1],r=p[0].toLowerCase()):2===p.length?n=p[0]:"localhost"===p[0].slice(0,l).toLowerCase()&&(n="localhost"),""===r&&"ns"in d&&(r=d.ns)}return{host:e,port:c,domain:n,subdomain:r,secure:s,scheme:u,pathString:a}},lt=/[\[\].#$\/\u0000-\u001F\u007F]/,ht=/[\[\].#$\u0000-\u001F\u007F]/,ft=function(t){return"string"===typeof t&&0!==t.length&&!lt.test(t)},dt=function(t){return"string"===typeof t&&0!==t.length&&!ht.test(t)},pt=function(t){return t&&(t=t.replace(/^\/*\.info(\/|$)/,"/")),dt(t)},mt=function(t){return null===t||"string"===typeof t||"number"===typeof t&&!B(t)||t&&"object"===typeof t&&v.contains(t,".sv")},gt=function(t,e,n,r,i){i&&void 0===n||vt(v.errorPrefix(t,e,i),n,r)},vt=function(t,e,n){var r=n instanceof it?new ot(n,t):n;if(void 0===e)throw new Error(t+"contains undefined "+r.toErrorString());if("function"===typeof e)throw new Error(t+"contains a function "+r.toErrorString()+" with contents = "+e.toString());if(B(e))throw new Error(t+"contains "+e.toString()+" "+r.toErrorString());if("string"===typeof e&&e.length>10485760/3&&v.stringLength(e)>10485760)throw new Error(t+"contains a string greater than 10485760 utf8 bytes "+r.toErrorString()+" ('"+e.substring(0,50)+"...')");if(e&&"object"===typeof e){var i=!1,o=!1;if(v.forEach(e,function(e,n){if(".value"===e)i=!0;else if(".priority"!==e&&".sv"!==e&&(o=!0,!ft(e)))throw new Error(t+" contains an invalid key ("+e+") "+r.toErrorString()+'.  Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"');r.push(e),vt(t,n,r),r.pop()}),i&&o)throw new Error(t+' contains ".value" child '+r.toErrorString()+" in addition to actual children.")}},yt=function(t,e){var n,r;for(n=0;n<e.length;n++){r=e[n];for(var i=r.slice(),o=0;o<i.length;o++)if(".priority"===i[o]&&o===i.length-1);else if(!ft(i[o]))throw new Error(t+"contains an invalid key ("+i[o]+") in path "+r.toString()+'. Keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]"')}e.sort(it.comparePaths);var a=null;for(n=0;n<e.length;n++){if(r=e[n],null!==a&&a.contains(r))throw new Error(t+"contains a path "+a.toString()+" that is ancestor of another path "+r.toString());a=r}},_t=function(t,e,n,r,i){if(!i||void 0!==n){var o=v.errorPrefix(t,e,i);if(!n||"object"!==typeof n||Array.isArray(n))throw new Error(o+" must be an object containing the children to replace.");var a=[];v.forEach(n,function(t,e){var n=new it(t);if(vt(o,e,r.child(n)),".priority"===n.getBack()&&!mt(e))throw new Error(o+"contains an invalid value for '"+n.toString()+"', which must be a valid Firebase priority (a string, finite number, server value, or null).");a.push(n)}),yt(o,a)}},bt=function(t,e,n,r){if(!r||void 0!==n){if(B(n))throw new Error(v.errorPrefix(t,e,r)+"is "+n.toString()+", but must be a valid Firebase priority (a string, finite number, server value, or null).");if(!mt(n))throw new Error(v.errorPrefix(t,e,r)+"must be a valid Firebase priority (a string, finite number, server value, or null).")}},wt=function(t,e,n,r){if(!r||void 0!==n)switch(n){case"value":case"child_added":case"child_removed":case"child_changed":case"child_moved":break;default:throw new Error(v.errorPrefix(t,e,r)+'must be a valid event type = "value", "child_added", "child_removed", "child_changed", or "child_moved".')}},Et=function(t,e,n,r){if((!r||void 0!==n)&&!ft(n))throw new Error(v.errorPrefix(t,e,r)+'was an invalid key = "'+n+'".  Firebase keys must be non-empty strings and can\'t contain ".", "#", "$", "/", "[", or "]").')},xt=function(t,e,n,r){if((!r||void 0!==n)&&!dt(n))throw new Error(v.errorPrefix(t,e,r)+'was an invalid path = "'+n+'". Paths must be non-empty strings and can\'t contain ".", "#", "$", "[", or "]"')},Tt=function(t,e,n,r){n&&(n=n.replace(/^\/*\.info(\/|$)/,"/")),xt(t,e,n,r)},St=function(t,e){if(".info"===e.getFront())throw new Error(t+" failed = Can't modify data under /.info/")},Ct=function(t,e,n){var r=n.path.toString();if("string"!==typeof n.repoInfo.host||0===n.repoInfo.host.length||!ft(n.repoInfo.namespace)&&"localhost"!==n.repoInfo.host.split(":")[0]||0!==r.length&&!pt(r))throw new Error(v.errorPrefix(t,e,!1)+'must be a valid firebase URL and the path can\'t contain ".", "#", "$", "[", or "]".')},Mt=function(t,e,n,r){if((!r||void 0!==n)&&"boolean"!==typeof n)throw new Error(v.errorPrefix(t,e,r)+"must be a boolean.")},At=function(){function t(t,e){this.repo_=t,this.path_=e}return t.prototype.cancel=function(t){v.validateArgCount("OnDisconnect.cancel",0,1,arguments.length),v.validateCallback("OnDisconnect.cancel",1,t,!0);var e=new v.Deferred;return this.repo_.onDisconnectCancel(this.path_,e.wrapCallback(t)),e.promise},t.prototype.remove=function(t){v.validateArgCount("OnDisconnect.remove",0,1,arguments.length),St("OnDisconnect.remove",this.path_),v.validateCallback("OnDisconnect.remove",1,t,!0);var e=new v.Deferred;return this.repo_.onDisconnectSet(this.path_,null,e.wrapCallback(t)),e.promise},t.prototype.set=function(t,e){v.validateArgCount("OnDisconnect.set",1,2,arguments.length),St("OnDisconnect.set",this.path_),gt("OnDisconnect.set",1,t,this.path_,!1),v.validateCallback("OnDisconnect.set",2,e,!0);var n=new v.Deferred;return this.repo_.onDisconnectSet(this.path_,t,n.wrapCallback(e)),n.promise},t.prototype.setWithPriority=function(t,e,n){v.validateArgCount("OnDisconnect.setWithPriority",2,3,arguments.length),St("OnDisconnect.setWithPriority",this.path_),gt("OnDisconnect.setWithPriority",1,t,this.path_,!1),bt("OnDisconnect.setWithPriority",2,e,!1),v.validateCallback("OnDisconnect.setWithPriority",3,n,!0);var r=new v.Deferred;return this.repo_.onDisconnectSetWithPriority(this.path_,t,e,r.wrapCallback(n)),r.promise},t.prototype.update=function(t,e){if(v.validateArgCount("OnDisconnect.update",1,2,arguments.length),St("OnDisconnect.update",this.path_),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,U("Passing an Array to firebase.database.onDisconnect().update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_t("OnDisconnect.update",1,t,this.path_,!1),v.validateCallback("OnDisconnect.update",2,e,!0);var i=new v.Deferred;return this.repo_.onDisconnectUpdate(this.path_,t,i.wrapCallback(e)),i.promise},t}(),It=function(){function t(t,e){this.committed=t,this.snapshot=e}return t.prototype.toJSON=function(){return v.validateArgCount("TransactionResult.toJSON",0,1,arguments.length),{committed:this.committed,snapshot:this.snapshot.toJSON()}},t}(),Rt=function(){var t="-0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ_abcdefghijklmnopqrstuvwxyz",e=0,n=[];return function(r){var i=r===e;e=r;var o,a=new Array(8);for(o=7;o>=0;o--)a[o]=t.charAt(r%64),r=Math.floor(r/64);v.assert(0===r,"Cannot push at time == 0");var s=a.join("");if(i){for(o=11;o>=0&&63===n[o];o--)n[o]=0;n[o]++}else for(o=0;o<12;o++)n[o]=Math.floor(64*Math.random());for(o=0;o<12;o++)s+=t.charAt(n[o]);return v.assert(20===s.length,"nextPushId: Length should be 20."),s}}(),Pt=function(){function t(t,e){this.name=t,this.node=e}return t.Wrap=function(e,n){return new t(e,n)},t}(),Nt=function(){function t(){}return t.prototype.getCompare=function(){return this.compare.bind(this)},t.prototype.indexedValueChanged=function(t,e){var n=new Pt(j,t),r=new Pt(j,e);return 0!==this.compare(n,r)},t.prototype.minPost=function(){return Pt.MIN},t}(),Dt=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _.__extends(e,t),Object.defineProperty(e,"__EMPTY_NODE",{get:function(){return l},set:function(t){l=t},enumerable:!0,configurable:!0}),e.prototype.compare=function(t,e){return G(t.name,e.name)},e.prototype.isDefinedOn=function(t){throw v.assertionError("KeyIndex.isDefinedOn not expected to be called.")},e.prototype.indexedValueChanged=function(t,e){return!1},e.prototype.minPost=function(){return Pt.MIN},e.prototype.maxPost=function(){return new Pt(H,l)},e.prototype.makePost=function(t,e){return v.assert("string"===typeof t,"KeyIndex indexValue must always be a string."),new Pt(t,l)},e.prototype.toString=function(){return".key"},e}(Nt),Ot=new Dt,kt=function(t){return"number"===typeof t?"number:"+Q(t):"string:"+t},Lt=function(t){if(t.isLeafNode()){var e=t.val();v.assert("string"===typeof e||"number"===typeof e||"object"===typeof e&&v.contains(e,".sv"),"Priority must be a string or number.")}else v.assert(t===h||t.isEmpty(),"priority of unexpected type.");v.assert(t===h||t.getPriority().isEmpty(),"Priority nodes can't have a priority of their own.")},Ut=function(){function t(e,n){void 0===n&&(n=t.__childrenNodeConstructor.EMPTY_NODE),this.value_=e,this.priorityNode_=n,this.lazyHash_=null,v.assert(void 0!==this.value_&&null!==this.value_,"LeafNode shouldn't be created with null/undefined value."),Lt(this.priorityNode_)}return Object.defineProperty(t,"__childrenNodeConstructor",{get:function(){return f},set:function(t){f=t},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!0},t.prototype.getPriority=function(){return this.priorityNode_},t.prototype.updatePriority=function(e){return new t(this.value_,e)},t.prototype.getImmediateChild=function(e){return".priority"===e?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.getChild=function(e){return e.isEmpty()?this:".priority"===e.getFront()?this.priorityNode_:t.__childrenNodeConstructor.EMPTY_NODE},t.prototype.hasChild=function(){return!1},t.prototype.getPredecessorChildName=function(t,e){return null},t.prototype.updateImmediateChild=function(e,n){return".priority"===e?this.updatePriority(n):n.isEmpty()&&".priority"!==e?this:t.__childrenNodeConstructor.EMPTY_NODE.updateImmediateChild(e,n).updatePriority(this.priorityNode_)},t.prototype.updateChild=function(e,n){var r=e.getFront();return null===r?n:n.isEmpty()&&".priority"!==r?this:(v.assert(".priority"!==r||1===e.getLength(),".priority must be the last token in a path"),this.updateImmediateChild(r,t.__childrenNodeConstructor.EMPTY_NODE.updateChild(e.popFront(),n)))},t.prototype.isEmpty=function(){return!1},t.prototype.numChildren=function(){return 0},t.prototype.forEachChild=function(t,e){return!1},t.prototype.val=function(t){return t&&!this.getPriority().isEmpty()?{".value":this.getValue(),".priority":this.getPriority().val()}:this.getValue()},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.priorityNode_.isEmpty()||(t+="priority:"+kt(this.priorityNode_.val())+":");var e=typeof this.value_;t+=e+":",t+="number"===e?Q(this.value_):this.value_,this.lazyHash_=A(t)}return this.lazyHash_},t.prototype.getValue=function(){return this.value_},t.prototype.compareTo=function(e){return e===t.__childrenNodeConstructor.EMPTY_NODE?1:e instanceof t.__childrenNodeConstructor?-1:(v.assert(e.isLeafNode(),"Unknown node type"),this.compareToLeafNode_(e))},t.prototype.compareToLeafNode_=function(e){var n=typeof e.value_,r=typeof this.value_,i=t.VALUE_TYPE_ORDER.indexOf(n),o=t.VALUE_TYPE_ORDER.indexOf(r);return v.assert(i>=0,"Unknown leaf type: "+n),v.assert(o>=0,"Unknown leaf type: "+r),i===o?"object"===r?0:this.value_<e.value_?-1:this.value_===e.value_?0:1:o-i},t.prototype.withIndex=function(){return this},t.prototype.isIndexed=function(){return!0},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode()){var e=t;return this.value_===e.value_&&this.priorityNode_.equals(e.priorityNode_)}return!1},t.VALUE_TYPE_ORDER=["object","boolean","number","string"],t}(),Ft=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _.__extends(e,t),e.prototype.compare=function(t,e){var n=t.node.getPriority(),r=e.node.getPriority(),i=n.compareTo(r);return 0===i?G(t.name,e.name):i},e.prototype.isDefinedOn=function(t){return!t.getPriority().isEmpty()},e.prototype.indexedValueChanged=function(t,e){return!t.getPriority().equals(e.getPriority())},e.prototype.minPost=function(){return Pt.MIN},e.prototype.maxPost=function(){return new Pt(H,new Ut("[PRIORITY-POST]",p))},e.prototype.makePost=function(t,e){var n=d(t);return new Pt(e,new Ut("[PRIORITY-POST]",n))},e.prototype.toString=function(){return".priority"},e}(Nt),Bt=new Ft,Vt=function(){function t(t,e,n,r,i){void 0===i&&(i=null),this.isReverse_=r,this.resultGenerator_=i,this.nodeStack_=[];for(var o=1;!t.isEmpty();)if(t=t,o=e?n(t.key,e):1,r&&(o*=-1),o<0)t=this.isReverse_?t.left:t.right;else{if(0===o){this.nodeStack_.push(t);break}this.nodeStack_.push(t),t=this.isReverse_?t.right:t.left}}return t.prototype.getNext=function(){if(0===this.nodeStack_.length)return null;var t,e=this.nodeStack_.pop();if(t=this.resultGenerator_?this.resultGenerator_(e.key,e.value):{key:e.key,value:e.value},this.isReverse_)for(e=e.left;!e.isEmpty();)this.nodeStack_.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack_.push(e),e=e.left;return t},t.prototype.hasNext=function(){return this.nodeStack_.length>0},t.prototype.peek=function(){if(0===this.nodeStack_.length)return null;var t=this.nodeStack_[this.nodeStack_.length-1];return this.resultGenerator_?this.resultGenerator_(t.key,t.value):{key:t.key,value:t.value}},t}(),jt=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:Gt.EMPTY_NODE,this.right=null!=o?o:Gt.EMPTY_NODE}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.count=function(){return this.left.count()+1+this.right.count()},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min_=function(){return this.left.isEmpty()?this:this.left.min_()},t.prototype.minKey=function(){return this.min_().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r,i;return i=this,r=n(t,i.key),i=r<0?i.copy(null,null,null,i.left.insert(t,e,n),null):0===r?i.copy(null,e,null,null,null):i.copy(null,null,null,null,i.right.insert(t,e,n)),i.fixUp_()},t.prototype.removeMin_=function(){if(this.left.isEmpty())return Gt.EMPTY_NODE;var t=this;return t.left.isRed_()||t.left.left.isRed_()||(t=t.moveRedLeft_()),t=t.copy(null,null,null,t.left.removeMin_(),null),t.fixUp_()},t.prototype.remove=function(t,e){var n,r;if(n=this,e(t,n.key)<0)n.left.isEmpty()||n.left.isRed_()||n.left.left.isRed_()||(n=n.moveRedLeft_()),n=n.copy(null,null,null,n.left.remove(t,e),null);else{if(n.left.isRed_()&&(n=n.rotateRight_()),n.right.isEmpty()||n.right.isRed_()||n.right.left.isRed_()||(n=n.moveRedRight_()),0===e(t,n.key)){if(n.right.isEmpty())return Gt.EMPTY_NODE;r=n.right.min_(),n=n.copy(r.key,r.value,null,null,n.right.removeMin_())}n=n.copy(null,null,null,null,n.right.remove(t,e))}return n.fixUp_()},t.prototype.isRed_=function(){return this.color},t.prototype.fixUp_=function(){var t=this;return t.right.isRed_()&&!t.left.isRed_()&&(t=t.rotateLeft_()),t.left.isRed_()&&t.left.left.isRed_()&&(t=t.rotateRight_()),t.left.isRed_()&&t.right.isRed_()&&(t=t.colorFlip_()),t},t.prototype.moveRedLeft_=function(){var t=this.colorFlip_();return t.right.left.isRed_()&&(t=t.copy(null,null,null,null,t.right.rotateRight_()),t=t.rotateLeft_(),t=t.colorFlip_()),t},t.prototype.moveRedRight_=function(){var t=this.colorFlip_();return t.left.left.isRed_()&&(t=t.rotateRight_(),t=t.colorFlip_()),t},t.prototype.rotateLeft_=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight_=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip_=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth_=function(){var t=this.check_();return Math.pow(2,t)<=this.count()+1},t.prototype.check_=function(){var t;if(this.isRed_()&&this.left.isRed_())throw new Error("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed_())throw new Error("Right child of ("+this.key+","+this.value+") is red");if((t=this.left.check_())!==this.right.check_())throw new Error("Black depths differ");return t+(this.isRed_()?0:1)},t.RED=!0,t.BLACK=!1,t}(),Ht=function(){function t(){}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new jt(t,e,null)},t.prototype.remove=function(t,e){return this},t.prototype.count=function(){return 0},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.check_=function(){return 0},t.prototype.isRed_=function(){return!1},t}(),Gt=function(){function t(e,n){void 0===n&&(n=t.EMPTY_NODE),this.comparator_=e,this.root_=n}return t.prototype.insert=function(e,n){return new t(this.comparator_,this.root_.insert(e,n,this.comparator_).copy(null,null,jt.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator_,this.root_.remove(e,this.comparator_).copy(null,null,jt.BLACK,null,null))},t.prototype.get=function(t){for(var e,n=this.root_;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key)))return n.value;e<0?n=n.left:e>0&&(n=n.right)}return null},t.prototype.getPredecessorKey=function(t){for(var e,n=this.root_,r=null;!n.isEmpty();){if(0===(e=this.comparator_(t,n.key))){if(n.left.isEmpty())return r?r.key:null;for(n=n.left;!n.right.isEmpty();)n=n.right;return n.key}e<0?n=n.left:e>0&&(r=n,n=n.right)}throw new Error("Attempted to find predecessor key for a nonexistent key.  What gives?")},t.prototype.isEmpty=function(){return this.root_.isEmpty()},t.prototype.count=function(){return this.root_.count()},t.prototype.minKey=function(){return this.root_.minKey()},t.prototype.maxKey=function(){return this.root_.maxKey()},t.prototype.inorderTraversal=function(t){return this.root_.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.root_.reverseTraversal(t)},t.prototype.getIterator=function(t){return new Vt(this.root_,null,this.comparator_,!1,t)},t.prototype.getIteratorFrom=function(t,e){return new Vt(this.root_,t,this.comparator_,!1,e)},t.prototype.getReverseIteratorFrom=function(t,e){return new Vt(this.root_,t,this.comparator_,!0,e)},t.prototype.getReverseIterator=function(t){return new Vt(this.root_,null,this.comparator_,!0,t)},t.EMPTY_NODE=new Ht,t}(),zt=Math.log(2),Wt=function(){function t(t){this.count=function(t){return parseInt(Math.log(t)/zt,10)}(t+1),this.current_=this.count-1;var e=function(t){return parseInt(Array(t+1).join("1"),2)}(this.count);this.bits_=t+1&e}return t.prototype.nextBitIsOne=function(){var t=!(this.bits_&1<<this.current_);return this.current_--,t},t}(),qt=function(t,e,n,r){t.sort(e);var i=function(e,r){var o,a,s=r-e;if(0==s)return null;if(1==s)return o=t[e],a=n?n(o):o,new jt(a,o.node,jt.BLACK,null,null);var u=parseInt(s/2,10)+e,c=i(e,u),l=i(u+1,r);return o=t[u],a=n?n(o):o,new jt(a,o.node,jt.BLACK,c,l)},o=new Wt(t.length),a=function(e){for(var r=null,o=null,a=t.length,s=function(e,r){var o=a-e,s=a;a-=e;var c=i(o+1,s),l=t[o],h=n?n(l):l;u(new jt(h,l.node,r,null,c))},u=function(t){r?(r.left=t,r=t):(o=t,r=t)},c=0;c<e.count;++c){var l=e.nextBitIsOne(),h=Math.pow(2,e.count-(c+1));l?s(h,jt.BLACK):(s(h,jt.BLACK),s(h,jt.RED))}return o}(o);return new Gt(r||e,a)},Yt={},Kt=function(){function t(t,e){this.indexes_=t,this.indexSet_=e}return Object.defineProperty(t,"Default",{get:function(){return v.assert(Yt&&Bt,"ChildrenNode.ts has not been loaded"),m=m||new t({".priority":Yt},{".priority":Bt})},enumerable:!0,configurable:!0}),t.prototype.get=function(t){var e=v.safeGet(this.indexes_,t);if(!e)throw new Error("No index defined for "+t);return e===Yt?null:e},t.prototype.hasIndex=function(t){return v.contains(this.indexSet_,t.toString())},t.prototype.addIndex=function(e,n){v.assert(e!==Ot,"KeyIndex always exists and isn't meant to be added to the IndexMap.");for(var r=[],i=!1,o=n.getIterator(Pt.Wrap),a=o.getNext();a;)i=i||e.isDefinedOn(a.node),r.push(a),a=o.getNext();var s;s=i?qt(r,e.getCompare()):Yt;var u=e.toString(),c=v.clone(this.indexSet_);c[u]=e;var l=v.clone(this.indexes_);return l[u]=s,new t(l,c)},t.prototype.addToIndexes=function(e,n){var r=this;return new t(v.map(this.indexes_,function(t,i){var o=v.safeGet(r.indexSet_,i);if(v.assert(o,"Missing index implementation for "+i),t===Yt){if(o.isDefinedOn(e.node)){for(var a=[],s=n.getIterator(Pt.Wrap),u=s.getNext();u;)u.name!=e.name&&a.push(u),u=s.getNext();return a.push(e),qt(a,o.getCompare())}return Yt}var c=n.get(e.name),l=t;return c&&(l=l.remove(new Pt(e.name,c))),l.insert(e,e.node)}),this.indexSet_)},t.prototype.removeFromIndexes=function(e,n){return new t(v.map(this.indexes_,function(t){if(t===Yt)return t;var r=n.get(e.name);return r?t.remove(new Pt(e.name,r)):t}),this.indexSet_)},t}(),Qt=function(){function t(t,e,n){this.children_=t,this.priorityNode_=e,this.indexMap_=n,this.lazyHash_=null,this.priorityNode_&&Lt(this.priorityNode_),this.children_.isEmpty()&&v.assert(!this.priorityNode_||this.priorityNode_.isEmpty(),"An empty node cannot have a priority")}return Object.defineProperty(t,"EMPTY_NODE",{get:function(){return g||(g=new t(new Gt(s),null,Kt.Default))},enumerable:!0,configurable:!0}),t.prototype.isLeafNode=function(){return!1},t.prototype.getPriority=function(){return this.priorityNode_||g},t.prototype.updatePriority=function(e){return this.children_.isEmpty()?this:new t(this.children_,e,this.indexMap_)},t.prototype.getImmediateChild=function(t){if(".priority"===t)return this.getPriority();var e=this.children_.get(t);return null===e?g:e},t.prototype.getChild=function(t){var e=t.getFront();return null===e?this:this.getImmediateChild(e).getChild(t.popFront())},t.prototype.hasChild=function(t){return null!==this.children_.get(t)},t.prototype.updateImmediateChild=function(e,n){if(v.assert(n,"We should always be passing snapshot nodes"),".priority"===e)return this.updatePriority(n);var r=new Pt(e,n),i=void 0,o=void 0,a=void 0;return n.isEmpty()?(i=this.children_.remove(e),o=this.indexMap_.removeFromIndexes(r,this.children_)):(i=this.children_.insert(e,n),o=this.indexMap_.addToIndexes(r,this.children_)),a=i.isEmpty()?g:this.priorityNode_,new t(i,a,o)},t.prototype.updateChild=function(t,e){var n=t.getFront();if(null===n)return e;v.assert(".priority"!==t.getFront()||1===t.getLength(),".priority must be the last token in a path");var r=this.getImmediateChild(n).updateChild(t.popFront(),e);return this.updateImmediateChild(n,r)},t.prototype.isEmpty=function(){return this.children_.isEmpty()},t.prototype.numChildren=function(){return this.children_.count()},t.prototype.val=function(e){if(this.isEmpty())return null;var n={},r=0,i=0,o=!0;if(this.forEachChild(Bt,function(a,s){n[a]=s.val(e),r++,o&&t.INTEGER_REGEXP_.test(a)?i=Math.max(i,Number(a)):o=!1}),!e&&o&&i<2*r){var a=[];for(var s in n)a[s]=n[s];return a}return e&&!this.getPriority().isEmpty()&&(n[".priority"]=this.getPriority().val()),n},t.prototype.hash=function(){if(null===this.lazyHash_){var t="";this.getPriority().isEmpty()||(t+="priority:"+kt(this.getPriority().val())+":"),this.forEachChild(Bt,function(e,n){var r=n.hash();""!==r&&(t+=":"+e+":"+r)}),this.lazyHash_=""===t?"":A(t)}return this.lazyHash_},t.prototype.getPredecessorChildName=function(t,e,n){var r=this.resolveIndex_(n);if(r){var i=r.getPredecessorKey(new Pt(t,e));return i?i.name:null}return this.children_.getPredecessorKey(t)},t.prototype.getFirstChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.minKey();return n&&n.name}return this.children_.minKey()},t.prototype.getFirstChild=function(t){var e=this.getFirstChildName(t);return e?new Pt(e,this.children_.get(e)):null},t.prototype.getLastChildName=function(t){var e=this.resolveIndex_(t);if(e){var n=e.maxKey();return n&&n.name}return this.children_.maxKey()},t.prototype.getLastChild=function(t){var e=this.getLastChildName(t);return e?new Pt(e,this.children_.get(e)):null},t.prototype.forEachChild=function(t,e){var n=this.resolveIndex_(t);return n?n.inorderTraversal(function(t){return e(t.name,t.node)}):this.children_.inorderTraversal(e)},t.prototype.getIterator=function(t){return this.getIteratorFrom(t.minPost(),t)},t.prototype.getIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getIteratorFrom(t,function(t){return t});for(var r=this.children_.getIteratorFrom(t.name,Pt.Wrap),i=r.peek();null!=i&&e.compare(i,t)<0;)r.getNext(),i=r.peek();return r},t.prototype.getReverseIterator=function(t){return this.getReverseIteratorFrom(t.maxPost(),t)},t.prototype.getReverseIteratorFrom=function(t,e){var n=this.resolveIndex_(e);if(n)return n.getReverseIteratorFrom(t,function(t){return t});for(var r=this.children_.getReverseIteratorFrom(t.name,Pt.Wrap),i=r.peek();null!=i&&e.compare(i,t)>0;)r.getNext(),i=r.peek();return r},t.prototype.compareTo=function(t){return this.isEmpty()?t.isEmpty()?0:-1:t.isLeafNode()||t.isEmpty()?1:t===Jt?-1:0},t.prototype.withIndex=function(e){if(e===Ot||this.indexMap_.hasIndex(e))return this;var n=this.indexMap_.addIndex(e,this.children_);return new t(this.children_,this.priorityNode_,n)},t.prototype.isIndexed=function(t){return t===Ot||this.indexMap_.hasIndex(t)},t.prototype.equals=function(t){if(t===this)return!0;if(t.isLeafNode())return!1;var e=t;if(this.getPriority().equals(e.getPriority())){if(this.children_.count()===e.children_.count()){for(var n=this.getIterator(Bt),r=e.getIterator(Bt),i=n.getNext(),o=r.getNext();i&&o;){if(i.name!==o.name||!i.node.equals(o.node))return!1;i=n.getNext(),o=r.getNext()}return null===i&&null===o}return!1}return!1},t.prototype.resolveIndex_=function(t){return t===Ot?null:this.indexMap_.get(t.toString())},t.INTEGER_REGEXP_=/^(0|[1-9]\d*)$/,t}(),Xt=function(t){function e(){return t.call(this,new Gt(s),Qt.EMPTY_NODE,Kt.Default)||this}return _.__extends(e,t),e.prototype.compareTo=function(t){return t===this?0:1},e.prototype.equals=function(t){return t===this},e.prototype.getPriority=function(){return this},e.prototype.getImmediateChild=function(t){return Qt.EMPTY_NODE},e.prototype.isEmpty=function(){return!1},e}(Qt),Jt=new Xt;Object.defineProperties(Pt,{MIN:{value:new Pt(j,Qt.EMPTY_NODE)},MAX:{value:new Pt(H,Jt)}}),Dt.__EMPTY_NODE=Qt.EMPTY_NODE,Ut.__childrenNodeConstructor=Qt,function(t){h=t}(Jt),function(t){p=t}(Jt);var Zt=!0;!function(t){d=t}(u);var $t,te,ee=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return _.__extends(e,t),e.prototype.compare=function(t,e){var n=t.node.compareTo(e.node);return 0===n?G(t.name,e.name):n},e.prototype.isDefinedOn=function(t){return!0},e.prototype.indexedValueChanged=function(t,e){return!t.equals(e)},e.prototype.minPost=function(){return Pt.MIN},e.prototype.maxPost=function(){return Pt.MAX},e.prototype.makePost=function(t,e){var n=u(t);return new Pt(e,n)},e.prototype.toString=function(){return".value"},e}(Nt),ne=new ee,re=function(t){function e(e){var n=t.call(this)||this;return n.indexPath_=e,v.assert(!e.isEmpty()&&".priority"!==e.getFront(),"Can't create PathIndex with empty path or .priority key"),n}return _.__extends(e,t),e.prototype.extractChild=function(t){return t.getChild(this.indexPath_)},e.prototype.isDefinedOn=function(t){return!t.getChild(this.indexPath_).isEmpty()},e.prototype.compare=function(t,e){var n=this.extractChild(t.node),r=this.extractChild(e.node),i=n.compareTo(r);return 0===i?G(t.name,e.name):i},e.prototype.makePost=function(t,e){var n=u(t),r=Qt.EMPTY_NODE.updateChild(this.indexPath_,n);return new Pt(e,r)},e.prototype.maxPost=function(){var t=Qt.EMPTY_NODE.updateChild(this.indexPath_,Jt);return new Pt(H,t)},e.prototype.toString=function(){return this.indexPath_.slice().join("/")},e}(Nt),ie=function(){function t(t,e,n){this.node_=t,this.ref_=e,this.index_=n}return t.prototype.val=function(){return v.validateArgCount("DataSnapshot.val",0,0,arguments.length),this.node_.val()},t.prototype.exportVal=function(){return v.validateArgCount("DataSnapshot.exportVal",0,0,arguments.length),this.node_.val(!0)},t.prototype.toJSON=function(){return v.validateArgCount("DataSnapshot.toJSON",0,1,arguments.length),this.exportVal()},t.prototype.exists=function(){return v.validateArgCount("DataSnapshot.exists",0,0,arguments.length),!this.node_.isEmpty()},t.prototype.child=function(e){v.validateArgCount("DataSnapshot.child",0,1,arguments.length),e=String(e),xt("DataSnapshot.child",1,e,!1);var n=new it(e),r=this.ref_.child(n);return new t(this.node_.getChild(n),r,Bt)},t.prototype.hasChild=function(t){v.validateArgCount("DataSnapshot.hasChild",1,1,arguments.length),xt("DataSnapshot.hasChild",1,t,!1);var e=new it(t);return!this.node_.getChild(e).isEmpty()},t.prototype.getPriority=function(){return v.validateArgCount("DataSnapshot.getPriority",0,0,arguments.length),this.node_.getPriority().val()},t.prototype.forEach=function(e){var n=this;return v.validateArgCount("DataSnapshot.forEach",1,1,arguments.length),v.validateCallback("DataSnapshot.forEach",1,e,!1),!this.node_.isLeafNode()&&!!this.node_.forEachChild(this.index_,function(r,i){return e(new t(i,n.ref_.child(r),Bt))})},t.prototype.hasChildren=function(){return v.validateArgCount("DataSnapshot.hasChildren",0,0,arguments.length),!this.node_.isLeafNode()&&!this.node_.isEmpty()},Object.defineProperty(t.prototype,"key",{get:function(){return this.ref_.getKey()},enumerable:!0,configurable:!0}),t.prototype.numChildren=function(){return v.validateArgCount("DataSnapshot.numChildren",0,0,arguments.length),this.node_.numChildren()},t.prototype.getRef=function(){return v.validateArgCount("DataSnapshot.ref",0,0,arguments.length),this.ref_},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}(),oe=function(){function t(t,e,n,r){this.eventType=t,this.eventRegistration=e,this.snapshot=n,this.prevName=r}return t.prototype.getPath=function(){var t=this.snapshot.getRef();return"value"===this.eventType?t.path:t.getParent().path},t.prototype.getEventType=function(){return this.eventType},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.getPath().toString()+":"+this.eventType+":"+v.stringify(this.snapshot.exportVal())},t}(),ae=function(){function t(t,e,n){this.eventRegistration=t,this.error=e,this.path=n}return t.prototype.getPath=function(){return this.path},t.prototype.getEventType=function(){return"cancel"},t.prototype.getEventRunner=function(){return this.eventRegistration.getEventRunner(this)},t.prototype.toString=function(){return this.path.toString()+":cancel"},t}(),se=function(){function t(t,e,n){this.callback_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){return"value"===t},t.prototype.createEvent=function(t,e){var n=e.getQueryParams().getIndex();return new oe("value",this,new ie(t.snapshotNode,e.getRef(),n))},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){v.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callback_;return function(){r.call(e,t.snapshot)}},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new ae(this,t,e):null},t.prototype.matches=function(e){return e instanceof t&&(!e.callback_||!this.callback_||e.callback_===this.callback_&&e.context_===this.context_)},t.prototype.hasAnyCallback=function(){return null!==this.callback_},t}(),ue=function(){function t(t,e,n){this.callbacks_=t,this.cancelCallback_=e,this.context_=n}return t.prototype.respondsTo=function(t){var e="children_added"===t?"child_added":t;return e="children_removed"===e?"child_removed":e,v.contains(this.callbacks_,e)},t.prototype.createCancelEvent=function(t,e){return this.cancelCallback_?new ae(this,t,e):null},t.prototype.createEvent=function(t,e){v.assert(null!=t.childName,"Child events should have a childName.");var n=e.getRef().child(t.childName),r=e.getQueryParams().getIndex();return new oe(t.type,this,new ie(t.snapshotNode,n,r),t.prevName)},t.prototype.getEventRunner=function(t){var e=this.context_;if("cancel"===t.getEventType()){v.assert(this.cancelCallback_,"Raising a cancel event on a listener with no cancel callback");var n=this.cancelCallback_;return function(){n.call(e,t.error)}}var r=this.callbacks_[t.eventType];return function(){r.call(e,t.snapshot,t.prevName)}},t.prototype.matches=function(e){if(e instanceof t){if(!this.callbacks_||!e.callbacks_)return!0;if(this.context_===e.context_){var n=v.getCount(e.callbacks_);if(n===v.getCount(this.callbacks_)){if(1===n){var r=v.getAnyKey(e.callbacks_),i=v.getAnyKey(this.callbacks_);return i===r&&(!e.callbacks_[r]||!this.callbacks_[i]||e.callbacks_[r]===this.callbacks_[i])}return v.every(this.callbacks_,function(t,n){return e.callbacks_[t]===n})}}}return!1},t.prototype.hasAnyCallback=function(){return null!==this.callbacks_},t}(),ce=function(){function t(t,e,n,r){this.repo=t,this.path=e,this.queryParams_=n,this.orderByCalled_=r}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return v.assert($t,"Reference.ts has not been loaded"),$t},set:function(t){$t=t},enumerable:!0,configurable:!0}),t.validateQueryEndpoints_=function(t){var e=null,n=null;if(t.hasStart()&&(e=t.getIndexStartValue()),t.hasEnd()&&(n=t.getIndexEndValue()),t.getIndex()===Ot){var r="Query: When ordering by key, you may only pass one argument to startAt(), endAt(), or equalTo().",i="Query: When ordering by key, the argument passed to startAt(), endAt(),or equalTo() must be a string.";if(t.hasStart()){if(t.getIndexStartName()!=j)throw new Error(r);if("string"!==typeof e)throw new Error(i)}if(t.hasEnd()){if(t.getIndexEndName()!=H)throw new Error(r);if("string"!==typeof n)throw new Error(i)}}else if(t.getIndex()===Bt){if(null!=e&&!mt(e)||null!=n&&!mt(n))throw new Error("Query: When ordering by priority, the first argument passed to startAt(), endAt(), or equalTo() must be a valid priority value (null, a number, or a string).")}else if(v.assert(t.getIndex()instanceof re||t.getIndex()===ne,"unknown index type."),null!=e&&"object"===typeof e||null!=n&&"object"===typeof n)throw new Error("Query: First argument passed to startAt(), endAt(), or equalTo() cannot be an object.")},t.validateLimit_=function(t){if(t.hasStart()&&t.hasEnd()&&t.hasLimit()&&!t.hasAnchoredLimit())throw new Error("Query: Can't combine startAt(), endAt(), and limit(). Use limitToFirst() or limitToLast() instead.")},t.prototype.validateNoPreviousOrderByCall_=function(t){if(!0===this.orderByCalled_)throw new Error(t+": You can't combine multiple orderBy calls.")},t.prototype.getQueryParams=function(){return this.queryParams_},t.prototype.getRef=function(){return v.validateArgCount("Query.ref",0,0,arguments.length),new t.__referenceConstructor(this.repo,this.path)},t.prototype.on=function(e,n,r,i){v.validateArgCount("Query.on",2,4,arguments.length),wt("Query.on",1,e,!1),v.validateCallback("Query.on",2,n,!1);var o=t.getCancelAndContextArgs_("Query.on",r,i);if("value"===e)this.onValueEvent(n,o.cancel,o.context);else{var a={};a[e]=n,this.onChildEvent(a,o.cancel,o.context)}return n},t.prototype.onValueEvent=function(t,e,n){var r=new se(t,e||null,n||null);this.repo.addEventCallbackForQuery(this,r)},t.prototype.onChildEvent=function(t,e,n){var r=new ue(t,e,n);this.repo.addEventCallbackForQuery(this,r)},t.prototype.off=function(t,e,n){v.validateArgCount("Query.off",0,3,arguments.length),wt("Query.off",1,t,!0),v.validateCallback("Query.off",2,e,!0),v.validateContextObject("Query.off",3,n,!0);var r=null,i=null;if("value"===t){r=new se(e||null,null,n||null)}else t&&(e&&(i={},i[t]=e),r=new ue(i,null,n||null));this.repo.removeEventCallbackForQuery(this,r)},t.prototype.once=function(e,n,r,i){var o=this;v.validateArgCount("Query.once",1,4,arguments.length),wt("Query.once",1,e,!1),v.validateCallback("Query.once",2,n,!0);var a=t.getCancelAndContextArgs_("Query.once",r,i),s=!0,u=new v.Deferred;u.promise.catch(function(){});var c=function(t){s&&(s=!1,o.off(e,c),n&&n.bind(a.context)(t),u.resolve(t))};return this.on(e,c,function(t){o.off(e,c),a.cancel&&a.cancel.bind(a.context)(t),u.reject(t)}),u.promise},t.prototype.limitToFirst=function(e){if(v.validateArgCount("Query.limitToFirst",1,1,arguments.length),"number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToFirst: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToFirst: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToFirst(e),this.orderByCalled_)},t.prototype.limitToLast=function(e){if(v.validateArgCount("Query.limitToLast",1,1,arguments.length),"number"!==typeof e||Math.floor(e)!==e||e<=0)throw new Error("Query.limitToLast: First argument must be a positive integer.");if(this.queryParams_.hasLimit())throw new Error("Query.limitToLast: Limit was already set (by another call to limit, limitToFirst, or limitToLast).");return new t(this.repo,this.path,this.queryParams_.limitToLast(e),this.orderByCalled_)},t.prototype.orderByChild=function(e){if(v.validateArgCount("Query.orderByChild",1,1,arguments.length),"$key"===e)throw new Error('Query.orderByChild: "$key" is invalid.  Use Query.orderByKey() instead.');if("$priority"===e)throw new Error('Query.orderByChild: "$priority" is invalid.  Use Query.orderByPriority() instead.');if("$value"===e)throw new Error('Query.orderByChild: "$value" is invalid.  Use Query.orderByValue() instead.');xt("Query.orderByChild",1,e,!1),this.validateNoPreviousOrderByCall_("Query.orderByChild");var n=new it(e);if(n.isEmpty())throw new Error("Query.orderByChild: cannot pass in empty path.  Use Query.orderByValue() instead.");var r=new re(n),i=this.queryParams_.orderBy(r);return t.validateQueryEndpoints_(i),new t(this.repo,this.path,i,!0)},t.prototype.orderByKey=function(){v.validateArgCount("Query.orderByKey",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByKey");var e=this.queryParams_.orderBy(Ot);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByPriority=function(){v.validateArgCount("Query.orderByPriority",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByPriority");var e=this.queryParams_.orderBy(Bt);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.orderByValue=function(){v.validateArgCount("Query.orderByValue",0,0,arguments.length),this.validateNoPreviousOrderByCall_("Query.orderByValue");var e=this.queryParams_.orderBy(ne);return t.validateQueryEndpoints_(e),new t(this.repo,this.path,e,!0)},t.prototype.startAt=function(e,n){void 0===e&&(e=null),v.validateArgCount("Query.startAt",0,2,arguments.length),gt("Query.startAt",1,e,this.path,!0),Et("Query.startAt",2,n,!0);var r=this.queryParams_.startAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasStart())throw new Error("Query.startAt: Starting point was already set (by another call to startAt or equalTo).");return void 0===e&&(e=null,n=null),new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.endAt=function(e,n){void 0===e&&(e=null),v.validateArgCount("Query.endAt",0,2,arguments.length),gt("Query.endAt",1,e,this.path,!0),Et("Query.endAt",2,n,!0);var r=this.queryParams_.endAt(e,n);if(t.validateLimit_(r),t.validateQueryEndpoints_(r),this.queryParams_.hasEnd())throw new Error("Query.endAt: Ending point was already set (by another call to endAt or equalTo).");return new t(this.repo,this.path,r,this.orderByCalled_)},t.prototype.equalTo=function(t,e){if(v.validateArgCount("Query.equalTo",1,2,arguments.length),gt("Query.equalTo",1,t,this.path,!1),Et("Query.equalTo",2,e,!0),this.queryParams_.hasStart())throw new Error("Query.equalTo: Starting point was already set (by another call to startAt or equalTo).");if(this.queryParams_.hasEnd())throw new Error("Query.equalTo: Ending point was already set (by another call to endAt or equalTo).");return this.startAt(t,e).endAt(t,e)},t.prototype.toString=function(){return v.validateArgCount("Query.toString",0,0,arguments.length),this.repo.toString()+this.path.toUrlEncodedString()},t.prototype.toJSON=function(){return v.validateArgCount("Query.toJSON",0,1,arguments.length),this.toString()},t.prototype.queryObject=function(){return this.queryParams_.getQueryObject()},t.prototype.queryIdentifier=function(){var t=this.queryObject(),e=q(t);return"{}"===e?"default":e},t.prototype.isEqual=function(e){if(v.validateArgCount("Query.isEqual",1,1,arguments.length),!(e instanceof t)){throw new Error("Query.isEqual failed: First argument must be an instance of firebase.database.Query.")}var n=this.repo===e.repo,r=this.path.equals(e.path),i=this.queryIdentifier()===e.queryIdentifier();return n&&r&&i},t.getCancelAndContextArgs_=function(t,e,n){var r={cancel:null,context:null};if(e&&n)r.cancel=e,v.validateCallback(t,3,r.cancel,!0),r.context=n,v.validateContextObject(t,4,r.context,!0);else if(e)if("object"===typeof e&&null!==e)r.context=e;else{if("function"!==typeof e)throw new Error(v.errorPrefix(t,3,!0)+" must either be a cancel callback or a context object.");r.cancel=e}return r},Object.defineProperty(t.prototype,"ref",{get:function(){return this.getRef()},enumerable:!0,configurable:!0}),t}(),le=function(){function t(){this.set={}}return t.prototype.add=function(t,e){this.set[t]=null===e||e},t.prototype.contains=function(t){return v.contains(this.set,t)},t.prototype.get=function(t){return this.contains(t)?this.set[t]:void 0},t.prototype.remove=function(t){delete this.set[t]},t.prototype.clear=function(){this.set={}},t.prototype.isEmpty=function(){return v.isEmpty(this.set)},t.prototype.count=function(){return v.getCount(this.set)},t.prototype.each=function(t){v.forEach(this.set,function(e,n){return t(e,n)})},t.prototype.keys=function(){var t=[];return v.forEach(this.set,function(e){t.push(e)}),t},t}(),he=function(){function t(){this.value_=null,this.children_=null}return t.prototype.find=function(t){if(null!=this.value_)return this.value_.getChild(t);if(t.isEmpty()||null==this.children_)return null;var e=t.getFront();if(t=t.popFront(),this.children_.contains(e)){return this.children_.get(e).find(t)}return null},t.prototype.remember=function(e,n){if(e.isEmpty())this.value_=n,this.children_=null;else if(null!==this.value_)this.value_=this.value_.updateChild(e,n);else{null==this.children_&&(this.children_=new le);var r=e.getFront();this.children_.contains(r)||this.children_.add(r,new t);var i=this.children_.get(r);e=e.popFront(),i.remember(e,n)}},t.prototype.forget=function(t){if(t.isEmpty())return this.value_=null,this.children_=null,!0;if(null!==this.value_){if(this.value_.isLeafNode())return!1;var e=this.value_;this.value_=null;var n=this;return e.forEachChild(Bt,function(t,e){n.remember(new it(t),e)}),this.forget(t)}if(null!==this.children_){var r=t.getFront();if(t=t.popFront(),this.children_.contains(r)){this.children_.get(r).forget(t)&&this.children_.remove(r)}return!!this.children_.isEmpty()&&(this.children_=null,!0)}return!0},t.prototype.forEachTree=function(t,e){null!==this.value_?e(t,this.value_):this.forEachChild(function(n,r){var i=new it(t.toString()+"/"+n);r.forEachTree(i,e)})},t.prototype.forEachChild=function(t){null!==this.children_&&this.children_.each(function(e,n){t(e,n)})},t}(),fe=function(t){return t=t||{},t.timestamp=t.timestamp||(new Date).getTime(),t},de=function(t,e){return t&&"object"===typeof t?(v.assert(".sv"in t,"Unexpected leaf node or priority contents"),e[t[".sv"]]):t},pe=function(t,e){var n=new he;return t.forEachTree(new it(""),function(t,r){n.remember(t,me(r,e))}),n},me=function(t,e){var n,r=t.getPriority().val(),i=de(r,e);if(t.isLeafNode()){var o=t,a=de(o.getValue(),e);return a!==o.getValue()||i!==o.getPriority().val()?new Ut(a,u(i)):t}var s=t;return n=s,i!==s.getPriority().val()&&(n=n.updatePriority(new Ut(i))),s.forEachChild(Bt,function(t,r){var i=me(r,e);i!==r&&(n=n.updateImmediateChild(t,i))}),n};!function(t){t[t.OVERWRITE=0]="OVERWRITE",t[t.MERGE=1]="MERGE",t[t.ACK_USER_WRITE=2]="ACK_USER_WRITE",t[t.LISTEN_COMPLETE=3]="LISTEN_COMPLETE"}(te||(te={}));var ge,ve,ye=function(){function t(t,e,n,r){this.fromUser=t,this.fromServer=e,this.queryId=n,this.tagged=r,v.assert(!r||e,"Tagged queries must be from server.")}return t.User=new t(!0,!1,null,!1),t.Server=new t(!1,!0,null,!1),t.forServerTaggedQuery=function(e){return new t(!1,!0,e,!0)},t}(),_e=function(){function t(t,e,n){this.path=t,this.affectedTree=e,this.revert=n,this.type=te.ACK_USER_WRITE,this.source=ye.User}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){if(null!=this.affectedTree.value)return v.assert(this.affectedTree.children.isEmpty(),"affectedTree should not have overlapping affected paths."),this;var n=this.affectedTree.subtree(new it(e));return new t(it.Empty,n,this.revert)}return v.assert(this.path.getFront()===e,"operationForChild called for unrelated child."),new t(this.path.popFront(),this.affectedTree,this.revert)},t}(),be=function(){return ge||(ge=new Gt(z)),ge},we=function(){function t(t,e){void 0===e&&(e=be()),this.value=t,this.children=e}return t.fromObject=function(e){var n=t.Empty;return v.forEach(e,function(t,e){n=n.set(new it(t),e)}),n},t.prototype.isEmpty=function(){return null===this.value&&this.children.isEmpty()},t.prototype.findRootMostMatchingPathAndValue=function(t,e){if(null!=this.value&&e(this.value))return{path:it.Empty,value:this.value};if(t.isEmpty())return null;var n=t.getFront(),r=this.children.get(n);if(null!==r){var i=r.findRootMostMatchingPathAndValue(t.popFront(),e);if(null!=i){return{path:new it(n).child(i.path),value:i.value}}return null}return null},t.prototype.findRootMostValueAndPath=function(t){return this.findRootMostMatchingPathAndValue(t,function(){return!0})},t.prototype.subtree=function(e){if(e.isEmpty())return this;var n=e.getFront(),r=this.children.get(n);return null!==r?r.subtree(e.popFront()):t.Empty},t.prototype.set=function(e,n){if(e.isEmpty())return new t(n,this.children);var r=e.getFront(),i=this.children.get(r)||t.Empty,o=i.set(e.popFront(),n),a=this.children.insert(r,o);return new t(this.value,a)},t.prototype.remove=function(e){if(e.isEmpty())return this.children.isEmpty()?t.Empty:new t(null,this.children);var n=e.getFront(),r=this.children.get(n);if(r){var i=r.remove(e.popFront()),o=void 0;return o=i.isEmpty()?this.children.remove(n):this.children.insert(n,i),null===this.value&&o.isEmpty()?t.Empty:new t(this.value,o)}return this},t.prototype.get=function(t){if(t.isEmpty())return this.value;var e=t.getFront(),n=this.children.get(e);return n?n.get(t.popFront()):null},t.prototype.setTree=function(e,n){if(e.isEmpty())return n;var r=e.getFront(),i=this.children.get(r)||t.Empty,o=i.setTree(e.popFront(),n),a=void 0;return a=o.isEmpty()?this.children.remove(r):this.children.insert(r,o),new t(this.value,a)},t.prototype.fold=function(t){return this.fold_(it.Empty,t)},t.prototype.fold_=function(t,e){var n={};return this.children.inorderTraversal(function(r,i){n[r]=i.fold_(t.child(r),e)}),e(t,this.value,n)},t.prototype.findOnPath=function(t,e){return this.findOnPath_(t,it.Empty,e)},t.prototype.findOnPath_=function(t,e,n){var r=!!this.value&&n(e,this.value);if(r)return r;if(t.isEmpty())return null;var i=t.getFront(),o=this.children.get(i);return o?o.findOnPath_(t.popFront(),e.child(i),n):null},t.prototype.foreachOnPath=function(t,e){return this.foreachOnPath_(t,it.Empty,e)},t.prototype.foreachOnPath_=function(e,n,r){if(e.isEmpty())return this;this.value&&r(n,this.value);var i=e.getFront(),o=this.children.get(i);return o?o.foreachOnPath_(e.popFront(),n.child(i),r):t.Empty},t.prototype.foreach=function(t){this.foreach_(it.Empty,t)},t.prototype.foreach_=function(t,e){this.children.inorderTraversal(function(n,r){r.foreach_(t.child(n),e)}),this.value&&e(t,this.value)},t.prototype.foreachChild=function(t){this.children.inorderTraversal(function(e,n){n.value&&t(e,n.value)})},t.Empty=new t(null),t}(),Ee=function(){function t(t,e){this.source=t,this.path=e,this.type=te.LISTEN_COMPLETE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,it.Empty):new t(this.source,this.path.popFront())},t}(),xe=function(){function t(t,e,n){this.source=t,this.path=e,this.snap=n,this.type=te.OVERWRITE}return t.prototype.operationForChild=function(e){return this.path.isEmpty()?new t(this.source,it.Empty,this.snap.getImmediateChild(e)):new t(this.source,this.path.popFront(),this.snap)},t}(),Te=function(){function t(t,e,n){this.source=t,this.path=e,this.children=n,this.type=te.MERGE}return t.prototype.operationForChild=function(e){if(this.path.isEmpty()){var n=this.children.subtree(new it(e));return n.isEmpty()?null:n.value?new xe(this.source,it.Empty,n.value):new t(this.source,it.Empty,n)}return v.assert(this.path.getFront()===e,"Can't get a merge for a child not on the path of the operation"),new t(this.source,this.path.popFront(),this.children)},t.prototype.toString=function(){return"Operation("+this.path+": "+this.source.toString()+" merge: "+this.children.toString()+")"},t}(),Se=function(){function t(t,e,n){this.node_=t,this.fullyInitialized_=e,this.filtered_=n}return t.prototype.isFullyInitialized=function(){return this.fullyInitialized_},t.prototype.isFiltered=function(){return this.filtered_},t.prototype.isCompleteForPath=function(t){if(t.isEmpty())return this.isFullyInitialized()&&!this.filtered_;var e=t.getFront();return this.isCompleteForChild(e)},t.prototype.isCompleteForChild=function(t){return this.isFullyInitialized()&&!this.filtered_||this.node_.hasChild(t)},t.prototype.getNode=function(){return this.node_},t}(),Ce=function(){function t(t,e){this.eventCache_=t,this.serverCache_=e}return t.prototype.updateEventSnap=function(e,n,r){return new t(new Se(e,n,r),this.serverCache_)},t.prototype.updateServerSnap=function(e,n,r){return new t(this.eventCache_,new Se(e,n,r))},t.prototype.getEventCache=function(){return this.eventCache_},t.prototype.getCompleteEventSnap=function(){return this.eventCache_.isFullyInitialized()?this.eventCache_.getNode():null},t.prototype.getServerCache=function(){return this.serverCache_},t.prototype.getCompleteServerSnap=function(){return this.serverCache_.isFullyInitialized()?this.serverCache_.getNode():null},t.Empty=new t(new Se(Qt.EMPTY_NODE,!1,!1),new Se(Qt.EMPTY_NODE,!1,!1)),t}(),Me=function(){function t(t,e,n,r,i){this.type=t,this.snapshotNode=e,this.childName=n,this.oldSnap=r,this.prevName=i}return t.valueChange=function(e){return new t(t.VALUE,e)},t.childAddedChange=function(e,n){return new t(t.CHILD_ADDED,n,e)},t.childRemovedChange=function(e,n){return new t(t.CHILD_REMOVED,n,e)},t.childChangedChange=function(e,n,r){return new t(t.CHILD_CHANGED,n,e,r)},t.childMovedChange=function(e,n){return new t(t.CHILD_MOVED,n,e)},t.CHILD_ADDED="child_added",t.CHILD_REMOVED="child_removed",t.CHILD_CHANGED="child_changed",t.CHILD_MOVED="child_moved",t.VALUE="value",t}(),Ae=function(){function t(t){this.index_=t}return t.prototype.updateChild=function(t,e,n,r,i,o){v.assert(t.isIndexed(this.index_),"A node must be indexed if only a child is updated");var a=t.getImmediateChild(e);return a.getChild(r).equals(n.getChild(r))&&a.isEmpty()==n.isEmpty()?t:(null!=o&&(n.isEmpty()?t.hasChild(e)?o.trackChildChange(Me.childRemovedChange(e,a)):v.assert(t.isLeafNode(),"A child remove without an old child only makes sense on a leaf node"):a.isEmpty()?o.trackChildChange(Me.childAddedChange(e,n)):o.trackChildChange(Me.childChangedChange(e,n,a))),t.isLeafNode()&&n.isEmpty()?t:t.updateImmediateChild(e,n).withIndex(this.index_))},t.prototype.updateFullNode=function(t,e,n){return null!=n&&(t.isLeafNode()||t.forEachChild(Bt,function(t,r){e.hasChild(t)||n.trackChildChange(Me.childRemovedChange(t,r))}),e.isLeafNode()||e.forEachChild(Bt,function(e,r){if(t.hasChild(e)){var i=t.getImmediateChild(e);i.equals(r)||n.trackChildChange(Me.childChangedChange(e,r,i))}else n.trackChildChange(Me.childAddedChange(e,r))})),e.withIndex(this.index_)},t.prototype.updatePriority=function(t,e){return t.isEmpty()?Qt.EMPTY_NODE:t.updatePriority(e)},t.prototype.filtersNodes=function(){return!1},t.prototype.getIndexedFilter=function(){return this},t.prototype.getIndex=function(){return this.index_},t}(),Ie=function(){function t(){this.changeMap_={}}return t.prototype.trackChildChange=function(t){var e=t.type,n=t.childName;v.assert(e==Me.CHILD_ADDED||e==Me.CHILD_CHANGED||e==Me.CHILD_REMOVED,"Only child changes supported for tracking"),v.assert(".priority"!==n,"Only non-priority child changes can be tracked.");var r=v.safeGet(this.changeMap_,n);if(r){var i=r.type;if(e==Me.CHILD_ADDED&&i==Me.CHILD_REMOVED)this.changeMap_[n]=Me.childChangedChange(n,t.snapshotNode,r.snapshotNode);else if(e==Me.CHILD_REMOVED&&i==Me.CHILD_ADDED)delete this.changeMap_[n];else if(e==Me.CHILD_REMOVED&&i==Me.CHILD_CHANGED)this.changeMap_[n]=Me.childRemovedChange(n,r.oldSnap);else if(e==Me.CHILD_CHANGED&&i==Me.CHILD_ADDED)this.changeMap_[n]=Me.childAddedChange(n,t.snapshotNode);else{if(e!=Me.CHILD_CHANGED||i!=Me.CHILD_CHANGED)throw v.assertionError("Illegal combination of changes: "+t+" occurred after "+r);this.changeMap_[n]=Me.childChangedChange(n,t.snapshotNode,r.oldSnap)}}else this.changeMap_[n]=t},t.prototype.getChanges=function(){return v.getValues(this.changeMap_)},t}(),Re=function(){function t(){}return t.prototype.getCompleteChild=function(t){return null},t.prototype.getChildAfterChild=function(t,e,n){return null},t}(),Pe=new Re,Ne=function(){function t(t,e,n){void 0===n&&(n=null),this.writes_=t,this.viewCache_=e,this.optCompleteServerCache_=n}return t.prototype.getCompleteChild=function(t){var e=this.viewCache_.getEventCache();if(e.isCompleteForChild(t))return e.getNode().getImmediateChild(t);var n=null!=this.optCompleteServerCache_?new Se(this.optCompleteServerCache_,!0,!1):this.viewCache_.getServerCache();return this.writes_.calcCompleteChild(t,n)},t.prototype.getChildAfterChild=function(t,e,n){var r=null!=this.optCompleteServerCache_?this.optCompleteServerCache_:this.viewCache_.getCompleteServerSnap(),i=this.writes_.calcIndexedSlice(r,e,1,n,t);return 0===i.length?null:i[0]},t}(),De=function(){function t(t,e){this.viewCache=t,this.changes=e}return t}(),Oe=function(){function t(t){this.filter_=t}return t.prototype.assertIndexed=function(t){v.assert(t.getEventCache().getNode().isIndexed(this.filter_.getIndex()),"Event snap not indexed"),v.assert(t.getServerCache().getNode().isIndexed(this.filter_.getIndex()),"Server snap not indexed")},t.prototype.applyOperation=function(e,n,r,i){var o,a,s=new Ie;if(n.type===te.OVERWRITE){var u=n;u.source.fromUser?o=this.applyUserOverwrite_(e,u.path,u.snap,r,i,s):(v.assert(u.source.fromServer,"Unknown source."),a=u.source.tagged||e.getServerCache().isFiltered()&&!u.path.isEmpty(),o=this.applyServerOverwrite_(e,u.path,u.snap,r,i,a,s))}else if(n.type===te.MERGE){var c=n;c.source.fromUser?o=this.applyUserMerge_(e,c.path,c.children,r,i,s):(v.assert(c.source.fromServer,"Unknown source."),a=c.source.tagged||e.getServerCache().isFiltered(),o=this.applyServerMerge_(e,c.path,c.children,r,i,a,s))}else if(n.type===te.ACK_USER_WRITE){var l=n;o=l.revert?this.revertUserWrite_(e,l.path,r,i,s):this.ackUserWrite_(e,l.path,l.affectedTree,r,i,s)}else{if(n.type!==te.LISTEN_COMPLETE)throw v.assertionError("Unknown operation type: "+n.type);o=this.listenComplete_(e,n.path,r,s)}var h=s.getChanges();return t.maybeAddValueEvent_(e,o,h),new De(o,h)},t.maybeAddValueEvent_=function(t,e,n){var r=e.getEventCache();if(r.isFullyInitialized()){var i=r.getNode().isLeafNode()||r.getNode().isEmpty(),o=t.getCompleteEventSnap();(n.length>0||!t.getEventCache().isFullyInitialized()||i&&!r.getNode().equals(o)||!r.getNode().getPriority().equals(o.getPriority()))&&n.push(Me.valueChange(e.getCompleteEventSnap()))}},t.prototype.generateEventCacheAfterServerEvent_=function(t,e,n,r,i){var o=t.getEventCache();if(null!=n.shadowingWrite(e))return t;var a=void 0,s=void 0;if(e.isEmpty())if(v.assert(t.getServerCache().isFullyInitialized(),"If change path is empty, we must have complete server data"),t.getServerCache().isFiltered()){var u=t.getCompleteServerSnap(),c=u instanceof Qt?u:Qt.EMPTY_NODE,l=n.calcCompleteEventChildren(c);a=this.filter_.updateFullNode(t.getEventCache().getNode(),l,i)}else{var h=n.calcCompleteEventCache(t.getCompleteServerSnap());a=this.filter_.updateFullNode(t.getEventCache().getNode(),h,i)}else{var f=e.getFront();if(".priority"==f){v.assert(1==e.getLength(),"Can't have a priority with additional path components");var d=o.getNode();s=t.getServerCache().getNode();var p=n.calcEventCacheAfterServerOverwrite(e,d,s);a=null!=p?this.filter_.updatePriority(d,p):o.getNode()}else{var m=e.popFront(),g=void 0;if(o.isCompleteForChild(f)){s=t.getServerCache().getNode();var y=n.calcEventCacheAfterServerOverwrite(e,o.getNode(),s);g=null!=y?o.getNode().getImmediateChild(f).updateChild(m,y):o.getNode().getImmediateChild(f)}else g=n.calcCompleteChild(f,t.getServerCache());a=null!=g?this.filter_.updateChild(o.getNode(),f,g,m,r,i):o.getNode()}}return t.updateEventSnap(a,o.isFullyInitialized()||e.isEmpty(),this.filter_.filtersNodes())},t.prototype.applyServerOverwrite_=function(t,e,n,r,i,o,a){var s,u=t.getServerCache(),c=o?this.filter_:this.filter_.getIndexedFilter();if(e.isEmpty())s=c.updateFullNode(u.getNode(),n,null);else if(c.filtersNodes()&&!u.isFiltered()){var l=u.getNode().updateChild(e,n);s=c.updateFullNode(u.getNode(),l,null)}else{var h=e.getFront();if(!u.isCompleteForPath(e)&&e.getLength()>1)return t;var f=e.popFront(),d=u.getNode().getImmediateChild(h),p=d.updateChild(f,n);s=".priority"==h?c.updatePriority(u.getNode(),p):c.updateChild(u.getNode(),h,p,f,Pe,null)}var m=t.updateServerSnap(s,u.isFullyInitialized()||e.isEmpty(),c.filtersNodes()),g=new Ne(r,m,i);return this.generateEventCacheAfterServerEvent_(m,e,r,g,a)},t.prototype.applyUserOverwrite_=function(t,e,n,r,i,o){var a,s,u=t.getEventCache(),c=new Ne(r,t,i);if(e.isEmpty())s=this.filter_.updateFullNode(t.getEventCache().getNode(),n,o),a=t.updateEventSnap(s,!0,this.filter_.filtersNodes());else{var l=e.getFront();if(".priority"===l)s=this.filter_.updatePriority(t.getEventCache().getNode(),n),a=t.updateEventSnap(s,u.isFullyInitialized(),u.isFiltered());else{var h=e.popFront(),f=u.getNode().getImmediateChild(l),d=void 0;if(h.isEmpty())d=n;else{var p=c.getCompleteChild(l);d=null!=p?".priority"===h.getBack()&&p.getChild(h.parent()).isEmpty()?p:p.updateChild(h,n):Qt.EMPTY_NODE}if(f.equals(d))a=t;else{var m=this.filter_.updateChild(u.getNode(),l,d,h,c,o);a=t.updateEventSnap(m,u.isFullyInitialized(),this.filter_.filtersNodes())}}}return a},t.cacheHasChild_=function(t,e){return t.getEventCache().isCompleteForChild(e)},t.prototype.applyUserMerge_=function(e,n,r,i,o,a){var s=this,u=e;return r.foreach(function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())&&(u=s.applyUserOverwrite_(u,l,c,i,o,a))}),r.foreach(function(r,c){var l=n.child(r);t.cacheHasChild_(e,l.getFront())||(u=s.applyUserOverwrite_(u,l,c,i,o,a))}),u},t.prototype.applyMerge_=function(t,e){return e.foreach(function(e,n){t=t.updateChild(e,n)}),t},t.prototype.applyServerMerge_=function(t,e,n,r,i,o,a){var s=this;if(t.getServerCache().getNode().isEmpty()&&!t.getServerCache().isFullyInitialized())return t;var u,c=t;u=e.isEmpty()?n:we.Empty.setTree(e,n);var l=t.getServerCache().getNode();return u.children.inorderTraversal(function(e,n){if(l.hasChild(e)){var u=t.getServerCache().getNode().getImmediateChild(e),h=s.applyMerge_(u,n);c=s.applyServerOverwrite_(c,new it(e),h,r,i,o,a)}}),u.children.inorderTraversal(function(e,n){var u=!t.getServerCache().isCompleteForChild(e)&&null==n.value;if(!l.hasChild(e)&&!u){var h=t.getServerCache().getNode().getImmediateChild(e),f=s.applyMerge_(h,n);c=s.applyServerOverwrite_(c,new it(e),f,r,i,o,a)}}),c},t.prototype.ackUserWrite_=function(t,e,n,r,i,o){if(null!=r.shadowingWrite(e))return t;var a=t.getServerCache().isFiltered(),s=t.getServerCache();if(null!=n.value){if(e.isEmpty()&&s.isFullyInitialized()||s.isCompleteForPath(e))return this.applyServerOverwrite_(t,e,s.getNode().getChild(e),r,i,a,o);if(e.isEmpty()){var u=we.Empty;return s.getNode().forEachChild(Ot,function(t,e){u=u.set(new it(t),e)}),this.applyServerMerge_(t,e,u,r,i,a,o)}return t}var c=we.Empty;return n.foreach(function(t,n){var r=e.child(t);s.isCompleteForPath(r)&&(c=c.set(t,s.getNode().getChild(r)))}),this.applyServerMerge_(t,e,c,r,i,a,o)},t.prototype.listenComplete_=function(t,e,n,r){var i=t.getServerCache(),o=t.updateServerSnap(i.getNode(),i.isFullyInitialized()||e.isEmpty(),i.isFiltered());return this.generateEventCacheAfterServerEvent_(o,e,n,Pe,r)},t.prototype.revertUserWrite_=function(t,e,n,r,i){var o;if(null!=n.shadowingWrite(e))return t;var a=new Ne(n,t,r),s=t.getEventCache().getNode(),u=void 0;if(e.isEmpty()||".priority"===e.getFront()){var c=void 0;if(t.getServerCache().isFullyInitialized())c=n.calcCompleteEventCache(t.getCompleteServerSnap());else{var l=t.getServerCache().getNode();v.assert(l instanceof Qt,"serverChildren would be complete if leaf node"),c=n.calcCompleteEventChildren(l)}c=c,u=this.filter_.updateFullNode(s,c,i)}else{var h=e.getFront(),f=n.calcCompleteChild(h,t.getServerCache());null==f&&t.getServerCache().isCompleteForChild(h)&&(f=s.getImmediateChild(h)),u=null!=f?this.filter_.updateChild(s,h,f,e.popFront(),a,i):t.getEventCache().getNode().hasChild(h)?this.filter_.updateChild(s,h,Qt.EMPTY_NODE,e.popFront(),a,i):s,u.isEmpty()&&t.getServerCache().isFullyInitialized()&&(o=n.calcCompleteEventCache(t.getCompleteServerSnap()),o.isLeafNode()&&(u=this.filter_.updateFullNode(u,o,i)))}return o=t.getServerCache().isFullyInitialized()||null!=n.shadowingWrite(it.Empty),t.updateEventSnap(u,o,this.filter_.filtersNodes())},t}(),ke=function(){function t(t){this.query_=t,this.index_=this.query_.getQueryParams().getIndex()}return t.prototype.generateEventsForChanges=function(t,e,n){var r=this,i=[],o=[];return t.forEach(function(t){t.type===Me.CHILD_CHANGED&&r.index_.indexedValueChanged(t.oldSnap,t.snapshotNode)&&o.push(Me.childMovedChange(t.childName,t.snapshotNode))}),this.generateEventsForType_(i,Me.CHILD_REMOVED,t,n,e),this.generateEventsForType_(i,Me.CHILD_ADDED,t,n,e),this.generateEventsForType_(i,Me.CHILD_MOVED,o,n,e),this.generateEventsForType_(i,Me.CHILD_CHANGED,t,n,e),this.generateEventsForType_(i,Me.VALUE,t,n,e),i},t.prototype.generateEventsForType_=function(t,e,n,r,i){var o=this,a=n.filter(function(t){return t.type===e});a.sort(this.compareChanges_.bind(this)),a.forEach(function(e){var n=o.materializeSingleChange_(e,i);r.forEach(function(r){r.respondsTo(e.type)&&t.push(r.createEvent(n,o.query_))})})},t.prototype.materializeSingleChange_=function(t,e){return"value"===t.type||"child_removed"===t.type?t:(t.prevName=e.getPredecessorChildName(t.childName,t.snapshotNode,this.index_),t)},t.prototype.compareChanges_=function(t,e){if(null==t.childName||null==e.childName)throw v.assertionError("Should only compare child_ events.");var n=new Pt(t.childName,t.snapshotNode),r=new Pt(e.childName,e.snapshotNode);return this.index_.compare(n,r)},t}(),Le=function(){function t(t,e){this.query_=t,this.eventRegistrations_=[];var n=this.query_.getQueryParams(),r=new Ae(n.getIndex()),i=n.getNodeFilter();this.processor_=new Oe(i);var o=e.getServerCache(),a=e.getEventCache(),s=r.updateFullNode(Qt.EMPTY_NODE,o.getNode(),null),u=i.updateFullNode(Qt.EMPTY_NODE,a.getNode(),null),c=new Se(s,o.isFullyInitialized(),r.filtersNodes()),l=new Se(u,a.isFullyInitialized(),i.filtersNodes());this.viewCache_=new Ce(l,c),this.eventGenerator_=new ke(this.query_)}return t.prototype.getQuery=function(){return this.query_},t.prototype.getServerCache=function(){return this.viewCache_.getServerCache().getNode()},t.prototype.getCompleteServerCache=function(t){var e=this.viewCache_.getCompleteServerSnap();return e&&(this.query_.getQueryParams().loadsAllData()||!t.isEmpty()&&!e.getImmediateChild(t.getFront()).isEmpty())?e.getChild(t):null},t.prototype.isEmpty=function(){return 0===this.eventRegistrations_.length},t.prototype.addEventRegistration=function(t){this.eventRegistrations_.push(t)},t.prototype.removeEventRegistration=function(t,e){var n=[];if(e){v.assert(null==t,"A cancel should cancel all event registrations.");var r=this.query_.path;this.eventRegistrations_.forEach(function(t){e=e;var i=t.createCancelEvent(e,r);i&&n.push(i)})}if(t){for(var i=[],o=0;o<this.eventRegistrations_.length;++o){var a=this.eventRegistrations_[o];if(a.matches(t)){if(t.hasAnyCallback()){i=i.concat(this.eventRegistrations_.slice(o+1));break}}else i.push(a)}this.eventRegistrations_=i}else this.eventRegistrations_=[];return n},t.prototype.applyOperation=function(t,e,n){t.type===te.MERGE&&null!==t.source.queryId&&(v.assert(this.viewCache_.getCompleteServerSnap(),"We should always have a full cache before handling merges"),v.assert(this.viewCache_.getCompleteEventSnap(),"Missing event cache, even though we have a server cache"));var r=this.viewCache_,i=this.processor_.applyOperation(r,t,e,n);return this.processor_.assertIndexed(i.viewCache),v.assert(i.viewCache.getServerCache().isFullyInitialized()||!r.getServerCache().isFullyInitialized(),"Once a server snap is complete, it should never go back"),this.viewCache_=i.viewCache,this.generateEventsForChanges_(i.changes,i.viewCache.getEventCache().getNode(),null)},t.prototype.getInitialEvents=function(t){var e=this.viewCache_.getEventCache(),n=[];if(!e.getNode().isLeafNode()){e.getNode().forEachChild(Bt,function(t,e){n.push(Me.childAddedChange(t,e))})}return e.isFullyInitialized()&&n.push(Me.valueChange(e.getNode())),this.generateEventsForChanges_(n,e.getNode(),t)},t.prototype.generateEventsForChanges_=function(t,e,n){var r=n?[n]:this.eventRegistrations_;return this.eventGenerator_.generateEventsForChanges(t,e,r)},t}(),Ue=function(){function t(){this.views_={}}return Object.defineProperty(t,"__referenceConstructor",{get:function(){return v.assert(ve,"Reference.ts has not been loaded"),ve},set:function(t){v.assert(!ve,"__referenceConstructor has already been defined"),ve=t},enumerable:!0,configurable:!0}),t.prototype.isEmpty=function(){return v.isEmpty(this.views_)},t.prototype.applyOperation=function(t,e,n){var r=t.source.queryId;if(null!==r){var i=v.safeGet(this.views_,r);return v.assert(null!=i,"SyncTree gave us an op for an invalid query."),i.applyOperation(t,e,n)}var o=[];return v.forEach(this.views_,function(r,i){o=o.concat(i.applyOperation(t,e,n))}),o},t.prototype.addEventRegistration=function(t,e,n,r,i){var o=t.queryIdentifier(),a=v.safeGet(this.views_,o);if(!a){var s=n.calcCompleteEventCache(i?r:null),u=!1;s?u=!0:r instanceof Qt?(s=n.calcCompleteEventChildren(r),u=!1):(s=Qt.EMPTY_NODE,u=!1);var c=new Ce(new Se(s,u,!1),new Se(r,i,!1));a=new Le(t,c),this.views_[o]=a}return a.addEventRegistration(e),a.getInitialEvents(e)},t.prototype.removeEventRegistration=function(e,n,r){var i=e.queryIdentifier(),o=[],a=[],s=this.hasCompleteView();if("default"===i){var u=this;v.forEach(this.views_,function(t,e){a=a.concat(e.removeEventRegistration(n,r)),e.isEmpty()&&(delete u.views_[t],e.getQuery().getQueryParams().loadsAllData()||o.push(e.getQuery()))})}else{var c=v.safeGet(this.views_,i);c&&(a=a.concat(c.removeEventRegistration(n,r)),c.isEmpty()&&(delete this.views_[i],c.getQuery().getQueryParams().loadsAllData()||o.push(c.getQuery())))}return s&&!this.hasCompleteView()&&o.push(new t.__referenceConstructor(e.repo,e.path)),{removed:o,events:a}},t.prototype.getQueryViews=function(){var t=this;return Object.keys(this.views_).map(function(e){return t.views_[e]}).filter(function(t){return!t.getQuery().getQueryParams().loadsAllData()})},t.prototype.getCompleteServerCache=function(t){var e=null;return v.forEach(this.views_,function(n,r){e=e||r.getCompleteServerCache(t)}),e},t.prototype.viewForQuery=function(t){if(t.getQueryParams().loadsAllData())return this.getCompleteView();var e=t.queryIdentifier();return v.safeGet(this.views_,e)},t.prototype.viewExistsForQuery=function(t){return null!=this.viewForQuery(t)},t.prototype.hasCompleteView=function(){return null!=this.getCompleteView()},t.prototype.getCompleteView=function(){return v.findValue(this.views_,function(t){return t.getQuery().getQueryParams().loadsAllData()})||null},t}(),Fe=function(){function t(t){this.writeTree_=t}return t.prototype.addWrite=function(e,n){if(e.isEmpty())return new t(new we(n));var r=this.writeTree_.findRootMostValueAndPath(e);if(null!=r){var i=r.path,o=r.value,a=it.relativePath(i,e);return o=o.updateChild(a,n),new t(this.writeTree_.set(i,o))}var s=new we(n);return new t(this.writeTree_.setTree(e,s))},t.prototype.addWrites=function(t,e){var n=this;return v.forEach(e,function(e,r){n=n.addWrite(t.child(e),r)}),n},t.prototype.removeWrite=function(e){return e.isEmpty()?t.Empty:new t(this.writeTree_.setTree(e,we.Empty))},t.prototype.hasCompleteWrite=function(t){return null!=this.getCompleteNode(t)},t.prototype.getCompleteNode=function(t){var e=this.writeTree_.findRootMostValueAndPath(t);return null!=e?this.writeTree_.get(e.path).getChild(it.relativePath(e.path,t)):null},t.prototype.getCompleteChildren=function(){var t=[],e=this.writeTree_.value;return null!=e?e.isLeafNode()||e.forEachChild(Bt,function(e,n){t.push(new Pt(e,n))}):this.writeTree_.children.inorderTraversal(function(e,n){null!=n.value&&t.push(new Pt(e,n.value))}),t},t.prototype.childCompoundWrite=function(e){if(e.isEmpty())return this;var n=this.getCompleteNode(e);return new t(null!=n?new we(n):this.writeTree_.subtree(e))},t.prototype.isEmpty=function(){return this.writeTree_.isEmpty()},t.prototype.apply=function(e){return t.applySubtreeWrite_(it.Empty,this.writeTree_,e)},t.Empty=new t(new we(null)),t.applySubtreeWrite_=function(e,n,r){if(null!=n.value)return r.updateChild(e,n.value);var i=null;return n.children.inorderTraversal(function(n,o){".priority"===n?(v.assert(null!==o.value,"Priority writes must always be leaf nodes"),i=o.value):r=t.applySubtreeWrite_(e.child(n),o,r)}),r.getChild(e).isEmpty()||null===i||(r=r.updateChild(e.child(".priority"),i)),r},t}(),Be=function(){function t(){this.visibleWrites_=Fe.Empty,this.allWrites_=[],this.lastWriteId_=-1}return t.prototype.childWrites=function(t){return new Ve(t,this)},t.prototype.addOverwrite=function(t,e,n,r){v.assert(n>this.lastWriteId_,"Stacking an older write on top of newer ones"),void 0===r&&(r=!0),this.allWrites_.push({path:t,snap:e,writeId:n,visible:r}),r&&(this.visibleWrites_=this.visibleWrites_.addWrite(t,e)),this.lastWriteId_=n},t.prototype.addMerge=function(t,e,n){v.assert(n>this.lastWriteId_,"Stacking an older merge on top of newer ones"),this.allWrites_.push({path:t,children:e,writeId:n,visible:!0}),this.visibleWrites_=this.visibleWrites_.addWrites(t,e),this.lastWriteId_=n},t.prototype.getWrite=function(t){for(var e=0;e<this.allWrites_.length;e++){var n=this.allWrites_[e];if(n.writeId===t)return n}return null},t.prototype.removeWrite=function(t){var e=this,n=this.allWrites_.findIndex(function(e){return e.writeId===t});v.assert(n>=0,"removeWrite called with nonexistent writeId.");var r=this.allWrites_[n];this.allWrites_.splice(n,1);for(var i=r.visible,o=!1,a=this.allWrites_.length-1;i&&a>=0;){var s=this.allWrites_[a];s.visible&&(a>=n&&this.recordContainsPath_(s,r.path)?i=!1:r.path.contains(s.path)&&(o=!0)),a--}if(i){if(o)return this.resetTree_(),!0;if(r.snap)this.visibleWrites_=this.visibleWrites_.removeWrite(r.path);else{var u=r.children;v.forEach(u,function(t){e.visibleWrites_=e.visibleWrites_.removeWrite(r.path.child(t))})}return!0}return!1},t.prototype.getCompleteWriteData=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcCompleteEventCache=function(e,n,r,i){if(r||i){var o=this.visibleWrites_.childCompoundWrite(e);if(!i&&o.isEmpty())return n;if(i||null!=n||o.hasCompleteWrite(it.Empty)){var a=function(t){return(t.visible||i)&&(!r||!~r.indexOf(t.writeId))&&(t.path.contains(e)||e.contains(t.path))},s=t.layerTree_(this.allWrites_,a,e),u=n||Qt.EMPTY_NODE;return s.apply(u)}return null}var c=this.visibleWrites_.getCompleteNode(e);if(null!=c)return c;var l=this.visibleWrites_.childCompoundWrite(e);if(l.isEmpty())return n;if(null!=n||l.hasCompleteWrite(it.Empty)){var u=n||Qt.EMPTY_NODE;return l.apply(u)}return null},t.prototype.calcCompleteEventChildren=function(t,e){var n=Qt.EMPTY_NODE,r=this.visibleWrites_.getCompleteNode(t);if(r)return r.isLeafNode()||r.forEachChild(Bt,function(t,e){n=n.updateImmediateChild(t,e)}),n;if(e){var i=this.visibleWrites_.childCompoundWrite(t);return e.forEachChild(Bt,function(t,e){var r=i.childCompoundWrite(new it(t)).apply(e);n=n.updateImmediateChild(t,r)}),i.getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n}return this.visibleWrites_.childCompoundWrite(t).getCompleteChildren().forEach(function(t){n=n.updateImmediateChild(t.name,t.node)}),n},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n,r){v.assert(n||r,"Either existingEventSnap or existingServerSnap must exist");var i=t.child(e);if(this.visibleWrites_.hasCompleteWrite(i))return null;var o=this.visibleWrites_.childCompoundWrite(i);return o.isEmpty()?r.getChild(e):o.apply(r.getChild(e))},t.prototype.calcCompleteChild=function(t,e,n){var r=t.child(e),i=this.visibleWrites_.getCompleteNode(r);if(null!=i)return i;if(n.isCompleteForChild(e)){return this.visibleWrites_.childCompoundWrite(r).apply(n.getNode().getImmediateChild(e))}return null},t.prototype.shadowingWrite=function(t){return this.visibleWrites_.getCompleteNode(t)},t.prototype.calcIndexedSlice=function(t,e,n,r,i,o){var a,s=this.visibleWrites_.childCompoundWrite(t),u=s.getCompleteNode(it.Empty);if(null!=u)a=u;else{if(null==e)return[];a=s.apply(e)}if(a=a.withIndex(o),a.isEmpty()||a.isLeafNode())return[];for(var c=[],l=o.getCompare(),h=i?a.getReverseIteratorFrom(n,o):a.getIteratorFrom(n,o),f=h.getNext();f&&c.length<r;)0!==l(f,n)&&c.push(f),f=h.getNext();return c},t.prototype.recordContainsPath_=function(t,e){return t.snap?t.path.contains(e):!!v.findKey(t.children,function(n,r){return t.path.child(r).contains(e)})},t.prototype.resetTree_=function(){this.visibleWrites_=t.layerTree_(this.allWrites_,t.DefaultFilter_,it.Empty),this.allWrites_.length>0?this.lastWriteId_=this.allWrites_[this.allWrites_.length-1].writeId:this.lastWriteId_=-1},t.DefaultFilter_=function(t){return t.visible},t.layerTree_=function(t,e,n){for(var r=Fe.Empty,i=0;i<t.length;++i){var o=t[i];if(e(o)){var a=o.path,s=void 0;if(o.snap)n.contains(a)?(s=it.relativePath(n,a),r=r.addWrite(s,o.snap)):a.contains(n)&&(s=it.relativePath(a,n),r=r.addWrite(it.Empty,o.snap.getChild(s)));else{if(!o.children)throw v.assertionError("WriteRecord should have .snap or .children");if(n.contains(a))s=it.relativePath(n,a),r=r.addWrites(s,o.children);else if(a.contains(n))if(s=it.relativePath(a,n),s.isEmpty())r=r.addWrites(it.Empty,o.children);else{var u=v.safeGet(o.children,s.getFront());if(u){var c=u.getChild(s.popFront());r=r.addWrite(it.Empty,c)}}}}}return r},t}(),Ve=function(){function t(t,e){this.treePath_=t,this.writeTree_=e}return t.prototype.calcCompleteEventCache=function(t,e,n){return this.writeTree_.calcCompleteEventCache(this.treePath_,t,e,n)},t.prototype.calcCompleteEventChildren=function(t){return this.writeTree_.calcCompleteEventChildren(this.treePath_,t)},t.prototype.calcEventCacheAfterServerOverwrite=function(t,e,n){return this.writeTree_.calcEventCacheAfterServerOverwrite(this.treePath_,t,e,n)},t.prototype.shadowingWrite=function(t){return this.writeTree_.shadowingWrite(this.treePath_.child(t))},t.prototype.calcIndexedSlice=function(t,e,n,r,i){return this.writeTree_.calcIndexedSlice(this.treePath_,t,e,n,r,i)},t.prototype.calcCompleteChild=function(t,e){return this.writeTree_.calcCompleteChild(this.treePath_,t,e)},t.prototype.child=function(e){return new t(this.treePath_.child(e),this.writeTree_)},t}(),je=function(){function t(t){this.listenProvider_=t,this.syncPointTree_=we.Empty,this.pendingWriteTree_=new Be,this.tagToQueryMap_={},this.queryToTagMap_={}}return t.prototype.applyUserOverwrite=function(t,e,n,r){return this.pendingWriteTree_.addOverwrite(t,e,n,r),r?this.applyOperationToSyncPoints_(new xe(ye.User,t,e)):[]},t.prototype.applyUserMerge=function(t,e,n){this.pendingWriteTree_.addMerge(t,e,n);var r=we.fromObject(e);return this.applyOperationToSyncPoints_(new Te(ye.User,t,r))},t.prototype.ackUserWrite=function(t,e){void 0===e&&(e=!1);var n=this.pendingWriteTree_.getWrite(t);if(this.pendingWriteTree_.removeWrite(t)){var r=we.Empty;return null!=n.snap?r=r.set(it.Empty,!0):v.forEach(n.children,function(t,e){r=r.set(new it(t),e)}),this.applyOperationToSyncPoints_(new _e(n.path,r,e))}return[]},t.prototype.applyServerOverwrite=function(t,e){return this.applyOperationToSyncPoints_(new xe(ye.Server,t,e))},t.prototype.applyServerMerge=function(t,e){var n=we.fromObject(e);return this.applyOperationToSyncPoints_(new Te(ye.Server,t,n))},t.prototype.applyListenComplete=function(t){return this.applyOperationToSyncPoints_(new Ee(ye.Server,t))},t.prototype.applyTaggedQueryOverwrite=function(e,n,r){var i=this.queryKeyForTag_(r);if(null!=i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=it.relativePath(a,e),c=new xe(ye.forServerTaggedQuery(s),u,n);return this.applyTaggedOperation_(a,c)}return[]},t.prototype.applyTaggedQueryMerge=function(e,n,r){var i=this.queryKeyForTag_(r);if(i){var o=t.parseQueryKey_(i),a=o.path,s=o.queryId,u=it.relativePath(a,e),c=we.fromObject(n),l=new Te(ye.forServerTaggedQuery(s),u,c);return this.applyTaggedOperation_(a,l)}return[]},t.prototype.applyTaggedListenComplete=function(e,n){var r=this.queryKeyForTag_(n);if(r){var i=t.parseQueryKey_(r),o=i.path,a=i.queryId,s=it.relativePath(o,e),u=new Ee(ye.forServerTaggedQuery(a),s);return this.applyTaggedOperation_(o,u)}return[]},t.prototype.addEventRegistration=function(e,n){var r=e.path,i=null,o=!1;this.syncPointTree_.foreachOnPath(r,function(t,e){var n=it.relativePath(t,r);i=i||e.getCompleteServerCache(n),o=o||e.hasCompleteView()});var a=this.syncPointTree_.get(r);a?(o=o||a.hasCompleteView(),i=i||a.getCompleteServerCache(it.Empty)):(a=new Ue,this.syncPointTree_=this.syncPointTree_.set(r,a));var s;if(null!=i)s=!0;else{s=!1,i=Qt.EMPTY_NODE;this.syncPointTree_.subtree(r).foreachChild(function(t,e){var n=e.getCompleteServerCache(it.Empty);n&&(i=i.updateImmediateChild(t,n))})}var u=a.viewExistsForQuery(e);if(!u&&!e.getQueryParams().loadsAllData()){var c=t.makeQueryKey_(e);v.assert(!(c in this.queryToTagMap_),"View does not exist, but we have a tag");var l=t.getNextQueryTag_();this.queryToTagMap_[c]=l,this.tagToQueryMap_["_"+l]=c}var h=this.pendingWriteTree_.childWrites(r),f=a.addEventRegistration(e,n,h,i,s);if(!u&&!o){var d=a.viewForQuery(e);f=f.concat(this.setupListener_(e,d))}return f},t.prototype.removeEventRegistration=function(e,n,r){var i=this,o=e.path,a=this.syncPointTree_.get(o),s=[];if(a&&("default"===e.queryIdentifier()||a.viewExistsForQuery(e))){var u=a.removeEventRegistration(e,n,r);a.isEmpty()&&(this.syncPointTree_=this.syncPointTree_.remove(o));var c=u.removed;s=u.events;var l=-1!==c.findIndex(function(t){return t.getQueryParams().loadsAllData()}),h=this.syncPointTree_.findOnPath(o,function(t,e){return e.hasCompleteView()});if(l&&!h){var f=this.syncPointTree_.subtree(o);if(!f.isEmpty())for(var d=this.collectDistinctViewsForSubTree_(f),p=0;p<d.length;++p){var m=d[p],g=m.getQuery(),v=this.createListenerForView_(m);this.listenProvider_.startListening(t.queryForListening_(g),this.tagForQuery_(g),v.hashFn,v.onComplete)}}if(!h&&c.length>0&&!r)if(l){this.listenProvider_.stopListening(t.queryForListening_(e),null)}else c.forEach(function(e){var n=i.queryToTagMap_[t.makeQueryKey_(e)];i.listenProvider_.stopListening(t.queryForListening_(e),n)});this.removeTags_(c)}return s},t.prototype.calcCompleteEventCache=function(t,e){var n=this.pendingWriteTree_,r=this.syncPointTree_.findOnPath(t,function(e,n){var r=it.relativePath(e,t),i=n.getCompleteServerCache(r);if(i)return i});return n.calcCompleteEventCache(t,r,e,!0)},t.prototype.collectDistinctViewsForSubTree_=function(t){return t.fold(function(t,e,n){if(e&&e.hasCompleteView()){return[e.getCompleteView()]}var r=[];return e&&(r=e.getQueryViews()),v.forEach(n,function(t,e){r=r.concat(e)}),r})},t.prototype.removeTags_=function(e){for(var n=0;n<e.length;++n){var r=e[n];if(!r.getQueryParams().loadsAllData()){var i=t.makeQueryKey_(r),o=this.queryToTagMap_[i];delete this.queryToTagMap_[i],delete this.tagToQueryMap_["_"+o]}}},t.queryForListening_=function(t){return t.getQueryParams().loadsAllData()&&!t.getQueryParams().isDefault()?t.getRef():t},t.prototype.setupListener_=function(e,n){var r=e.path,i=this.tagForQuery_(e),o=this.createListenerForView_(n),a=this.listenProvider_.startListening(t.queryForListening_(e),i,o.hashFn,o.onComplete),s=this.syncPointTree_.subtree(r);if(i)v.assert(!s.value.hasCompleteView(),"If we're adding a query, it shouldn't be shadowed");else for(var u=s.fold(function(t,e,n){if(!t.isEmpty()&&e&&e.hasCompleteView())return[e.getCompleteView().getQuery()];var r=[];return e&&(r=r.concat(e.getQueryViews().map(function(t){return t.getQuery()}))),v.forEach(n,function(t,e){r=r.concat(e)}),r}),c=0;c<u.length;++c){var l=u[c];this.listenProvider_.stopListening(t.queryForListening_(l),this.tagForQuery_(l))}return a},t.prototype.createListenerForView_=function(t){var e=this,n=t.getQuery(),r=this.tagForQuery_(n);return{hashFn:function(){return(t.getServerCache()||Qt.EMPTY_NODE).hash()},onComplete:function(t){if("ok"===t)return r?e.applyTaggedListenComplete(n.path,r):e.applyListenComplete(n.path);var i=Z(t,n);return e.removeEventRegistration(n,null,i)}}},t.makeQueryKey_=function(t){return t.path.toString()+"$"+t.queryIdentifier()},t.parseQueryKey_=function(t){var e=t.indexOf("$");return v.assert(-1!==e&&e<t.length-1,"Bad queryKey."),{queryId:t.substr(e+1),path:new it(t.substr(0,e))}},t.prototype.queryKeyForTag_=function(t){return this.tagToQueryMap_["_"+t]},t.prototype.tagForQuery_=function(e){var n=t.makeQueryKey_(e);return v.safeGet(this.queryToTagMap_,n)},t.getNextQueryTag_=function(){return t.nextQueryTag_++},t.prototype.applyTaggedOperation_=function(t,e){var n=this.syncPointTree_.get(t);v.assert(n,"Missing sync point for query tag that we're tracking");var r=this.pendingWriteTree_.childWrites(t);return n.applyOperation(e,r,null)},t.prototype.applyOperationToSyncPoints_=function(t){return this.applyOperationHelper_(t,this.syncPointTree_,null,this.pendingWriteTree_.childWrites(it.Empty))},t.prototype.applyOperationHelper_=function(t,e,n,r){if(t.path.isEmpty())return this.applyOperationDescendantsHelper_(t,e,n,r);var i=e.get(it.Empty);null==n&&null!=i&&(n=i.getCompleteServerCache(it.Empty));var o=[],a=t.path.getFront(),s=t.operationForChild(a),u=e.children.get(a);if(u&&s){var c=n?n.getImmediateChild(a):null,l=r.child(a);o=o.concat(this.applyOperationHelper_(s,u,c,l))}return i&&(o=o.concat(i.applyOperation(t,r,n))),o},t.prototype.applyOperationDescendantsHelper_=function(t,e,n,r){var i=this,o=e.get(it.Empty);null==n&&null!=o&&(n=o.getCompleteServerCache(it.Empty));var a=[];return e.children.inorderTraversal(function(e,o){var s=n?n.getImmediateChild(e):null,u=r.child(e),c=t.operationForChild(e);c&&(a=a.concat(i.applyOperationDescendantsHelper_(c,o,s,u)))}),o&&(a=a.concat(o.applyOperation(t,r,n))),a},t.nextQueryTag_=1,t}(),He=function(){function t(){this.rootNode_=Qt.EMPTY_NODE}return t.prototype.getNode=function(t){return this.rootNode_.getChild(t)},t.prototype.updateSnapshot=function(t,e){this.rootNode_=this.rootNode_.updateChild(t,e)},t}(),Ge=function(){function t(t){this.app_=t}return t.prototype.getToken=function(t){return this.app_.INTERNAL.getToken(t).then(null,function(t){return t&&"auth/token-not-initialized"===t.code?(D("Got auth/token-not-initialized error.  Treating as null token."),null):Promise.reject(t)})},t.prototype.addTokenChangeListener=function(t){this.app_.INTERNAL.addAuthTokenListener(t)},t.prototype.removeTokenChangeListener=function(t){this.app_.INTERNAL.removeAuthTokenListener(t)},t.prototype.notifyForInvalidToken=function(){var t='Provided authentication credentials for the app named "'+this.app_.name+'" are invalid. This usually indicates your app was not initialized correctly. ';"credential"in this.app_.options?t+='Make sure the "credential" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':"serviceAccount"in this.app_.options?t+='Make sure the "serviceAccount" property provided to initializeApp() is authorized to access the specified "databaseURL" and is from the correct project.':t+='Make sure the "apiKey" and "databaseURL" properties provided to initializeApp() match the values provided for your app at https://console.firebase.google.com/.',U(t)},t}(),ze=function(){function t(){this.counters_={}}return t.prototype.incrementCounter=function(t,e){void 0===e&&(e=1),v.contains(this.counters_,t)||(this.counters_[t]=0),this.counters_[t]+=e},t.prototype.get=function(){return v.deepCopy(this.counters_)},t}(),We=function(){function t(){}return t.getCollection=function(t){var e=t.toString();return this.collections_[e]||(this.collections_[e]=new ze),this.collections_[e]},t.getOrCreateReporter=function(t,e){var n=t.toString();return this.reporters_[n]||(this.reporters_[n]=e()),this.reporters_[n]},t.collections_={},t.reporters_={},t}(),qe=function(){function t(t){this.collection_=t,this.last_=null}return t.prototype.get=function(){var t=this.collection_.get(),e=v.clone(t);return this.last_&&v.forEach(this.last_,function(t,n){e[t]=e[t]-n}),this.last_=t,e},t}(),Ye=1e4,Ke=3e4,Qe=function(){function t(t,e){this.server_=e,this.statsToReport_={},this.statsListener_=new qe(t);var n=Ye+(Ke-Ye)*Math.random();rt(this.reportStats_.bind(this),Math.floor(n))}return t.prototype.includeStat=function(t){this.statsToReport_[t]=!0},t.prototype.reportStats_=function(){var t=this,e=this.statsListener_.get(),n={},r=!1;v.forEach(e,function(e,i){i>0&&v.contains(t.statsToReport_,e)&&(n[e]=i,r=!0)}),r&&this.server_.reportStats(n),rt(this.reportStats_.bind(this),Math.floor(2*Math.random()*3e5))},t}(),Xe=function(){function t(){this.eventLists_=[],this.recursionDepth_=0}return t.prototype.queueEvents=function(t){for(var e=null,n=0;n<t.length;n++){var r=t[n],i=r.getPath();null===e||i.equals(e.getPath())||(this.eventLists_.push(e),e=null),null===e&&(e=new Je(i)),e.add(r)}e&&this.eventLists_.push(e)},t.prototype.raiseEventsAtPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.equals(t)})},t.prototype.raiseEventsForChangedPath=function(t,e){this.queueEvents(e),this.raiseQueuedEventsMatchingPredicate_(function(e){return e.contains(t)||t.contains(e)})},t.prototype.raiseQueuedEventsMatchingPredicate_=function(t){this.recursionDepth_++;for(var e=!0,n=0;n<this.eventLists_.length;n++){var r=this.eventLists_[n];if(r){t(r.getPath())?(this.eventLists_[n].raise(),this.eventLists_[n]=null):e=!1}}e&&(this.eventLists_=[]),this.recursionDepth_--},t}(),Je=function(){function t(t){this.path_=t,this.events_=[]}return t.prototype.add=function(t){this.events_.push(t)},t.prototype.raise=function(){for(var t=0;t<this.events_.length;t++){var e=this.events_[t];if(null!==e){this.events_[t]=null;var n=e.getEventRunner();R&&D("event: "+e.toString()),et(n)}}},t.prototype.getPath=function(){return this.path_},t}(),Ze=function(){function t(t){this.allowedEvents_=t,this.listeners_={},v.assert(Array.isArray(t)&&t.length>0,"Requires a non-empty array")}return t.prototype.trigger=function(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(Array.isArray(this.listeners_[t]))for(var r=this.listeners_[t].slice(),i=0;i<r.length;i++)r[i].callback.apply(r[i].context,e)},t.prototype.on=function(t,e,n){this.validateEventType_(t),this.listeners_[t]=this.listeners_[t]||[],this.listeners_[t].push({callback:e,context:n});var r=this.getInitialEvent(t);r&&e.apply(n,r)},t.prototype.off=function(t,e,n){this.validateEventType_(t);for(var r=this.listeners_[t]||[],i=0;i<r.length;i++)if(r[i].callback===e&&(!n||n===r[i].context))return void r.splice(i,1)},t.prototype.validateEventType_=function(t){v.assert(this.allowedEvents_.find(function(e){return e===t}),"Unknown event: "+t)},t}(),$e=function(t){function e(){var e,n,r=t.call(this,["visible"])||this;return"undefined"!==typeof document&&"undefined"!==typeof document.addEventListener&&("undefined"!==typeof document.hidden?(n="visibilitychange",e="hidden"):"undefined"!==typeof document.mozHidden?(n="mozvisibilitychange",e="mozHidden"):"undefined"!==typeof document.msHidden?(n="msvisibilitychange",e="msHidden"):"undefined"!==typeof document.webkitHidden&&(n="webkitvisibilitychange",e="webkitHidden")),r.visible_=!0,n&&document.addEventListener(n,function(){var t=!document[e];t!==r.visible_&&(r.visible_=t,r.trigger("visible",t))},!1),r}return _.__extends(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return v.assert("visible"===t,"Unknown event type: "+t),[this.visible_]},e}(Ze),tn=function(t){function e(){var e=t.call(this,["online"])||this;return e.online_=!0,"undefined"===typeof window||"undefined"===typeof window.addEventListener||v.isMobileCordova()||(window.addEventListener("online",function(){e.online_||(e.online_=!0,e.trigger("online",!0))},!1),window.addEventListener("offline",function(){e.online_&&(e.online_=!1,e.trigger("online",!1))},!1)),e}return _.__extends(e,t),e.getInstance=function(){return new e},e.prototype.getInitialEvent=function(t){return v.assert("online"===t,"Unknown event type: "+t),[this.online_]},e.prototype.currentlyOnline=function(){return this.online_},e}(Ze),en=function(){function t(t){this.onMessage_=t,this.pendingResponses=[],this.currentResponseNum=0,this.closeAfterResponse=-1,this.onClose=null}return t.prototype.closeAfter=function(t,e){this.closeAfterResponse=t,this.onClose=e,this.closeAfterResponse<this.currentResponseNum&&(this.onClose(),this.onClose=null)},t.prototype.handleResponse=function(t,e){var n=this;this.pendingResponses[t]=e;for(var r=this;this.pendingResponses[this.currentResponseNum];){if("break"===function(){var t=r.pendingResponses[r.currentResponseNum];delete r.pendingResponses[r.currentResponseNum];for(var e=0;e<t.length;++e)!function(e){t[e]&&et(function(){n.onMessage_(t[e])})}(e);if(r.currentResponseNum===r.closeAfterResponse)return r.onClose&&(r.onClose(),r.onClose=null),"break";r.currentResponseNum++}())break}},t}(),nn="pLPCommand",rn="pRTLPCB",on=function(){function t(t,e,n,r){this.connId=t,this.repoInfo=e,this.transportSessionId=n,this.lastSessionId=r,this.bytesSent=0,this.bytesReceived=0,this.everConnected_=!1,this.log_=O(t),this.stats_=We.getCollection(e),this.urlFn=function(t){return e.connectionURL(at,t)}}return t.prototype.open=function(t,e){var n=this;this.curSegmentNum=0,this.onDisconnect_=e,this.myPacketOrderer=new en(t),this.isClosed_=!1,this.connectTimeoutTimer_=setTimeout(function(){n.log_("Timed out trying to connect."),n.onClosed_(),n.connectTimeoutTimer_=null},Math.floor(3e4)),V(function(){if(!n.isClosed_){n.scriptTagHolder=new an(function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[0],i=t[1],o=t[2];if(n.incrementIncomingBytes_(t),n.scriptTagHolder)if(n.connectTimeoutTimer_&&(clearTimeout(n.connectTimeoutTimer_),n.connectTimeoutTimer_=null),n.everConnected_=!0,"start"==r)n.id=i,n.password=o;else{if("close"!==r)throw new Error("Unrecognized command received: "+r);i?(n.scriptTagHolder.sendNewPolls=!1,n.myPacketOrderer.closeAfter(i,function(){n.onClosed_()})):n.onClosed_()}},function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var r=t[0],i=t[1];n.incrementIncomingBytes_(t),n.myPacketOrderer.handleResponse(r,i)},function(){n.onClosed_()},n.urlFn);var t={};t.start="t",t.ser=Math.floor(1e8*Math.random()),n.scriptTagHolder.uniqueCallbackIdentifier&&(t.cb=n.scriptTagHolder.uniqueCallbackIdentifier),t.v="5",n.transportSessionId&&(t.s=n.transportSessionId),n.lastSessionId&&(t.ls=n.lastSessionId),!v.isNodeSdk()&&"undefined"!==typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(t.r="f");var e=n.urlFn(t);n.log_("Connecting via long-poll to "+e),n.scriptTagHolder.addTag(e,function(){})}})},t.prototype.start=function(){this.scriptTagHolder.startLongPoll(this.id,this.password),this.addDisconnectPingFrame(this.id,this.password)},t.forceAllow=function(){t.forceAllow_=!0},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){return t.forceAllow_||!t.forceDisallow_&&"undefined"!==typeof document&&null!=document.createElement&&!X()&&!J()&&!v.isNodeSdk()},t.prototype.markConnectionHealthy=function(){},t.prototype.shutdown_=function(){this.isClosed_=!0,this.scriptTagHolder&&(this.scriptTagHolder.close(),this.scriptTagHolder=null),this.myDisconnFrame&&(document.body.removeChild(this.myDisconnFrame),this.myDisconnFrame=null),this.connectTimeoutTimer_&&(clearTimeout(this.connectTimeoutTimer_),this.connectTimeoutTimer_=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("Longpoll is closing itself"),this.shutdown_(),this.onDisconnect_&&(this.onDisconnect_(this.everConnected_),this.onDisconnect_=null))},t.prototype.close=function(){this.isClosed_||(this.log_("Longpoll is being closed."),this.shutdown_())},t.prototype.send=function(t){var e=v.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);for(var n=v.base64Encode(e),r=Y(n,1840),i=0;i<r.length;i++)this.scriptTagHolder.enqueueSegment(this.curSegmentNum,r.length,r[i]),this.curSegmentNum++},t.prototype.addDisconnectPingFrame=function(t,e){if(!v.isNodeSdk()){this.myDisconnFrame=document.createElement("iframe");var n={};n.dframe="t",n.id=t,n.pw=e,this.myDisconnFrame.src=this.urlFn(n),this.myDisconnFrame.style.display="none",document.body.appendChild(this.myDisconnFrame)}},t.prototype.incrementIncomingBytes_=function(t){var e=v.stringify(t).length;this.bytesReceived+=e,this.stats_.incrementCounter("bytes_received",e)},t}(),an=function(){function t(e,n,r,i){if(this.onDisconnect=r,this.urlFn=i,this.outstandingRequests=new le,this.pendingSegs=[],this.currentSerial=Math.floor(1e8*Math.random()),this.sendNewPolls=!0,v.isNodeSdk())this.commandCB=e,this.onMessageCB=n;else{this.uniqueCallbackIdentifier=M(),window[nn+this.uniqueCallbackIdentifier]=e,window[rn+this.uniqueCallbackIdentifier]=n,this.myIFrame=t.createIFrame_();var o="";if(this.myIFrame.src&&"javascript:"===this.myIFrame.src.substr(0,"javascript:".length)){o='<script>document.domain="'+document.domain+'";<\/script>'}var a="<html><body>"+o+"</body></html>";try{this.myIFrame.doc.open(),this.myIFrame.doc.write(a),this.myIFrame.doc.close()}catch(t){D("frame writing exception"),t.stack&&D(t.stack),D(t)}}}return t.createIFrame_=function(){var t=document.createElement("iframe");if(t.style.display="none",!document.body)throw"Document body has not initialized. Wait to initialize Firebase until after the document is ready.";document.body.appendChild(t);try{t.contentWindow.document||D("No IE domain setting required")}catch(n){var e=document.domain;t.src="javascript:void((function(){document.open();document.domain='"+e+"';document.close();})())"}return t.contentDocument?t.doc=t.contentDocument:t.contentWindow?t.doc=t.contentWindow.document:t.document&&(t.doc=t.document),t},t.prototype.close=function(){var e=this;if(this.alive=!1,this.myIFrame&&(this.myIFrame.doc.body.innerHTML="",setTimeout(function(){null!==e.myIFrame&&(document.body.removeChild(e.myIFrame),e.myIFrame=null)},Math.floor(0))),v.isNodeSdk()&&this.myID){var n={};n.disconn="t",n.id=this.myID,n.pw=this.myPW;var r=this.urlFn(n);t.nodeRestRequest(r)}var i=this.onDisconnect;i&&(this.onDisconnect=null,i())},t.prototype.startLongPoll=function(t,e){for(this.myID=t,this.myPW=e,this.alive=!0;this.newRequest_(););},t.prototype.newRequest_=function(){if(this.alive&&this.sendNewPolls&&this.outstandingRequests.count()<(this.pendingSegs.length>0?2:1)){this.currentSerial++;var t={};t.id=this.myID,t.pw=this.myPW,t.ser=this.currentSerial;for(var e=this.urlFn(t),n="",r=0;this.pendingSegs.length>0;){if(!(this.pendingSegs[0].d.length+30+n.length<=1870))break;var i=this.pendingSegs.shift();n=n+"&seg"+r+"="+i.seg+"&ts"+r+"="+i.ts+"&d"+r+"="+i.d,r++}return e+=n,this.addLongPollTag_(e,this.currentSerial),!0}return!1},t.prototype.enqueueSegment=function(t,e,n){this.pendingSegs.push({seg:t,ts:e,d:n}),this.alive&&this.newRequest_()},t.prototype.addLongPollTag_=function(t,e){var n=this;this.outstandingRequests.add(e,1);var r=function(){n.outstandingRequests.remove(e),n.newRequest_()},i=setTimeout(r,Math.floor(25e3)),o=function(){clearTimeout(i),r()};this.addTag(t,o)},t.prototype.addTag=function(t,e){var n=this;v.isNodeSdk()?this.doNodeLongPoll(t,e):setTimeout(function(){try{if(!n.sendNewPolls)return;var r=n.myIFrame.doc.createElement("script");r.type="text/javascript",r.async=!0,r.src=t,r.onload=r.onreadystatechange=function(){var t=r.readyState;t&&"loaded"!==t&&"complete"!==t||(r.onload=r.onreadystatechange=null,r.parentNode&&r.parentNode.removeChild(r),e())},r.onerror=function(){D("Long-poll script failed to load: "+t),n.sendNewPolls=!1,n.close()},n.myIFrame.doc.body.appendChild(r)}catch(t){}},Math.floor(1))},t}(),sn=null;"undefined"!==typeof MozWebSocket?sn=MozWebSocket:"undefined"!==typeof WebSocket&&(sn=WebSocket);var un=function(){function t(e,n,r,i){this.connId=e,this.keepaliveTimer=null,this.frames=null,this.totalFrames=0,this.bytesSent=0,this.bytesReceived=0,this.log_=O(this.connId),this.stats_=We.getCollection(n),this.connURL=t.connectionURL_(n,r,i)}return t.connectionURL_=function(t,e,n){var r={};return r.v="5",!v.isNodeSdk()&&"undefined"!==typeof location&&location.href&&-1!==location.href.indexOf("firebaseio.com")&&(r.r="f"),e&&(r.s=e),n&&(r.ls=n),t.connectionURL("websocket",r)},t.prototype.open=function(t,e){var n=this;this.onDisconnect=e,this.onMessage=t,this.log_("Websocket connecting to "+this.connURL),this.everConnected_=!1,T.set("previous_websocket_failure",!0);try{if(v.isNodeSdk()){var i=v.CONSTANTS.NODE_ADMIN?"AdminNode":"Node",o={headers:{"User-Agent":"Firebase/5/"+b.SDK_VERSION+"/"+r.platform+"/"+i}},a=Object({NODE_ENV:"production",PUBLIC_URL:""}),s=0==this.connURL.indexOf("wss://")?a.HTTPS_PROXY||a.https_proxy:a.HTTP_PROXY||a.http_proxy;s&&(o.proxy={origin:s}),this.mySock=new sn(this.connURL,[],o)}else this.mySock=new sn(this.connURL)}catch(t){this.log_("Error instantiating WebSocket.");var u=t.message||t.data;return u&&this.log_(u),void this.onClosed_()}this.mySock.onopen=function(){n.log_("Websocket connected."),n.everConnected_=!0},this.mySock.onclose=function(){n.log_("Websocket connection was disconnected."),n.mySock=null,n.onClosed_()},this.mySock.onmessage=function(t){n.handleIncomingFrame(t)},this.mySock.onerror=function(t){n.log_("WebSocket error.  Closing connection.");var e=t.message||t.data;e&&n.log_(e),n.onClosed_()}},t.prototype.start=function(){},t.forceDisallow=function(){t.forceDisallow_=!0},t.isAvailable=function(){var e=!1;if("undefined"!==typeof navigator&&navigator.userAgent){var n=/Android ([0-9]{0,}\.[0-9]{0,})/,r=navigator.userAgent.match(n);r&&r.length>1&&parseFloat(r[1])<4.4&&(e=!0)}return!e&&null!==sn&&!t.forceDisallow_},t.previouslyFailed=function(){return T.isInMemoryStorage||!0===T.get("previous_websocket_failure")},t.prototype.markConnectionHealthy=function(){T.remove("previous_websocket_failure")},t.prototype.appendFrame_=function(t){if(this.frames.push(t),this.frames.length==this.totalFrames){var e=this.frames.join("");this.frames=null;var n=v.jsonEval(e);this.onMessage(n)}},t.prototype.handleNewFrameCount_=function(t){this.totalFrames=t,this.frames=[]},t.prototype.extractFrameCount_=function(t){if(v.assert(null===this.frames,"We already have a frame buffer"),t.length<=6){var e=Number(t);if(!isNaN(e))return this.handleNewFrameCount_(e),null}return this.handleNewFrameCount_(1),t},t.prototype.handleIncomingFrame=function(t){if(null!==this.mySock){var e=t.data;if(this.bytesReceived+=e.length,this.stats_.incrementCounter("bytes_received",e.length),this.resetKeepAlive(),null!==this.frames)this.appendFrame_(e);else{var n=this.extractFrameCount_(e);null!==n&&this.appendFrame_(n)}}},t.prototype.send=function(t){this.resetKeepAlive();var e=v.stringify(t);this.bytesSent+=e.length,this.stats_.incrementCounter("bytes_sent",e.length);var n=Y(e,16384);n.length>1&&this.sendString_(String(n.length));for(var r=0;r<n.length;r++)this.sendString_(n[r])},t.prototype.shutdown_=function(){this.isClosed_=!0,this.keepaliveTimer&&(clearInterval(this.keepaliveTimer),this.keepaliveTimer=null),this.mySock&&(this.mySock.close(),this.mySock=null)},t.prototype.onClosed_=function(){this.isClosed_||(this.log_("WebSocket is closing itself"),this.shutdown_(),this.onDisconnect&&(this.onDisconnect(this.everConnected_),this.onDisconnect=null))},t.prototype.close=function(){this.isClosed_||(this.log_("WebSocket is being closed"),this.shutdown_())},t.prototype.resetKeepAlive=function(){var t=this;clearInterval(this.keepaliveTimer),this.keepaliveTimer=setInterval(function(){t.mySock&&t.sendString_("0"),t.resetKeepAlive()},Math.floor(45e3))},t.prototype.sendString_=function(t){try{this.mySock.send(t)}catch(t){this.log_("Exception thrown from WebSocket.send():",t.message||t.data,"Closing connection."),setTimeout(this.onClosed_.bind(this),0)}},t.responsesRequiredToBeHealthy=2,t.healthyTimeout=3e4,t}(),cn=function(){function t(t){this.initTransports_(t)}return Object.defineProperty(t,"ALL_TRANSPORTS",{get:function(){return[on,un]},enumerable:!0,configurable:!0}),t.prototype.initTransports_=function(e){var n=un&&un.isAvailable(),r=n&&!un.previouslyFailed();if(e.webSocketOnly&&(n||U("wss:// URL used, but browser isn't known to support websockets.  Trying anyway."),r=!0),r)this.transports_=[un];else{var i=this.transports_=[];K(t.ALL_TRANSPORTS,function(t,e){e&&e.isAvailable()&&i.push(e)})}},t.prototype.initialTransport=function(){if(this.transports_.length>0)return this.transports_[0];throw new Error("No transports available")},t.prototype.upgradeTransport=function(){return this.transports_.length>1?this.transports_[1]:null},t}(),ln=function(){function t(t,e,n,r,i,o,a){this.id=t,this.repoInfo_=e,this.onMessage_=n,this.onReady_=r,this.onDisconnect_=i,this.onKill_=o,this.lastSessionId=a,this.connectionCount=0,this.pendingDataMessages=[],this.state_=0,this.log_=O("c:"+this.id+":"),this.transportManager_=new cn(e),this.log_("Connection created"),this.start_()}return t.prototype.start_=function(){var t=this,e=this.transportManager_.initialTransport();this.conn_=new e(this.nextTransportId_(),this.repoInfo_,void 0,this.lastSessionId),this.primaryResponsesRequired_=e.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.conn_),r=this.disconnReceiver_(this.conn_);this.tx_=this.conn_,this.rx_=this.conn_,this.secondaryConn_=null,this.isHealthy_=!1,setTimeout(function(){t.conn_&&t.conn_.open(n,r)},Math.floor(0));var i=e.healthyTimeout||0;i>0&&(this.healthyTimeout_=rt(function(){t.healthyTimeout_=null,t.isHealthy_||(t.conn_&&t.conn_.bytesReceived>102400?(t.log_("Connection exceeded healthy timeout but has received "+t.conn_.bytesReceived+" bytes.  Marking connection healthy."),t.isHealthy_=!0,t.conn_.markConnectionHealthy()):t.conn_&&t.conn_.bytesSent>10240?t.log_("Connection exceeded healthy timeout but has sent "+t.conn_.bytesSent+" bytes.  Leaving connection alive."):(t.log_("Closing unhealthy connection after timeout."),t.close()))},Math.floor(i)))},t.prototype.nextTransportId_=function(){return"c:"+this.id+":"+this.connectionCount++},t.prototype.disconnReceiver_=function(t){var e=this;return function(n){t===e.conn_?e.onConnectionLost_(n):t===e.secondaryConn_?(e.log_("Secondary connection lost."),e.onSecondaryConnectionLost_()):e.log_("closing an old connection")}},t.prototype.connReceiver_=function(t){var e=this;return function(n){2!=e.state_&&(t===e.rx_?e.onPrimaryMessageReceived_(n):t===e.secondaryConn_?e.onSecondaryMessageReceived_(n):e.log_("message on old connection"))}},t.prototype.sendRequest=function(t){var e={t:"d",d:t};this.sendData_(e)},t.prototype.tryCleanupConnection=function(){this.tx_===this.secondaryConn_&&this.rx_===this.secondaryConn_&&(this.log_("cleaning up and promoting a connection: "+this.secondaryConn_.connId),this.conn_=this.secondaryConn_,this.secondaryConn_=null)},t.prototype.onSecondaryControl_=function(t){if("t"in t){var e=t.t;"a"===e?this.upgradeIfSecondaryHealthy_():"r"===e?(this.log_("Got a reset on secondary, closing it"),this.secondaryConn_.close(),this.tx_!==this.secondaryConn_&&this.rx_!==this.secondaryConn_||this.close()):"o"===e&&(this.log_("got pong on secondary."),this.secondaryResponsesRequired_--,this.upgradeIfSecondaryHealthy_())}},t.prototype.onSecondaryMessageReceived_=function(t){var e=W("t",t),n=W("d",t);if("c"==e)this.onSecondaryControl_(n);else{if("d"!=e)throw new Error("Unknown protocol layer: "+e);this.pendingDataMessages.push(n)}},t.prototype.upgradeIfSecondaryHealthy_=function(){this.secondaryResponsesRequired_<=0?(this.log_("Secondary connection is healthy."),this.isHealthy_=!0,this.secondaryConn_.markConnectionHealthy(),this.proceedWithUpgrade_()):(this.log_("sending ping on secondary."),this.secondaryConn_.send({t:"c",d:{t:"p",d:{}}}))},t.prototype.proceedWithUpgrade_=function(){this.secondaryConn_.start(),this.log_("sending client ack on secondary"),this.secondaryConn_.send({t:"c",d:{t:"a",d:{}}}),this.log_("Ending transmission on primary"),this.conn_.send({t:"c",d:{t:"n",d:{}}}),this.tx_=this.secondaryConn_,this.tryCleanupConnection()},t.prototype.onPrimaryMessageReceived_=function(t){var e=W("t",t),n=W("d",t);"c"==e?this.onControl_(n):"d"==e&&this.onDataMessage_(n)},t.prototype.onDataMessage_=function(t){this.onPrimaryResponse_(),this.onMessage_(t)},t.prototype.onPrimaryResponse_=function(){this.isHealthy_||--this.primaryResponsesRequired_<=0&&(this.log_("Primary connection is healthy."),this.isHealthy_=!0,this.conn_.markConnectionHealthy())},t.prototype.onControl_=function(t){var e=W("t",t);if("d"in t){var n=t.d;if("h"===e)this.onHandshake_(n);else if("n"===e){this.log_("recvd end transmission on primary"),this.rx_=this.secondaryConn_;for(var r=0;r<this.pendingDataMessages.length;++r)this.onDataMessage_(this.pendingDataMessages[r]);this.pendingDataMessages=[],this.tryCleanupConnection()}else"s"===e?this.onConnectionShutdown_(n):"r"===e?this.onReset_(n):"e"===e?k("Server Error: "+n):"o"===e?(this.log_("got pong on primary."),this.onPrimaryResponse_(),this.sendPingOnPrimaryIfNecessary_()):k("Unknown control packet command: "+e)}},t.prototype.onHandshake_=function(t){var e=t.ts,n=t.v,r=t.h;this.sessionId=t.s,this.repoInfo_.updateHost(r),0==this.state_&&(this.conn_.start(),this.onConnectionEstablished_(this.conn_,e),"5"!==n&&U("Protocol version mismatch detected"),this.tryStartUpgrade_())},t.prototype.tryStartUpgrade_=function(){var t=this.transportManager_.upgradeTransport();t&&this.startUpgrade_(t)},t.prototype.startUpgrade_=function(t){var e=this;this.secondaryConn_=new t(this.nextTransportId_(),this.repoInfo_,this.sessionId),this.secondaryResponsesRequired_=t.responsesRequiredToBeHealthy||0;var n=this.connReceiver_(this.secondaryConn_),r=this.disconnReceiver_(this.secondaryConn_);this.secondaryConn_.open(n,r),rt(function(){e.secondaryConn_&&(e.log_("Timed out trying to upgrade."),e.secondaryConn_.close())},Math.floor(6e4))},t.prototype.onReset_=function(t){this.log_("Reset packet received.  New host: "+t),this.repoInfo_.updateHost(t),1===this.state_?this.close():(this.closeConnections_(),this.start_())},t.prototype.onConnectionEstablished_=function(t,e){var n=this;this.log_("Realtime connection established."),this.conn_=t,this.state_=1,this.onReady_&&(this.onReady_(e,this.sessionId),this.onReady_=null),0===this.primaryResponsesRequired_?(this.log_("Primary connection is healthy."),this.isHealthy_=!0):rt(function(){n.sendPingOnPrimaryIfNecessary_()},Math.floor(5e3))},t.prototype.sendPingOnPrimaryIfNecessary_=function(){this.isHealthy_||1!==this.state_||(this.log_("sending ping on primary."),this.sendData_({t:"c",d:{t:"p",d:{}}}))},t.prototype.onSecondaryConnectionLost_=function(){var t=this.secondaryConn_;this.secondaryConn_=null,this.tx_!==t&&this.rx_!==t||this.close()},t.prototype.onConnectionLost_=function(t){this.conn_=null,t||0!==this.state_?1===this.state_&&this.log_("Realtime connection lost."):(this.log_("Realtime connection failed."),this.repoInfo_.isCacheableHost()&&(T.remove("host:"+this.repoInfo_.host),this.repoInfo_.internalHost=this.repoInfo_.host)),this.close()},t.prototype.onConnectionShutdown_=function(t){this.log_("Connection shutdown command received. Shutting down..."),this.onKill_&&(this.onKill_(t),this.onKill_=null),this.onDisconnect_=null,this.close()},t.prototype.sendData_=function(t){if(1!==this.state_)throw"Connection is not connected";this.tx_.send(t)},t.prototype.close=function(){2!==this.state_&&(this.log_("Closing realtime connection."),this.state_=2,this.closeConnections_(),this.onDisconnect_&&(this.onDisconnect_(),this.onDisconnect_=null))},t.prototype.closeConnections_=function(){this.log_("Shutting down all connections"),this.conn_&&(this.conn_.close(),this.conn_=null),this.secondaryConn_&&(this.secondaryConn_.close(),this.secondaryConn_=null),this.healthyTimeout_&&(clearTimeout(this.healthyTimeout_),this.healthyTimeout_=null)},t}(),hn=function(){function t(){}return t.prototype.put=function(t,e,n,r){},t.prototype.merge=function(t,e,n,r){},t.prototype.refreshAuthToken=function(t){},t.prototype.onDisconnectPut=function(t,e,n){},t.prototype.onDisconnectMerge=function(t,e,n){},t.prototype.onDisconnectCancel=function(t,e){},t.prototype.reportStats=function(t){},t}(),fn=1e3,dn=3e5,pn=function(t){function e(n,r,i,o,a,s){var u=t.call(this)||this;if(u.repoInfo_=n,u.onDataUpdate_=r,u.onConnectStatus_=i,u.onServerInfoUpdate_=o,u.authTokenProvider_=a,u.authOverride_=s,u.id=e.nextPersistentConnectionId_++,u.log_=O("p:"+u.id+":"),u.interruptReasons_={},u.listens_={},u.outstandingPuts_=[],u.outstandingPutCount_=0,u.onDisconnectRequestQueue_=[],u.connected_=!1,u.reconnectDelay_=fn,u.maxReconnectDelay_=dn,u.securityDebugCallback_=null,u.lastSessionId=null,u.establishConnectionTimer_=null,u.visible_=!1,u.requestCBHash_={},u.requestNumber_=0,u.realtime_=null,u.authToken_=null,u.forceTokenRefresh_=!1,u.invalidAuthTokenCount_=0,u.firstConnection_=!0,u.lastConnectionAttemptTime_=null,u.lastConnectionEstablishedTime_=null,s&&!v.isNodeSdk())throw new Error("Auth override specified in options, but not supported on non Node.js platforms");return u.scheduleConnect_(0),$e.getInstance().on("visible",u.onVisible_,u),-1===n.host.indexOf("fblocal")&&tn.getInstance().on("online",u.onOnline_,u),u}return _.__extends(e,t),e.prototype.sendRequest=function(t,e,n){var r=++this.requestNumber_,i={r:r,a:t,b:e};this.log_(v.stringify(i)),v.assert(this.connected_,"sendRequest call when we're not connected not allowed."),this.realtime_.sendRequest(i),n&&(this.requestCBHash_[r]=n)},e.prototype.listen=function(t,e,n,r){var i=t.queryIdentifier(),o=t.path.toString();this.log_("Listen called for "+o+" "+i),this.listens_[o]=this.listens_[o]||{},v.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"listen() called for non-default but complete query"),v.assert(!this.listens_[o][i],"listen() called twice for same path/queryId.");var a={onComplete:r,hashFn:e,query:t,tag:n};this.listens_[o][i]=a,this.connected_&&this.sendListen_(a)},e.prototype.sendListen_=function(t){var n=this,r=t.query,i=r.path.toString(),o=r.queryIdentifier();this.log_("Listen on "+i+" for "+o);var a={p:i};t.tag&&(a.q=r.queryObject(),a.t=t.tag),a.h=t.hashFn(),this.sendRequest("q",a,function(a){var s=a.d,u=a.s;e.warnOnListenWarnings_(s,r),(n.listens_[i]&&n.listens_[i][o])===t&&(n.log_("listen response",a),"ok"!==u&&n.removeListen_(i,o),t.onComplete&&t.onComplete(u,s))})},e.warnOnListenWarnings_=function(t,e){if(t&&"object"===typeof t&&v.contains(t,"w")){var n=v.safeGet(t,"w");if(Array.isArray(n)&&~n.indexOf("no_index")){var r='".indexOn": "'+e.getQueryParams().getIndex().toString()+'"',i=e.path.toString();U("Using an unspecified index. Your data will be downloaded and filtered on the client. Consider adding "+r+" at "+i+" to your security rules for better performance.")}}},e.prototype.refreshAuthToken=function(t){this.authToken_=t,this.log_("Auth token refreshed"),this.authToken_?this.tryAuth():this.connected_&&this.sendRequest("unauth",{},function(){}),this.reduceReconnectDelayIfAdminCredential_(t)},e.prototype.reduceReconnectDelayIfAdminCredential_=function(t){(t&&40===t.length||v.isAdmin(t))&&(this.log_("Admin auth credential detected.  Reducing max reconnect time."),this.maxReconnectDelay_=3e4)},e.prototype.tryAuth=function(){var t=this;if(this.connected_&&this.authToken_){var e=this.authToken_,n=v.isValidFormat(e)?"auth":"gauth",r={cred:e};null===this.authOverride_?r.noauth=!0:"object"===typeof this.authOverride_&&(r.authvar=this.authOverride_),this.sendRequest(n,r,function(n){var r=n.s,i=n.d||"error";t.authToken_===e&&("ok"===r?t.invalidAuthTokenCount_=0:t.onAuthRevoked_(r,i))})}},e.prototype.unlisten=function(t,e){var n=t.path.toString(),r=t.queryIdentifier();this.log_("Unlisten called for "+n+" "+r),v.assert(t.getQueryParams().isDefault()||!t.getQueryParams().loadsAllData(),"unlisten() called for non-default but complete query"),this.removeListen_(n,r)&&this.connected_&&this.sendUnlisten_(n,r,t.queryObject(),e)},e.prototype.sendUnlisten_=function(t,e,n,r){this.log_("Unlisten on "+t+" for "+e);var i={p:t};r&&(i.q=n,i.t=r),this.sendRequest("n",i)},e.prototype.onDisconnectPut=function(t,e,n){this.connected_?this.sendOnDisconnect_("o",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"o",data:e,onComplete:n})},e.prototype.onDisconnectMerge=function(t,e,n){this.connected_?this.sendOnDisconnect_("om",t,e,n):this.onDisconnectRequestQueue_.push({pathString:t,action:"om",data:e,onComplete:n})},e.prototype.onDisconnectCancel=function(t,e){this.connected_?this.sendOnDisconnect_("oc",t,null,e):this.onDisconnectRequestQueue_.push({pathString:t,action:"oc",data:null,onComplete:e})},e.prototype.sendOnDisconnect_=function(t,e,n,r){var i={p:e,d:n};this.log_("onDisconnect "+t,i),this.sendRequest(t,i,function(t){r&&setTimeout(function(){r(t.s,t.d)},Math.floor(0))})},e.prototype.put=function(t,e,n,r){this.putInternal("p",t,e,n,r)},e.prototype.merge=function(t,e,n,r){this.putInternal("m",t,e,n,r)},e.prototype.putInternal=function(t,e,n,r,i){var o={p:e,d:n};void 0!==i&&(o.h=i),this.outstandingPuts_.push({action:t,request:o,onComplete:r}),this.outstandingPutCount_++;var a=this.outstandingPuts_.length-1;this.connected_?this.sendPut_(a):this.log_("Buffering put: "+e)},e.prototype.sendPut_=function(t){var e=this,n=this.outstandingPuts_[t].action,r=this.outstandingPuts_[t].request,i=this.outstandingPuts_[t].onComplete;this.outstandingPuts_[t].queued=this.connected_,this.sendRequest(n,r,function(r){e.log_(n+" response",r),delete e.outstandingPuts_[t],e.outstandingPutCount_--,0===e.outstandingPutCount_&&(e.outstandingPuts_=[]),i&&i(r.s,r.d)})},e.prototype.reportStats=function(t){var e=this;if(this.connected_){var n={c:t};this.log_("reportStats",n),this.sendRequest("s",n,function(t){if("ok"!==t.s){var n=t.d;e.log_("reportStats","Error sending stats: "+n)}})}},e.prototype.onDataMessage_=function(t){if("r"in t){this.log_("from server: "+v.stringify(t));var e=t.r,n=this.requestCBHash_[e];n&&(delete this.requestCBHash_[e],n(t.b))}else{if("error"in t)throw"A server-side error has occurred: "+t.error;"a"in t&&this.onDataPush_(t.a,t.b)}},e.prototype.onDataPush_=function(t,e){this.log_("handleServerMessage",t,e),"d"===t?this.onDataUpdate_(e.p,e.d,!1,e.t):"m"===t?this.onDataUpdate_(e.p,e.d,!0,e.t):"c"===t?this.onListenRevoked_(e.p,e.q):"ac"===t?this.onAuthRevoked_(e.s,e.d):"sd"===t?this.onSecurityDebugPacket_(e):k("Unrecognized action received from server: "+v.stringify(t)+"\nAre you using the latest client?")},e.prototype.onReady_=function(t,e){this.log_("connection ready"),this.connected_=!0,this.lastConnectionEstablishedTime_=(new Date).getTime(),this.handleTimestamp_(t),this.lastSessionId=e,this.firstConnection_&&this.sendConnectStats_(),this.restoreState_(),this.firstConnection_=!1,this.onConnectStatus_(!0)},e.prototype.scheduleConnect_=function(t){var e=this;v.assert(!this.realtime_,"Scheduling a connect when we're already connected/ing?"),this.establishConnectionTimer_&&clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=setTimeout(function(){e.establishConnectionTimer_=null,e.establishConnection_()},Math.floor(t))},e.prototype.onVisible_=function(t){t&&!this.visible_&&this.reconnectDelay_===this.maxReconnectDelay_&&(this.log_("Window became visible.  Reducing delay."),this.reconnectDelay_=fn,this.realtime_||this.scheduleConnect_(0)),this.visible_=t},e.prototype.onOnline_=function(t){t?(this.log_("Browser went online."),this.reconnectDelay_=fn,this.realtime_||this.scheduleConnect_(0)):(this.log_("Browser went offline.  Killing connection."),this.realtime_&&this.realtime_.close())},e.prototype.onRealtimeDisconnect_=function(){if(this.log_("data client disconnected"),this.connected_=!1,this.realtime_=null,this.cancelSentTransactions_(),this.requestCBHash_={},this.shouldReconnect_()){if(this.visible_){if(this.lastConnectionEstablishedTime_){var t=(new Date).getTime()-this.lastConnectionEstablishedTime_;t>3e4&&(this.reconnectDelay_=fn),this.lastConnectionEstablishedTime_=null}}else this.log_("Window isn't visible.  Delaying reconnect."),this.reconnectDelay_=this.maxReconnectDelay_,this.lastConnectionAttemptTime_=(new Date).getTime();var e=(new Date).getTime()-this.lastConnectionAttemptTime_,n=Math.max(0,this.reconnectDelay_-e);n=Math.random()*n,this.log_("Trying to reconnect in "+n+"ms"),this.scheduleConnect_(n),this.reconnectDelay_=Math.min(this.maxReconnectDelay_,1.3*this.reconnectDelay_)}this.onConnectStatus_(!1)},e.prototype.establishConnection_=function(){if(this.shouldReconnect_()){this.log_("Making a connection attempt"),this.lastConnectionAttemptTime_=(new Date).getTime(),this.lastConnectionEstablishedTime_=null;var t=this.onDataMessage_.bind(this),n=this.onReady_.bind(this),r=this.onRealtimeDisconnect_.bind(this),i=this.id+":"+e.nextConnectionId_++,o=this,a=this.lastSessionId,s=!1,u=null,c=function(){u?u.close():(s=!0,r())},l=function(t){v.assert(u,"sendRequest call when we're not connected not allowed."),u.sendRequest(t)};this.realtime_={close:c,sendRequest:l};var h=this.forceTokenRefresh_;this.forceTokenRefresh_=!1,this.authTokenProvider_.getToken(h).then(function(e){s?D("getToken() completed but was canceled"):(D("getToken() completed. Creating connection."),o.authToken_=e&&e.accessToken,u=new ln(i,o.repoInfo_,t,n,r,function(t){U(t+" ("+o.repoInfo_.toString()+")"),o.interrupt("server_kill")},a))}).then(null,function(t){o.log_("Failed to get token: "+t),s||(v.CONSTANTS.NODE_ADMIN&&U(t),c())})}},e.prototype.interrupt=function(t){D("Interrupting connection for reason: "+t),this.interruptReasons_[t]=!0,this.realtime_?this.realtime_.close():(this.establishConnectionTimer_&&(clearTimeout(this.establishConnectionTimer_),this.establishConnectionTimer_=null),this.connected_&&this.onRealtimeDisconnect_())},e.prototype.resume=function(t){D("Resuming connection for reason: "+t),delete this.interruptReasons_[t],v.isEmpty(this.interruptReasons_)&&(this.reconnectDelay_=fn,this.realtime_||this.scheduleConnect_(0))},e.prototype.handleTimestamp_=function(t){var e=t-(new Date).getTime();this.onServerInfoUpdate_({serverTimeOffset:e})},e.prototype.cancelSentTransactions_=function(){for(var t=0;t<this.outstandingPuts_.length;t++){var e=this.outstandingPuts_[t];e&&"h"in e.request&&e.queued&&(e.onComplete&&e.onComplete("disconnect"),delete this.outstandingPuts_[t],this.outstandingPutCount_--)}0===this.outstandingPutCount_&&(this.outstandingPuts_=[])},e.prototype.onListenRevoked_=function(t,e){var n;n=e?e.map(function(t){return q(t)}).join("$"):"default";var r=this.removeListen_(t,n);r&&r.onComplete&&r.onComplete("permission_denied")},e.prototype.removeListen_=function(t,e){var n,r=new it(t).toString();return void 0!==this.listens_[r]?(n=this.listens_[r][e],delete this.listens_[r][e],0===v.getCount(this.listens_[r])&&delete this.listens_[r]):n=void 0,n},e.prototype.onAuthRevoked_=function(t,e){D("Auth token revoked: "+t+"/"+e),this.authToken_=null,this.forceTokenRefresh_=!0,this.realtime_.close(),"invalid_token"!==t&&"permission_denied"!==t||++this.invalidAuthTokenCount_>=3&&(this.reconnectDelay_=3e4,this.authTokenProvider_.notifyForInvalidToken())},e.prototype.onSecurityDebugPacket_=function(t){this.securityDebugCallback_?this.securityDebugCallback_(t):"msg"in t&&console.log("FIREBASE: "+t.msg.replace("\n","\nFIREBASE: "))},e.prototype.restoreState_=function(){var t=this;this.tryAuth(),v.forEach(this.listens_,function(e,n){v.forEach(n,function(e,n){t.sendListen_(n)})});for(var e=0;e<this.outstandingPuts_.length;e++)this.outstandingPuts_[e]&&this.sendPut_(e);for(;this.onDisconnectRequestQueue_.length;){var n=this.onDisconnectRequestQueue_.shift();this.sendOnDisconnect_(n.action,n.pathString,n.data,n.onComplete)}},e.prototype.sendConnectStats_=function(){var t={},e="js";v.CONSTANTS.NODE_ADMIN?e="admin_node":v.CONSTANTS.NODE_CLIENT&&(e="node"),t["sdk."+e+"."+b.SDK_VERSION.replace(/\./g,"-")]=1,v.isMobileCordova()?t["framework.cordova"]=1:v.isReactNative()&&(t["framework.reactnative"]=1),this.reportStats(t)},e.prototype.shouldReconnect_=function(){var t=tn.getInstance().currentlyOnline();return v.isEmpty(this.interruptReasons_)&&t},e.nextPersistentConnectionId_=0,e.nextConnectionId_=0,e}(hn),mn=function(t){function e(e,n,r){var i=t.call(this)||this;return i.repoInfo_=e,i.onDataUpdate_=n,i.authTokenProvider_=r,i.log_=O("p:rest:"),i.listens_={},i}return _.__extends(e,t),e.prototype.reportStats=function(t){throw new Error("Method not implemented.")},e.getListenId_=function(t,e){return void 0!==e?"tag$"+e:(v.assert(t.getQueryParams().isDefault(),"should have a tag if it's not a default query."),t.path.toString())},e.prototype.listen=function(t,n,r,i){var o=this,a=t.path.toString();this.log_("Listen called for "+a+" "+t.queryIdentifier());var s=e.getListenId_(t,r),u={};this.listens_[s]=u;var c=t.getQueryParams().toRestQueryStringParameters();this.restRequest_(a+".json",c,function(t,e){var n=e;if(404===t&&(n=null,t=null),null===t&&o.onDataUpdate_(a,n,!1,r),v.safeGet(o.listens_,s)===u){var c;c=t?401==t?"permission_denied":"rest_error:"+t:"ok",i(c,null)}})},e.prototype.unlisten=function(t,n){var r=e.getListenId_(t,n);delete this.listens_[r]},e.prototype.refreshAuthToken=function(t){},e.prototype.restRequest_=function(t,e,n){var r=this;void 0===e&&(e={}),e.format="export",this.authTokenProvider_.getToken(!1).then(function(i){var o=i&&i.accessToken;o&&(e.auth=o);var a=(r.repoInfo_.secure?"https://":"http://")+r.repoInfo_.host+t+"?"+v.querystring(e);r.log_("Sending REST request for "+a);var s=new XMLHttpRequest;s.onreadystatechange=function(){if(n&&4===s.readyState){r.log_("REST Response for "+a+" received. status:",s.status,"response:",s.responseText);var t=null;if(s.status>=200&&s.status<300){try{t=v.jsonEval(s.responseText)}catch(t){U("Failed to parse JSON response for "+a+": "+s.responseText)}n(null,t)}else 401!==s.status&&404!==s.status&&U("Got unsuccessful REST response for "+a+" Status: "+s.status),n(s.status);n=null}},s.open("GET",a,!0),s.send()})},e}(hn),gn=function(){function t(t,e,n){var r=this;this.repoInfo_=t,this.app=n,this.dataUpdateCount=0,this.statsListener_=null,this.eventQueue_=new Xe,this.nextWriteId_=1,this.interceptServerDataCallback_=null,this.onDisconnect_=new he,this.persistentConnection_=null;var i=new Ge(n);if(this.stats_=We.getCollection(t),e||nt())this.server_=new mn(this.repoInfo_,this.onDataUpdate_.bind(this),i),setTimeout(this.onConnectStatus_.bind(this,!0),0);else{var o=n.options.databaseAuthVariableOverride;if("undefined"!==typeof o&&null!==o){if("object"!==typeof o)throw new Error("Only objects are supported for option databaseAuthVariableOverride");try{v.stringify(o)}catch(t){throw new Error("Invalid authOverride provided: "+t)}}this.persistentConnection_=new pn(this.repoInfo_,this.onDataUpdate_.bind(this),this.onConnectStatus_.bind(this),this.onServerInfoUpdate_.bind(this),i,o),this.server_=this.persistentConnection_}i.addTokenChangeListener(function(t){r.server_.refreshAuthToken(t)}),this.statsReporter_=We.getOrCreateReporter(t,function(){return new Qe(r.stats_,r.server_)}),this.transactions_init_(),this.infoData_=new He,this.infoSyncTree_=new je({startListening:function(t,e,n,i){var o=[],a=r.infoData_.getNode(t.path);return a.isEmpty()||(o=r.infoSyncTree_.applyServerOverwrite(t.path,a),setTimeout(function(){i("ok")},0)),o},stopListening:function(){}}),this.updateInfo_("connected",!1),this.serverSyncTree_=new je({startListening:function(t,e,n,i){return r.server_.listen(t,n,e,function(e,n){var o=i(e,n);r.eventQueue_.raiseEventsForChangedPath(t.path,o)}),[]},stopListening:function(t,e){r.server_.unlisten(t,e)}})}return t.prototype.toString=function(){return(this.repoInfo_.secure?"https://":"http://")+this.repoInfo_.host},t.prototype.name=function(){return this.repoInfo_.namespace},t.prototype.serverTime=function(){var t=this.infoData_.getNode(new it(".info/serverTimeOffset")),e=t.val()||0;return(new Date).getTime()+e},t.prototype.generateServerValues=function(){return fe({timestamp:this.serverTime()})},t.prototype.onDataUpdate_=function(t,e,n,r){this.dataUpdateCount++;var i=new it(t);e=this.interceptServerDataCallback_?this.interceptServerDataCallback_(t,e):e;var o=[];if(r)if(n){var a=v.map(e,function(t){return u(t)});o=this.serverSyncTree_.applyTaggedQueryMerge(i,a,r)}else{var s=u(e);o=this.serverSyncTree_.applyTaggedQueryOverwrite(i,s,r)}else if(n){var c=v.map(e,function(t){return u(t)});o=this.serverSyncTree_.applyServerMerge(i,c)}else{var l=u(e);o=this.serverSyncTree_.applyServerOverwrite(i,l)}var h=i;o.length>0&&(h=this.rerunTransactions_(i)),this.eventQueue_.raiseEventsForChangedPath(h,o)},t.prototype.interceptServerData_=function(t){this.interceptServerDataCallback_=t},t.prototype.onConnectStatus_=function(t){this.updateInfo_("connected",t),!1===t&&this.runOnDisconnectEvents_()},t.prototype.onServerInfoUpdate_=function(t){var e=this;K(t,function(t,n){e.updateInfo_(n,t)})},t.prototype.updateInfo_=function(t,e){var n=new it("/.info/"+t),r=u(e);this.infoData_.updateSnapshot(n,r);var i=this.infoSyncTree_.applyServerOverwrite(n,r);this.eventQueue_.raiseEventsForChangedPath(n,i)},t.prototype.getNextWriteId_=function(){return this.nextWriteId_++},t.prototype.setWithPriority=function(t,e,n,r){var i=this;this.log_("set",{path:t.toString(),value:e,priority:n});var o=this.generateServerValues(),a=u(e,n),s=me(a,o),c=this.getNextWriteId_(),l=this.serverSyncTree_.applyUserOverwrite(t,s,c,!0);this.eventQueue_.queueEvents(l),this.server_.put(t.toString(),a.val(!0),function(e,n){var o="ok"===e;o||U("set at "+t+" failed: "+e);var a=i.serverSyncTree_.ackUserWrite(c,!o);i.eventQueue_.raiseEventsForChangedPath(t,a),i.callOnCompleteCallback(r,e,n)});var h=this.abortTransactions_(t);this.rerunTransactions_(h),this.eventQueue_.raiseEventsForChangedPath(h,[])},t.prototype.update=function(t,e,n){var r=this;this.log_("update",{path:t.toString(),value:e});var i=!0,o=this.generateServerValues(),a={};if(v.forEach(e,function(t,e){i=!1;var n=u(e);a[t]=me(n,o)}),i)D("update() called with empty data.  Don't do anything."),this.callOnCompleteCallback(n,"ok");else{var s=this.getNextWriteId_(),c=this.serverSyncTree_.applyUserMerge(t,a,s);this.eventQueue_.queueEvents(c),this.server_.merge(t.toString(),e,function(e,i){var o="ok"===e;o||U("update at "+t+" failed: "+e);var a=r.serverSyncTree_.ackUserWrite(s,!o),u=a.length>0?r.rerunTransactions_(t):t;r.eventQueue_.raiseEventsForChangedPath(u,a),r.callOnCompleteCallback(n,e,i)}),v.forEach(e,function(e){var n=r.abortTransactions_(t.child(e));r.rerunTransactions_(n)}),this.eventQueue_.raiseEventsForChangedPath(t,[])}},t.prototype.runOnDisconnectEvents_=function(){var t=this;this.log_("onDisconnectEvents");var e=this.generateServerValues(),n=pe(this.onDisconnect_,e),r=[];n.forEachTree(it.Empty,function(e,n){r=r.concat(t.serverSyncTree_.applyServerOverwrite(e,n));var i=t.abortTransactions_(e);t.rerunTransactions_(i)}),this.onDisconnect_=new he,this.eventQueue_.raiseEventsForChangedPath(it.Empty,r)},t.prototype.onDisconnectCancel=function(t,e){var n=this;this.server_.onDisconnectCancel(t.toString(),function(r,i){"ok"===r&&n.onDisconnect_.forget(t),n.callOnCompleteCallback(e,r,i)})},t.prototype.onDisconnectSet=function(t,e,n){var r=this,i=u(e);this.server_.onDisconnectPut(t.toString(),i.val(!0),function(e,o){"ok"===e&&r.onDisconnect_.remember(t,i),r.callOnCompleteCallback(n,e,o)})},t.prototype.onDisconnectSetWithPriority=function(t,e,n,r){var i=this,o=u(e,n);this.server_.onDisconnectPut(t.toString(),o.val(!0),function(e,n){"ok"===e&&i.onDisconnect_.remember(t,o),i.callOnCompleteCallback(r,e,n)})},t.prototype.onDisconnectUpdate=function(t,e,n){var r=this;if(v.isEmpty(e))return D("onDisconnect().update() called with empty data.  Don't do anything."),void this.callOnCompleteCallback(n,"ok");this.server_.onDisconnectMerge(t.toString(),e,function(i,o){"ok"===i&&v.forEach(e,function(e,n){var i=u(n);r.onDisconnect_.remember(t.child(e),i)}),r.callOnCompleteCallback(n,i,o)})},t.prototype.addEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.addEventRegistration(t,e):this.serverSyncTree_.addEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.removeEventCallbackForQuery=function(t,e){var n;n=".info"===t.path.getFront()?this.infoSyncTree_.removeEventRegistration(t,e):this.serverSyncTree_.removeEventRegistration(t,e),this.eventQueue_.raiseEventsAtPath(t.path,n)},t.prototype.interrupt=function(){this.persistentConnection_&&this.persistentConnection_.interrupt("repo_interrupt")},t.prototype.resume=function(){this.persistentConnection_&&this.persistentConnection_.resume("repo_interrupt")},t.prototype.stats=function(t){if(void 0===t&&(t=!1),"undefined"!==typeof console){var e;t?(this.statsListener_||(this.statsListener_=new qe(this.stats_)),e=this.statsListener_.get()):e=this.stats_.get();var n=Object.keys(e).reduce(function(t,e){return Math.max(e.length,t)},0);v.forEach(e,function(t,e){for(var r=t.length;r<n+2;r++)t+=" ";console.log(t+e)})}},t.prototype.statsIncrementCounter=function(t){this.stats_.incrementCounter(t),this.statsReporter_.includeStat(t)},t.prototype.log_=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n="";this.persistentConnection_&&(n=this.persistentConnection_.id+":"),D.apply(void 0,[n].concat(t))},t.prototype.callOnCompleteCallback=function(t,e,n){t&&et(function(){if("ok"==e)t(null);else{var r=(e||"error").toUpperCase(),i=r;n&&(i+=": "+n);var o=new Error(i);o.code=r,t(o)}})},Object.defineProperty(t.prototype,"database",{get:function(){return this.__database||(this.__database=new Cn(this))},enumerable:!0,configurable:!0}),t}(),vn=function(){function t(e){this.indexedFilter_=new Ae(e.getIndex()),this.index_=e.getIndex(),this.startPost_=t.getStartPost_(e),this.endPost_=t.getEndPost_(e)}return t.prototype.getStartPost=function(){return this.startPost_},t.prototype.getEndPost=function(){return this.endPost_},t.prototype.matches=function(t){return this.index_.compare(this.getStartPost(),t)<=0&&this.index_.compare(t,this.getEndPost())<=0},t.prototype.updateChild=function(t,e,n,r,i,o){return this.matches(new Pt(e,n))||(n=Qt.EMPTY_NODE),this.indexedFilter_.updateChild(t,e,n,r,i,o)},t.prototype.updateFullNode=function(t,e,n){e.isLeafNode()&&(e=Qt.EMPTY_NODE);var r=e.withIndex(this.index_);r=r.updatePriority(Qt.EMPTY_NODE);var i=this;return e.forEachChild(Bt,function(t,e){i.matches(new Pt(t,e))||(r=r.updateImmediateChild(t,Qt.EMPTY_NODE))}),this.indexedFilter_.updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.indexedFilter_},t.prototype.getIndex=function(){return this.index_},t.getStartPost_=function(t){if(t.hasStart()){var e=t.getIndexStartName();return t.getIndex().makePost(t.getIndexStartValue(),e)}return t.getIndex().minPost()},t.getEndPost_=function(t){if(t.hasEnd()){var e=t.getIndexEndName();return t.getIndex().makePost(t.getIndexEndValue(),e)}return t.getIndex().maxPost()},t}(),yn=function(){function t(t){this.rangedFilter_=new vn(t),this.index_=t.getIndex(),this.limit_=t.getLimit(),this.reverse_=!t.isViewFromLeft()}return t.prototype.updateChild=function(t,e,n,r,i,o){return this.rangedFilter_.matches(new Pt(e,n))||(n=Qt.EMPTY_NODE),t.getImmediateChild(e).equals(n)?t:t.numChildren()<this.limit_?this.rangedFilter_.getIndexedFilter().updateChild(t,e,n,r,i,o):this.fullLimitUpdateChild_(t,e,n,i,o)},t.prototype.updateFullNode=function(t,e,n){var r;if(e.isLeafNode()||e.isEmpty())r=Qt.EMPTY_NODE.withIndex(this.index_);else if(2*this.limit_<e.numChildren()&&e.isIndexed(this.index_)){r=Qt.EMPTY_NODE.withIndex(this.index_);var i=void 0;i=this.reverse_?e.getReverseIteratorFrom(this.rangedFilter_.getEndPost(),this.index_):e.getIteratorFrom(this.rangedFilter_.getStartPost(),this.index_);for(var o=0;i.hasNext()&&o<this.limit_;){var a=i.getNext(),s=void 0;if(!(s=this.reverse_?this.index_.compare(this.rangedFilter_.getStartPost(),a)<=0:this.index_.compare(a,this.rangedFilter_.getEndPost())<=0))break;r=r.updateImmediateChild(a.name,a.node),o++}}else{r=e.withIndex(this.index_),r=r.updatePriority(Qt.EMPTY_NODE);var u=void 0,c=void 0,l=void 0,i=void 0;if(this.reverse_){i=r.getReverseIterator(this.index_),u=this.rangedFilter_.getEndPost(),c=this.rangedFilter_.getStartPost();var h=this.index_.getCompare();l=function(t,e){return h(e,t)}}else i=r.getIterator(this.index_),u=this.rangedFilter_.getStartPost(),c=this.rangedFilter_.getEndPost(),l=this.index_.getCompare();for(var o=0,f=!1;i.hasNext();){var a=i.getNext();!f&&l(u,a)<=0&&(f=!0);var s=f&&o<this.limit_&&l(a,c)<=0;s?o++:r=r.updateImmediateChild(a.name,Qt.EMPTY_NODE)}}return this.rangedFilter_.getIndexedFilter().updateFullNode(t,r,n)},t.prototype.updatePriority=function(t,e){return t},t.prototype.filtersNodes=function(){return!0},t.prototype.getIndexedFilter=function(){return this.rangedFilter_.getIndexedFilter()},t.prototype.getIndex=function(){return this.index_},t.prototype.fullLimitUpdateChild_=function(t,e,n,r,i){var o;if(this.reverse_){var a=this.index_.getCompare();o=function(t,e){return a(e,t)}}else o=this.index_.getCompare();var s=t;v.assert(s.numChildren()==this.limit_,"");var u=new Pt(e,n),c=this.reverse_?s.getFirstChild(this.index_):s.getLastChild(this.index_),l=this.rangedFilter_.matches(u);if(s.hasChild(e)){for(var h=s.getImmediateChild(e),f=r.getChildAfterChild(this.index_,c,this.reverse_);null!=f&&(f.name==e||s.hasChild(f.name));)f=r.getChildAfterChild(this.index_,f,this.reverse_);var d=null==f?1:o(f,u);if(l&&!n.isEmpty()&&d>=0)return null!=i&&i.trackChildChange(Me.childChangedChange(e,n,h)),s.updateImmediateChild(e,n);null!=i&&i.trackChildChange(Me.childRemovedChange(e,h));var p=s.updateImmediateChild(e,Qt.EMPTY_NODE);return null!=f&&this.rangedFilter_.matches(f)?(null!=i&&i.trackChildChange(Me.childAddedChange(f.name,f.node)),p.updateImmediateChild(f.name,f.node)):p}return n.isEmpty()?t:l&&o(c,u)>=0?(null!=i&&(i.trackChildChange(Me.childRemovedChange(c.name,c.node)),i.trackChildChange(Me.childAddedChange(e,n))),s.updateImmediateChild(e,n).updateImmediateChild(c.name,Qt.EMPTY_NODE)):t},t}(),_n=function(){function t(){this.limitSet_=!1,this.startSet_=!1,this.startNameSet_=!1,this.endSet_=!1,this.endNameSet_=!1,this.limit_=0,this.viewFrom_="",this.indexStartValue_=null,this.indexStartName_="",this.indexEndValue_=null,this.indexEndName_="",this.index_=Bt}return t.prototype.hasStart=function(){return this.startSet_},t.prototype.isViewFromLeft=function(){return""===this.viewFrom_?this.startSet_:this.viewFrom_===t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT},t.prototype.getIndexStartValue=function(){return v.assert(this.startSet_,"Only valid if start has been set"),this.indexStartValue_},t.prototype.getIndexStartName=function(){return v.assert(this.startSet_,"Only valid if start has been set"),this.startNameSet_?this.indexStartName_:j},t.prototype.hasEnd=function(){return this.endSet_},t.prototype.getIndexEndValue=function(){return v.assert(this.endSet_,"Only valid if end has been set"),this.indexEndValue_},t.prototype.getIndexEndName=function(){return v.assert(this.endSet_,"Only valid if end has been set"),this.endNameSet_?this.indexEndName_:H},t.prototype.hasLimit=function(){return this.limitSet_},t.prototype.hasAnchoredLimit=function(){return this.limitSet_&&""!==this.viewFrom_},t.prototype.getLimit=function(){return v.assert(this.limitSet_,"Only valid if limit has been set"),this.limit_},t.prototype.getIndex=function(){return this.index_},t.prototype.copy_=function(){var e=new t;return e.limitSet_=this.limitSet_,e.limit_=this.limit_,e.startSet_=this.startSet_,e.indexStartValue_=this.indexStartValue_,e.startNameSet_=this.startNameSet_,e.indexStartName_=this.indexStartName_,e.endSet_=this.endSet_,e.indexEndValue_=this.indexEndValue_,e.endNameSet_=this.endNameSet_,e.indexEndName_=this.indexEndName_,e.index_=this.index_,e.viewFrom_=this.viewFrom_,e},t.prototype.limit=function(t){var e=this.copy_();return e.limitSet_=!0,e.limit_=t,e.viewFrom_="",e},t.prototype.limitToFirst=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_LEFT,n},t.prototype.limitToLast=function(e){var n=this.copy_();return n.limitSet_=!0,n.limit_=e,n.viewFrom_=t.WIRE_PROTOCOL_CONSTANTS_.VIEW_FROM_RIGHT,n},t.prototype.startAt=function(t,e){var n=this.copy_();return n.startSet_=!0,void 0===t&&(t=null),n.indexStartValue_=t,null!=e?(n.startNameSet_=!0,n.indexStartName_=e):(n.startNameSet_=!1,n.indexStartName_=""),n},t.prototype.endAt=function(t,e){var n=this.copy_();return n.endSet_=!0,void 0===t&&(t=null),n.indexEndValue_=t,void 0!==e?(n.endNameSet_=!0,n.indexEndName_=e):(n.endNameSet_=!1,n.indexEndName_=""),n},t.prototype.orderBy=function(t){var e=this.copy_();return e.index_=t,e},t.prototype.getQueryObject=function(){var e=t.WIRE_PROTOCOL_CONSTANTS_,n={};if(this.startSet_&&(n[e.INDEX_START_VALUE]=this.indexStartValue_,this.startNameSet_&&(n[e.INDEX_START_NAME]=this.indexStartName_)),this.endSet_&&(n[e.INDEX_END_VALUE]=this.indexEndValue_,this.endNameSet_&&(n[e.INDEX_END_NAME]=this.indexEndName_)),this.limitSet_){n[e.LIMIT]=this.limit_;var r=this.viewFrom_;""===r&&(r=this.isViewFromLeft()?e.VIEW_FROM_LEFT:e.VIEW_FROM_RIGHT),n[e.VIEW_FROM]=r}return this.index_!==Bt&&(n[e.INDEX]=this.index_.toString()),n},t.prototype.loadsAllData=function(){return!(this.startSet_||this.endSet_||this.limitSet_)},t.prototype.isDefault=function(){return this.loadsAllData()&&this.index_==Bt},t.prototype.getNodeFilter=function(){return this.loadsAllData()?new Ae(this.getIndex()):this.hasLimit()?new yn(this):new vn(this)},t.prototype.toRestQueryStringParameters=function(){var e=t.REST_QUERY_CONSTANTS_,n={};if(this.isDefault())return n;var r;return this.index_===Bt?r=e.PRIORITY_INDEX:this.index_===ne?r=e.VALUE_INDEX:this.index_===Ot?r=e.KEY_INDEX:(v.assert(this.index_ instanceof re,"Unrecognized index type!"),r=this.index_.toString()),n[e.ORDER_BY]=v.stringify(r),this.startSet_&&(n[e.START_AT]=v.stringify(this.indexStartValue_),this.startNameSet_&&(n[e.START_AT]+=","+v.stringify(this.indexStartName_))),this.endSet_&&(n[e.END_AT]=v.stringify(this.indexEndValue_),this.endNameSet_&&(n[e.END_AT]+=","+v.stringify(this.indexEndName_))),this.limitSet_&&(this.isViewFromLeft()?n[e.LIMIT_TO_FIRST]=this.limit_:n[e.LIMIT_TO_LAST]=this.limit_),n},t.WIRE_PROTOCOL_CONSTANTS_={INDEX_START_VALUE:"sp",INDEX_START_NAME:"sn",INDEX_END_VALUE:"ep",INDEX_END_NAME:"en",LIMIT:"l",VIEW_FROM:"vf",VIEW_FROM_LEFT:"l",VIEW_FROM_RIGHT:"r",INDEX:"i"},t.REST_QUERY_CONSTANTS_={ORDER_BY:"orderBy",PRIORITY_INDEX:"$priority",VALUE_INDEX:"$value",KEY_INDEX:"$key",START_AT:"startAt",END_AT:"endAt",LIMIT_TO_FIRST:"limitToFirst",LIMIT_TO_LAST:"limitToLast"},t.DEFAULT=new t,t}(),bn=function(t){function e(e,n){if(!(e instanceof gn))throw new Error("new Reference() no longer supported - use app.database().");return t.call(this,e,n,_n.DEFAULT,!1)||this}return _.__extends(e,t),e.prototype.getKey=function(){return v.validateArgCount("Reference.key",0,0,arguments.length),this.path.isEmpty()?null:this.path.getBack()},e.prototype.child=function(t){return v.validateArgCount("Reference.child",1,1,arguments.length),"number"===typeof t?t=String(t):t instanceof it||(null===this.path.getFront()?Tt("Reference.child",1,t,!1):xt("Reference.child",1,t,!1)),new e(this.repo,this.path.child(t))},e.prototype.getParent=function(){v.validateArgCount("Reference.parent",0,0,arguments.length);var t=this.path.parent();return null===t?null:new e(this.repo,t)},e.prototype.getRoot=function(){v.validateArgCount("Reference.root",0,0,arguments.length);for(var t=this;null!==t.getParent();)t=t.getParent();return t},e.prototype.databaseProp=function(){return this.repo.database},e.prototype.set=function(t,e){v.validateArgCount("Reference.set",1,2,arguments.length),St("Reference.set",this.path),gt("Reference.set",1,t,this.path,!1),v.validateCallback("Reference.set",2,e,!0);var n=new v.Deferred;return this.repo.setWithPriority(this.path,t,null,n.wrapCallback(e)),n.promise},e.prototype.update=function(t,e){if(v.validateArgCount("Reference.update",1,2,arguments.length),St("Reference.update",this.path),Array.isArray(t)){for(var n={},r=0;r<t.length;++r)n[""+r]=t[r];t=n,U("Passing an Array to Firebase.update() is deprecated. Use set() if you want to overwrite the existing data, or an Object with integer keys if you really do want to only update some of the children.")}_t("Reference.update",1,t,this.path,!1),v.validateCallback("Reference.update",2,e,!0);var i=new v.Deferred;return this.repo.update(this.path,t,i.wrapCallback(e)),i.promise},e.prototype.setWithPriority=function(t,e,n){if(v.validateArgCount("Reference.setWithPriority",2,3,arguments.length),St("Reference.setWithPriority",this.path),gt("Reference.setWithPriority",1,t,this.path,!1),bt("Reference.setWithPriority",2,e,!1),v.validateCallback("Reference.setWithPriority",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.setWithPriority failed: "+this.getKey()+" is a read-only object.";var r=new v.Deferred;return this.repo.setWithPriority(this.path,t,e,r.wrapCallback(n)),r.promise},e.prototype.remove=function(t){return v.validateArgCount("Reference.remove",0,1,arguments.length),St("Reference.remove",this.path),v.validateCallback("Reference.remove",1,t,!0),this.set(null,t)},e.prototype.transaction=function(t,e,n){if(v.validateArgCount("Reference.transaction",1,3,arguments.length),St("Reference.transaction",this.path),v.validateCallback("Reference.transaction",1,t,!1),v.validateCallback("Reference.transaction",2,e,!0),Mt("Reference.transaction",3,n,!0),".length"===this.getKey()||".keys"===this.getKey())throw"Reference.transaction failed: "+this.getKey()+" is a read-only object.";void 0===n&&(n=!0);var r=new v.Deferred;"function"===typeof e&&r.promise.catch(function(){});var i=function(t,n,i){t?r.reject(t):r.resolve(new It(n,i)),"function"===typeof e&&e(t,n,i)};return this.repo.startTransaction(this.path,t,i,n),r.promise},e.prototype.setPriority=function(t,e){v.validateArgCount("Reference.setPriority",1,2,arguments.length),St("Reference.setPriority",this.path),bt("Reference.setPriority",1,t,!1),v.validateCallback("Reference.setPriority",2,e,!0);var n=new v.Deferred;return this.repo.setWithPriority(this.path.child(".priority"),t,null,n.wrapCallback(e)),n.promise},e.prototype.push=function(t,e){v.validateArgCount("Reference.push",0,2,arguments.length),St("Reference.push",this.path),gt("Reference.push",1,t,this.path,!0),v.validateCallback("Reference.push",2,e,!0);var n,r=this.repo.serverTime(),i=Rt(r),o=this.child(i),a=this.child(i);return n=null!=t?o.set(t,e).then(function(){return a}):Promise.resolve(a),o.then=n.then.bind(n),o.catch=n.then.bind(n,void 0),"function"===typeof e&&n.catch(function(){}),o},e.prototype.onDisconnect=function(){return St("Reference.onDisconnect",this.path),new At(this.repo,this.path)},Object.defineProperty(e.prototype,"database",{get:function(){return this.databaseProp()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.getKey()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){return this.getParent()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"root",{get:function(){return this.getRoot()},enumerable:!0,configurable:!0}),e}(ce);ce.__referenceConstructor=bn,Ue.__referenceConstructor=bn;var wn,En=function(){function t(){this.children={},this.childCount=0,this.value=null}return t}(),xn=function(){function t(t,e,n){void 0===t&&(t=""),void 0===e&&(e=null),void 0===n&&(n=new En),this.name_=t,this.parent_=e,this.node_=n}return t.prototype.subTree=function(e){for(var n,r=e instanceof it?e:new it(e),i=this;null!==(n=r.getFront());){i=new t(n,i,v.safeGet(i.node_.children,n)||new En),r=r.popFront()}return i},t.prototype.getValue=function(){return this.node_.value},t.prototype.setValue=function(t){v.assert("undefined"!==typeof t,"Cannot set value to undefined"),this.node_.value=t,this.updateParents_()},t.prototype.clear=function(){this.node_.value=null,this.node_.children={},this.node_.childCount=0,this.updateParents_()},t.prototype.hasChildren=function(){return this.node_.childCount>0},t.prototype.isEmpty=function(){return null===this.getValue()&&!this.hasChildren()},t.prototype.forEachChild=function(e){var n=this;v.forEach(this.node_.children,function(r,i){e(new t(r,n,i))})},t.prototype.forEachDescendant=function(t,e,n){e&&!n&&t(this),this.forEachChild(function(e){e.forEachDescendant(t,!0,n)}),e&&n&&t(this)},t.prototype.forEachAncestor=function(t,e){for(var n=e?this:this.parent();null!==n;){if(t(n))return!0;n=n.parent()}return!1},t.prototype.forEachImmediateDescendantWithValue=function(t){this.forEachChild(function(e){null!==e.getValue()?t(e):e.forEachImmediateDescendantWithValue(t)})},t.prototype.path=function(){return new it(null===this.parent_?this.name_:this.parent_.path()+"/"+this.name_)},t.prototype.name=function(){return this.name_},t.prototype.parent=function(){return this.parent_},t.prototype.updateParents_=function(){null!==this.parent_&&this.parent_.updateChild_(this.name_,this)},t.prototype.updateChild_=function(t,e){var n=e.isEmpty(),r=v.contains(this.node_.children,t);n&&r?(delete this.node_.children[t],this.node_.childCount--,this.updateParents_()):n||r||(this.node_.children[t]=e.node_,this.node_.childCount++,this.updateParents_())},t}();!function(t){t[t.RUN=0]="RUN",t[t.SENT=1]="SENT",t[t.COMPLETED=2]="COMPLETED",t[t.SENT_NEEDS_ABORT=3]="SENT_NEEDS_ABORT",t[t.NEEDS_ABORT=4]="NEEDS_ABORT"}(wn||(wn={})),gn.MAX_TRANSACTION_RETRIES_=25,gn.prototype.transactions_init_=function(){this.transactionQueueTree_=new xn},gn.prototype.startTransaction=function(t,e,n,r){this.log_("transaction on "+t);var i=function(){},o=new bn(this,t);o.on("value",i);var a=function(){o.off("value",i)},s={path:t,update:e,onComplete:n,status:null,order:M(),applyLocally:r,retryCount:0,unwatcher:a,abortReason:null,currentWriteId:null,currentInputSnapshot:null,currentOutputSnapshotRaw:null,currentOutputSnapshotResolved:null},c=this.getLatestState_(t);s.currentInputSnapshot=c;var l=s.update(c.val());if(void 0===l){if(s.unwatcher(),s.currentOutputSnapshotRaw=null,s.currentOutputSnapshotResolved=null,s.onComplete){var h=new ie(s.currentInputSnapshot,new bn(this,s.path),Bt);s.onComplete(null,!1,h)}}else{vt("transaction failed: Data returned ",l,s.path),s.status=wn.RUN;var f=this.transactionQueueTree_.subTree(t),d=f.getValue()||[];d.push(s),f.setValue(d);var p=void 0;if("object"===typeof l&&null!==l&&v.contains(l,".priority"))p=v.safeGet(l,".priority"),v.assert(mt(p),"Invalid priority returned by transaction. Priority must be a valid string, finite number, server value, or null.");else{p=(this.serverSyncTree_.calcCompleteEventCache(t)||Qt.EMPTY_NODE).getPriority().val()}p=p;var m=this.generateServerValues(),g=u(l,p),y=me(g,m);s.currentOutputSnapshotRaw=g,s.currentOutputSnapshotResolved=y,s.currentWriteId=this.getNextWriteId_();var _=this.serverSyncTree_.applyUserOverwrite(t,y,s.currentWriteId,s.applyLocally);this.eventQueue_.raiseEventsForChangedPath(t,_),this.sendReadyTransactions_()}},gn.prototype.getLatestState_=function(t,e){return this.serverSyncTree_.calcCompleteEventCache(t,e)||Qt.EMPTY_NODE},gn.prototype.sendReadyTransactions_=function(t){var e=this;if(void 0===t&&(t=this.transactionQueueTree_),t||this.pruneCompletedTransactionsBelowNode_(t),null!==t.getValue()){var n=this.buildTransactionQueue_(t);v.assert(n.length>0,"Sending zero length transaction queue");n.every(function(t){return t.status===wn.RUN})&&this.sendTransactionQueue_(t.path(),n)}else t.hasChildren()&&t.forEachChild(function(t){e.sendReadyTransactions_(t)})},gn.prototype.sendTransactionQueue_=function(t,e){for(var n=this,r=e.map(function(t){return t.currentWriteId}),i=this.getLatestState_(t,r),o=i,a=i.hash(),s=0;s<e.length;s++){var u=e[s];v.assert(u.status===wn.RUN,"tryToSendTransactionQueue_: items in queue should all be run."),u.status=wn.SENT,u.retryCount++;var c=it.relativePath(t,u.path);o=o.updateChild(c,u.currentOutputSnapshotRaw)}var l=o.val(!0),h=t;this.server_.put(h.toString(),l,function(r){n.log_("transaction put response",{path:h.toString(),status:r});var i=[];if("ok"===r){for(var o=[],a=0;a<e.length;a++){if(e[a].status=wn.COMPLETED,i=i.concat(n.serverSyncTree_.ackUserWrite(e[a].currentWriteId)),e[a].onComplete){var s=e[a].currentOutputSnapshotResolved,u=new bn(n,e[a].path),c=new ie(s,u,Bt);o.push(e[a].onComplete.bind(null,null,!0,c))}e[a].unwatcher()}n.pruneCompletedTransactionsBelowNode_(n.transactionQueueTree_.subTree(t)),n.sendReadyTransactions_(),n.eventQueue_.raiseEventsForChangedPath(t,i);for(var a=0;a<o.length;a++)et(o[a])}else{if("datastale"===r)for(var a=0;a<e.length;a++)e[a].status===wn.SENT_NEEDS_ABORT?e[a].status=wn.NEEDS_ABORT:e[a].status=wn.RUN;else{U("transaction at "+h.toString()+" failed: "+r);for(var a=0;a<e.length;a++)e[a].status=wn.NEEDS_ABORT,e[a].abortReason=r}n.rerunTransactions_(t)}},a)},gn.prototype.rerunTransactions_=function(t){var e=this.getAncestorTransactionNode_(t),n=e.path(),r=this.buildTransactionQueue_(e);return this.rerunTransactionQueue_(r,n),n},gn.prototype.rerunTransactionQueue_=function(t,e){if(0!==t.length){for(var n=[],r=[],i=t.filter(function(t){return t.status===wn.RUN}),o=i.map(function(t){return t.currentWriteId}),a=0;a<t.length;a++){var s=t[a],c=it.relativePath(e,s.path),l=!1,h=void 0;if(v.assert(null!==c,"rerunTransactionsUnderNode_: relativePath should not be null."),s.status===wn.NEEDS_ABORT)l=!0,h=s.abortReason,r=r.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else if(s.status===wn.RUN)if(s.retryCount>=gn.MAX_TRANSACTION_RETRIES_)l=!0,h="maxretry",r=r.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0));else{var f=this.getLatestState_(s.path,o);s.currentInputSnapshot=f;var d=t[a].update(f.val());if(void 0!==d){vt("transaction failed: Data returned ",d,s.path);var p=u(d),m="object"===typeof d&&null!=d&&v.contains(d,".priority");m||(p=p.updatePriority(f.getPriority()));var g=s.currentWriteId,y=this.generateServerValues(),_=me(p,y);s.currentOutputSnapshotRaw=p,s.currentOutputSnapshotResolved=_,s.currentWriteId=this.getNextWriteId_(),o.splice(o.indexOf(g),1),r=r.concat(this.serverSyncTree_.applyUserOverwrite(s.path,_,s.currentWriteId,s.applyLocally)),r=r.concat(this.serverSyncTree_.ackUserWrite(g,!0))}else l=!0,h="nodata",r=r.concat(this.serverSyncTree_.ackUserWrite(s.currentWriteId,!0))}if(this.eventQueue_.raiseEventsForChangedPath(e,r),r=[],l&&(t[a].status=wn.COMPLETED,function(t){setTimeout(t,Math.floor(0))}(t[a].unwatcher),t[a].onComplete))if("nodata"===h){var b=new bn(this,t[a].path),w=t[a].currentInputSnapshot,E=new ie(w,b,Bt);n.push(t[a].onComplete.bind(null,null,!1,E))}else n.push(t[a].onComplete.bind(null,new Error(h),!1,null))}this.pruneCompletedTransactionsBelowNode_(this.transactionQueueTree_);for(var a=0;a<n.length;a++)et(n[a]);this.sendReadyTransactions_()}},gn.prototype.getAncestorTransactionNode_=function(t){for(var e,n=this.transactionQueueTree_;null!==(e=t.getFront())&&null===n.getValue();)n=n.subTree(e),t=t.popFront();return n},gn.prototype.buildTransactionQueue_=function(t){var e=[];return this.aggregateTransactionQueuesForNode_(t,e),e.sort(function(t,e){return t.order-e.order}),e},gn.prototype.aggregateTransactionQueuesForNode_=function(t,e){var n=this,r=t.getValue();if(null!==r)for(var i=0;i<r.length;i++)e.push(r[i]);t.forEachChild(function(t){n.aggregateTransactionQueuesForNode_(t,e)})},gn.prototype.pruneCompletedTransactionsBelowNode_=function(t){var e=this,n=t.getValue();if(n){for(var r=0,i=0;i<n.length;i++)n[i].status!==wn.COMPLETED&&(n[r]=n[i],r++);n.length=r,t.setValue(n.length>0?n:null)}t.forEachChild(function(t){e.pruneCompletedTransactionsBelowNode_(t)})},gn.prototype.abortTransactions_=function(t){var e=this,n=this.getAncestorTransactionNode_(t).path(),r=this.transactionQueueTree_.subTree(t);return r.forEachAncestor(function(t){e.abortTransactionsOnNode_(t)}),this.abortTransactionsOnNode_(r),r.forEachDescendant(function(t){e.abortTransactionsOnNode_(t)}),n},gn.prototype.abortTransactionsOnNode_=function(t){var e=t.getValue();if(null!==e){for(var n=[],r=[],i=-1,o=0;o<e.length;o++)if(e[o].status===wn.SENT_NEEDS_ABORT);else if(e[o].status===wn.SENT)v.assert(i===o-1,"All SENT items should be at beginning of queue."),i=o,e[o].status=wn.SENT_NEEDS_ABORT,e[o].abortReason="set";else if(v.assert(e[o].status===wn.RUN,"Unexpected transaction status in abort"),e[o].unwatcher(),r=r.concat(this.serverSyncTree_.ackUserWrite(e[o].currentWriteId,!0)),e[o].onComplete){n.push(e[o].onComplete.bind(null,new Error("set"),!1,null))}-1===i?t.setValue(null):e.length=i+1,this.eventQueue_.raiseEventsForChangedPath(t.path(),r);for(var o=0;o<n.length;o++)et(n[o])}};var Tn,Sn=function(){function t(){this.repos_={},this.useRestClient_=!1}return t.getInstance=function(){return Tn||(Tn=new t),Tn},t.prototype.interrupt=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].interrupt()},t.prototype.resume=function(){for(var t in this.repos_)for(var e in this.repos_[t])this.repos_[t][e].resume()},t.prototype.databaseFromApp=function(t,e){var n=e||t.options.databaseURL;void 0===n&&L("Can't determine Firebase Database URL.  Be sure to include databaseURL option when calling firebase.initializeApp().");var r=ut(n),i=r.repoInfo;return Ct("Invalid Firebase Database URL",1,r),r.path.isEmpty()||L("Database URL must point to the root of a Firebase Database (not including a child path)."),this.createRepo(i,t).database},t.prototype.deleteRepo=function(t){var e=v.safeGet(this.repos_,t.app.name);e&&v.safeGet(e,t.repoInfo_.toURLString())===t||L("Database "+t.app.name+"("+t.repoInfo_+") has already been deleted."),t.interrupt(),delete e[t.repoInfo_.toURLString()]},t.prototype.createRepo=function(t,e){var n=v.safeGet(this.repos_,e.name);n||(n={},this.repos_[e.name]=n);var r=v.safeGet(n,t.toURLString());return r&&L("Database initialized multiple times. Please make sure the format of the database URL matches with each database() call."),r=new gn(t,this.useRestClient_,e),n[t.toURLString()]=r,r},t.prototype.forceRestClient=function(t){this.useRestClient_=t},t}(),Cn=function(){function t(t){this.repo_=t,t instanceof gn||L("Don't call new Database() directly - please use firebase.database()."),this.root_=new bn(t,it.Empty),this.INTERNAL=new Mn(this)}return Object.defineProperty(t.prototype,"app",{get:function(){return this.repo_.app},enumerable:!0,configurable:!0}),t.prototype.ref=function(t){return this.checkDeleted_("ref"),v.validateArgCount("database.ref",0,1,arguments.length),t instanceof bn?this.refFromURL(t.toString()):void 0!==t?this.root_.child(t):this.root_},t.prototype.refFromURL=function(t){var e="database.refFromURL";this.checkDeleted_(e),v.validateArgCount(e,1,1,arguments.length);var n=ut(t);Ct(e,1,n);var r=n.repoInfo;return r.host!==this.repo_.repoInfo_.host&&L(e+": Host name does not match the current database: (found "+r.host+" but expected "+this.repo_.repoInfo_.host+")"),this.ref(n.path.toString())},t.prototype.checkDeleted_=function(t){null===this.repo_&&L("Cannot call "+t+" on a deleted database.")},t.prototype.goOffline=function(){v.validateArgCount("database.goOffline",0,0,arguments.length),this.checkDeleted_("goOffline"),this.repo_.interrupt()},t.prototype.goOnline=function(){v.validateArgCount("database.goOnline",0,0,arguments.length),this.checkDeleted_("goOnline"),this.repo_.resume()},t.ServerValue={TIMESTAMP:{".sv":"timestamp"}},t}(),Mn=function(){function t(t){this.database=t}return t.prototype.delete=function(){return _.__awaiter(this,void 0,void 0,function(){return _.__generator(this,function(t){return this.database.checkDeleted_("delete"),Sn.getInstance().deleteRepo(this.database.repo_),this.database.repo_=null,this.database.root_=null,this.database.INTERNAL=null,this.database=null,[2]})})},t}(),An=function(){un.forceDisallow(),on.forceAllow()},In=function(){on.forceDisallow()},Rn=function(){return un.isAvailable()},Pn=function(t,e){t.repo.persistentConnection_.securityDebugCallback_=e},Nn=function(t,e){t.repo.stats(e)},Dn=function(t,e){t.repo.statsIncrementCounter(e)},On=function(t){return t.repo.dataUpdateCount},kn=function(t,e){return t.repo.interceptServerData_(e)},Ln=Object.freeze({forceLongPolling:An,forceWebSockets:In,isWebSocketsAvailable:Rn,setSecurityDebugCallback:Pn,stats:Nn,statsIncrementCounter:Dn,dataUpdateCount:On,interceptServerData:kn}),Un=pn;pn.prototype.simpleListen=function(t,e){this.sendRequest("q",{p:t},e)},pn.prototype.echo=function(t,e){this.sendRequest("echo",{d:t},e)};var Fn=ln,Bn=function(t){var e=pn.prototype.put;return pn.prototype.put=function(n,r,i,o){void 0!==o&&(o=t()),e.call(this,n,r,i,o)},function(){pn.prototype.put=e}},Vn=st,jn=function(t){return t.queryIdentifier()},Hn=function(t){return t.repo.persistentConnection_.listens_},Gn=function(t){Sn.getInstance().forceRestClient(t)},zn=Object.freeze({DataConnection:Un,RealTimeConnection:Fn,hijackHash:Bn,ConnectionTarget:Vn,queryIdentifier:jn,listens:Hn,forceRestClient:Gn}),Wn=Cn.ServerValue;c(b),e.registerDatabase=c,e.Database=Cn,e.Query=ce,e.Reference=bn,e.enableLogging=N,e.ServerValue=Wn,e.DataSnapshot=ie,e.OnDisconnect=At}).call(e,n(7))},function(t,e,n){n(80)},function(t,e,n){"use strict";function r(t,e){if(null==t||null==e)return!1;if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(var n=new DataView(t),r=new DataView(e),i=0;i<t.byteLength;i++)if(n.getUint8(i)!==r.getUint8(i))return!1;return!0}function i(t){var e=new Uint8Array(t);return btoa(String.fromCharCode.apply(null,e))}function o(t){return i(t).replace(/=/g,"").replace(/\+/g,"-").replace(/\//g,"_")}function a(t){for(var e="=".repeat((4-t.length%4)%4),n=(t+e).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(n),i=new Uint8Array(r.length),o=0;o<r.length;++o)i[o]=r.charCodeAt(o);return i}function s(t){if(t.objectStoreNames.contains(A)){var e=t.transaction(A),n=e.objectStore(A),r=new C,i=n.openCursor();i.onerror=function(t){console.warn("Unable to cleanup old IDB.",t)},i.onsuccess=function(){var e=i.result;if(e){var n=e.value;r.deleteToken(n.fcmSenderId,n.fcmToken,n.fcmPushSet),e.continue()}else t.close(),indexedDB.deleteDatabase(M)}}}function u(){var t=indexedDB.open(M);t.onerror=function(t){},t.onsuccess=function(e){s(t.result)}}function c(t){return new Promise(function(e,n){t.onsuccess=function(){e(t.result)},t.onerror=function(){n(t.error)}})}function l(t){if(t.fcmToken&&("string"!==typeof t.fcmToken||0===t.fcmToken.length))throw E.create(b.BAD_TOKEN);if(t.swScope&&("string"!==typeof t.swScope||0===t.swScope.length))throw E.create(b.BAD_SCOPE);if(t.vapidKey&&(!(t.vapidKey instanceof Uint8Array)||65!==t.vapidKey.length))throw E.create(b.BAD_VAPID_KEY);if(t.endpoint&&("string"!==typeof t.endpoint||0===t.endpoint.length))throw E.create(b.BAD_SUBSCRIPTION);if(t.auth&&!(t.auth instanceof ArrayBuffer))throw E.create(b.BAD_SUBSCRIPTION);if(t.p256dh&&!(t.p256dh instanceof ArrayBuffer))throw E.create(b.BAD_SUBSCRIPTION);if(t.fcmSenderId&&("string"!==typeof t.fcmSenderId||0===t.fcmSenderId.length))throw E.create(b.BAD_SENDER_ID);if(t.fcmPushSet&&("string"!==typeof t.fcmPushSet||0===t.fcmPushSet.length))throw E.create(b.BAD_PUSH_SET)}function h(t,e,n){if(!r(e.buffer,n.vapidKey.buffer))return!1;var i=t.endpoint===n.endpoint,o=r(t.getKey("auth"),n.auth),a=r(t.getKey("p256dh"),n.p256dh);return i&&o&&a}function f(){return self.clients.matchAll({type:"window",includeUncontrolled:!0})}function d(t,e){return n={},n[g.TYPE_OF_MSG]=t,n[g.DATA]=e,n;var n}function p(t){var e=function(t){return self&&"ServiceWorkerGlobalScope"in self?new O(t):new k(t)},n={Messaging:k};t.INTERNAL.registerService("messaging",e,n)}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"registerMessaging",function(){return p});var m,g,v=n(8),y=(n.n(v),n(3)),_=n(2),b={AVAILABLE_IN_WINDOW:"only-available-in-window",AVAILABLE_IN_SW:"only-available-in-sw",SHOULD_BE_INHERITED:"should-be-overriden",BAD_SENDER_ID:"bad-sender-id",INCORRECT_GCM_SENDER_ID:"incorrect-gcm-sender-id",PERMISSION_DEFAULT:"permission-default",PERMISSION_BLOCKED:"permission-blocked",UNSUPPORTED_BROWSER:"unsupported-browser",NOTIFICATIONS_BLOCKED:"notifications-blocked",FAILED_DEFAULT_REGISTRATION:"failed-serviceworker-registration",SW_REGISTRATION_EXPECTED:"sw-registration-expected",GET_SUBSCRIPTION_FAILED:"get-subscription-failed",INVALID_SAVED_TOKEN:"invalid-saved-token",SW_REG_REDUNDANT:"sw-reg-redundant",TOKEN_SUBSCRIBE_FAILED:"token-subscribe-failed",TOKEN_SUBSCRIBE_NO_TOKEN:"token-subscribe-no-token",TOKEN_SUBSCRIBE_NO_PUSH_SET:"token-subscribe-no-push-set",TOKEN_UNSUBSCRIBE_FAILED:"token-unsubscribe-failed",TOKEN_UPDATE_FAILED:"token-update-failed",TOKEN_UPDATE_NO_TOKEN:"token-update-no-token",USE_SW_BEFORE_GET_TOKEN:"use-sw-before-get-token",INVALID_DELETE_TOKEN:"invalid-delete-token",DELETE_TOKEN_NOT_FOUND:"delete-token-not-found",DELETE_SCOPE_NOT_FOUND:"delete-scope-not-found",BG_HANDLER_FUNCTION_EXPECTED:"bg-handler-function-expected",NO_WINDOW_CLIENT_TO_MSG:"no-window-client-to-msg",UNABLE_TO_RESUBSCRIBE:"unable-to-resubscribe",NO_FCM_TOKEN_FOR_RESUBSCRIBE:"no-fcm-token-for-resubscribe",FAILED_TO_DELETE_TOKEN:"failed-to-delete-token",NO_SW_IN_REG:"no-sw-in-reg",BAD_SCOPE:"bad-scope",BAD_VAPID_KEY:"bad-vapid-key",BAD_SUBSCRIPTION:"bad-subscription",BAD_TOKEN:"bad-token",BAD_PUSH_SET:"bad-push-set",FAILED_DELETE_VAPID_KEY:"failed-delete-vapid-key",INVALID_PUBLIC_VAPID_KEY:"invalid-public-vapid-key",USE_PUBLIC_KEY_BEFORE_GET_TOKEN:"use-public-key-before-get-token",PUBLIC_KEY_DECRYPTION_FAILED:"public-vapid-key-decryption-failed"},w=(m={},m[b.AVAILABLE_IN_WINDOW]="This method is available in a Window context.",m[b.AVAILABLE_IN_SW]="This method is available in a service worker context.",m[b.SHOULD_BE_INHERITED]="This method should be overriden by extended classes.",m[b.BAD_SENDER_ID]="Please ensure that 'messagingSenderId' is set correctly in the options passed into firebase.initializeApp().",m[b.PERMISSION_DEFAULT]="The required permissions were not granted and dismissed instead.",m[b.PERMISSION_BLOCKED]="The required permissions were not granted and blocked instead.",m[b.UNSUPPORTED_BROWSER]="This browser doesn't support the API's required to use the firebase SDK.",m[b.NOTIFICATIONS_BLOCKED]="Notifications have been blocked.",m[b.FAILED_DEFAULT_REGISTRATION]="We are unable to register the default service worker. {$browserErrorMessage}",m[b.SW_REGISTRATION_EXPECTED]="A service worker registration was the expected input.",m[b.GET_SUBSCRIPTION_FAILED]="There was an error when trying to get any existing Push Subscriptions.",m[b.INVALID_SAVED_TOKEN]="Unable to access details of the saved token.",m[b.SW_REG_REDUNDANT]="The service worker being used for push was made redundant.",m[b.TOKEN_SUBSCRIBE_FAILED]="A problem occured while subscribing the user to FCM: {$message}",m[b.TOKEN_SUBSCRIBE_NO_TOKEN]="FCM returned no token when subscribing the user to push.",m[b.TOKEN_SUBSCRIBE_NO_PUSH_SET]="FCM returned an invalid response when getting an FCM token.",m[b.TOKEN_UNSUBSCRIBE_FAILED]="A problem occured while unsubscribing the user from FCM: {$message}",m[b.TOKEN_UPDATE_FAILED]="A problem occured while updating the user from FCM: {$message}",m[b.TOKEN_UPDATE_NO_TOKEN]="FCM returned no token when updating the user to push.",m[b.USE_SW_BEFORE_GET_TOKEN]="The useServiceWorker() method may only be called once and must be called before calling getToken() to ensure your service worker is used.",m[b.INVALID_DELETE_TOKEN]="You must pass a valid token into deleteToken(), i.e. the token from getToken().",m[b.DELETE_TOKEN_NOT_FOUND]="The deletion attempt for token could not be performed as the token was not found.",m[b.DELETE_SCOPE_NOT_FOUND]="The deletion attempt for service worker scope could not be performed as the scope was not found.",m[b.BG_HANDLER_FUNCTION_EXPECTED]="The input to setBackgroundMessageHandler() must be a function.",m[b.NO_WINDOW_CLIENT_TO_MSG]="An attempt was made to message a non-existant window client.",m[b.UNABLE_TO_RESUBSCRIBE]="There was an error while re-subscribing the FCM token for push messaging. Will have to resubscribe the user on next visit. {$message}",m[b.NO_FCM_TOKEN_FOR_RESUBSCRIBE]="Could not find an FCM token and as a result, unable to resubscribe. Will have to resubscribe the user on next visit.",m[b.FAILED_TO_DELETE_TOKEN]="Unable to delete the currently saved token.",m[b.NO_SW_IN_REG]="Even though the service worker registration was successful, there was a problem accessing the service worker itself.",m[b.INCORRECT_GCM_SENDER_ID]="Please change your web app manifest's 'gcm_sender_id' value to '103953800507' to use Firebase messaging.",m[b.BAD_SCOPE]="The service worker scope must be a string with at least one character.",m[b.BAD_VAPID_KEY]="The public VAPID key is not a Uint8Array with 65 bytes.",m[b.BAD_SUBSCRIPTION]="The subscription must be a valid PushSubscription.",m[b.BAD_TOKEN]="The FCM Token used for storage / lookup was not a valid token string.",m[b.BAD_PUSH_SET]="The FCM push set used for storage / lookup was not not a valid push set string.",m[b.FAILED_DELETE_VAPID_KEY]="The VAPID key could not be deleted.",m[b.INVALID_PUBLIC_VAPID_KEY]="The public VAPID key must be a string.",m[b.PUBLIC_KEY_DECRYPTION_FAILED]="The public VAPID key did not equal 65 bytes when decrypted.",m),E=new v.ErrorFactory("messaging","Messaging",w),x=new Uint8Array([4,51,148,247,223,161,235,177,220,3,162,94,21,113,219,72,211,46,237,237,178,52,219,183,71,58,12,143,196,204,225,111,60,140,132,223,171,182,102,62,242,12,212,139,254,227,249,118,47,20,28,99,8,106,111,45,177,26,149,176,206,55,192,156,110]),T="https://fcm.googleapis.com";!function(t){t.TYPE_OF_MSG="firebase-messaging-msg-type",t.DATA="firebase-messaging-msg-data"}(g||(g={}));var S;!function(t){t.PUSH_MSG_RECEIVED="push-msg-received",t.NOTIFICATION_CLICKED="notification-clicked"}(S||(S={}));var C=function(){function t(){}return t.prototype.getToken=function(t,e,n){return Object(y.__awaiter)(this,void 0,void 0,function(){var r,i,a,s,u,c,l,h,f,d;return Object(y.__generator)(this,function(p){switch(p.label){case 0:r=o(e.getKey("p256dh")),i=o(e.getKey("auth")),a="authorized_entity="+t+"&endpoint="+e.endpoint+"&encryption_key="+r+"&encryption_auth="+i,n!==x&&(s=o(n),a+="&application_pub_key="+s),u=new Headers,u.append("Content-Type","application/x-www-form-urlencoded"),c={method:"POST",headers:u,body:a},p.label=1;case 1:return p.trys.push([1,4,,5]),[4,fetch(T+"/fcm/connect/subscribe",c)];case 2:return h=p.sent(),[4,h.json()];case 3:return l=p.sent(),[3,5];case 4:throw f=p.sent(),E.create(b.TOKEN_SUBSCRIBE_FAILED);case 5:if(l.error)throw d=l.error.message,E.create(b.TOKEN_SUBSCRIBE_FAILED,{message:d});if(!l.token)throw E.create(b.TOKEN_SUBSCRIBE_NO_TOKEN);if(!l.pushSet)throw E.create(b.TOKEN_SUBSCRIBE_NO_PUSH_SET);return[2,{token:l.token,pushSet:l.pushSet}]}})})},t.prototype.updateToken=function(t,e,n,r,i){return Object(y.__awaiter)(this,void 0,void 0,function(){var a,s,u,c,l,h,f,d,p,m;return Object(y.__generator)(this,function(g){switch(g.label){case 0:a=o(r.getKey("p256dh")),s=o(r.getKey("auth")),u="push_set="+n+"&token="+e+"&authorized_entity="+t+"&endpoint="+r.endpoint+"&encryption_key="+a+"&encryption_auth="+s,i!==x&&(c=o(i),u+="&application_pub_key="+c),l=new Headers,l.append("Content-Type","application/x-www-form-urlencoded"),h={method:"POST",headers:l,body:u},g.label=1;case 1:return g.trys.push([1,4,,5]),[4,fetch(T+"/fcm/connect/subscribe",h)];case 2:return d=g.sent(),[4,d.json()];case 3:return f=g.sent(),[3,5];case 4:throw p=g.sent(),E.create(b.TOKEN_UPDATE_FAILED);case 5:if(f.error)throw m=f.error.message,E.create(b.TOKEN_UPDATE_FAILED,{message:m});if(!f.token)throw E.create(b.TOKEN_UPDATE_NO_TOKEN);return[2,f.token]}})})},t.prototype.deleteToken=function(t,e,n){return Object(y.__awaiter)(this,void 0,void 0,function(){var r,i,o,a,s,u,c;return Object(y.__generator)(this,function(l){switch(l.label){case 0:r="authorized_entity="+t+"&token="+e+"&pushSet="+n,i=new Headers,i.append("Content-Type","application/x-www-form-urlencoded"),o={method:"POST",headers:i,body:r},l.label=1;case 1:return l.trys.push([1,4,,5]),[4,fetch(T+"/fcm/connect/unsubscribe",o)];case 2:return a=l.sent(),[4,a.json()];case 3:if(s=l.sent(),s.error)throw u=s.error.message,E.create(b.TOKEN_UNSUBSCRIBE_FAILED,{message:u});return[3,5];case 4:throw c=l.sent(),E.create(b.TOKEN_UNSUBSCRIBE_FAILED);case 5:return[2]}})})},t}(),M="undefined",A="fcm_token_object_Store",I=function(){function t(){this.dbPromise=null}return t.prototype.get=function(t){return this.createTransaction(function(e){return e.get(t)})},t.prototype.getIndex=function(t,e){function n(n){return n.index(t).get(e)}return this.createTransaction(n)},t.prototype.put=function(t){return this.createTransaction(function(e){return e.put(t)},"readwrite")},t.prototype.delete=function(t){return this.createTransaction(function(e){return e.delete(t)},"readwrite")},t.prototype.closeDatabase=function(){return Object(y.__awaiter)(this,void 0,void 0,function(){var t;return Object(y.__generator)(this,function(e){switch(e.label){case 0:return this.dbPromise?[4,this.dbPromise]:[3,2];case 1:t=e.sent(),t.close(),this.dbPromise=null,e.label=2;case 2:return[2]}})})},t.prototype.createTransaction=function(t,e){return Object(y.__awaiter)(this,void 0,void 0,function(){var n,r,i,o;return Object(y.__generator)(this,function(a){switch(a.label){case 0:return[4,this.getDb()];case 1:return n=a.sent(),r=n.transaction(this.objectStoreName,e),i=r.objectStore(this.objectStoreName),[4,c(t(i))];case 2:return o=a.sent(),[2,new Promise(function(t,e){r.oncomplete=function(){t(o)},r.onerror=function(){e(r.error)}})]}})})},t.prototype.getDb=function(){var t=this;return this.dbPromise||(this.dbPromise=new Promise(function(e,n){var r=indexedDB.open(t.dbName,t.dbVersion);r.onsuccess=function(){e(r.result)},r.onerror=function(){t.dbPromise=null,n(r.error)},r.onupgradeneeded=function(e){return t.onDbUpgrade(r,e)}})),this.dbPromise},t}(),R=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dbName="fcm_token_details_db",e.dbVersion=3,e.objectStoreName="fcm_token_object_Store",e}return Object(y.__extends)(e,t),e.prototype.onDbUpgrade=function(t,e){var n=t.result;switch(e.oldVersion){case 0:var r=n.createObjectStore(this.objectStoreName,{keyPath:"swScope"});r.createIndex("fcmSenderId","fcmSenderId",{unique:!1}),r.createIndex("fcmToken","fcmToken",{unique:!0});case 1:u();case 2:var r=t.transaction.objectStore(this.objectStoreName),i=r.openCursor();i.onsuccess=function(){var t=i.result;if(t){var e=t.value,n=Object(y.__assign)({},e);e.createTime||(n.createTime=Date.now()),"string"===typeof e.vapidKey&&(n.vapidKey=a(e.vapidKey)),"string"===typeof e.auth&&(n.auth=a(e.auth).buffer),"string"===typeof e.auth&&(n.p256dh=a(e.p256dh).buffer),t.update(n),t.continue()}}}},e.prototype.getTokenDetailsFromToken=function(t){return Object(y.__awaiter)(this,void 0,void 0,function(){return Object(y.__generator)(this,function(e){if(!t)throw E.create(b.BAD_TOKEN);return l({fcmToken:t}),[2,this.getIndex("fcmToken",t)]})})},e.prototype.getTokenDetailsFromSWScope=function(t){return Object(y.__awaiter)(this,void 0,void 0,function(){return Object(y.__generator)(this,function(e){if(!t)throw E.create(b.BAD_SCOPE);return l({swScope:t}),[2,this.get(t)]})})},e.prototype.saveTokenDetails=function(t){return Object(y.__awaiter)(this,void 0,void 0,function(){return Object(y.__generator)(this,function(e){if(!t.swScope)throw E.create(b.BAD_SCOPE);if(!t.vapidKey)throw E.create(b.BAD_VAPID_KEY);if(!t.endpoint||!t.auth||!t.p256dh)throw E.create(b.BAD_SUBSCRIPTION);if(!t.fcmSenderId)throw E.create(b.BAD_SENDER_ID);if(!t.fcmToken)throw E.create(b.BAD_TOKEN);if(!t.fcmPushSet)throw E.create(b.BAD_PUSH_SET);return l(t),[2,this.put(t)]})})},e.prototype.deleteToken=function(t){return Object(y.__awaiter)(this,void 0,void 0,function(){var e;return Object(y.__generator)(this,function(n){switch(n.label){case 0:return"string"!==typeof t||0===t.length?[2,Promise.reject(E.create(b.INVALID_DELETE_TOKEN))]:[4,this.getTokenDetailsFromToken(t)];case 1:if(!(e=n.sent()))throw E.create(b.DELETE_TOKEN_NOT_FOUND);return[4,this.delete(e.swScope)];case 2:return n.sent(),[2,e]}})})},e}(I),P=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.dbName="fcm_vapid_details_db",e.dbVersion=1,e.objectStoreName="fcm_vapid_object_Store",e}return Object(y.__extends)(e,t),e.prototype.onDbUpgrade=function(t){t.result.createObjectStore(this.objectStoreName,{keyPath:"swScope"})},e.prototype.getVapidFromSWScope=function(t){return Object(y.__awaiter)(this,void 0,void 0,function(){var e;return Object(y.__generator)(this,function(n){switch(n.label){case 0:if("string"!==typeof t||0===t.length)throw E.create(b.BAD_SCOPE);return[4,this.get(t)];case 1:return e=n.sent(),[2,e?e.vapidKey:void 0]}})})},e.prototype.saveVapidDetails=function(t,e){return Object(y.__awaiter)(this,void 0,void 0,function(){var n;return Object(y.__generator)(this,function(r){if("string"!==typeof t||0===t.length)throw E.create(b.BAD_SCOPE);if(null===e||65!==e.length)throw E.create(b.BAD_VAPID_KEY);return n={swScope:t,vapidKey:e},[2,this.put(n)]})})},e.prototype.deleteVapidDetails=function(t){return Object(y.__awaiter)(this,void 0,void 0,function(){var e;return Object(y.__generator)(this,function(n){switch(n.label){case 0:return[4,this.getVapidFromSWScope(t)];case 1:if(!(e=n.sent()))throw E.create(b.DELETE_SCOPE_NOT_FOUND);return[4,this.delete(t)];case 2:return n.sent(),[2,e]}})})},e}(I),N="messagingSenderId",D=function(){function t(t){var e=this;if(!t.options[N]||"string"!==typeof t.options[N])throw E.create(b.BAD_SENDER_ID);this.messagingSenderId=t.options[N],this.tokenDetailsModel=new R,this.vapidDetailsModel=new P,this.iidModel=new C,this.app=t,this.INTERNAL={delete:function(){return e.delete()}}}return t.prototype.getToken=function(){return Object(y.__awaiter)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(y.__generator)(this,function(o){switch(o.label){case 0:return t=this.getNotificationPermission_(),"granted"!==t?"denied"===t?[2,Promise.reject(E.create(b.NOTIFICATIONS_BLOCKED))]:[2,Promise.resolve(null)]:[4,this.getSWRegistration_()];case 1:return e=o.sent(),[4,this.getPublicVapidKey_()];case 2:return n=o.sent(),[4,this.getPushSubscription(e,n)];case 3:return r=o.sent(),[4,this.tokenDetailsModel.getTokenDetailsFromSWScope(e.scope)];case 4:return i=o.sent(),i?[2,this.manageExistingToken(e,r,n,i)]:[2,this.getNewToken(e,r,n)]}})})},t.prototype.manageExistingToken=function(t,e,n,r){return Object(y.__awaiter)(this,void 0,void 0,function(){var i,o;return Object(y.__generator)(this,function(a){switch(a.label){case 0:return i=h(e,n,r),i?(o=Date.now(),o<r.createTime+6048e5?[2,r.fcmToken]:[2,this.updateToken(t,e,n,r)]):[4,this.deleteTokenFromDB(r.fcmToken)];case 1:return a.sent(),[2,this.getNewToken(t,e,n)]}})})},t.prototype.updateToken=function(t,e,n,r){return Object(y.__awaiter)(this,void 0,void 0,function(){var i,o,a;return Object(y.__generator)(this,function(s){switch(s.label){case 0:return s.trys.push([0,4,,6]),[4,this.iidModel.updateToken(this.messagingSenderId,r.fcmToken,r.fcmPushSet,e,n)];case 1:return i=s.sent(),o={swScope:t.scope,vapidKey:n,fcmSenderId:this.messagingSenderId,fcmToken:i,fcmPushSet:r.fcmPushSet,createTime:Date.now(),endpoint:e.endpoint,auth:e.getKey("auth"),p256dh:e.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(o)];case 2:return s.sent(),[4,this.vapidDetailsModel.saveVapidDetails(t.scope,n)];case 3:return s.sent(),[2,i];case 4:return a=s.sent(),[4,this.deleteToken(r.fcmToken)];case 5:throw s.sent(),a;case 6:return[2]}})})},t.prototype.getNewToken=function(t,e,n){return Object(y.__awaiter)(this,void 0,void 0,function(){var r,i;return Object(y.__generator)(this,function(o){switch(o.label){case 0:return[4,this.iidModel.getToken(this.messagingSenderId,e,n)];case 1:return r=o.sent(),i={swScope:t.scope,vapidKey:n,fcmSenderId:this.messagingSenderId,fcmToken:r.token,fcmPushSet:r.pushSet,createTime:Date.now(),endpoint:e.endpoint,auth:e.getKey("auth"),p256dh:e.getKey("p256dh")},[4,this.tokenDetailsModel.saveTokenDetails(i)];case 2:return o.sent(),[4,this.vapidDetailsModel.saveVapidDetails(t.scope,n)];case 3:return o.sent(),[2,r.token]}})})},t.prototype.deleteToken=function(t){return Object(y.__awaiter)(this,void 0,void 0,function(){var e,n;return Object(y.__generator)(this,function(r){switch(r.label){case 0:return[4,this.deleteTokenFromDB(t)];case 1:return r.sent(),[4,this.getSWRegistration_()];case 2:return e=r.sent(),e?[4,e.pushManager.getSubscription()]:[3,4];case 3:if(n=r.sent())return[2,n.unsubscribe()];r.label=4;case 4:return[2,!0]}})})},t.prototype.deleteTokenFromDB=function(t){return Object(y.__awaiter)(this,void 0,void 0,function(){var e;return Object(y.__generator)(this,function(n){switch(n.label){case 0:return[4,this.tokenDetailsModel.deleteToken(t)];case 1:return e=n.sent(),[4,this.iidModel.deleteToken(e.fcmSenderId,e.fcmToken,e.fcmPushSet)];case 2:return n.sent(),[2]}})})},t.prototype.getPushSubscription=function(t,e){return t.pushManager.getSubscription().then(function(n){return n||t.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:e})})},t.prototype.requestPermission=function(){throw E.create(b.AVAILABLE_IN_WINDOW)},t.prototype.useServiceWorker=function(t){throw E.create(b.AVAILABLE_IN_WINDOW)},t.prototype.usePublicVapidKey=function(t){throw E.create(b.AVAILABLE_IN_WINDOW)},t.prototype.onMessage=function(t,e,n){throw E.create(b.AVAILABLE_IN_WINDOW)},t.prototype.onTokenRefresh=function(t,e,n){throw E.create(b.AVAILABLE_IN_WINDOW)},t.prototype.setBackgroundMessageHandler=function(t){throw E.create(b.AVAILABLE_IN_SW)},t.prototype.delete=function(){return Object(y.__awaiter)(this,void 0,void 0,function(){return Object(y.__generator)(this,function(t){switch(t.label){case 0:return[4,Promise.all([this.tokenDetailsModel.closeDatabase(),this.vapidDetailsModel.closeDatabase()])];case 1:return t.sent(),[2]}})})},t.prototype.getNotificationPermission_=function(){return Notification.permission},t.prototype.getTokenDetailsModel=function(){return this.tokenDetailsModel},t.prototype.getVapidDetailsModel=function(){return this.vapidDetailsModel},t.prototype.getIIDModel=function(){return this.iidModel},t}(),O=function(t){function e(e){var n=t.call(this,e)||this;return n.bgMessageHandler=null,self.addEventListener("push",function(t){n.onPush(t)}),self.addEventListener("pushsubscriptionchange",function(t){n.onSubChange(t)}),self.addEventListener("notificationclick",function(t){n.onNotificationClick(t)}),n}return Object(y.__extends)(e,t),e.prototype.onPush=function(t){t.waitUntil(this.onPush_(t))},e.prototype.onSubChange=function(t){t.waitUntil(this.onSubChange_(t))},e.prototype.onNotificationClick=function(t){t.waitUntil(this.onNotificationClick_(t))},e.prototype.onPush_=function(t){return Object(y.__awaiter)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(y.__generator)(this,function(a){switch(a.label){case 0:if(!t.data)return[2];try{e=t.data.json()}catch(t){return[2]}return[4,this.hasVisibleClients_()];case 1:return(n=a.sent())?e.notification||this.bgMessageHandler?[2,this.sendMessageToWindowClients_(e)]:[2]:(r=this.getNotificationData_(e))?(i=r.title||"",[4,this.getSWRegistration_()]):[3,3];case 2:return o=a.sent(),[2,o.showNotification(i,r)];case 3:return this.bgMessageHandler?[4,this.bgMessageHandler(e)]:[3,5];case 4:return a.sent(),[2];case 5:return[2]}})})},e.prototype.onSubChange_=function(t){return Object(y.__awaiter)(this,void 0,void 0,function(){var t,e,n,r,i;return Object(y.__generator)(this,function(o){switch(o.label){case 0:return o.trys.push([0,2,,3]),[4,this.getSWRegistration_()];case 1:return t=o.sent(),[3,3];case 2:throw e=o.sent(),E.create(b.UNABLE_TO_RESUBSCRIBE,{message:e});case 3:return o.trys.push([3,5,,8]),[4,t.pushManager.getSubscription()];case 4:return o.sent(),[3,8];case 5:return n=o.sent(),r=this.getTokenDetailsModel(),[4,r.getTokenDetailsFromSWScope(t.scope)];case 6:if(!(i=o.sent()))throw n;return[4,this.deleteToken(i.fcmToken)];case 7:throw o.sent(),n;case 8:return[2]}})})},e.prototype.onNotificationClick_=function(t){return Object(y.__awaiter)(this,void 0,void 0,function(){var e,n,r,i;return Object(y.__generator)(this,function(o){switch(o.label){case 0:return t.notification&&t.notification.data&&t.notification.data.FCM_MSG?(t.stopImmediatePropagation(),t.notification.close(),e=t.notification.data.FCM_MSG,e.notification?(n=e.notification.click_action,n?[4,this.getWindowClient_(n)]:[2]):[2]):[2];case 1:return r=o.sent(),r?[3,3]:[4,self.clients.openWindow(n)];case 2:return r=o.sent(),[3,5];case 3:return[4,r.focus()];case 4:r=o.sent(),o.label=5;case 5:return r?(delete e.notification,i=d(S.NOTIFICATION_CLICKED,e),[2,this.attemptToMessageClient_(r,i)]):[2]}})})},e.prototype.getNotificationData_=function(t){if(t&&"object"===typeof t.notification){var e=Object(y.__assign)({},t.notification);return e.data=(n={},n.FCM_MSG=t,n),e;var n}},e.prototype.setBackgroundMessageHandler=function(t){if(!t||"function"!==typeof t)throw E.create(b.BG_HANDLER_FUNCTION_EXPECTED);this.bgMessageHandler=t},e.prototype.getWindowClient_=function(t){return Object(y.__awaiter)(this,void 0,void 0,function(){var e,n,r,i,o;return Object(y.__generator)(this,function(a){switch(a.label){case 0:return e=new URL(t,self.location.href).href,[4,f()];case 1:for(n=a.sent(),r=null,i=0;i<n.length;i++)if((o=new URL(n[i].url,self.location.href).href)===e){r=n[i];break}return[2,r]}})})},e.prototype.attemptToMessageClient_=function(t,e){return Object(y.__awaiter)(this,void 0,void 0,function(){return Object(y.__generator)(this,function(n){if(!t)throw E.create(b.NO_WINDOW_CLIENT_TO_MSG);return t.postMessage(e),[2]})})},e.prototype.hasVisibleClients_=function(){return Object(y.__awaiter)(this,void 0,void 0,function(){var t;return Object(y.__generator)(this,function(e){switch(e.label){case 0:return[4,f()];case 1:return t=e.sent(),[2,t.some(function(t){return"visible"===t.visibilityState})]}})})},e.prototype.sendMessageToWindowClients_=function(t){return Object(y.__awaiter)(this,void 0,void 0,function(){var e,n,r=this;return Object(y.__generator)(this,function(i){switch(i.label){case 0:return[4,f()];case 1:return e=i.sent(),n=d(S.PUSH_MSG_RECEIVED,t),[4,Promise.all(e.map(function(t){return r.attemptToMessageClient_(t,n)}))];case 2:return i.sent(),[2]}})})},e.prototype.getSWRegistration_=function(){return Object(y.__awaiter)(this,void 0,void 0,function(){return Object(y.__generator)(this,function(t){return[2,self.registration]})})},e.prototype.getPublicVapidKey_=function(){return Object(y.__awaiter)(this,void 0,void 0,function(){var t,e;return Object(y.__generator)(this,function(n){switch(n.label){case 0:return[4,this.getSWRegistration_()];case 1:if(!(t=n.sent()))throw E.create(b.SW_REGISTRATION_EXPECTED);return[4,this.getVapidDetailsModel().getVapidFromSWScope(t.scope)];case 2:return e=n.sent(),null==e?[2,x]:[2,e]}})})},e}(D),k=function(t){function e(e){var n=t.call(this,e)||this;return n.registrationToUse=null,n.publicVapidKeyToUse=null,n.manifestCheckPromise=null,n.messageObserver=null,n.tokenRefreshObserver=null,n.onMessageInternal=Object(v.createSubscribe)(function(t){n.messageObserver=t}),n.onTokenRefreshInternal=Object(v.createSubscribe)(function(t){n.tokenRefreshObserver=t}),n.setupSWMessageListener_(),n}return Object(y.__extends)(e,t),e.prototype.getToken=function(){var e=this;return this.isSupported_()?this.manifestCheck_().then(function(){return t.prototype.getToken.call(e)}):Promise.reject(E.create(b.UNSUPPORTED_BROWSER))},e.prototype.manifestCheck_=function(){if(this.manifestCheckPromise)return this.manifestCheckPromise;var t=document.querySelector('link[rel="manifest"]');return this.manifestCheckPromise=t?fetch(t.href).then(function(t){return t.json()}).catch(function(){}).then(function(t){if(t&&t.gcm_sender_id&&"103953800507"!==t.gcm_sender_id)throw E.create(b.INCORRECT_GCM_SENDER_ID)}):Promise.resolve(),this.manifestCheckPromise},e.prototype.requestPermission=function(){return Object(y.__awaiter)(this,void 0,void 0,function(){return Object(y.__generator)(this,function(t){return"granted"===Notification.permission?[2]:[2,new Promise(function(t,e){var n=function(n){return"granted"===n?t():e("denied"===n?E.create(b.PERMISSION_BLOCKED):E.create(b.PERMISSION_DEFAULT))},r=Notification.requestPermission(n);r&&r.then(n)})]})})},e.prototype.useServiceWorker=function(t){if(!(t instanceof ServiceWorkerRegistration))throw E.create(b.SW_REGISTRATION_EXPECTED);if(null!=this.registrationToUse)throw E.create(b.USE_SW_BEFORE_GET_TOKEN);this.registrationToUse=t},e.prototype.usePublicVapidKey=function(t){if("string"!==typeof t)throw E.create(b.INVALID_PUBLIC_VAPID_KEY);if(null!=this.publicVapidKeyToUse)throw E.create(b.USE_PUBLIC_KEY_BEFORE_GET_TOKEN);var e=a(t);if(65!==e.length)throw E.create(b.PUBLIC_KEY_DECRYPTION_FAILED);this.publicVapidKeyToUse=e},e.prototype.onMessage=function(t,e,n){return"function"===typeof t?this.onMessageInternal(t,e,n):this.onMessageInternal(t)},e.prototype.onTokenRefresh=function(t,e,n){return"function"===typeof t?this.onTokenRefreshInternal(t,e,n):this.onTokenRefreshInternal(t)},e.prototype.waitForRegistrationToActivate_=function(t){var e=t.installing||t.waiting||t.active;return new Promise(function(n,r){if(!e)return void r(E.create(b.NO_SW_IN_REG));if("activated"===e.state)return void n(t);if("redundant"===e.state)return void r(E.create(b.SW_REG_REDUNDANT));var i=function(){if("activated"===e.state)n(t);else{if("redundant"!==e.state)return;r(E.create(b.SW_REG_REDUNDANT))}e.removeEventListener("statechange",i)};e.addEventListener("statechange",i)})},e.prototype.getSWRegistration_=function(){var t=this;return this.registrationToUse?this.waitForRegistrationToActivate_(this.registrationToUse):(this.registrationToUse=null,navigator.serviceWorker.register("/firebase-messaging-sw.js",{scope:"/firebase-cloud-messaging-push-scope"}).catch(function(t){throw E.create(b.FAILED_DEFAULT_REGISTRATION,{browserErrorMessage:t.message})}).then(function(e){return t.waitForRegistrationToActivate_(e).then(function(){return t.registrationToUse=e,e.update(),e})}))},e.prototype.getPublicVapidKey_=function(){return this.publicVapidKeyToUse?Promise.resolve(this.publicVapidKeyToUse):Promise.resolve(x)},e.prototype.setupSWMessageListener_=function(){var t=this;"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",function(e){if(e.data&&e.data[g.TYPE_OF_MSG]){var n=e.data;switch(n[g.TYPE_OF_MSG]){case S.PUSH_MSG_RECEIVED:case S.NOTIFICATION_CLICKED:var r=n[g.DATA];t.messageObserver&&t.messageObserver.next(r)}}},!1)},e.prototype.isSupported_=function(){return"serviceWorker"in navigator&&"PushManager"in window&&"Notification"in window&&"fetch"in window&&ServiceWorkerRegistration.prototype.hasOwnProperty("showNotification")&&PushSubscription.prototype.hasOwnProperty("getKey")},e}(D);p(_.default)},function(t,e,n){n(82)},function(t,e,n){"use strict";function r(t){return"storage/"+t}function i(){return new te(ee.UNKNOWN,"An unknown error occurred, please check the error payload for server response.")}function o(t){return new te(ee.OBJECT_NOT_FOUND,"Object '"+t+"' does not exist.")}function a(t){return new te(ee.QUOTA_EXCEEDED,"Quota for bucket '"+t+"' exceeded, please view quota on https://firebase.google.com/pricing/.")}function s(){return new te(ee.UNAUTHENTICATED,"User is not authenticated, please authenticate using Firebase Authentication and try again.")}function u(t){return new te(ee.UNAUTHORIZED,"User does not have permission to access '"+t+"'.")}function c(){return new te(ee.RETRY_LIMIT_EXCEEDED,"Max retry time for operation exceeded, please try again.")}function l(){return new te(ee.CANCELED,"User canceled the upload/download.")}function h(t){return new te(ee.INVALID_URL,"Invalid URL '"+t+"'.")}function f(t){return new te(ee.INVALID_DEFAULT_BUCKET,"Invalid default bucket '"+t+"'.")}function d(){return new te(ee.CANNOT_SLICE_BLOB,"Cannot slice blob for upload. Please retry the upload.")}function p(){return new te(ee.SERVER_FILE_WRONG_SIZE,"Server recorded incorrect upload file size, please retry the upload.")}function m(){return new te(ee.NO_DOWNLOAD_URL,"The given file does not have any download URLs.")}function g(t,e,n){return new te(ee.INVALID_ARGUMENT,"Invalid argument in `"+e+"` at index "+t+": "+n)}function v(t,e,n,r){var i,o;return t===e?(i=t,o=1===t?"argument":"arguments"):(i="between "+t+" and "+e,o="arguments"),new te(ee.INVALID_ARGUMENT_COUNT,"Invalid argument count in `"+n+"`: Expected "+i+" "+o+", received "+r+".")}function y(){return new te(ee.APP_DELETED,"The Firebase app was deleted.")}function _(t){return new te(ee.INVALID_ROOT_OPERATION,"The operation '"+t+"' cannot be performed on a root reference, create a non-root reference using child, such as .child('file.png').")}function b(t,e){return new te(ee.INVALID_FORMAT,"String does not match format '"+t+"': "+e)}function w(t){throw new te(ee.INTERNAL_ERROR,"Internal error: "+t)}function E(t){switch(t){case ne.RAW:case ne.BASE64:case ne.BASE64URL:case ne.DATA_URL:return;default:throw"Expected one of the event types: ["+ne.RAW+", "+ne.BASE64+", "+ne.BASE64URL+", "+ne.DATA_URL+"]."}}function x(t,e){switch(t){case ne.RAW:return new re(T(e));case ne.BASE64:case ne.BASE64URL:return new re(C(t,e));case ne.DATA_URL:return new re(M(e),A(e))}throw i()}function T(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(r<=127)e.push(r);else if(r<=2047)e.push(192|r>>6,128|63&r);else if(55296==(64512&r)){var i=n<t.length-1&&56320==(64512&t.charCodeAt(n+1));if(i){var o=r,a=t.charCodeAt(++n);r=65536|(1023&o)<<10|1023&a,e.push(240|r>>18,128|r>>12&63,128|r>>6&63,128|63&r)}else e.push(239,191,189)}else 56320==(64512&r)?e.push(239,191,189):e.push(224|r>>12,128|r>>6&63,128|63&r)}return new Uint8Array(e)}function S(t){var e;try{e=decodeURIComponent(t)}catch(t){throw b(ne.DATA_URL,"Malformed data URL.")}return T(e)}function C(t,e){switch(t){case ne.BASE64:var n=-1!==e.indexOf("-"),r=-1!==e.indexOf("_");if(n||r){var i=n?"-":"_";throw b(t,"Invalid character '"+i+"' found: is it base64url encoded?")}break;case ne.BASE64URL:var o=-1!==e.indexOf("+"),a=-1!==e.indexOf("/");if(o||a){var i=o?"+":"/";throw b(t,"Invalid character '"+i+"' found: is it base64 encoded?")}e=e.replace(/-/g,"+").replace(/_/g,"/")}var s;try{s=atob(e)}catch(e){throw b(t,"Invalid character found")}for(var u=new Uint8Array(s.length),c=0;c<s.length;c++)u[c]=s.charCodeAt(c);return u}function M(t){var e=new ie(t);return e.base64?C(ne.BASE64,e.rest):S(e.rest)}function A(t){return new ie(t).contentType}function I(t,e){return!!(t.length>=e.length)&&t.substring(t.length-e.length)===e}function R(t){switch(t){case ae.RUNNING:case ae.PAUSING:case ae.CANCELING:return se.RUNNING;case ae.PAUSED:return se.PAUSED;case ae.SUCCESS:return se.SUCCESS;case ae.CANCELED:return se.CANCELED;case ae.ERROR:default:return se.ERROR}}function P(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function N(t,e){for(var n in t)P(t,n)&&e(n,t[n])}function D(t){if(null==t)return{};var e={};return N(t,function(t,n){e[t]=n}),e}function O(t){return new Promise(t)}function k(t){return Promise.resolve(t)}function L(t){return Promise.reject(t)}function U(t){return null!=t}function F(t){return void 0!==t}function B(t){return"function"===typeof t}function V(t){return"object"===typeof t}function j(t){return V(t)&&null!==t}function H(t){return V(t)&&!Array.isArray(t)}function G(t){return"string"===typeof t||t instanceof String}function z(t){return"number"===typeof t||t instanceof Number}function W(t){return q()&&t instanceof Blob}function q(){return"undefined"!==typeof Blob}function Y(t){var e;try{e=JSON.parse(t)}catch(t){return null}return H(e)?e:null}function K(t){if(0==t.length)return null;var e=t.lastIndexOf("/");return-1===e?"":t.slice(0,e)}function Q(t,e){var n=e.split("/").filter(function(t){return t.length>0}).join("/");return 0===t.length?n:t+"/"+n}function X(t){var e=t.lastIndexOf("/",t.length-2);return-1===e?t:t.slice(e+1)}function J(t){return Yt+Qt+t}function Z(t){return Kt+Qt+t}function $(t){return Yt+Xt+t}function tt(t){var e=encodeURIComponent,n="?";return N(t,function(t,r){var i=e(t)+"="+e(r);n=n+i+"&"}),n=n.slice(0,-1)}function et(t,e){return e}function nt(t){return!G(t)||t.length<2?t:(t=t,X(t))}function rt(){function t(t,e){return nt(e)}function e(t,e){return U(e)?+e:e}function n(t,e){if(!(G(e)&&e.length>0))return[];var n=encodeURIComponent;return e.split(",").map(function(e){var r=t.bucket,i=t.fullPath;return Z("/b/"+n(r)+"/o/"+n(i))+tt({alt:"media",token:e})})}if(fe)return fe;var r=[];r.push(new he("bucket")),r.push(new he("generation")),r.push(new he("metageneration")),r.push(new he("name","fullPath",!0));var i=new he("name");i.xform=t,r.push(i);var o=new he("size");return o.xform=e,r.push(o),r.push(new he("timeCreated")),r.push(new he("updated")),r.push(new he("md5Hash",null,!0)),r.push(new he("cacheControl",null,!0)),r.push(new he("contentDisposition",null,!0)),r.push(new he("contentEncoding",null,!0)),r.push(new he("contentLanguage",null,!0)),r.push(new he("contentType",null,!0)),r.push(new he("metadata","customMetadata",!0)),r.push(new he("downloadTokens","downloadURLs",!1,n)),fe=r}function it(t,e){function n(){var n=t.bucket,r=t.fullPath,i=new le(n,r);return e.makeStorageReference(i)}Object.defineProperty(t,"ref",{get:n})}function ot(t,e,n){var r={};r.type="file";for(var i=n.length,o=0;o<i;o++){var a=n[o];r[a.local]=a.xform(r,e[a.server])}return it(r,t),r}function at(t,e,n){var r=Y(e);return null===r?null:ot(t,r,n)}function st(t,e){for(var n={},r=e.length,i=0;i<r;i++){var o=e[i];o.writable&&(n[o.server]=t[o.local])}return JSON.stringify(n)}function ut(t){if(!t||!V(t))throw"Expected Metadata object.";for(var e in t){var n=t[e];if("customMetadata"===e){if(!V(n))throw"Expected object for 'customMetadata' mapping."}else if(j(n))throw"Mapping for '"+e+"' cannot be an object."}}function ct(t,e,n){for(var r=e.length,i=e.length,o=0;o<e.length;o++)if(e[o].optional){r=o;break}if(!(r<=n.length&&n.length<=i))throw v(r,i,t,n.length);for(var o=0;o<n.length;o++)try{e[o].validator(n[o])}catch(e){throw e instanceof Error?g(o,t,e.message):g(o,t,e)}}function lt(t,e){return function(n){t(n),e(n)}}function ht(t,e){function n(t){if(!G(t))throw"Expected string."}var r;return r=t?lt(n,t):n,new de(r,e)}function ft(){function t(t){if(!(t instanceof Uint8Array||t instanceof ArrayBuffer||q()&&t instanceof Blob))throw"Expected Blob or File."}return new de(t)}function dt(t){return new de(ut,t)}function pt(){function t(t){if(!(z(t)&&t>=0))throw"Expected a number 0 or greater."}return new de(t)}function mt(t,e){function n(e){if(!(null===e||U(e)&&e instanceof Object))throw"Expected an Object.";void 0!==t&&null!==t&&t(e)}return new de(n,e)}function gt(t){function e(t){if(null!==t&&!B(t))throw"Expected a Function."}return new de(e,t)}function vt(){return"undefined"!==typeof BlobBuilder?BlobBuilder:"undefined"!==typeof WebKitBlobBuilder?WebKitBlobBuilder:void 0}function yt(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=vt();if(void 0!==n){for(var r=new n,i=0;i<t.length;i++)r.append(t[i]);return r.getBlob()}if(q())return new Blob(t);throw Error("This browser doesn't seem to support creating Blobs")}function _t(t,e,n){return t.webkitSlice?t.webkitSlice(e,n):t.mozSlice?t.mozSlice(e,n):t.slice?t.slice(e,n):null}function bt(t,e){return-1!==t.indexOf(e)}function wt(t){return Array.prototype.slice.call(t)}function Et(t,e){var n=t.indexOf(e);-1!==n&&t.splice(n,1)}function xt(t){if(!t)throw i()}function Tt(t,e){function n(n,r){var i=at(t,r,e);return xt(null!==i),i}return n}function St(t){function e(e,n){var r;return r=401===e.getStatus()?s():402===e.getStatus()?a(t.bucket):403===e.getStatus()?u(t.path):n,r.setServerResponseProp(n.serverResponseProp()),r}return e}function Ct(t){function e(e,r){var i=n(e,r);return 404===e.getStatus()&&(i=o(t.path)),i.setServerResponseProp(r.serverResponseProp()),i}var n=St(t);return e}function Mt(t,e,n){var r=e.fullServerUrl(),i=J(r),o=t.maxOperationRetryTime(),a=new me(i,"GET",Tt(t,n),o);return a.errorHandler=Ct(e),a}function At(t,e,n,r){var i=e.fullServerUrl(),o=J(i),a=st(n,r),s={"Content-Type":"application/json; charset=utf-8"},u=t.maxOperationRetryTime(),c=new me(o,"PATCH",Tt(t,r),u);return c.headers=s,c.body=a,c.errorHandler=Ct(e),c}function It(t,e){function n(t,e){}var r=e.fullServerUrl(),i=J(r),o=t.maxOperationRetryTime(),a=new me(i,"DELETE",n,o);return a.successCodes=[200,204],a.errorHandler=Ct(e),a}function Rt(t,e){return t&&t.contentType||e&&e.type()||"application/octet-stream"}function Pt(t,e,n){var r=D(n);return r.fullPath=t.path,r.size=e.size(),r.contentType||(r.contentType=Rt(null,e)),r}function Nt(t,e,n,r,i){var o=e.bucketOnlyServerUrl(),a={"X-Goog-Upload-Protocol":"multipart"},s=function(){for(var t="",e=0;e<2;e++)t+=Math.random().toString().slice(2);return t}();a["Content-Type"]="multipart/related; boundary="+s;var u=Pt(e,r,i),c=st(u,n),l="--"+s+"\r\nContent-Type: application/json; charset=utf-8\r\n\r\n"+c+"\r\n--"+s+"\r\nContent-Type: "+u.contentType+"\r\n\r\n",h="\r\n--"+s+"--",f=pe.getBlob(l,r,h);if(null===f)throw d();var p={name:u.fullPath},m=$(o),g=t.maxUploadRetryTime(),v=new me(m,"POST",Tt(t,n),g);return v.urlParams=p,v.headers=a,v.body=f.uploadData(),v.errorHandler=St(e),v}function Dt(t,e){var n;try{n=t.getResponseHeader("X-Goog-Upload-Status")}catch(t){xt(!1)}return xt(bt(e||["active"],n)),n}function Ot(t,e,n,r,i){function o(t,e){Dt(t);var n;try{n=t.getResponseHeader("X-Goog-Upload-URL")}catch(t){xt(!1)}return xt(G(n)),n}var a=e.bucketOnlyServerUrl(),s=Pt(e,r,i),u={name:s.fullPath},c=$(a),l={"X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":r.size(),"X-Goog-Upload-Header-Content-Type":s.contentType,"Content-Type":"application/json; charset=utf-8"},h=st(s,n),f=t.maxUploadRetryTime(),d=new me(c,"POST",o,f);return d.urlParams=u,d.headers=l,d.body=h,d.errorHandler=St(e),d}function kt(t,e,n,r){function i(t,e){var n,i=Dt(t,["active","final"]);try{n=t.getResponseHeader("X-Goog-Upload-Size-Received")}catch(t){xt(!1)}var o=parseInt(n,10);return xt(!isNaN(o)),new ge(o,r.size(),"final"===i)}var o={"X-Goog-Upload-Command":"query"},a=t.maxUploadRetryTime(),s=new me(n,"POST",i,a);return s.headers=o,s.errorHandler=St(e),s}function Lt(t,e,n,r,i,o,a,s){function u(t,n){var i,a=Dt(t,["active","final"]),s=c.current+h,u=r.size();return i="final"===a?Tt(e,o)(t,n):null,new ge(s,u,"final"===a,i)}var c=new ge(0,0);if(a?(c.current=a.current,c.total=a.total):(c.current=0,c.total=r.size()),r.size()!==c.total)throw p();var l=c.total-c.current,h=l;i>0&&(h=Math.min(h,i));var f=c.current,m=f+h,g=h===l?"upload, finalize":"upload",v={"X-Goog-Upload-Command":g,"X-Goog-Upload-Offset":c.current},y=r.slice(f,m);if(null===y)throw d();var _=e.maxUploadRetryTime(),b=new me(n,"POST",u,_);return b.headers=v,b.body=y.uploadData(),b.progressCallback=s||null,b.errorHandler=St(t),b}function Ut(t){return function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];k(!0).then(function(){t.apply(null,e)})}}function Ft(t,e,n){function r(){return 2===h}function i(){f||(f=!0,e.apply(null,arguments))}function o(e){c=setTimeout(function(){c=null,t(a,r())},e)}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(!f){if(t)return void i.apply(null,arguments);if(r()||l)return void i.apply(null,arguments);u<64&&(u*=2);var a;1===h?(h=2,a=0):a=1e3*(u+Math.random()),o(a)}}function s(t){d||(d=!0,f||(null!==c?(t||(h=2),clearTimeout(c),o(0)):t||(h=1)))}var u=1,c=null,l=!1,h=0,f=!1,d=!1;return o(0),setTimeout(function(){l=!0,s(!0)},n),s}function Bt(t){t(!1)}function Vt(t,e){null!==e&&e.length>0&&(t.Authorization="Firebase "+e)}function jt(t){var e="undefined"!==typeof qt.default?qt.default.SDK_VERSION:"AppManager";t["X-Firebase-Storage-Version"]="webjs/"+e}function Ht(t,e,n){var r=tt(t.urlParams),i=t.url+r,o=D(t.headers);return Vt(o,e),jt(o),new Te(i,t.method,o,t.body,t.successCodes,t.additionalRetryCodes,t.handler,t.errorHandler,t.timeout,t.progressCallback,n)}function Gt(t,e,n){return new Ce(t,new ce,n)}function zt(t){var e={TaskState:se,TaskEvent:oe,StringFormat:ne,Storage:Ce,Reference:be};t.INTERNAL.registerService(Ae,Gt,e,void 0,!0)}Object.defineProperty(e,"__esModule",{value:!0}),n.d(e,"registerStorage",function(){return zt});var Wt,qt=n(2),Yt="https://firebasestorage.googleapis.com",Kt="https://firebasestorage.googleapis.com",Qt="/v0",Xt="/v0",Jt=12e4,Zt=6e4,$t=-9007199254740991,te=function(){function t(t,e){this.code_=r(t),this.message_="Firebase Storage: "+e,this.serverResponse_=null,this.name_="FirebaseError"}return t.prototype.codeProp=function(){return this.code},t.prototype.codeEquals=function(t){return r(t)===this.codeProp()},t.prototype.serverResponseProp=function(){return this.serverResponse_},t.prototype.setServerResponseProp=function(t){this.serverResponse_=t},Object.defineProperty(t.prototype,"name",{get:function(){return this.name_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"code",{get:function(){return this.code_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"message",{get:function(){return this.message_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"serverResponse",{get:function(){return this.serverResponse_},enumerable:!0,configurable:!0}),t}(),ee={UNKNOWN:"unknown",OBJECT_NOT_FOUND:"object-not-found",BUCKET_NOT_FOUND:"bucket-not-found",PROJECT_NOT_FOUND:"project-not-found",QUOTA_EXCEEDED:"quota-exceeded",UNAUTHENTICATED:"unauthenticated",UNAUTHORIZED:"unauthorized",RETRY_LIMIT_EXCEEDED:"retry-limit-exceeded",INVALID_CHECKSUM:"invalid-checksum",CANCELED:"canceled",INVALID_EVENT_NAME:"invalid-event-name",INVALID_URL:"invalid-url",INVALID_DEFAULT_BUCKET:"invalid-default-bucket",NO_DEFAULT_BUCKET:"no-default-bucket",CANNOT_SLICE_BLOB:"cannot-slice-blob",SERVER_FILE_WRONG_SIZE:"server-file-wrong-size",NO_DOWNLOAD_URL:"no-download-url",INVALID_ARGUMENT:"invalid-argument",INVALID_ARGUMENT_COUNT:"invalid-argument-count",APP_DELETED:"app-deleted",INVALID_ROOT_OPERATION:"invalid-root-operation",INVALID_FORMAT:"invalid-format",INTERNAL_ERROR:"internal-error"},ne={RAW:"raw",BASE64:"base64",BASE64URL:"base64url",DATA_URL:"data_url"},re=function(){function t(t,e){this.data=t,this.contentType=e||null}return t}(),ie=function(){function t(t){this.base64=!1,this.contentType=null;var e=t.match(/^data:([^,]+)?,/);if(null===e)throw b(ne.DATA_URL,"Must be formatted 'data:[<mediatype>][;base64],<data>");var n=e[1]||null;null!=n&&(this.base64=I(n,";base64"),this.contentType=this.base64?n.substring(0,n.length-";base64".length):n),this.rest=t.substring(t.indexOf(",")+1)}return t}(),oe={STATE_CHANGED:"state_changed"},ae={RUNNING:"running",PAUSING:"pausing",PAUSED:"paused",SUCCESS:"success",CANCELING:"canceling",CANCELED:"canceled",ERROR:"error"},se={RUNNING:"running",PAUSED:"paused",SUCCESS:"success",CANCELED:"canceled",ERROR:"error"};!function(t){t[t.NO_ERROR=0]="NO_ERROR",t[t.NETWORK_ERROR=1]="NETWORK_ERROR",t[t.ABORT=2]="ABORT"}(Wt||(Wt={}));var ue=function(){function t(){var t=this;this.sent_=!1,this.xhr_=new XMLHttpRequest,this.errorCode_=Wt.NO_ERROR,this.sendPromise_=O(function(e,n){t.xhr_.addEventListener("abort",function(n){t.errorCode_=Wt.ABORT,e(t)}),t.xhr_.addEventListener("error",function(n){t.errorCode_=Wt.NETWORK_ERROR,e(t)}),t.xhr_.addEventListener("load",function(n){e(t)})})}return t.prototype.send=function(t,e,n,r){var i=this;if(this.sent_)throw w("cannot .send() more than once");if(this.sent_=!0,this.xhr_.open(e,t,!0),U(r)){N(r,function(t,e){i.xhr_.setRequestHeader(t,e.toString())})}return U(n)?this.xhr_.send(n):this.xhr_.send(),this.sendPromise_},t.prototype.getErrorCode=function(){if(!this.sent_)throw w("cannot .getErrorCode() before sending");return this.errorCode_},t.prototype.getStatus=function(){if(!this.sent_)throw w("cannot .getStatus() before sending");try{return this.xhr_.status}catch(t){return-1}},t.prototype.getResponseText=function(){if(!this.sent_)throw w("cannot .getResponseText() before sending");return this.xhr_.responseText},t.prototype.abort=function(){this.xhr_.abort()},t.prototype.getResponseHeader=function(t){return this.xhr_.getResponseHeader(t)},t.prototype.addUploadProgressListener=function(t){U(this.xhr_.upload)&&this.xhr_.upload.addEventListener("progress",t)},t.prototype.removeUploadProgressListener=function(t){U(this.xhr_.upload)&&this.xhr_.upload.removeEventListener("progress",t)},t}(),ce=function(){function t(){}return t.prototype.createXhrIo=function(){return new ue},t}(),le=function(){function t(t,e){this.bucket=t,this.path_=e}return Object.defineProperty(t.prototype,"path",{get:function(){return this.path_},enumerable:!0,configurable:!0}),t.prototype.fullServerUrl=function(){var t=encodeURIComponent;return"/b/"+t(this.bucket)+"/o/"+t(this.path)},t.prototype.bucketOnlyServerUrl=function(){return"/b/"+encodeURIComponent(this.bucket)+"/o"},t.makeFromBucketSpec=function(e){var n;try{n=t.makeFromUrl(e)}catch(n){return new t(e,"")}if(""===n.path)return n;throw f(e)},t.makeFromUrl=function(e){function n(t){"/"===t.path.charAt(t.path.length-1)&&(t.path_=t.path_.slice(0,-1))}function r(t){t.path_=decodeURIComponent(t.path)}for(var i=null,o=new RegExp("^gs://([A-Za-z0-9.\\-]+)(/(.*))?$","i"),a={bucket:1,path:3},s=new RegExp("^https?://firebasestorage\\.googleapis\\.com/v[A-Za-z0-9_]+/b/([A-Za-z0-9.\\-]+)/o(/([^?#]*).*)?$","i"),u={bucket:1,path:3},c=[{regex:o,indices:a,postModify:n},{regex:s,indices:u,postModify:r}],l=0;l<c.length;l++){var f=c[l],d=f.regex.exec(e);if(d){var p=d[f.indices.bucket],m=d[f.indices.path];m||(m=""),i=new t(p,m),f.postModify(i);break}}if(null==i)throw h(e);return i},t}(),he=function(){function t(t,e,n,r){this.server=t,this.local=e||t,this.writable=!!n,this.xform=r||et}return t}(),fe=null,de=function(){function t(t,e){var n=this;this.validator=function(e){n.optional&&!F(e)||t(e)},this.optional=!!e}return t}(),pe=function(){function t(t,e){var n=0,r="";W(t)?(this.data_=t,n=t.size,r=t.type):t instanceof ArrayBuffer?(e?this.data_=new Uint8Array(t):(this.data_=new Uint8Array(t.byteLength),this.data_.set(new Uint8Array(t))),n=this.data_.length):t instanceof Uint8Array&&(e?this.data_=t:(this.data_=new Uint8Array(t.length),this.data_.set(t)),n=t.length),this.size_=n,this.type_=r}return t.prototype.size=function(){return this.size_},t.prototype.type=function(){return this.type_},t.prototype.slice=function(e,n){if(W(this.data_)){var r=this.data_,i=_t(r,e,n);return null===i?null:new t(i)}return new t(new Uint8Array(this.data_.buffer,e,n-e),!0)},t.getBlob=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];if(q()){var r=e.map(function(e){return e instanceof t?e.data_:e});return new t(yt.apply(null,r))}var i=e.map(function(t){return G(t)?x(ne.RAW,t).data:t.data_}),o=0;i.forEach(function(t){o+=t.byteLength});var a=new Uint8Array(o),s=0;return i.forEach(function(t){for(var e=0;e<t.length;e++)a[s++]=t[e]}),new t(a,!0)},t.prototype.uploadData=function(){return this.data_},t}(),me=function(){function t(t,e,n,r){this.url=t,this.method=e,this.handler=n,this.timeout=r,this.urlParams={},this.headers={},this.body=null,this.errorHandler=null,this.progressCallback=null,this.successCodes=[200],this.additionalRetryCodes=[]}return t}(),ge=function(){function t(t,e,n,r){this.current=t,this.total=e,this.finalized=!!n,this.metadata=r||null}return t}(),ve=function(){function t(t,e,n){if(B(t)||U(e)||U(n))this.next=t,this.error=e||null,this.complete=n||null;else{var r=t;this.next=r.next||null,this.error=r.error||null,this.complete=r.complete||null}}return t}(),ye=function(){function t(t,e,n,r,i,o){this.bytesTransferred=t,this.totalBytes=e,this.state=n,this.metadata=r,this.task=i,this.ref=o}return Object.defineProperty(t.prototype,"downloadURL",{get:function(){if(null!==this.metadata){var t=this.metadata.downloadURLs;return null!=t&&null!=t[0]?t[0]:null}return null},enumerable:!0,configurable:!0}),t}(),_e=function(){function t(t,e,n,r,i,o){void 0===o&&(o=null);var a=this;this.transferred_=0,this.needToFetchStatus_=!1,this.needToFetchMetadata_=!1,this.observers_=[],this.error_=null,this.uploadUrl_=null,this.request_=null,this.chunkMultiplier_=1,this.resolve_=null,this.reject_=null,this.ref_=t,this.authWrapper_=e,this.location_=n,this.blob_=i,this.metadata_=o,this.mappings_=r,this.resumable_=this.shouldDoResumable_(this.blob_),this.state_=ae.RUNNING,this.errorHandler_=function(t){a.request_=null,a.chunkMultiplier_=1,t.codeEquals(ee.CANCELED)?(a.needToFetchStatus_=!0,a.completeTransitions_()):(a.error_=t,a.transition_(ae.ERROR))},this.metadataErrorHandler_=function(t){a.request_=null,t.codeEquals(ee.CANCELED)?a.completeTransitions_():(a.error_=t,a.transition_(ae.ERROR))},this.promise_=O(function(t,e){a.resolve_=t,a.reject_=e,a.start_()}),this.promise_.then(null,function(){})}return t.prototype.makeProgressCallback_=function(){var t=this,e=this.transferred_;return function(n,r){t.updateProgress_(e+n)}},t.prototype.shouldDoResumable_=function(t){return t.size()>262144},t.prototype.start_=function(){this.state_===ae.RUNNING&&null===this.request_&&(this.resumable_?null===this.uploadUrl_?this.createResumable_():this.needToFetchStatus_?this.fetchStatus_():this.needToFetchMetadata_?this.fetchMetadata_():this.continueUpload_():this.oneShotUpload_())},t.prototype.resolveToken_=function(t){var e=this;this.authWrapper_.getAuthToken().then(function(n){switch(e.state_){case ae.RUNNING:t(n);break;case ae.CANCELING:e.transition_(ae.CANCELED);break;case ae.PAUSING:e.transition_(ae.PAUSED)}})},t.prototype.createResumable_=function(){var t=this;this.resolveToken_(function(e){var n=Ot(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.uploadUrl_=e,t.needToFetchStatus_=!1,t.completeTransitions_()},t.errorHandler_)})},t.prototype.fetchStatus_=function(){var t=this,e=this.uploadUrl_;this.resolveToken_(function(n){var r=kt(t.authWrapper_,t.location_,e,t.blob_),i=t.authWrapper_.makeRequest(r,n);t.request_=i,i.getPromise().then(function(e){e=e,t.request_=null,t.updateProgress_(e.current),t.needToFetchStatus_=!1,e.finalized&&(t.needToFetchMetadata_=!0),t.completeTransitions_()},t.errorHandler_)})},t.prototype.continueUpload_=function(){var t=this,e=262144*this.chunkMultiplier_,n=new ge(this.transferred_,this.blob_.size()),r=this.uploadUrl_;this.resolveToken_(function(i){var o;try{o=Lt(t.location_,t.authWrapper_,r,t.blob_,e,t.mappings_,n,t.makeProgressCallback_())}catch(e){return t.error_=e,void t.transition_(ae.ERROR)}var a=t.authWrapper_.makeRequest(o,i);t.request_=a,a.getPromise().then(function(e){t.increaseMultiplier_(),t.request_=null,t.updateProgress_(e.current),e.finalized?(t.metadata_=e.metadata,t.transition_(ae.SUCCESS)):t.completeTransitions_()},t.errorHandler_)})},t.prototype.increaseMultiplier_=function(){262144*this.chunkMultiplier_<33554432&&(this.chunkMultiplier_*=2)},t.prototype.fetchMetadata_=function(){var t=this;this.resolveToken_(function(e){var n=Mt(t.authWrapper_,t.location_,t.mappings_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.metadata_=e,t.transition_(ae.SUCCESS)},t.metadataErrorHandler_)})},t.prototype.oneShotUpload_=function(){var t=this;this.resolveToken_(function(e){var n=Nt(t.authWrapper_,t.location_,t.mappings_,t.blob_,t.metadata_),r=t.authWrapper_.makeRequest(n,e);t.request_=r,r.getPromise().then(function(e){t.request_=null,t.metadata_=e,t.updateProgress_(t.blob_.size()),t.transition_(ae.SUCCESS)},t.errorHandler_)})},t.prototype.updateProgress_=function(t){var e=this.transferred_;this.transferred_=t,this.transferred_!==e&&this.notifyObservers_()},t.prototype.transition_=function(t){if(this.state_!==t)switch(t){case ae.CANCELING:case ae.PAUSING:this.state_=t,null!==this.request_&&this.request_.cancel();break;case ae.RUNNING:var e=this.state_===ae.PAUSED;this.state_=t,e&&(this.notifyObservers_(),this.start_());break;case ae.PAUSED:this.state_=t,this.notifyObservers_();break;case ae.CANCELED:this.error_=l(),this.state_=t,this.notifyObservers_();break;case ae.ERROR:case ae.SUCCESS:this.state_=t,this.notifyObservers_()}},t.prototype.completeTransitions_=function(){switch(this.state_){case ae.PAUSING:this.transition_(ae.PAUSED);break;case ae.CANCELING:this.transition_(ae.CANCELED);break;case ae.RUNNING:this.start_()}},Object.defineProperty(t.prototype,"snapshot",{get:function(){var t=R(this.state_);return new ye(this.transferred_,this.blob_.size(),t,this.metadata_,this,this.ref_)},enumerable:!0,configurable:!0}),t.prototype.on=function(t,e,n,r){function i(e){if(t!==oe.STATE_CHANGED)throw"Expected one of the event types: ["+oe.STATE_CHANGED+"]."}function o(t){try{return void c(t)}catch(t){}try{l(t);if(!(F(t.next)||F(t.error)||F(t.complete)))throw"";return}catch(t){throw u}}function a(t){function e(e,n,i){null!==t&&ct("on",t,arguments);var o=new ve(e,n,r);return h.addObserver_(o),function(){h.removeObserver_(o)}}return e}function s(t){if(null===t)throw u;o(t)}void 0===e&&(e=void 0),void 0===n&&(n=void 0),void 0===r&&(r=void 0);var u="Expected a function or an Object with one of `next`, `error`, `complete` properties.",c=gt(!0).validator,l=mt(null,!0).validator;ct("on",[ht(i),mt(o,!0),gt(!0),gt(!0)],arguments);var h=this,f=[mt(s),gt(!0),gt(!0)];return F(e)||F(n)||F(r)?a(null)(e,n,r):a(f)},t.prototype.then=function(t,e){return this.promise_.then(t,e)},t.prototype.catch=function(t){return this.then(null,t)},t.prototype.addObserver_=function(t){this.observers_.push(t),this.notifyObserver_(t)},t.prototype.removeObserver_=function(t){Et(this.observers_,t)},t.prototype.notifyObservers_=function(){var t=this;this.finishPromise_(),wt(this.observers_).forEach(function(e){t.notifyObserver_(e)})},t.prototype.finishPromise_=function(){if(null!==this.resolve_){var t=!0;switch(R(this.state_)){case se.SUCCESS:Ut(this.resolve_.bind(null,this.snapshot))();break;case se.CANCELED:case se.ERROR:Ut(this.reject_.bind(null,this.error_))();break;default:t=!1}t&&(this.resolve_=null,this.reject_=null)}},t.prototype.notifyObserver_=function(t){switch(R(this.state_)){case se.RUNNING:case se.PAUSED:null!==t.next&&Ut(t.next.bind(t,this.snapshot))();break;case se.SUCCESS:null!==t.complete&&Ut(t.complete.bind(t))();break;case se.CANCELED:case se.ERROR:null!==t.error&&Ut(t.error.bind(t,this.error_))();break;default:null!==t.error&&Ut(t.error.bind(t,this.error_))()}},t.prototype.resume=function(){ct("resume",[],arguments);var t=this.state_===ae.PAUSED||this.state_===ae.PAUSING;return t&&this.transition_(ae.RUNNING),t},t.prototype.pause=function(){ct("pause",[],arguments);var t=this.state_===ae.RUNNING;return t&&this.transition_(ae.PAUSING),t},t.prototype.cancel=function(){ct("cancel",[],arguments);var t=this.state_===ae.RUNNING||this.state_===ae.PAUSING;return t&&this.transition_(ae.CANCELING),t},t}(),be=function(){function t(t,e){this.authWrapper=t,this.location=e instanceof le?e:le.makeFromUrl(e)}return t.prototype.toString=function(){return ct("toString",[],arguments),"gs://"+this.location.bucket+"/"+this.location.path},t.prototype.newRef=function(e,n){return new t(e,n)},t.prototype.mappings=function(){return rt()},t.prototype.child=function(t){ct("child",[ht()],arguments);var e=Q(this.location.path,t),n=new le(this.location.bucket,e);return this.newRef(this.authWrapper,n)},Object.defineProperty(t.prototype,"parent",{get:function(){var t=K(this.location.path);if(null===t)return null;var e=new le(this.location.bucket,t);return this.newRef(this.authWrapper,e)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"root",{get:function(){var t=new le(this.location.bucket,"");return this.newRef(this.authWrapper,t)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"bucket",{get:function(){return this.location.bucket},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"fullPath",{get:function(){return this.location.path},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"name",{get:function(){return X(this.location.path)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"storage",{get:function(){return this.authWrapper.service()},enumerable:!0,configurable:!0}),t.prototype.put=function(t,e){return void 0===e&&(e=null),ct("put",[ft(),dt(!0)],arguments),this.throwIfRoot_("put"),new _e(this,this.authWrapper,this.location,this.mappings(),new pe(t),e)},t.prototype.putString=function(t,e,n){void 0===e&&(e=ne.RAW),ct("putString",[ht(),ht(E,!0),dt(!0)],arguments),this.throwIfRoot_("putString");var r=x(e,t),i=D(n);return!U(i.contentType)&&U(r.contentType)&&(i.contentType=r.contentType),new _e(this,this.authWrapper,this.location,this.mappings(),new pe(r.data,!0),i)},t.prototype.delete=function(){ct("delete",[],arguments),this.throwIfRoot_("delete");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=It(t.authWrapper,t.location);return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.getMetadata=function(){ct("getMetadata",[],arguments),this.throwIfRoot_("getMetadata");var t=this;return this.authWrapper.getAuthToken().then(function(e){var n=Mt(t.authWrapper,t.location,t.mappings());return t.authWrapper.makeRequest(n,e).getPromise()})},t.prototype.updateMetadata=function(t){ct("updateMetadata",[dt()],arguments),this.throwIfRoot_("updateMetadata");var e=this;return this.authWrapper.getAuthToken().then(function(n){var r=At(e.authWrapper,e.location,t,e.mappings());return e.authWrapper.makeRequest(r,n).getPromise()})},t.prototype.getDownloadURL=function(){return ct("getDownloadURL",[],arguments),this.throwIfRoot_("getDownloadURL"),this.getMetadata().then(function(t){var e=t.downloadURLs[0];if(U(e))return e;throw m()})},t.prototype.throwIfRoot_=function(t){if(""===this.location.path)throw _(t)},t}(),we=function(){function t(t){this.promise_=L(t)}return t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){void 0===t&&(t=!1)},t}(),Ee=function(){function t(){this.map_={},this.id_=$t}return t.prototype.addRequest=function(t){function e(){delete r.map_[n]}var n=this.id_;this.id_++,this.map_[n]=t;var r=this;t.getPromise().then(e,e)},t.prototype.clear=function(){N(this.map_,function(t,e){e&&e.cancel(!0)}),this.map_={}},t}(),xe=function(){function t(e,n,r,i,o){if(this.bucket_=null,this.deleted_=!1,this.app_=e,null!==this.app_){var a=this.app_.options;U(a)&&(this.bucket_=t.extractBucket_(a))}this.storageRefMaker_=n,this.requestMaker_=r,this.pool_=o,this.service_=i,this.maxOperationRetryTime_=Jt,this.maxUploadRetryTime_=Zt,this.requestMap_=new Ee}return t.extractBucket_=function(t){var e=t.storageBucket||null;return null==e?null:le.makeFromBucketSpec(e).bucket},t.prototype.getAuthToken=function(){return null!==this.app_&&U(this.app_.INTERNAL)&&U(this.app_.INTERNAL.getToken)?this.app_.INTERNAL.getToken().then(function(t){return null!==t?t.accessToken:null},function(t){return null}):k(null)},t.prototype.bucket=function(){if(this.deleted_)throw y();return this.bucket_},t.prototype.service=function(){return this.service_},t.prototype.makeStorageReference=function(t){return this.storageRefMaker_(this,t)},t.prototype.makeRequest=function(t,e){if(this.deleted_)return new we(y());var n=this.requestMaker_(t,e,this.pool_);return this.requestMap_.addRequest(n),n},t.prototype.deleteApp=function(){this.deleted_=!0,this.app_=null,this.requestMap_.clear()},t.prototype.maxUploadRetryTime=function(){return this.maxUploadRetryTime_},t.prototype.setMaxUploadRetryTime=function(t){this.maxUploadRetryTime_=t},t.prototype.maxOperationRetryTime=function(){return this.maxOperationRetryTime_},t.prototype.setMaxOperationRetryTime=function(t){this.maxOperationRetryTime_=t},t}(),Te=function(){function t(t,e,n,r,i,o,a,s,u,c,l){this.pendingXhr_=null,this.backoffId_=null,this.resolve_=null,this.reject_=null,this.canceled_=!1,this.appDelete_=!1,this.url_=t,this.method_=e,this.headers_=n,this.body_=r,this.successCodes_=i.slice(),this.additionalRetryCodes_=o.slice(),this.callback_=a,this.errorCallback_=s,this.progressCallback_=c,this.timeout_=u,this.pool_=l;var h=this;this.promise_=O(function(t,e){h.resolve_=t,h.reject_=e,h.start_()})}return t.prototype.start_=function(){function t(t,e){function r(t){var e=t.loaded,r=t.lengthComputable?t.total:-1;null!==n.progressCallback_&&n.progressCallback_(e,r)}if(e)return void t(!1,new Se(!1,null,!0));var i=n.pool_.createXhrIo();n.pendingXhr_=i,null!==n.progressCallback_&&i.addUploadProgressListener(r),i.send(n.url_,n.method_,n.body_,n.headers_).then(function(e){null!==n.progressCallback_&&e.removeUploadProgressListener(r),n.pendingXhr_=null,e=e;var i=e.getErrorCode()===Wt.NO_ERROR,o=e.getStatus();if(!i||n.isRetryStatusCode_(o)){var a=e.getErrorCode()===Wt.ABORT;return void t(!1,new Se(!1,null,a))}var s=bt(n.successCodes_,o);t(!0,new Se(s,e))})}function e(t,e){var r=n.resolve_,o=n.reject_,a=e.xhr;if(e.wasSuccessCode)try{var s=n.callback_(a,a.getResponseText());F(s)?r(s):r()}catch(t){o(t)}else if(null!==a){var u=i();u.setServerResponseProp(a.getResponseText()),o(n.errorCallback_?n.errorCallback_(a,u):u)}else if(e.canceled){var u=n.appDelete_?y():l();o(u)}else{var u=c();o(u)}}var n=this;this.canceled_?e(!1,new Se(!1,null,!0)):this.backoffId_=Ft(t,e,this.timeout_)},t.prototype.getPromise=function(){return this.promise_},t.prototype.cancel=function(t){this.canceled_=!0,this.appDelete_=t||!1,null!==this.backoffId_&&Bt(this.backoffId_),null!==this.pendingXhr_&&this.pendingXhr_.abort()},t.prototype.isRetryStatusCode_=function(t){var e=t>=500&&t<600,n=[408,429],r=bt(n,t),i=bt(this.additionalRetryCodes_,t);return e||r||i},t}(),Se=function(){function t(t,e,n){this.wasSuccessCode=t,this.xhr=e,this.canceled=!!n}return t}(),Ce=function(){function t(t,e,n){function r(t,e){return new be(t,e)}if(this.bucket_=null,this.authWrapper_=new xe(t,r,Ht,this,e),this.app_=t,null!=n)this.bucket_=le.makeFromBucketSpec(n);else{var i=this.authWrapper_.bucket();null!=i&&(this.bucket_=new le(i,""))}this.internals_=new Me(this)}return t.prototype.ref=function(t){function e(t){if(/^[A-Za-z]+:\/\//.test(t))throw"Expected child path but got a URL, use refFromURL instead."}if(ct("ref",[ht(e,!0)],arguments),null==this.bucket_)throw new Error("No Storage Bucket defined in Firebase Options.");var n=new be(this.authWrapper_,this.bucket_);return null!=t?n.child(t):n},t.prototype.refFromURL=function(t){function e(t){if(!/^[A-Za-z]+:\/\//.test(t))throw"Expected full URL but got a child path, use ref instead.";try{le.makeFromUrl(t)}catch(t){throw"Expected valid full URL but got an invalid one."}}return ct("refFromURL",[ht(e,!1)],arguments),new be(this.authWrapper_,t)},Object.defineProperty(t.prototype,"maxUploadRetryTime",{get:function(){return this.authWrapper_.maxUploadRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxUploadRetryTime=function(t){ct("setMaxUploadRetryTime",[pt()],arguments),this.authWrapper_.setMaxUploadRetryTime(t)},Object.defineProperty(t.prototype,"maxOperationRetryTime",{get:function(){return this.authWrapper_.maxOperationRetryTime()},enumerable:!0,configurable:!0}),t.prototype.setMaxOperationRetryTime=function(t){ct("setMaxOperationRetryTime",[pt()],arguments),this.authWrapper_.setMaxOperationRetryTime(t)},Object.defineProperty(t.prototype,"app",{get:function(){return this.app_},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"INTERNAL",{get:function(){return this.internals_},enumerable:!0,configurable:!0}),t}(),Me=function(){function t(t){this.service_=t}return t.prototype.delete=function(){return this.service_.authWrapper_.deleteApp(),k(void 0)},t}(),Ae="storage";zt(qt.default)},function(t,e,n){n(84)},function(t,e,n){"use strict";function r(){return ne.logLevel===Zt.LogLevel.DEBUG?Xt.DEBUG:ne.logLevel===Zt.LogLevel.SILENT?Xt.SILENT:Xt.ERROR}function i(t){switch(t){case Xt.DEBUG:ne.logLevel=Zt.LogLevel.DEBUG;break;case Xt.ERROR:ne.logLevel=Zt.LogLevel.ERROR;break;case Xt.SILENT:ne.logLevel=Zt.LogLevel.SILENT;break;default:ne.error("Firestore ("+ee+"): Invalid value passed to `setLogLevel`")}}function o(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];if(ne.logLevel<=Zt.LogLevel.DEBUG){var i=n.map(s);ne.debug.apply(ne,["Firestore ("+ee+") ["+t+"]: "+e].concat(i))}}function a(t){for(var e=[],n=1;n<arguments.length;n++)e[n-1]=arguments[n];if(ne.logLevel<=Zt.LogLevel.ERROR){var r=e.map(s);ne.error.apply(ne,["Firestore ("+ee+"): "+t].concat(r))}}function s(t){if("string"===typeof t)return t;var e=re.getPlatform();try{return e.formatJSON(t)}catch(e){return t}}function u(t){var e="FIRESTORE ("+ee+") INTERNAL ASSERTION FAILED: "+t;throw a(e),new Error(e)}function c(t,e){t||u(e)}function l(){return re.getPlatform().emptyByteString}function h(t,e){function n(){var t="This constructor is private.";throw e&&(t+=" ",t+=e),new oe(ie.INVALID_ARGUMENT,t)}n.prototype=t.prototype;for(var r in t)t.hasOwnProperty(r)&&(n[r]=t[r]);return n}function f(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function d(t,e){return void 0!==t?t:e}function p(t,e){for(var n in t)if(Object.prototype.hasOwnProperty.call(t,n)){var r=Number(n);isNaN(r)||e(r,t[n])}}function m(t,e){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function g(t){c(null!=t&&"object"===typeof t,"isEmpty() expects object parameter.");for(var e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function v(t){c(t&&"object"===typeof t,"shallowCopy() expects object parameter.");var e={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e}function y(t,e,n){if(e.length!==n)throw new oe(ie.INVALID_ARGUMENT,"Function "+t+"() requires "+L(n,"argument")+", but was called with "+L(e.length,"argument")+".")}function _(t,e,n){if(e.length<n)throw new oe(ie.INVALID_ARGUMENT,"Function "+t+"() requires at least "+L(n,"argument")+", but was called with "+L(e.length,"argument")+".")}function b(t,e,n,r){if(e.length<n||e.length>r)throw new oe(ie.INVALID_ARGUMENT,"Function "+t+"() requires between "+n+" and "+r+" arguments, but was called with "+L(e.length,"argument")+".")}function w(t,e,n,r){if(!(e instanceof Array)||e.length<r)throw new oe(ie.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" argument to be an array with at least "+L(r,"element")+".")}function E(t,e,n,r){A(t,e,k(n)+" argument",r)}function x(t,e,n,r){void 0!==r&&E(t,e,n,r)}function T(t,e,n,r){A(t,e,n+" option",r)}function S(t,e,n,r){void 0!==r&&T(t,e,n,r)}function C(t,e,n,r,i){for(var o=[],a=0,s=i;a<s.length;a++){var u=s[a];if(u===r)return;o.push(R(u))}var c=R(r);throw new oe(ie.INVALID_ARGUMENT,"Invalid value "+c+" provided to function "+t+'() for option "'+n+'". Acceptable values: '+o.join(", "))}function M(t,e,n,r,i){void 0!==r&&C(t,e,n,r,i)}function A(t,e,n,r){if(typeof r!==e||"object"===e&&!I(r)){var i=R(r);throw new oe(ie.INVALID_ARGUMENT,"Function "+t+"() requires its "+n+" to be of type "+e+", but it was: "+i)}}function I(t){return"object"===typeof t&&null!==t&&Object.getPrototypeOf(t)===Object.prototype}function R(t){if(void 0===t)return"undefined";if(null===t)return"null";if("string"===typeof t)return t.length>20&&(t=t.substring(0,20)+"..."),JSON.stringify(t);if("number"===typeof t||"boolean"===typeof t)return""+t;if("object"===typeof t){if(t instanceof Array)return"an array";var e=P(t);return e?"a custom "+e+" object":"an object"}return"function"===typeof t?"a function":u("Unknown wrong type: "+typeof t)}function P(t){if(t.constructor){var e=/function\s+([^\s(]+)\s*\(/,n=e.exec(t.constructor.toString());if(n&&n.length>1)return n[1]}return null}function N(t,e,n){if(void 0===n)throw new oe(ie.INVALID_ARGUMENT,"Function "+t+"() requires a valid "+k(e)+" argument, but it was undefined.")}function D(t,e,n){m(e,function(e,r){if(n.indexOf(e)<0)throw new oe(ie.INVALID_ARGUMENT,"Unknown option '"+e+"' passed to function "+t+"(). Available options: "+n.join(", "))})}function O(t,e,n,r){var i=R(r);return new oe(ie.INVALID_ARGUMENT,"Function "+t+"() requires its "+k(n)+" argument to be a "+e+", but it was: "+i)}function k(t){switch(t){case 1:return"first";case 2:return"second";case 3:return"third";default:return t+"th"}}function L(t,e){return t+" "+e+(1===t?"":"s")}function U(t,e){return t<e?-1:t>e?1:0}function F(t,e){return null!==t&&void 0!==t?!(!e||!t.isEqual(e)):t===e}function B(t,e){if(t.length!==e.length)return!1;for(var n=0;n<t.length;n++)if(!t[n].isEqual(e[n]))return!1;return!0}function V(t){var e=t.length-1;return 0===t.length?"":"\0"===t.charAt(e)?t.substring(0,e):t.substring(0,e)+String.fromCharCode(t.charCodeAt(e)-1)}function j(t){return t+"\0"}function H(){if("undefined"===typeof Uint8Array)throw new oe(ie.UNIMPLEMENTED,"Uint8Arrays are not available in this environment.")}function G(){if(!re.getPlatform().base64Available)throw new oe(ie.UNIMPLEMENTED,"Blobs are unavailable in Firestore in this environment.")}function z(t,e){return t<e?-1:t>e?1:t===e?0:isNaN(t)?isNaN(e)?0:-1:1}function W(t,e){return t===e?0!==t||1/t===1/e:t!==t&&e!==e}function q(t){return null===t||void 0===t}function Y(t){return qe(t)&&t<=We&&t>=ze}function K(t,e,n){if(n.isEqual(Re.INSTANCE)){if(e!==Ke.EQUAL)throw new oe(ie.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on null.");return new Xe(t)}if(n.isEqual(Oe.NAN)){if(e!==Ke.EQUAL)throw new oe(ie.INVALID_ARGUMENT,"Invalid query. You can only perform equals comparisons on NaN.");return new Je(t)}return new Qe(t,e,n)}function Q(t){switch(t){case ie.OK:return u("Treated status OK as error");case ie.CANCELLED:case ie.UNKNOWN:case ie.DEADLINE_EXCEEDED:case ie.RESOURCE_EXHAUSTED:case ie.INTERNAL:case ie.UNAVAILABLE:case ie.UNAUTHENTICATED:return!1;case ie.INVALID_ARGUMENT:case ie.NOT_FOUND:case ie.ALREADY_EXISTS:case ie.PERMISSION_DENIED:case ie.FAILED_PRECONDITION:case ie.ABORTED:case ie.OUT_OF_RANGE:case ie.UNIMPLEMENTED:case ie.DATA_LOSS:return!0;default:return u("Unknown status code: "+t)}}function X(t){var e=hn[t];if(void 0!==e)return J(e)}function J(t){if(void 0===t)return a("GRPC error has no .code"),ie.UNKNOWN;switch(t){case hn.OK:return ie.OK;case hn.CANCELLED:return ie.CANCELLED;case hn.UNKNOWN:return ie.UNKNOWN;case hn.DEADLINE_EXCEEDED:return ie.DEADLINE_EXCEEDED;case hn.RESOURCE_EXHAUSTED:return ie.RESOURCE_EXHAUSTED;case hn.INTERNAL:return ie.INTERNAL;case hn.UNAVAILABLE:return ie.UNAVAILABLE;case hn.UNAUTHENTICATED:return ie.UNAUTHENTICATED;case hn.INVALID_ARGUMENT:return ie.INVALID_ARGUMENT;case hn.NOT_FOUND:return ie.NOT_FOUND;case hn.ALREADY_EXISTS:return ie.ALREADY_EXISTS;case hn.PERMISSION_DENIED:return ie.PERMISSION_DENIED;case hn.FAILED_PRECONDITION:return ie.FAILED_PRECONDITION;case hn.ABORTED:return ie.ABORTED;case hn.OUT_OF_RANGE:return ie.OUT_OF_RANGE;case hn.UNIMPLEMENTED:return ie.UNIMPLEMENTED;case hn.DATA_LOSS:return ie.DATA_LOSS;default:return u("Unknown status code: "+t)}}function Z(t){if(void 0===t)return hn.OK;switch(t){case ie.OK:return hn.OK;case ie.CANCELLED:return hn.CANCELLED;case ie.UNKNOWN:return hn.UNKNOWN;case ie.DEADLINE_EXCEEDED:return hn.DEADLINE_EXCEEDED;case ie.RESOURCE_EXHAUSTED:return hn.RESOURCE_EXHAUSTED;case ie.INTERNAL:return hn.INTERNAL;case ie.UNAVAILABLE:return hn.UNAVAILABLE;case ie.UNAUTHENTICATED:return hn.UNAUTHENTICATED;case ie.INVALID_ARGUMENT:return hn.INVALID_ARGUMENT;case ie.NOT_FOUND:return hn.NOT_FOUND;case ie.ALREADY_EXISTS:return hn.ALREADY_EXISTS;case ie.PERMISSION_DENIED:return hn.PERMISSION_DENIED;case ie.FAILED_PRECONDITION:return hn.FAILED_PRECONDITION;case ie.ABORTED:return hn.ABORTED;case ie.OUT_OF_RANGE:return hn.OUT_OF_RANGE;case ie.UNIMPLEMENTED:return hn.UNIMPLEMENTED;case ie.DATA_LOSS:return hn.DATA_LOSS;default:return u("Unknown status code: "+t)}}function $(t){switch(t){case 200:return ie.OK;case 400:return ie.INVALID_ARGUMENT;case 401:return ie.UNAUTHENTICATED;case 403:return ie.PERMISSION_DENIED;case 404:return ie.NOT_FOUND;case 409:return ie.ABORTED;case 416:return ie.OUT_OF_RANGE;case 429:return ie.RESOURCE_EXHAUSTED;case 499:return ie.CANCELLED;case 500:return ie.UNKNOWN;case 501:return ie.UNIMPLEMENTED;case 503:return ie.UNAVAILABLE;case 504:return ie.DEADLINE_EXCEEDED;default:return t>=200&&t<300?ie.OK:t>=400&&t<500?ie.FAILED_PRECONDITION:t>=500&&t<600?ie.INTERNAL:ie.UNKNOWN}}function tt(){return wn}function et(){return En}function nt(){return xn}function rt(){return Tn}function it(t,e){e.length>0&&(t.resumeToken=e)}function ot(t,e){c(!q(t),e+" is missing")}function at(t){return"number"===typeof t?t:"string"===typeof t?Number(t):u("can't parse "+t)}function st(t,e,n){return e===n||!e&&n in t}function ut(t){if(t.search(qn)>=0)throw new oe(ie.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not contain '~', '*', '/', '[', or ']'");try{return new(Wn.bind.apply(Wn,[void 0].concat(t.split("."))))}catch(e){throw new oe(ie.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'")}}function ct(t,e){var n=function(t){switch(t){case Yn.Added:return 1;case Yn.Modified:case Yn.Metadata:return 2;case Yn.Removed:return 0;default:return u("Unknown ChangeType: "+t)}};return n(t)-n(e)}function lt(t){for(var e="",n=0;n<t.length;n++)e.length>0&&(e=ft(e)),e=ht(t.get(n),e);return ft(e)}function ht(t,e){for(var n=e,r=t.length,i=0;i<r;i++){var o=t.charAt(i);switch(o){case"\0":n+=_r+wr;break;case _r:n+=_r+Er;break;default:n+=o}}return n}function ft(t){return t+_r+br}function dt(t){var e=t.length;if(c(e>=2,"Invalid path "+t),2===e)return c(t.charAt(0)===_r&&t.charAt(1)===br,"Non-empty path "+t+" had length 2"),me.EMPTY_PATH;for(var n=e-2,r=[],i="",o=0;o<e;){var a=t.indexOf(_r,o);(a<0||a>n)&&u('Invalid encoded resource path: "'+t+'"');switch(t.charAt(a+1)){case br:var s=t.substring(o,a),l=void 0;0===i.length?l=s:(i+=s,l=i,i=""),r.push(l);break;case wr:i+=t.substring(o,a),i+="\0";break;case Er:i+=t.substring(o,a+1);break;default:u('Invalid encoded resource path: "'+t+'"')}o=a+2}return new me(r)}function pt(t,e,n,r){c(n<r&&n>=0&&r<=2,"Unexpected schema upgrade from v${fromVersion} to v{toVersion}."),n<1&&r>=1&&(mt(t),gt(t),yt(t),vt(t));var i=rr.resolve();return n<2&&r>=2&&(i=bt(e).next(function(t){return _t(e,t)})),i}function mt(t){t.createObjectStore(Tr.store)}function gt(t){t.createObjectStore(Sr.store,{keyPath:Sr.keyPath}),t.createObjectStore(Cr.store,{keyPath:Cr.keyPath}),t.createObjectStore(Mr.store)}function vt(t){t.createObjectStore(Ir.store)}function yt(t){t.createObjectStore(Pr.store,{keyPath:Pr.keyPath}).createIndex(Pr.documentTargetsIndex,Pr.documentTargetsKeyPath,{unique:!0}),t.createObjectStore(Rr.store,{keyPath:Rr.keyPath}).createIndex(Rr.queryTargetsIndexName,Rr.queryTargetsKeyPath,{unique:!0}),t.createObjectStore(Nr.store)}function _t(t,e){var n=t.store(Nr.store);return t.store(Rr.store).count().next(function(t){return e.targetCount=t,n.put(Nr.key,e)})}function bt(t){var e=t.store(Nr.store);return e.get(Nr.key).next(function(t){return null!=t?rr.resolve(t):(t=new Nr(0,0,rn.MIN.toTimestamp(),0),e.put(Nr.key,t).next(function(){return t}))})}function wt(t){return new rr(function(e,n){t.onsuccess=function(t){var n=t.target.result;e(n)},t.onerror=function(t){n(t.target.error)}})}function Et(t){return c("string"===typeof t,"Persisting non-string stream token not supported."),t}function xt(t){return Ct(t,Cr.store)}function Tt(t){return Ct(t,Mr.store)}function St(t){return Ct(t,Sr.store)}function Ct(t,e){return t instanceof Lr?t.store(e):u("Invalid transaction object provided!")}function Mt(t){return Rt(t,Rr.store)}function At(t){return Rt(t,Nr.store)}function It(t){return Rt(t,Pr.store)}function Rt(t,e){return t instanceof Lr?t.store(e):u("Invalid transaction object provided!")}function Pt(t){return t instanceof Lr?t.store(Ir.store):u("Invalid transaction object provided!")}function Nt(t){return t.path.toArray()}function Dt(t){return void 0!==t.documents}function Ot(t){if(!t)return new bi;switch(t.type){case"gapi":return new xi(t.client,t.sessionIndex||"0");case"provider":return t.client;default:throw new oe(ie.INVALID_ARGUMENT,"makeCredentialsProvider failed due to invalid credential type")}}function kt(t){return Lt(t,["next","error","complete"])}function Lt(t,e){if("object"!==typeof t||null===t)return!1;for(var n=t,r=0,i=e;r<i.length;r++){var o=i[r];if(o in n&&"function"===typeof n[o])return!0}return!1}function Ut(t){switch(t){case oi.Set:case oi.MergeSet:case oi.Update:return!0;case oi.QueryValue:return!1;default:throw u("Unexpected case for UserDataSource: "+t)}}function Ft(t){return"object"===typeof t&&null!==t&&!(t instanceof Array)&&!(t instanceof Date)&&!(t instanceof le)&&!(t instanceof ce)&&!(t instanceof se)&&!(t instanceof Ni)&&!(t instanceof Ti)}function Bt(t,e,n){if(!Ft(n)||!I(n)){var r=R(n);throw"an object"===r?e.createError(t+" a custom object"):e.createError(t+" "+r)}}function Vt(t,e){if(e instanceof Wn)return e._internalPath;if("string"===typeof e)return jt(t,e);throw new oe(ie.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. Field path arguments must be of type string or FieldPath.")}function jt(t,e){try{return ut(e)._internalPath}catch(e){var n=Ht(e);throw new oe(ie.INVALID_ARGUMENT,"Function "+t+"() called with invalid data. "+n)}}function Ht(t){return t instanceof Error?t.message:t.toString()}function Gt(t,e){return void 0===e?{merge:!1}:(D(t,e,["merge"]),S(t,"boolean","merge",e.merge),e)}function zt(t,e){return void 0===e?{}:(D(t,e,["serverTimestamps"]),M(t,"options","serverTimestamps",e.serverTimestamps,["estimate","previous","none"]),e)}function Wt(t,e,n){if(e instanceof Hi){if(e.firestore!==n)throw new oe(ie.INVALID_ARGUMENT,"Provided document reference is from a different Firestore instance.");return e}throw O(t,"DocumentReference",1,e)}function qt(t,e){if(e.oldDocs.isEmpty()){var n,r=0;return e.docChanges.map(function(i){var o=new Wi(t,i.doc.key,i.doc,e.fromCache);return c(i.type===Yn.Added,"Invalid event type for first snapshot"),c(!n||e.query.docComparator(n,i.doc)<0,"Got added events in wrong order"),n=i.doc,{type:"added",doc:o,oldIndex:-1,newIndex:r++}})}var i=e.oldDocs;return e.docChanges.map(function(n){var r=new Wi(t,n.doc.key,n.doc,e.fromCache),o=-1,a=-1;return n.type!==Yn.Added&&(o=i.indexOf(n.doc.key),c(o>=0,"Index for document not found"),i=i.delete(n.doc.key)),n.type!==Yn.Removed&&(i=i.add(n.doc),a=i.indexOf(n.doc.key)),{type:Yt(n.type),doc:r,oldIndex:o,newIndex:a}})}function Yt(t){switch(t){case Yn.Added:return"added";case Yn.Modified:case Yn.Metadata:return"modified";case Yn.Removed:return"removed";default:return u("Unknown change type: "+t)}}function Kt(t){t.INTERNAL.registerService("firestore",function(t){return new Bi(t)},v(io))}function Qt(t){Kt(t)}Object.defineProperty(e,"__esModule",{value:!0});var Xt,Jt=function(t){return t&&"object"===typeof t&&"default"in t?t.default:t}(n(2)),Zt=n(14),$t=n(3),te=n(85),ee=Jt.SDK_VERSION,ne=new Zt.Logger("@firebase/firestore");!function(t){t[t.DEBUG=0]="DEBUG",t[t.ERROR=1]="ERROR",t[t.SILENT=2]="SILENT"}(Xt||(Xt={}));var re=function(){function t(){}return t.setPlatform=function(e){t.platform&&u("Platform already defined"),t.platform=e},t.getPlatform=function(){return t.platform||u("Platform not set"),t.platform},t}(),ie={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"},oe=function(t){function e(e,n){var r=t.call(this,n)||this;return r.code=e,r.message=n,r.name="FirebaseError",r.toString=function(){return r.name+": [code="+r.code+"]: "+r.message},r}return $t.__extends(e,t),e}(Error),ae=function(){function t(){}return t.newId=function(){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",e="",n=0;n<20;n++)e+=t.charAt(Math.floor(Math.random()*t.length));return c(20===e.length,"Invalid auto ID: "+e),e},t}(),se=function(){function t(t){G(),this._binaryString=t}return t.fromBase64String=function(e){y("Blob.fromBase64String",arguments,1),E("Blob.fromBase64String","string",1,e),G();try{return new t(re.getPlatform().atob(e))}catch(t){throw new oe(ie.INVALID_ARGUMENT,"Failed to construct Blob from Base64 string: "+t)}},t.fromUint8Array=function(e){if(y("Blob.fromUint8Array",arguments,1),H(),!(e instanceof Uint8Array))throw O("Blob.fromUint8Array","Uint8Array",1,e);return new t(Array.prototype.map.call(e,function(t){return String.fromCharCode(t)}).join(""))},t.prototype.toBase64=function(){return y("Blob.toBase64",arguments,0),G(),re.getPlatform().btoa(this._binaryString)},t.prototype.toUint8Array=function(){y("Blob.toUint8Array",arguments,0),H();for(var t=new Uint8Array(this._binaryString.length),e=0;e<this._binaryString.length;e++)t[e]=this._binaryString.charCodeAt(e);return t},t.prototype.toString=function(){return"Blob(base64: "+this.toBase64()+")"},t.prototype.isEqual=function(t){return this._binaryString===t._binaryString},t.prototype._compareTo=function(t){return U(this._binaryString,t._binaryString)},t}(),ue=h(se,"Use Blob.fromUint8Array() or Blob.fromBase64String() instead."),ce=function(){function t(t,e){if(y("GeoPoint",arguments,2),E("GeoPoint","number",1,t),E("GeoPoint","number",2,e),!isFinite(t)||t<-90||t>90)throw new oe(ie.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+t);if(!isFinite(e)||e<-180||e>180)throw new oe(ie.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+e);this._lat=t,this._long=e}return Object.defineProperty(t.prototype,"latitude",{get:function(){return this._lat},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"longitude",{get:function(){return this._long},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(t){return this._lat===t._lat&&this._long===t._long},t.prototype._compareTo=function(t){return U(this._lat,t._lat)||U(this._long,t._long)},t}(),le=function(){function t(t,e){if(this.seconds=t,this.nanoseconds=e,e<0)throw new oe(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(e>=1e9)throw new oe(ie.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+e);if(t<-62135596800)throw new oe(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t);if(t>=253402300800)throw new oe(ie.INVALID_ARGUMENT,"Timestamp seconds out of range: "+t)}return t.now=function(){return t.fromMillis(Date.now())},t.fromDate=function(e){return t.fromMillis(e.getTime())},t.fromMillis=function(e){var n=Math.floor(e/1e3);return new t(n,1e6*(e-1e3*n))},t.prototype.toDate=function(){return new Date(this.toMillis())},t.prototype.toMillis=function(){return 1e3*this.seconds+this.nanoseconds/1e6},t.prototype._compareTo=function(t){return this.seconds===t.seconds?U(this.nanoseconds,t.nanoseconds):U(this.seconds,t.seconds)},t.prototype.isEqual=function(t){return t.seconds===this.seconds&&t.nanoseconds===this.nanoseconds},t.prototype.toString=function(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"},t}(),he=function(){function t(t,e,n,r){this.databaseId=t,this.persistenceKey=e,this.host=n,this.ssl=r}return t}(),fe="(default)",de=function(){function t(t,e){this.projectId=t,this.database=e||fe}return Object.defineProperty(t.prototype,"isDefaultDatabase",{get:function(){return this.database===fe},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return e instanceof t&&e.projectId===this.projectId&&e.database===this.database},t.prototype.compareTo=function(t){return U(this.projectId,t.projectId)||U(this.database,t.database)},t}(),pe=function(){function t(t,e,n){this.init(t,e,n)}return t.prototype.init=function(t,e,n){void 0===e?e=0:e>t.length&&u("offset "+e+" out of range "+t.length),void 0===n?n=t.length-e:n>t.length-e&&u("length "+n+" out of range "+(t.length-e)),this.segments=t,this.offset=e,this.len=n},t.prototype.construct=function(t,e,n){var r=Object.create(Object.getPrototypeOf(this));return r.init(t,e,n),r},Object.defineProperty(t.prototype,"length",{get:function(){return this.len},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){return 0===t.comparator(this,e)},t.prototype.child=function(e){var n=this.segments.slice(this.offset,this.limit());return e instanceof t?e.forEach(function(t){n.push(t)}):"string"===typeof e?n.push(e):u("Unknown parameter type for Path.child(): "+e),this.construct(n)},t.prototype.limit=function(){return this.offset+this.length},t.prototype.popFirst=function(t){return t=void 0===t?1:t,c(this.length>=t,"Can't call popFirst() with less segments"),this.construct(this.segments,this.offset+t,this.length-t)},t.prototype.popLast=function(){return c(!this.isEmpty(),"Can't call popLast() on empty path"),this.construct(this.segments,this.offset,this.length-1)},t.prototype.firstSegment=function(){return c(!this.isEmpty(),"Can't call firstSegment() on empty path"),this.segments[this.offset]},t.prototype.lastSegment=function(){return c(!this.isEmpty(),"Can't call lastSegment() on empty path"),this.segments[this.limit()-1]},t.prototype.get=function(t){return c(t<this.length,"Index out of range"),this.segments[this.offset+t]},t.prototype.isEmpty=function(){return 0===this.length},t.prototype.isPrefixOf=function(t){if(t.length<this.length)return!1;for(var e=0;e<this.length;e++)if(this.get(e)!==t.get(e))return!1;return!0},t.prototype.forEach=function(t){for(var e=this.offset,n=this.limit();e<n;e++)t(this.segments[e])},t.prototype.toArray=function(){return this.segments.slice(this.offset,this.limit())},t.comparator=function(t,e){for(var n=Math.min(t.length,e.length),r=0;r<n;r++){var i=t.get(r),o=e.get(r);if(i<o)return-1;if(i>o)return 1}return t.length<e.length?-1:t.length>e.length?1:0},t}(),me=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $t.__extends(e,t),e.prototype.canonicalString=function(){return this.toArray().join("/")},e.prototype.toString=function(){return this.canonicalString()},e.fromString=function(t){if(t.indexOf("//")>=0)throw new oe(ie.INVALID_ARGUMENT,"Invalid path ("+t+"). Paths must not contain // in them.");return new e(t.split("/").filter(function(t){return t.length>0}))},e.EMPTY_PATH=new e([]),e}(pe),ge=/^[_a-zA-Z][_a-zA-Z0-9]*$/,ve=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return $t.__extends(e,t),e.isValidIdentifier=function(t){return ge.test(t)},e.prototype.canonicalString=function(){return this.toArray().map(function(t){return t=t.replace("\\","\\\\").replace("`","\\`"),e.isValidIdentifier(t)||(t="`"+t+"`"),t}).join(".")},e.prototype.toString=function(){return this.canonicalString()},e.prototype.isKeyField=function(){return 1===this.length&&"__name__"===this.get(0)},e.keyField=function(){return new e(["__name__"])},e.fromServerFormat=function(t){for(var n=[],r="",i=0,o=function(){if(0===r.length)throw new oe(ie.INVALID_ARGUMENT,"Invalid field path ("+t+"). Paths must not be empty, begin with '.', end with '.', or contain '..'");n.push(r),r=""},a=!1;i<t.length;){var s=t[i];if("\\"===s){if(i+1===t.length)throw new oe(ie.INVALID_ARGUMENT,"Path has trailing escape character: "+t);var u=t[i+1];if("\\"!==u&&"."!==u&&"`"!==u)throw new oe(ie.INVALID_ARGUMENT,"Path has invalid escape sequence: "+t);r+=u,i+=2}else"`"===s?(a=!a,i++):"."!==s||a?(r+=s,i++):(o(),i++)}if(o(),a)throw new oe(ie.INVALID_ARGUMENT,"Unterminated ` in path: "+t);return new e(n)},e.EMPTY_PATH=new e([]),e}(pe),ye=function(){function t(e){this.path=e,c(t.isDocumentKey(e),"Invalid DocumentKey with an odd number of segments: "+e.toArray().join("/"))}return t.prototype.isEqual=function(t){return null!==t&&0===me.comparator(this.path,t.path)},t.prototype.toString=function(){return this.path.toString()},t.comparator=function(t,e){return me.comparator(t.path,e.path)},t.isDocumentKey=function(t){return t.length%2===0},t.fromSegments=function(e){return new t(new me(e.slice()))},t.fromPathString=function(e){return new t(me.fromString(e))},t.EMPTY=new t(new me([])),t}(),_e=function(){function t(t,e,n,r){this.key=t,this.version=e,this.data=n,this.hasLocalMutations=r.hasLocalMutations}return t.prototype.field=function(t){return this.data.field(t)},t.prototype.fieldValue=function(t){var e=this.field(t);return e?e.value():void 0},t.prototype.value=function(){return this.data.value()},t.prototype.isEqual=function(e){return e instanceof t&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.data.isEqual(e.data)&&this.hasLocalMutations===e.hasLocalMutations},t.prototype.toString=function(){return"Document("+this.key+", "+this.version+", "+this.data.toString()+", {hasLocalMutations: "+this.hasLocalMutations+"})"},t.compareByKey=function(t,e){return ye.comparator(t.key,e.key)},t.compareByField=function(t,e,n){var r=e.field(t),i=n.field(t);return void 0!==r&&void 0!==i?r.compareTo(i):u("Trying to compare documents on fields that don't exist")},t}(),be=function(){function t(t,e){this.key=t,this.version=e}return t.prototype.toString=function(){return"NoDocument("+this.key+", "+this.version+")"},t.prototype.isEqual=function(t){return t&&t.version.isEqual(this.version)&&t.key.isEqual(this.key)},t.compareByKey=function(t,e){return ye.comparator(t.key,e.key)},t}(),we=function(){function t(t,e){this.comparator=t,this.root=e||xe.EMPTY}return t.prototype.insert=function(e,n){return new t(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,xe.BLACK,null,null))},t.prototype.remove=function(e){return new t(this.comparator,this.root.remove(e,this.comparator).copy(null,null,xe.BLACK,null,null))},t.prototype.get=function(t){for(var e=this.root;!e.isEmpty();){var n=this.comparator(t,e.key);if(0===n)return e.value;n<0?e=e.left:n>0&&(e=e.right)}return null},t.prototype.indexOf=function(t){for(var e=0,n=this.root;!n.isEmpty();){var r=this.comparator(t,n.key);if(0===r)return e+n.left.size;r<0?n=n.left:(e+=n.left.size+1,n=n.right)}return-1},t.prototype.isEmpty=function(){return this.root.isEmpty()},Object.defineProperty(t.prototype,"size",{get:function(){return this.root.size},enumerable:!0,configurable:!0}),t.prototype.minKey=function(){return this.root.minKey()},t.prototype.maxKey=function(){return this.root.maxKey()},t.prototype.inorderTraversal=function(t){return this.root.inorderTraversal(t)},t.prototype.forEach=function(t){this.inorderTraversal(function(e,n){return t(e,n),!1})},t.prototype.reverseTraversal=function(t){return this.root.reverseTraversal(t)},t.prototype.getIterator=function(){return new Ee(this.root,null,this.comparator,!1)},t.prototype.getIteratorFrom=function(t){return new Ee(this.root,t,this.comparator,!1)},t.prototype.getReverseIterator=function(){return new Ee(this.root,null,this.comparator,!0)},t.prototype.getReverseIteratorFrom=function(t){return new Ee(this.root,t,this.comparator,!0)},t}(),Ee=function(){function t(t,e,n,r){this.isReverse=r,this.nodeStack=[];for(var i=1;!t.isEmpty();)if(i=e?n(t.key,e):1,r&&(i*=-1),i<0)t=this.isReverse?t.left:t.right;else{if(0===i){this.nodeStack.push(t);break}this.nodeStack.push(t),t=this.isReverse?t.right:t.left}}return t.prototype.getNext=function(){c(this.nodeStack.length>0,"getNext() called on iterator when hasNext() is false.");var t=this.nodeStack.pop(),e={key:t.key,value:t.value};if(this.isReverse)for(t=t.left;!t.isEmpty();)this.nodeStack.push(t),t=t.right;else for(t=t.right;!t.isEmpty();)this.nodeStack.push(t),t=t.left;return e},t.prototype.hasNext=function(){return this.nodeStack.length>0},t.prototype.peek=function(){if(0===this.nodeStack.length)return null;var t=this.nodeStack[this.nodeStack.length-1];return{key:t.key,value:t.value}},t}(),xe=function(){function t(e,n,r,i,o){this.key=e,this.value=n,this.color=null!=r?r:t.RED,this.left=null!=i?i:t.EMPTY,this.right=null!=o?o:t.EMPTY,this.size=this.left.size+1+this.right.size}return t.prototype.copy=function(e,n,r,i,o){return new t(null!=e?e:this.key,null!=n?n:this.value,null!=r?r:this.color,null!=i?i:this.left,null!=o?o:this.right)},t.prototype.isEmpty=function(){return!1},t.prototype.inorderTraversal=function(t){return this.left.inorderTraversal(t)||t(this.key,this.value)||this.right.inorderTraversal(t)},t.prototype.reverseTraversal=function(t){return this.right.reverseTraversal(t)||t(this.key,this.value)||this.left.reverseTraversal(t)},t.prototype.min=function(){return this.left.isEmpty()?this:this.left.min()},t.prototype.minKey=function(){return this.min().key},t.prototype.maxKey=function(){return this.right.isEmpty()?this.key:this.right.maxKey()},t.prototype.insert=function(t,e,n){var r=this,i=n(t,r.key);return r=i<0?r.copy(null,null,null,r.left.insert(t,e,n),null):0===i?r.copy(null,e,null,null,null):r.copy(null,null,null,null,r.right.insert(t,e,n)),r.fixUp()},t.prototype.removeMin=function(){if(this.left.isEmpty())return t.EMPTY;var e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()},t.prototype.remove=function(e,n){var r,i=this;if(n(e,i.key)<0)i.left.isEmpty()||i.left.isRed()||i.left.left.isRed()||(i=i.moveRedLeft()),i=i.copy(null,null,null,i.left.remove(e,n),null);else{if(i.left.isRed()&&(i=i.rotateRight()),i.right.isEmpty()||i.right.isRed()||i.right.left.isRed()||(i=i.moveRedRight()),0===n(e,i.key)){if(i.right.isEmpty())return t.EMPTY;r=i.right.min(),i=i.copy(r.key,r.value,null,null,i.right.removeMin())}i=i.copy(null,null,null,null,i.right.remove(e,n))}return i.fixUp()},t.prototype.isRed=function(){return this.color},t.prototype.fixUp=function(){var t=this;return t.right.isRed()&&!t.left.isRed()&&(t=t.rotateLeft()),t.left.isRed()&&t.left.left.isRed()&&(t=t.rotateRight()),t.left.isRed()&&t.right.isRed()&&(t=t.colorFlip()),t},t.prototype.moveRedLeft=function(){var t=this.colorFlip();return t.right.left.isRed()&&(t=t.copy(null,null,null,null,t.right.rotateRight()),t=t.rotateLeft(),t=t.colorFlip()),t},t.prototype.moveRedRight=function(){var t=this.colorFlip();return t.left.left.isRed()&&(t=t.rotateRight(),t=t.colorFlip()),t},t.prototype.rotateLeft=function(){var e=this.copy(null,null,t.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)},t.prototype.rotateRight=function(){var e=this.copy(null,null,t.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)},t.prototype.colorFlip=function(){var t=this.left.copy(null,null,!this.left.color,null,null),e=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,t,e)},t.prototype.checkMaxDepth=function(){var t=this.check();return Math.pow(2,t)<=this.size+1},t.prototype.check=function(){if(this.isRed()&&this.left.isRed())throw u("Red node has red child("+this.key+","+this.value+")");if(this.right.isRed())throw u("Right child of ("+this.key+","+this.value+") is red");var t=this.left.check();if(t!==this.right.check())throw u("Black depths differ");return t+(this.isRed()?0:1)},t.EMPTY=null,t.RED=!0,t.BLACK=!1,t}(),Te=function(){function t(){this.size=0}return t.prototype.copy=function(t,e,n,r,i){return this},t.prototype.insert=function(t,e,n){return new xe(t,e)},t.prototype.remove=function(t,e){return this},t.prototype.isEmpty=function(){return!0},t.prototype.inorderTraversal=function(t){return!1},t.prototype.reverseTraversal=function(t){return!1},t.prototype.minKey=function(){return null},t.prototype.maxKey=function(){return null},t.prototype.isRed=function(){return!1},t.prototype.checkMaxDepth=function(){return!0},t.prototype.check=function(){return 0},t}();xe.EMPTY=new Te;var Se;!function(t){t[t.NullValue=0]="NullValue",t[t.BooleanValue=1]="BooleanValue",t[t.NumberValue=2]="NumberValue",t[t.TimestampValue=3]="TimestampValue",t[t.StringValue=4]="StringValue",t[t.BlobValue=5]="BlobValue",t[t.RefValue=6]="RefValue",t[t.GeoPointValue=7]="GeoPointValue",t[t.ArrayValue=8]="ArrayValue",t[t.ObjectValue=9]="ObjectValue"}(Se||(Se={}));var Ce;!function(t){t[t.Default=0]="Default",t[t.Estimate=1]="Estimate",t[t.Previous=2]="Previous"}(Ce||(Ce={}));var Me,Ae=function(){function t(t,e){this.serverTimestampBehavior=t,this.timestampsInSnapshots=e}return t.fromSnapshotOptions=function(e,n){switch(e.serverTimestamps){case"estimate":return new t(Ce.Estimate,n);case"previous":return new t(Ce.Previous,n);case"none":case void 0:return new t(Ce.Default,n);default:return u("fromSnapshotOptions() called with invalid options.")}},t}(),Ie=function(){function t(){}return t.prototype.toString=function(){var t=this.value();return null===t?"null":t.toString()},t.prototype.defaultCompareTo=function(t){return c(this.typeOrder!==t.typeOrder,"Default compareTo should not be used for values of same type."),U(this.typeOrder,t.typeOrder)},t}(),Re=function(t){function e(){var e=t.call(this)||this;return e.typeOrder=Se.NullValue,e.internalValue=null,e}return $t.__extends(e,t),e.prototype.value=function(t){return null},e.prototype.isEqual=function(t){return t instanceof e},e.prototype.compareTo=function(t){return t instanceof e?0:this.defaultCompareTo(t)},e.INSTANCE=new e,e}(Ie),Pe=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.BooleanValue,n}return $t.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?U(this,t):this.defaultCompareTo(t)},e.of=function(t){return t?e.TRUE:e.FALSE},e.TRUE=new e(!0),e.FALSE=new e(!1),e}(Ie),Ne=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.NumberValue,n}return $t.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.compareTo=function(t){return t instanceof e?z(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(Ie),De=function(t){function e(e){return t.call(this,e)||this}return $t.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&W(this.internalValue,t.internalValue)},e}(Ne),Oe=function(t){function e(e){var n=t.call(this,e)||this;return n.internalValue=e,n}return $t.__extends(e,t),e.prototype.isEqual=function(t){return t instanceof e&&W(this.internalValue,t.internalValue)},e.NAN=new e(NaN),e.POSITIVE_INFINITY=new e(1/0),e.NEGATIVE_INFINITY=new e(-1/0),e}(Ne),ke=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.StringValue,n}return $t.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue===t.internalValue},e.prototype.compareTo=function(t){return t instanceof e?U(this.internalValue,t.internalValue):this.defaultCompareTo(t)},e}(Ie),Le=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.TimestampValue,n}return $t.__extends(e,t),e.prototype.value=function(t){return t&&t.timestampsInSnapshots?this.internalValue:this.internalValue.toDate()},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):t instanceof Ue?-1:this.defaultCompareTo(t)},e}(Ie),Ue=function(t){function e(e,n){var r=t.call(this)||this;return r.localWriteTime=e,r.previousValue=n,r.typeOrder=Se.TimestampValue,r}return $t.__extends(e,t),e.prototype.value=function(t){return t&&t.serverTimestampBehavior===Ce.Estimate?new Le(this.localWriteTime).value(t):t&&t.serverTimestampBehavior===Ce.Previous&&this.previousValue?this.previousValue.value(t):null},e.prototype.isEqual=function(t){return t instanceof e&&this.localWriteTime.isEqual(t.localWriteTime)},e.prototype.compareTo=function(t){return t instanceof e?this.localWriteTime._compareTo(t.localWriteTime):t instanceof Le?1:this.defaultCompareTo(t)},e.prototype.toString=function(){return"<ServerTimestamp localTime="+this.localWriteTime.toString()+">"},e}(Ie),Fe=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.BlobValue,n}return $t.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Ie),Be=function(t){function e(e,n){var r=t.call(this)||this;return r.databaseId=e,r.key=n,r.typeOrder=Se.RefValue,r}return $t.__extends(e,t),e.prototype.value=function(t){return this.key},e.prototype.isEqual=function(t){return t instanceof e&&(this.key.isEqual(t.key)&&this.databaseId.isEqual(t.databaseId))},e.prototype.compareTo=function(t){if(t instanceof e){var n=this.databaseId.compareTo(t.databaseId);return 0!==n?n:ye.comparator(this.key,t.key)}return this.defaultCompareTo(t)},e}(Ie),Ve=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.GeoPointValue,n}return $t.__extends(e,t),e.prototype.value=function(t){return this.internalValue},e.prototype.isEqual=function(t){return t instanceof e&&this.internalValue.isEqual(t.internalValue)},e.prototype.compareTo=function(t){return t instanceof e?this.internalValue._compareTo(t.internalValue):this.defaultCompareTo(t)},e}(Ie),je=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.ObjectValue,n}return $t.__extends(e,t),e.prototype.value=function(t){var e={};return this.internalValue.inorderTraversal(function(n,r){e[n]=r.value(t)}),e},e.prototype.forEach=function(t){this.internalValue.inorderTraversal(t)},e.prototype.isEqual=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext();if(i.key!==o.key||!i.value.isEqual(o.value))return!1}return!n.hasNext()&&!r.hasNext()}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=this.internalValue.getIterator(),r=t.internalValue.getIterator();n.hasNext()&&r.hasNext();){var i=n.getNext(),o=r.getNext(),a=U(i.key,o.key)||i.value.compareTo(o.value);if(a)return a}return U(n.hasNext(),r.hasNext())}return this.defaultCompareTo(t)},e.prototype.set=function(t,n){if(c(!t.isEmpty(),"Cannot set field for empty path on ObjectValue"),1===t.length)return this.setChild(t.firstSegment(),n);var r=this.child(t.firstSegment());r instanceof e||(r=e.EMPTY);var i=r.set(t.popFirst(),n);return this.setChild(t.firstSegment(),i)},e.prototype.delete=function(t){if(c(!t.isEmpty(),"Cannot delete field for empty path on ObjectValue"),1===t.length)return new e(this.internalValue.remove(t.firstSegment()));var n=this.child(t.firstSegment());if(n instanceof e){var r=n.delete(t.popFirst());return new e(this.internalValue.insert(t.firstSegment(),r))}return this},e.prototype.contains=function(t){return void 0!==this.field(t)},e.prototype.field=function(t){c(!t.isEmpty(),"Can't get field of empty path");var n=this;return t.forEach(function(t){n=n instanceof e?n.internalValue.get(t)||void 0:void 0}),n},e.prototype.toString=function(){return JSON.stringify(this.value())},e.prototype.child=function(t){return this.internalValue.get(t)||void 0},e.prototype.setChild=function(t,n){return new e(this.internalValue.insert(t,n))},e.EMPTY=new e(new we(U)),e}(Ie),He=function(t){function e(e){var n=t.call(this)||this;return n.internalValue=e,n.typeOrder=Se.ArrayValue,n}return $t.__extends(e,t),e.prototype.value=function(t){return this.internalValue.map(function(e){return e.value(t)})},e.prototype.forEach=function(t){this.internalValue.forEach(t)},e.prototype.isEqual=function(t){if(t instanceof e){if(this.internalValue.length!==t.internalValue.length)return!1;for(var n=0;n<this.internalValue.length;n++)if(!this.internalValue[n].isEqual(t.internalValue[n]))return!1;return!0}return!1},e.prototype.compareTo=function(t){if(t instanceof e){for(var n=Math.min(this.internalValue.length,t.internalValue.length),r=0;r<n;r++){var i=this.internalValue[r].compareTo(t.internalValue[r]);if(i)return i}return U(this.internalValue.length,t.internalValue.length)}return this.defaultCompareTo(t)},e.prototype.toString=function(){return JSON.stringify(this.value())},e}(Ie),Ge=Number,ze=Ge.MIN_SAFE_INTEGER||-(Math.pow(2,53)-1),We=Ge.MAX_SAFE_INTEGER||Math.pow(2,53)-1,qe=Ge.isInteger||function(t){return"number"===typeof t&&isFinite(t)&&Math.floor(t)===t},Ye=function(){function t(t,e,n,r,i,o){void 0===e&&(e=[]),void 0===n&&(n=[]),void 0===r&&(r=null),void 0===i&&(i=null),void 0===o&&(o=null),this.path=t,this.explicitOrderBy=e,this.filters=n,this.limit=r,this.startAt=i,this.endAt=o,this.memoizedCanonicalId=null,this.memoizedOrderBy=null,this.startAt&&this.assertValidBound(this.startAt),this.endAt&&this.assertValidBound(this.endAt)}return t.atPath=function(e){return new t(e)},Object.defineProperty(t.prototype,"orderBy",{get:function(){if(null===this.memoizedOrderBy){var t=this.getInequalityFilterField(),e=this.getFirstOrderByField();if(null!==t&&null===e)t.isKeyField()?this.memoizedOrderBy=[en]:this.memoizedOrderBy=[new tn(t),en];else{c(null===t||null!==e&&t.isEqual(e),"First orderBy should match inequality field."),this.memoizedOrderBy=[];for(var n=!1,r=0,i=this.explicitOrderBy;r<i.length;r++){var o=i[r];this.memoizedOrderBy.push(o),o.field.isKeyField()&&(n=!0)}if(!n){var a=this.explicitOrderBy.length>0?this.explicitOrderBy[this.explicitOrderBy.length-1].dir:Ze.ASCENDING;this.memoizedOrderBy.push(a===Ze.ASCENDING?en:nn)}}}return this.memoizedOrderBy},enumerable:!0,configurable:!0}),t.prototype.addFilter=function(e){c(null==this.getInequalityFilterField()||!(e instanceof Qe)||!e.isInequality()||e.field.isEqual(this.getInequalityFilterField()),"Query must only have one inequality field."),c(!ye.isDocumentKey(this.path),"No filtering allowed for document query");var n=this.filters.concat([e]);return new t(this.path,this.explicitOrderBy.slice(),n,this.limit,this.startAt,this.endAt)},t.prototype.addOrderBy=function(e){c(!ye.isDocumentKey(this.path),"No ordering allowed for document query"),c(!this.startAt&&!this.endAt,"Bounds must be set after orderBy");var n=this.explicitOrderBy.concat([e]);return new t(this.path,n,this.filters.slice(),this.limit,this.startAt,this.endAt)},t.prototype.withLimit=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),e,this.startAt,this.endAt)},t.prototype.withStartAt=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,e,this.endAt)},t.prototype.withEndAt=function(e){return new t(this.path,this.explicitOrderBy.slice(),this.filters.slice(),this.limit,this.startAt,e)},t.prototype.canonicalId=function(){if(null===this.memoizedCanonicalId){var t=this.path.canonicalString();t+="|f:";for(var e=0,n=this.filters;e<n.length;e++){t+=n[e].canonicalId(),t+=","}t+="|ob:";for(var r=0,i=this.orderBy;r<i.length;r++){t+=i[r].canonicalId(),t+=","}q(this.limit)||(t+="|l:",t+=this.limit),this.startAt&&(t+="|lb:",t+=this.startAt.canonicalId()),this.endAt&&(t+="|ub:",t+=this.endAt.canonicalId()),this.memoizedCanonicalId=t}return this.memoizedCanonicalId},t.prototype.toString=function(){var t="Query("+this.path.canonicalString();return this.filters.length>0&&(t+=", filters: ["+this.filters.join(", ")+"]"),q(this.limit)||(t+=", limit: "+this.limit),this.explicitOrderBy.length>0&&(t+=", orderBy: ["+this.explicitOrderBy.join(", ")+"]"),this.startAt&&(t+=", startAt: "+this.startAt.canonicalId()),this.endAt&&(t+=", endAt: "+this.endAt.canonicalId()),t+")"},t.prototype.isEqual=function(t){if(this.limit!==t.limit)return!1;if(this.orderBy.length!==t.orderBy.length)return!1;for(var e=0;e<this.orderBy.length;e++)if(!this.orderBy[e].isEqual(t.orderBy[e]))return!1;if(this.filters.length!==t.filters.length)return!1;for(var e=0;e<this.filters.length;e++)if(!this.filters[e].isEqual(t.filters[e]))return!1;return!!this.path.isEqual(t.path)&&(!(null!==this.startAt?!this.startAt.isEqual(t.startAt):null!==t.startAt)&&(null!==this.endAt?this.endAt.isEqual(t.endAt):null===t.endAt))},t.prototype.docComparator=function(t,e){for(var n=!1,r=0,i=this.orderBy;r<i.length;r++){var o=i[r],a=o.compare(t,e);if(0!==a)return a;n=n||o.field.isKeyField()}return c(n,"orderBy used that doesn't compare on key field"),0},t.prototype.matches=function(t){return this.matchesAncestor(t)&&this.matchesOrderBy(t)&&this.matchesFilters(t)&&this.matchesBounds(t)},t.prototype.hasLimit=function(){return!q(this.limit)},t.prototype.getFirstOrderByField=function(){return this.explicitOrderBy.length>0?this.explicitOrderBy[0].field:null},t.prototype.getInequalityFilterField=function(){for(var t=0,e=this.filters;t<e.length;t++){var n=e[t];if(n instanceof Qe&&n.isInequality())return n.field}return null},t.prototype.isDocumentQuery=function(){return ye.isDocumentKey(this.path)&&0===this.filters.length},t.prototype.matchesAncestor=function(t){var e=t.key.path;return ye.isDocumentKey(this.path)?this.path.isEqual(e):this.path.isPrefixOf(e)&&this.path.length===e.length-1},t.prototype.matchesOrderBy=function(t){for(var e=0,n=this.explicitOrderBy;e<n.length;e++){var r=n[e];if(!r.field.isKeyField()&&void 0===t.field(r.field))return!1}return!0},t.prototype.matchesFilters=function(t){for(var e=0,n=this.filters;e<n.length;e++){if(!n[e].matches(t))return!1}return!0},t.prototype.matchesBounds=function(t){return!(this.startAt&&!this.startAt.sortsBeforeDocument(this.orderBy,t))&&(!this.endAt||!this.endAt.sortsBeforeDocument(this.orderBy,t))},t.prototype.assertValidBound=function(t){c(t.position.length<=this.orderBy.length,"Bound is longer than orderBy")},t}(),Ke=function(){function t(t){this.name=t}return t.fromString=function(e){switch(e){case"<":return t.LESS_THAN;case"<=":return t.LESS_THAN_OR_EQUAL;case"==":return t.EQUAL;case">=":return t.GREATER_THAN_OR_EQUAL;case">":return t.GREATER_THAN;default:return u("Unknown relation: "+e)}},t.prototype.toString=function(){return this.name},t.prototype.isEqual=function(t){return this.name===t.name},t.LESS_THAN=new t("<"),t.LESS_THAN_OR_EQUAL=new t("<="),t.EQUAL=new t("=="),t.GREATER_THAN=new t(">"),t.GREATER_THAN_OR_EQUAL=new t(">="),t}(),Qe=function(){function t(t,e,n){this.field=t,this.op=e,this.value=n}return t.prototype.matches=function(t){if(this.field.isKeyField()){c(this.value instanceof Be,"Comparing on key, but filter value not a RefValue");var e=this.value,n=ye.comparator(t.key,e.key);return this.matchesComparison(n)}var r=t.field(this.field);return void 0!==r&&this.matchesValue(r)},t.prototype.matchesValue=function(t){return this.value.typeOrder===t.typeOrder&&this.matchesComparison(t.compareTo(this.value))},t.prototype.matchesComparison=function(t){switch(this.op){case Ke.LESS_THAN:return t<0;case Ke.LESS_THAN_OR_EQUAL:return t<=0;case Ke.EQUAL:return 0===t;case Ke.GREATER_THAN:return t>0;case Ke.GREATER_THAN_OR_EQUAL:return t>=0;default:return u("Unknown relation op"+this.op)}},t.prototype.isInequality=function(){return this.op!==Ke.EQUAL},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.op.toString()+this.value.toString()},t.prototype.isEqual=function(e){return e instanceof t&&(this.op.isEqual(e.op)&&this.field.isEqual(e.field)&&this.value.isEqual(e.value))},t.prototype.toString=function(){return this.field.canonicalString()+" "+this.op+" "+this.value.value()},t}(),Xe=function(){function t(t){this.field=t}return t.prototype.matches=function(t){var e=t.field(this.field);return void 0!==e&&null===e.value()},t.prototype.canonicalId=function(){return this.field.canonicalString()+" IS null"},t.prototype.toString=function(){return this.field.canonicalString()+" IS null"},t.prototype.isEqual=function(e){return e instanceof t&&this.field.isEqual(e.field)},t}(),Je=function(){function t(t){this.field=t}return t.prototype.matches=function(t){var e=t.field(this.field).value();return"number"===typeof e&&isNaN(e)},t.prototype.canonicalId=function(){return this.field.canonicalString()+" IS NaN"},t.prototype.toString=function(){return this.field.canonicalString()+" IS NaN"},t.prototype.isEqual=function(e){return e instanceof t&&this.field.isEqual(e.field)},t}(),Ze=function(){function t(t){this.name=t}return t.prototype.toString=function(){return this.name},t.ASCENDING=new t("asc"),t.DESCENDING=new t("desc"),t}(),$e=function(){function t(t,e){this.position=t,this.before=e}return t.prototype.canonicalId=function(){for(var t=this.before?"b:":"a:",e=0,n=this.position;e<n.length;e++){t+=n[e].toString()}return t},t.prototype.sortsBeforeDocument=function(t,e){c(this.position.length<=t.length,"Bound has more components than query's orderBy");for(var n=0,r=0;r<this.position.length;r++){var i=t[r],o=this.position[r];if(i.field.isKeyField())c(o instanceof Be,"Bound has a non-key value where the key path is being used."),n=ye.comparator(o.key,e.key);else{var a=e.field(i.field);c(void 0!==a,"Field should exist since document matched the orderBy already."),n=o.compareTo(a)}if(i.dir===Ze.DESCENDING&&(n*=-1),0!==n)break}return this.before?n<=0:n<0},t.prototype.isEqual=function(t){if(null===t)return!1;if(this.before!==t.before||this.position.length!==t.position.length)return!1;for(var e=0;e<this.position.length;e++){var n=this.position[e],r=t.position[e];return n.isEqual(r)}return!0},t}(),tn=function(){function t(t,e){this.field=t,void 0===e&&(e=Ze.ASCENDING),this.dir=e,this.isKeyOrderBy=t.isKeyField()}return t.prototype.compare=function(t,e){var n=this.isKeyOrderBy?_e.compareByKey(t,e):_e.compareByField(this.field,t,e);switch(this.dir){case Ze.ASCENDING:return n;case Ze.DESCENDING:return-1*n;default:return u("Unknown direction: "+this.dir)}},t.prototype.canonicalId=function(){return this.field.canonicalString()+this.dir.toString()},t.prototype.toString=function(){return this.field.canonicalString()+" ("+this.dir+")"},t.prototype.isEqual=function(t){return this.dir===t.dir&&this.field.isEqual(t.field)},t}(),en=new tn(ve.keyField(),Ze.ASCENDING),nn=new tn(ve.keyField(),Ze.DESCENDING),rn=function(){function t(t){this.timestamp=t}return t.fromMicroseconds=function(e){var n=Math.floor(e/1e6);return new t(new le(n,e%1e6*1e3))},t.fromTimestamp=function(e){return new t(e)},t.forDeletedDoc=function(){return t.MIN},t.prototype.compareTo=function(t){return this.timestamp._compareTo(t.timestamp)},t.prototype.isEqual=function(t){return this.timestamp.isEqual(t.timestamp)},t.prototype.toMicroseconds=function(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3},t.prototype.toString=function(){return"SnapshotVersion("+this.timestamp.toString()+")"},t.prototype.toTimestamp=function(){return this.timestamp},t.MIN=new t(new le(0,0)),t}();!function(t){t[t.Listen=0]="Listen",t[t.ExistenceFilterMismatch=1]="ExistenceFilterMismatch",t[t.LimboResolution=2]="LimboResolution"}(Me||(Me={}));var on,an=function(){function t(t,e,n,r,i){void 0===r&&(r=rn.MIN),void 0===i&&(i=l()),this.query=t,this.targetId=e,this.purpose=n,this.snapshotVersion=r,this.resumeToken=i}return t.prototype.update=function(e){return new t(this.query,this.targetId,this.purpose,e.snapshotVersion,e.resumeToken)},t.prototype.isEqual=function(t){return this.targetId===t.targetId&&this.purpose===t.purpose&&this.snapshotVersion.isEqual(t.snapshotVersion)&&this.resumeToken===t.resumeToken&&this.query.isEqual(t.query)},t}(),sn=function(){function t(t){this.fields=t}return t.prototype.isEqual=function(t){return B(this.fields,t.fields)},t}(),un=function(){function t(){}return t.prototype.isEqual=function(e){return e instanceof t},t.instance=new t,t}(),cn=function(){function t(t,e){this.field=t,this.transform=e}return t.prototype.isEqual=function(t){return this.field.isEqual(t.field)&&this.transform.isEqual(t.transform)},t}(),ln=function(){function t(t,e){this.version=t,this.transformResults=e}return t}();!function(t){t[t.Set=0]="Set",t[t.Patch=1]="Patch",t[t.Transform=2]="Transform",t[t.Delete=3]="Delete"}(on||(on={}));var hn,fn=function(){function t(t,e){this.updateTime=t,this.exists=e,c(void 0===t||void 0===e,'Precondition can specify "exists" or "updateTime" but not both')}return t.exists=function(e){return new t(void 0,e)},t.updateTime=function(e){return new t(e)},Object.defineProperty(t.prototype,"isNone",{get:function(){return void 0===this.updateTime&&void 0===this.exists},enumerable:!0,configurable:!0}),t.prototype.isValidFor=function(t){return void 0!==this.updateTime?t instanceof _e&&t.version.isEqual(this.updateTime):void 0!==this.exists?this.exists?t instanceof _e:null===t||t instanceof be:(c(this.isNone,"Precondition should be empty"),!0)},t.prototype.isEqual=function(t){return F(this.updateTime,t.updateTime)&&this.exists===t.exists},t.NONE=new t,t}(),dn=function(){function t(){}return t.prototype.verifyKeyMatches=function(t){null!=t&&c(t.key.isEqual(this.key),"Can only apply a mutation to a document with the same key")},t.getPostMutationVersion=function(t){return t instanceof _e?t.version:rn.MIN},t}(),pn=function(t){function e(e,n,r){var i=t.call(this)||this;return i.key=e,i.value=n,i.precondition=r,i.type=on.Set,i}return $t.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by SetMutation.");var n=dn.getPostMutationVersion(t);return new _e(this.key,n,this.value,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=dn.getPostMutationVersion(t);return new _e(this.key,r,this.value,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.value.isEqual(t.value)&&this.precondition.isEqual(t.precondition)},e}(dn),mn=function(t){function e(e,n,r,i){var o=t.call(this)||this;return o.key=e,o.data=n,o.fieldMask=r,o.precondition=i,o.type=on.Patch,o}return $t.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){if(this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by PatchMutation."),!this.precondition.isValidFor(t))return t;var n=dn.getPostMutationVersion(t),r=this.patchDocument(t);return new _e(this.key,n,r,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=dn.getPostMutationVersion(t),i=this.patchDocument(t);return new _e(this.key,r,i,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.fieldMask.isEqual(t.fieldMask)&&this.precondition.isEqual(t.precondition)},e.prototype.patchDocument=function(t){var e;return e=t instanceof _e?t.data:je.EMPTY,this.patchObject(e)},e.prototype.patchObject=function(t){for(var e=0,n=this.fieldMask.fields;e<n.length;e++){var r=n[e],i=this.data.field(r);t=void 0!==i?t.set(r,i):t.delete(r)}return t},e}(dn),gn=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.fieldTransforms=n,r.type=on.Transform,r.precondition=fn.exists(!0),r}return $t.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){this.verifyKeyMatches(t),c(null!=e.transformResults,"Transform results missing for TransformMutation.");var n=e.transformResults;if(!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.transformObject(r.data,n);return new _e(this.key,r.version,i,{hasLocalMutations:!1})},e.prototype.applyToLocalView=function(t,e,n){if(this.verifyKeyMatches(t),!this.precondition.isValidFor(t))return t;var r=this.requireDocument(t),i=this.localTransformResults(n,e),o=this.transformObject(r.data,i);return new _e(this.key,r.version,o,{hasLocalMutations:!0})},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&B(this.fieldTransforms,t.fieldTransforms)&&this.precondition.isEqual(t.precondition)},e.prototype.requireDocument=function(t){c(t instanceof _e,"Unknown MaybeDocument type "+t);var e=t;return c(e.key.isEqual(this.key),"Can only transform a document with the same key"),e},e.prototype.localTransformResults=function(t,e){for(var n=[],r=0,i=this.fieldTransforms;r<i.length;r++){var o=i[r],a=o.transform;if(!(a instanceof un))return u("Encountered unknown transform: "+a);var s=null;e instanceof _e&&(s=e.field(o.field)||null),n.push(new Ue(t,s))}return n},e.prototype.transformObject=function(t,e){c(e.length===this.fieldTransforms.length,"TransformResults length mismatch.");for(var n=0;n<this.fieldTransforms.length;n++){var r=this.fieldTransforms[n],i=r.transform,o=r.field;if(!(i instanceof un))return u("Encountered unknown transform: "+i);t=t.set(o,e[n])}return t},e}(dn),vn=function(t){function e(e,n){var r=t.call(this)||this;return r.key=e,r.precondition=n,r.type=on.Delete,r}return $t.__extends(e,t),e.prototype.applyToRemoteDocument=function(t,e){return this.verifyKeyMatches(t),c(null==e.transformResults,"Transform results received by DeleteMutation."),new be(this.key,rn.MIN)},e.prototype.applyToLocalView=function(t,e,n){return this.verifyKeyMatches(t),this.precondition.isValidFor(t)?(t&&c(t.key.isEqual(this.key),"Can only apply mutation to document with same key"),new be(this.key,rn.forDeletedDoc())):t},e.prototype.isEqual=function(t){return t instanceof e&&this.key.isEqual(t.key)&&this.precondition.isEqual(t.precondition)},e}(dn),yn=function(){function t(t){this.count=t}return t.prototype.isEqual=function(t){return t&&t.count===this.count},t}();!function(t){t[t.OK=0]="OK",t[t.CANCELLED=1]="CANCELLED",t[t.UNKNOWN=2]="UNKNOWN",t[t.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",t[t.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",t[t.NOT_FOUND=5]="NOT_FOUND",t[t.ALREADY_EXISTS=6]="ALREADY_EXISTS",t[t.PERMISSION_DENIED=7]="PERMISSION_DENIED",t[t.UNAUTHENTICATED=16]="UNAUTHENTICATED",t[t.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",t[t.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",t[t.ABORTED=10]="ABORTED",t[t.OUT_OF_RANGE=11]="OUT_OF_RANGE",t[t.UNIMPLEMENTED=12]="UNIMPLEMENTED",t[t.INTERNAL=13]="INTERNAL",t[t.UNAVAILABLE=14]="UNAVAILABLE",t[t.DATA_LOSS=15]="DATA_LOSS"}(hn||(hn={}));var _n,bn=function(){function t(t){this.comparator=t,this.data=new we(this.comparator)}return t.fromMapKeys=function(e){var n=new t(e.comparator);return e.forEach(function(t){n=n.add(t)}),n},t.prototype.has=function(t){return null!==this.data.get(t)},t.prototype.first=function(){return this.data.minKey()},t.prototype.last=function(){return this.data.maxKey()},Object.defineProperty(t.prototype,"size",{get:function(){return this.data.size},enumerable:!0,configurable:!0}),t.prototype.indexOf=function(t){return this.data.indexOf(t)},t.prototype.forEach=function(t){this.data.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.forEachInRange=function(t,e){for(var n=this.data.getIteratorFrom(t[0]);n.hasNext();){var r=n.getNext();if(this.comparator(r.key,t[1])>=0)return;e(r.key)}},t.prototype.forEachWhile=function(t,e){var n;for(n=void 0!==e?this.data.getIteratorFrom(e):this.data.getIterator();n.hasNext();){if(!t(n.getNext().key))return}},t.prototype.firstAfterOrEqual=function(t){var e=this.data.getIteratorFrom(t);return e.hasNext()?e.getNext().key:null},t.prototype.add=function(t){return this.copy(this.data.remove(t).insert(t,!0))},t.prototype.delete=function(t){return this.has(t)?this.copy(this.data.remove(t)):this},t.prototype.isEmpty=function(){return this.data.isEmpty()},t.prototype.unionWith=function(t){var e=this;return t.forEach(function(t){e=e.add(t)}),e},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.data.getIterator(),r=e.data.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(0!==this.comparator(i,o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){return t.push(e)}),"SortedSet("+t.toString()+")"},t.prototype.copy=function(e){var n=new t(this.comparator);return n.data=e,n},t}(),wn=new we(ye.comparator),En=new we(ye.comparator),xn=new we(ye.comparator),Tn=new bn(ye.comparator),Sn=function(){function t(t,e,n){this.snapshotVersion=t,this.targetChanges=e,this.documentUpdates=n}return t.prototype.addDocumentUpdate=function(t){this.documentUpdates=this.documentUpdates.insert(t.key,t)},t.prototype.handleExistenceFilterMismatch=function(t){this.targetChanges[t]={mapping:new An,snapshotVersion:rn.MIN,currentStatusUpdate:_n.MarkNotCurrent,resumeToken:l()}},t}();!function(t){t[t.None=0]="None",t[t.MarkNotCurrent=1]="MarkNotCurrent",t[t.MarkCurrent=2]="MarkCurrent"}(_n||(_n={}));var Cn,Mn=rt(),An=function(){function t(){this.docs=Mn}return Object.defineProperty(t.prototype,"documents",{get:function(){return this.docs},enumerable:!0,configurable:!0}),t.prototype.add=function(t){this.docs=this.docs.add(t)},t.prototype.delete=function(t){this.docs=this.docs.delete(t)},t.prototype.isEqual=function(t){return null!==t&&this.docs.isEqual(t.docs)},t}(),In=function(){function t(){this.addedDocuments=Mn,this.removedDocuments=Mn}return t.prototype.applyToKeySet=function(t){var e=t;return this.addedDocuments.forEach(function(t){return e=e.add(t)}),this.removedDocuments.forEach(function(t){return e=e.delete(t)}),e},t.prototype.add=function(t){this.addedDocuments=this.addedDocuments.add(t),this.removedDocuments=this.removedDocuments.delete(t)},t.prototype.delete=function(t){this.addedDocuments=this.addedDocuments.delete(t),this.removedDocuments=this.removedDocuments.add(t)},t.prototype.isEqual=function(t){return null!==t&&this.addedDocuments.isEqual(t.addedDocuments)&&this.removedDocuments.isEqual(t.removedDocuments)},t}(),Rn=function(){function t(t,e,n,r){this.updatedTargetIds=t,this.removedTargetIds=e,this.key=n,this.newDoc=r}return t}(),Pn=function(){function t(t,e){this.targetId=t,this.existenceFilter=e}return t}();!function(t){t[t.NoChange=0]="NoChange",t[t.Added=1]="Added",t[t.Removed=2]="Removed",t[t.Current=3]="Current",t[t.Reset=4]="Reset"}(Cn||(Cn={}));var Nn=function(){function t(t,e,n,r){void 0===n&&(n=l()),void 0===r&&(r=null),this.state=t,this.targetIds=e,this.resumeToken=n,this.cause=r}return t}(),Dn=function(){function t(t,e,n){this.snapshotVersion=t,this.listenTargets=e,this.existenceFilters={},this.targetChanges={},this.documentUpdates=tt(),this.frozen=!1,this.pendingTargetResponses=v(n)}return t.prototype.add=function(t){c(!this.frozen,"Trying to modify frozen WatchChangeAggregator."),t instanceof Rn?this.addDocumentChange(t):t instanceof Nn?this.addTargetChange(t):t instanceof Pn?this.addExistenceFilterChange(t):u("Unknown watch change: "+t)},t.prototype.addChanges=function(t){var e=this;c(!this.frozen,"Trying to modify frozen WatchChangeAggregator."),t.forEach(function(t){return e.add(t)})},t.prototype.createRemoteEvent=function(){var t=this,e=this.targetChanges;return p(this.targetChanges,function(n){t.isActiveTarget(n)||delete e[n]}),this.frozen=!0,new Sn(this.snapshotVersion,e,this.documentUpdates)},t.prototype.ensureTargetChange=function(t){var e=this.targetChanges[t];return e||(e={currentStatusUpdate:_n.None,snapshotVersion:this.snapshotVersion,mapping:new In,resumeToken:l()},this.targetChanges[t]=e),e},t.prototype.isActiveTarget=function(t){return!f(this.pendingTargetResponses,t)&&f(this.listenTargets,t)},t.prototype.addDocumentChange=function(t){for(var e=!1,n=0,r=t.updatedTargetIds;n<r.length;n++){var i=r[n];if(this.isActiveTarget(i)){var o=this.ensureTargetChange(i);o.mapping.add(t.key),e=!0}}for(var a=0,s=t.removedTargetIds;a<s.length;a++){var i=s[a];if(this.isActiveTarget(i)){var o=this.ensureTargetChange(i);o.mapping.delete(t.key),e=!0}}t.newDoc&&e&&(this.documentUpdates=this.documentUpdates.insert(t.key,t.newDoc))},t.prototype.addTargetChange=function(t){var e=this;t.targetIds.forEach(function(n){var r=e.ensureTargetChange(n);switch(t.state){case Cn.NoChange:e.isActiveTarget(n)&&it(r,t.resumeToken);break;case Cn.Added:e.recordTargetResponse(n),f(e.pendingTargetResponses,n)||(r.mapping=new In,r.currentStatusUpdate=_n.None,delete e.existenceFilters[n]),it(r,t.resumeToken);break;case Cn.Removed:e.recordTargetResponse(n),c(!t.cause,"WatchChangeAggregator does not handle errored targets");break;case Cn.Current:e.isActiveTarget(n)&&(r.currentStatusUpdate=_n.MarkCurrent,it(r,t.resumeToken));break;case Cn.Reset:e.isActiveTarget(n)&&(r.mapping=new An,it(r,t.resumeToken));break;default:u("Unknown target watch change state: "+t.state)}})},t.prototype.recordTargetResponse=function(t){var e=(this.pendingTargetResponses[t]||0)-1;0===e?delete this.pendingTargetResponses[t]:this.pendingTargetResponses[t]=e},t.prototype.addExistenceFilterChange=function(t){this.isActiveTarget(t.targetId)&&(this.existenceFilters[t.targetId]=t.existenceFilter)},t}(),On=function(){var t={};return t[Ze.ASCENDING.name]="ASCENDING",t[Ze.DESCENDING.name]="DESCENDING",t}(),kn=function(){var t={};return t[Ke.LESS_THAN.name]="LESS_THAN",t[Ke.LESS_THAN_OR_EQUAL.name]="LESS_THAN_OR_EQUAL",t[Ke.GREATER_THAN.name]="GREATER_THAN",t[Ke.GREATER_THAN_OR_EQUAL.name]="GREATER_THAN_OR_EQUAL",t[Ke.EQUAL.name]="EQUAL",t}(),Ln=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/),Un=function(){function t(t,e){this.databaseId=t,this.options=e}return t.prototype.emptyByteString=function(){return this.options.useProto3Json?"":new Uint8Array(0)},t.prototype.unsafeCastProtoByteString=function(t){return t},t.prototype.fromRpcStatus=function(t){var e=void 0===t.code?ie.UNKNOWN:J(t.code);return new oe(e,t.message||"")},t.prototype.toInt32Value=function(t){return q(t)?void 0:{value:t}},t.prototype.fromInt32Value=function(t){var e;return e="object"===typeof t?t.value:t,q(e)?null:e},t.prototype.toTimestamp=function(t){return{seconds:t.seconds,nanos:t.nanoseconds}},t.prototype.fromTimestamp=function(t){if("string"===typeof t)return this.fromIso8601String(t);c(!!t,"Cannot deserialize null or undefined timestamp.");var e=at(t.seconds||"0"),n=t.nanos||0;return new le(e,n)},t.prototype.fromIso8601String=function(t){var e=0,n=Ln.exec(t);if(c(!!n,"invalid timestamp: "+t),n[1]){var r=n[1];r=(r+"000000000").substr(0,9),e=Number(r)}var i=new Date(t),o=Math.floor(i.getTime()/1e3);return new le(o,e)},t.prototype.toBytes=function(t){return this.options.useProto3Json?t.toBase64():this.unsafeCastProtoByteString(t.toUint8Array())},t.prototype.fromBlob=function(t){return"string"===typeof t?(c(this.options.useProto3Json,"Expected bytes to be passed in as Uint8Array, but got a string instead."),se.fromBase64String(t)):(c(!this.options.useProto3Json,"Expected bytes to be passed in as string, but got something else instead."),se.fromUint8Array(t))},t.prototype.toVersion=function(t){return this.toTimestamp(t.toTimestamp())},t.prototype.fromVersion=function(t){return c(!!t,"Trying to deserialize version that isn't set"),rn.fromTimestamp(this.fromTimestamp(t))},t.prototype.toResourceName=function(t,e){return this.fullyQualifiedPrefixPath(t).child("documents").child(e).canonicalString()},t.prototype.fromResourceName=function(t){var e=me.fromString(t);return c(this.isValidResourceName(e),"Tried to deserialize invalid key "+e.toString()),e},t.prototype.toName=function(t){return this.toResourceName(this.databaseId,t.path)},t.prototype.fromName=function(t){var e=this.fromResourceName(t);return c(e.get(1)===this.databaseId.projectId,"Tried to deserialize key from different project: "+e.get(1)+" vs "+this.databaseId.projectId),c(!e.get(3)&&!this.databaseId.database||e.get(3)===this.databaseId.database,"Tried to deserialize key from different database: "+e.get(3)+" vs "+this.databaseId.database),new ye(this.extractLocalPathFromResourceName(e))},t.prototype.toQueryPath=function(t){return 0===t.length?this.encodedDatabaseId:this.toResourceName(this.databaseId,t)},t.prototype.fromQueryPath=function(t){var e=this.fromResourceName(t);return 4===e.length?me.EMPTY_PATH:this.extractLocalPathFromResourceName(e)},Object.defineProperty(t.prototype,"encodedDatabaseId",{get:function(){return new me(["projects",this.databaseId.projectId,"databases",this.databaseId.database]).canonicalString()},enumerable:!0,configurable:!0}),t.prototype.fullyQualifiedPrefixPath=function(t){return new me(["projects",t.projectId,"databases",t.database])},t.prototype.extractLocalPathFromResourceName=function(t){return c(t.length>4&&"documents"===t.get(4),"tried to deserialize invalid key "+t.toString()),t.popFirst(5)},t.prototype.isValidResourceName=function(t){return t.length>=4&&"projects"===t.get(0)&&"databases"===t.get(2)},t.prototype.toValue=function(t){if(t instanceof Re)return{nullValue:"NULL_VALUE"};if(t instanceof Pe)return{booleanValue:t.value()};if(t instanceof De)return{integerValue:""+t.value()};if(t instanceof Oe){var e=t.value();if(this.options.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:t.value()}}return t instanceof ke?{stringValue:t.value()}:t instanceof je?{mapValue:this.toMapValue(t)}:t instanceof He?{arrayValue:this.toArrayValue(t)}:t instanceof Le?{timestampValue:this.toTimestamp(t.internalValue)}:t instanceof Ve?{geoPointValue:{latitude:t.value().latitude,longitude:t.value().longitude}}:t instanceof Fe?{bytesValue:this.toBytes(t.value())}:t instanceof Be?{referenceValue:this.toResourceName(t.databaseId,t.key.path)}:u("Unknown FieldValue "+JSON.stringify(t))},t.prototype.fromValue=function(t){var e=this,n=t.value_type;if(st(t,n,"nullValue"))return Re.INSTANCE;if(st(t,n,"booleanValue"))return Pe.of(t.booleanValue);if(st(t,n,"integerValue"))return new De(at(t.integerValue));if(st(t,n,"doubleValue")){if(this.options.useProto3Json){if("NaN"===t.doubleValue)return Oe.NAN;if("Infinity"===t.doubleValue)return Oe.POSITIVE_INFINITY;if("-Infinity"===t.doubleValue)return Oe.NEGATIVE_INFINITY}return new Oe(t.doubleValue)}if(st(t,n,"stringValue"))return new ke(t.stringValue);if(st(t,n,"mapValue"))return this.fromFields(t.mapValue.fields||{});if(st(t,n,"arrayValue")){ot(t.arrayValue,"arrayValue");var r=t.arrayValue.values||[];return new He(r.map(function(t){return e.fromValue(t)}))}if(st(t,n,"timestampValue"))return ot(t.timestampValue,"timestampValue"),new Le(this.fromTimestamp(t.timestampValue));if(st(t,n,"geoPointValue")){ot(t.geoPointValue,"geoPointValue");var i=t.geoPointValue.latitude||0,o=t.geoPointValue.longitude||0;return new Ve(new ce(i,o))}if(st(t,n,"bytesValue")){ot(t.bytesValue,"bytesValue");var a=this.fromBlob(t.bytesValue);return new Fe(a)}if(st(t,n,"referenceValue")){ot(t.referenceValue,"referenceValue");var s=this.fromResourceName(t.referenceValue),c=new de(s.get(1),s.get(3)),l=new ye(this.extractLocalPathFromResourceName(s));return new Be(c,l)}return u("Unknown Value proto "+JSON.stringify(t))},t.prototype.toMutationDocument=function(t,e){return{name:this.toName(t),fields:this.toFields(e)}},t.prototype.toDocument=function(t){return c(!t.hasLocalMutations,"Can't serialize documents with mutations."),{name:this.toName(t.key),fields:this.toFields(t.data),updateTime:this.toTimestamp(t.version.toTimestamp())}},t.prototype.fromDocument=function(t){return new _e(this.fromName(t.name),this.fromVersion(t.updateTime),this.fromFields(t.fields||{}),{hasLocalMutations:!1})},t.prototype.toFields=function(t){var e=this,n={};return t.forEach(function(t,r){n[t]=e.toValue(r)}),n},t.prototype.fromFields=function(t){var e=this,n=t,r=je.EMPTY;return m(n,function(t,n){r=r.set(new ve([t]),e.fromValue(n))}),r},t.prototype.toMapValue=function(t){return{fields:this.toFields(t)}},t.prototype.toArrayValue=function(t){var e=this,n=[];return t.forEach(function(t){n.push(e.toValue(t))}),{values:n}},t.prototype.fromFound=function(t){c(!!t.found,"Tried to deserialize a found document from a missing document."),ot(t.found.name,"doc.found.name"),ot(t.found.updateTime,"doc.found.updateTime");var e=this.fromName(t.found.name),n=this.fromVersion(t.found.updateTime),r=this.fromFields(t.found.fields||{});return new _e(e,n,r,{hasLocalMutations:!1})},t.prototype.fromMissing=function(t){c(!!t.missing,"Tried to deserialize a missing document from a found document."),c(!!t.readTime,"Tried to deserialize a missing document without a read time.");var e=this.fromName(t.missing),n=this.fromVersion(t.readTime);return new be(e,n)},t.prototype.fromMaybeDocument=function(t){var e=t.result;return st(t,e,"found")?this.fromFound(t):st(t,e,"missing")?this.fromMissing(t):u("invalid batch get response: "+JSON.stringify(t))},t.prototype.toWatchTargetChangeState=function(t){switch(t){case Cn.Added:return"ADD";case Cn.Current:return"CURRENT";case Cn.NoChange:return"NO_CHANGE";case Cn.Removed:return"REMOVE";case Cn.Reset:return"RESET";default:return u("Unknown WatchTargetChangeState: "+t)}},t.prototype.toTestWatchChange=function(t){if(t instanceof Pn)return{filter:{count:t.existenceFilter.count,targetId:t.targetId}};if(t instanceof Rn){if(t.newDoc instanceof _e){var e=t.newDoc;return{documentChange:{document:{name:this.toName(e.key),fields:this.toFields(e.data),updateTime:this.toVersion(e.version)},targetIds:t.updatedTargetIds,removedTargetIds:t.removedTargetIds}}}if(t.newDoc instanceof be){var e=t.newDoc;return{documentDelete:{document:this.toName(e.key),readTime:this.toVersion(e.version),removedTargetIds:t.removedTargetIds}}}if(null===t.newDoc)return{documentRemove:{document:this.toName(t.key),removedTargetIds:t.removedTargetIds}}}if(t instanceof Nn){var n=void 0;return t.cause&&(n={code:Z(t.cause.code),message:t.cause.message}),{targetChange:{targetChangeType:this.toWatchTargetChangeState(t.state),targetIds:t.targetIds,resumeToken:this.unsafeCastProtoByteString(t.resumeToken),cause:n}}}return u("Unrecognized watch change: "+JSON.stringify(t))},t.prototype.fromWatchChange=function(t){var e,n=t.response_type;if(st(t,n,"targetChange")){ot(t.targetChange,"targetChange");var r=this.fromWatchTargetChangeState(t.targetChange.targetChangeType||"NO_CHANGE"),i=t.targetChange.targetIds||[],o=t.targetChange.resumeToken||this.emptyByteString(),a=t.targetChange.cause,s=a&&this.fromRpcStatus(a);e=new Nn(r,i,o,s||null)}else if(st(t,n,"documentChange")){ot(t.documentChange,"documentChange"),ot(t.documentChange.document,"documentChange.name"),ot(t.documentChange.document.name,"documentChange.document.name"),ot(t.documentChange.document.updateTime,"documentChange.document.updateTime");var c=t.documentChange,l=this.fromName(c.document.name),h=this.fromVersion(c.document.updateTime),f=this.fromFields(c.document.fields||{}),d=new _e(l,h,f,{hasLocalMutations:!1}),p=c.targetIds||[],m=c.removedTargetIds||[];e=new Rn(p,m,d.key,d)}else if(st(t,n,"documentDelete")){ot(t.documentDelete,"documentDelete"),ot(t.documentDelete.document,"documentDelete.document");var g=t.documentDelete,l=this.fromName(g.document),h=g.readTime?this.fromVersion(g.readTime):rn.forDeletedDoc(),d=new be(l,h),m=g.removedTargetIds||[];e=new Rn([],m,d.key,d)}else if(st(t,n,"documentRemove")){ot(t.documentRemove,"documentRemove"),ot(t.documentRemove.document,"documentRemove");var v=t.documentRemove,l=this.fromName(v.document),m=v.removedTargetIds||[];e=new Rn([],m,l,null)}else{if(!st(t,n,"filter"))return u("Unknown change type "+JSON.stringify(t));ot(t.filter,"filter"),ot(t.filter.targetId,"filter.targetId");var y=t.filter,_=y.count||0,b=new yn(_),w=y.targetId;e=new Pn(w,b)}return e},t.prototype.fromWatchTargetChangeState=function(t){return"NO_CHANGE"===t?Cn.NoChange:"ADD"===t?Cn.Added:"REMOVE"===t?Cn.Removed:"CURRENT"===t?Cn.Current:"RESET"===t?Cn.Reset:u("Got unexpected TargetChange.state: "+t)},t.prototype.versionFromListenResponse=function(t){if(!st(t,t.response_type,"targetChange"))return rn.MIN;var e=t.targetChange;return e.targetIds&&e.targetIds.length?rn.MIN:e.readTime?this.fromVersion(e.readTime):rn.MIN},t.prototype.toMutation=function(t){var e,n=this;if(t instanceof pn)e={update:this.toMutationDocument(t.key,t.value)};else if(t instanceof vn)e={delete:this.toName(t.key)};else if(t instanceof mn)e={update:this.toMutationDocument(t.key,t.data),updateMask:this.toDocumentMask(t.fieldMask)};else{if(!(t instanceof gn))return u("Unknown mutation type "+t.type);e={transform:{document:this.toName(t.key),fieldTransforms:t.fieldTransforms.map(function(t){return n.toFieldTransform(t)})}}}return t.precondition.isNone||(e.currentDocument=this.toPrecondition(t.precondition)),e},t.prototype.fromMutation=function(t){var e=this,n=t.currentDocument?this.fromPrecondition(t.currentDocument):fn.NONE;if(t.update){ot(t.update.name,"name");var r=this.fromName(t.update.name),i=this.fromFields(t.update.fields||{});if(t.updateMask){var o=this.fromDocumentMask(t.updateMask);return new mn(r,i,o,n)}return new pn(r,i,n)}if(t.delete){var r=this.fromName(t.delete);return new vn(r,n)}if(t.transform){var r=this.fromName(t.transform.document),a=t.transform.fieldTransforms.map(function(t){return e.fromFieldTransform(t)});return c(!0===n.exists,'Transforms only support precondition "exists == true"'),new gn(r,a)}return u("unknown mutation proto: "+JSON.stringify(t))},t.prototype.toPrecondition=function(t){return c(!t.isNone,"Can't serialize an empty precondition"),void 0!==t.updateTime?{updateTime:this.toVersion(t.updateTime)}:void 0!==t.exists?{exists:t.exists}:u("Unknown precondition")},t.prototype.fromPrecondition=function(t){return void 0!==t.updateTime?fn.updateTime(this.fromVersion(t.updateTime)):void 0!==t.exists?fn.exists(t.exists):fn.NONE},t.prototype.fromWriteResult=function(t){var e=this,n=t.updateTime?this.fromVersion(t.updateTime):null,r=null;return t.transformResults&&t.transformResults.length>0&&(r=t.transformResults.map(function(t){return e.fromValue(t)})),new ln(n,r)},t.prototype.fromWriteResults=function(t){var e=this;return(t||[]).map(function(t){return e.fromWriteResult(t)})},t.prototype.toFieldTransform=function(t){return c(t.transform instanceof un,"Unknown transform: "+t.transform),{fieldPath:t.field.canonicalString(),setToServerValue:"REQUEST_TIME"}},t.prototype.fromFieldTransform=function(t){c("REQUEST_TIME"===t.setToServerValue,"Unknown transform proto: "+JSON.stringify(t));var e=ve.fromServerFormat(t.fieldPath);return new cn(e,un.instance)},t.prototype.toDocumentsTarget=function(t){return{documents:[this.toQueryPath(t.path)]}},t.prototype.fromDocumentsTarget=function(t){var e=t.documents.length;c(1===e,"DocumentsTarget contained other than 1 document: "+e);var n=t.documents[0];return Ye.atPath(this.fromQueryPath(n))},t.prototype.toQueryTarget=function(t){var e={structuredQuery:{}};if(t.path.isEmpty())e.parent=this.toQueryPath(me.EMPTY_PATH);else{var n=t.path;c(n.length%2!==0,"Document queries with filters are not supported."),e.parent=this.toQueryPath(n.popLast()),e.structuredQuery.from=[{collectionId:n.lastSegment()}]}var r=this.toFilter(t.filters);r&&(e.structuredQuery.where=r);var i=this.toOrder(t.orderBy);i&&(e.structuredQuery.orderBy=i);var o=this.toInt32Value(t.limit);return void 0!==o&&(e.structuredQuery.limit=o),t.startAt&&(e.structuredQuery.startAt=this.toCursor(t.startAt)),t.endAt&&(e.structuredQuery.endAt=this.toCursor(t.endAt)),e},t.prototype.fromQueryTarget=function(t){var e=this.fromQueryPath(t.parent),n=t.structuredQuery,r=n.from?n.from.length:0;if(r>0){c(1===r,"StructuredQuery.from with more than one collection is not supported.");var i=n.from[0];e=e.child(i.collectionId)}var o=[];n.where&&(o=this.fromFilter(n.where));var a=[];n.orderBy&&(a=this.fromOrder(n.orderBy));var s=null;n.limit&&(s=this.fromInt32Value(n.limit));var u=null;n.startAt&&(u=this.fromCursor(n.startAt));var l=null;return n.endAt&&(l=this.fromCursor(n.endAt)),new Ye(e,a,o,s,u,l)},t.prototype.toListenRequestLabels=function(t){var e=this.toLabel(t.purpose);return null==e?null:{"goog-listen-tags":e}},t.prototype.toLabel=function(t){switch(t){case Me.Listen:return null;case Me.ExistenceFilterMismatch:return"existence-filter-mismatch";case Me.LimboResolution:return"limbo-document";default:return u("Unrecognized query purpose: "+t)}},t.prototype.toTarget=function(t){var e,n=t.query;return e=n.isDocumentQuery()?{documents:this.toDocumentsTarget(n)}:{query:this.toQueryTarget(n)},e.targetId=t.targetId,t.resumeToken.length>0&&(e.resumeToken=this.unsafeCastProtoByteString(t.resumeToken)),e},t.prototype.toFilter=function(t){var e=this;if(0!==t.length){var n=t.map(function(t){return t instanceof Qe?e.toRelationFilter(t):e.toUnaryFilter(t)});return 1===n.length?n[0]:{compositeFilter:{op:"AND",filters:n}}}},t.prototype.fromFilter=function(t){var e=this;return t?void 0!==t.unaryFilter?[this.fromUnaryFilter(t)]:void 0!==t.fieldFilter?[this.fromRelationFilter(t)]:void 0!==t.compositeFilter?t.compositeFilter.filters.map(function(t){return e.fromFilter(t)}).reduce(function(t,e){return t.concat(e)}):u("Unknown filter: "+JSON.stringify(t)):[]},t.prototype.toOrder=function(t){var e=this;if(0!==t.length)return t.map(function(t){return e.toPropertyOrder(t)})},t.prototype.fromOrder=function(t){var e=this;return t.map(function(t){return e.fromPropertyOrder(t)})},t.prototype.toCursor=function(t){var e=this;return{before:t.before,values:t.position.map(function(t){return e.toValue(t)})}},t.prototype.fromCursor=function(t){var e=this,n=!!t.before,r=t.values.map(function(t){return e.fromValue(t)});return new $e(r,n)},t.prototype.toDirection=function(t){return On[t.name]},t.prototype.fromDirection=function(t){switch(t){case"ASCENDING":return Ze.ASCENDING;case"DESCENDING":return Ze.DESCENDING;default:return}},t.prototype.toOperatorName=function(t){return kn[t.name]},t.prototype.fromOperatorName=function(t){switch(t){case"EQUAL":return Ke.EQUAL;case"GREATER_THAN":return Ke.GREATER_THAN;case"GREATER_THAN_OR_EQUAL":return Ke.GREATER_THAN_OR_EQUAL;case"LESS_THAN":return Ke.LESS_THAN;case"LESS_THAN_OR_EQUAL":return Ke.LESS_THAN_OR_EQUAL;case"OPERATOR_UNSPECIFIED":return u("Unspecified relation");default:return u("Unknown relation")}},t.prototype.toFieldPathReference=function(t){return{fieldPath:t.canonicalString()}},t.prototype.fromFieldPathReference=function(t){return ve.fromServerFormat(t.fieldPath)},t.prototype.toPropertyOrder=function(t){return{field:this.toFieldPathReference(t.field),direction:this.toDirection(t.dir)}},t.prototype.fromPropertyOrder=function(t){return new tn(this.fromFieldPathReference(t.field),this.fromDirection(t.direction))},t.prototype.toRelationFilter=function(t){return t instanceof Qe?{fieldFilter:{field:this.toFieldPathReference(t.field),op:this.toOperatorName(t.op),value:this.toValue(t.value)}}:u("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromRelationFilter=function(t){return new Qe(this.fromFieldPathReference(t.fieldFilter.field),this.fromOperatorName(t.fieldFilter.op),this.fromValue(t.fieldFilter.value))},t.prototype.toUnaryFilter=function(t){return t instanceof Je?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NAN"}}:t instanceof Xe?{unaryFilter:{field:this.toFieldPathReference(t.field),op:"IS_NULL"}}:u("Unrecognized filter: "+JSON.stringify(t))},t.prototype.fromUnaryFilter=function(t){switch(t.unaryFilter.op){case"IS_NAN":var e=this.fromFieldPathReference(t.unaryFilter.field);return new Je(e);case"IS_NULL":var n=this.fromFieldPathReference(t.unaryFilter.field);return new Xe(n);case"OPERATOR_UNSPECIFIED":return u("Unspecified filter");default:return u("Unknown filter")}},t.prototype.toDocumentMask=function(t){return{fieldPaths:t.fields.map(function(t){return t.canonicalString()})}},t.prototype.fromDocumentMask=function(t){var e=t.fieldPaths||[],n=e.map(function(t){return ve.fromServerFormat(t)});return new sn(n)},t}(),Fn=function(){function t(t){this.sendFn=t.sendFn,this.closeFn=t.closeFn}return t.prototype.onOpen=function(t){c(!this.wrappedOnOpen,"Called onOpen on stream twice!"),this.wrappedOnOpen=t},t.prototype.onClose=function(t){c(!this.wrappedOnClose,"Called onClose on stream twice!"),this.wrappedOnClose=t},t.prototype.onMessage=function(t){c(!this.wrappedOnMessage,"Called onMessage on stream twice!"),this.wrappedOnMessage=t},t.prototype.close=function(){this.closeFn()},t.prototype.send=function(t){this.sendFn(t)},t.prototype.callOnOpen=function(){c(void 0!==this.wrappedOnOpen,"Cannot call onOpen because no callback was set"),this.wrappedOnOpen()},t.prototype.callOnClose=function(t){c(void 0!==this.wrappedOnClose,"Cannot call onClose because no callback was set"),this.wrappedOnClose(t)},t.prototype.callOnMessage=function(t){c(void 0!==this.wrappedOnMessage,"Cannot call onMessage because no callback was set"),this.wrappedOnMessage(t)},t}(),Bn="Connection",Vn={BatchGetDocuments:"batchGet",Commit:"commit"},jn="gl-js/ fire/"+ee,Hn=function(){function t(t){this.databaseId=t.databaseId,this.pool=new te.XhrIoPool;var e=t.ssl?"https":"http";this.baseUrl=e+"://"+t.host}return t.prototype.modifyHeadersForRequest=function(t,e){if(e)for(var n in e.authHeaders)e.authHeaders.hasOwnProperty(n)&&(t[n]=e.authHeaders[n]);t["X-Goog-Api-Client"]=jn},t.prototype.invokeRPC=function(t,e,n){var r=this,i=this.makeUrl(t);return new Promise(function(a,s){r.pool.getObject(function(c){c.listenOnce(te.EventType.COMPLETE,function(){try{switch(c.getLastErrorCode()){case te.ErrorCode.NO_ERROR:var e=c.getResponseJson();o(Bn,"XHR received:",JSON.stringify(e)),a(e);break;case te.ErrorCode.TIMEOUT:o(Bn,'RPC "'+t+'" timed out'),s(new oe(ie.DEADLINE_EXCEEDED,"Request time out"));break;case te.ErrorCode.HTTP_ERROR:var n=c.getStatus();o(Bn,'RPC "'+t+'" failed with status:',n,"response text:",c.getResponseText()),n>0?s(new oe($(n),"Server responded with status "+c.getStatusText())):(o(Bn,'RPC "'+t+'" failed'),s(new oe(ie.UNAVAILABLE,"Connection failed.")));break;default:u('RPC "'+t+'" failed with unanticipated webchannel error '+c.getLastErrorCode()+": "+c.getLastError()+", giving up.")}}finally{o(Bn,'RPC "'+t+'" completed.'),r.pool.releaseObject(c)}});var l=JSON.stringify(e);o(Bn,"XHR sending: ",i+" "+l);var h={"Content-Type":"text/plain"};r.modifyHeadersForRequest(h,n),c.send(i,"POST",l,h,15)})})},t.prototype.invokeStreamingRPC=function(t,e,n){return this.invokeRPC(t,e,n)},t.prototype.openStream=function(t,e){var n=[this.baseUrl,"/","google.firestore.v1beta1.Firestore","/",t,"/channel"],r=te.createWebChannelTransport(),i={backgroundChannelTest:!0,httpSessionIdParam:"gsessionid",initMessageHeaders:{},httpHeadersOverwriteParam:"$httpHeaders",messageUrlParams:{database:"projects/"+this.databaseId.projectId+"/databases/"+this.databaseId.database},sendRawJson:!0,supportsCrossDomainXhr:!0};this.modifyHeadersForRequest(i.initMessageHeaders,e);var a=n.join("");o(Bn,"Creating WebChannel: "+a+" "+i);var s=r.createWebChannel(a,i),u=!1,l=!1,h=new Fn({sendFn:function(t){l?o(Bn,"Not sending because WebChannel is closed:",t):(u||(o(Bn,"Opening WebChannel transport."),s.open(),u=!0),o(Bn,"WebChannel sending:",t),s.send(t))},closeFn:function(){return s.close()}}),f=function(t,e){s.listen(t,function(t){try{e(t)}catch(t){setTimeout(function(){throw t},0)}})};return f(te.WebChannel.EventType.OPEN,function(){l||o(Bn,"WebChannel transport opened.")}),f(te.WebChannel.EventType.CLOSE,function(){l||(l=!0,o(Bn,"WebChannel transport closed"),h.callOnClose())}),f(te.WebChannel.EventType.ERROR,function(t){l||(l=!0,o(Bn,"WebChannel transport errored:",t),h.callOnClose(new oe(ie.UNAVAILABLE,"The operation could not be completed")))}),f(te.WebChannel.EventType.MESSAGE,function(t){if(!l){var e=t.data[0];c(!!e,"Got a webchannel message without data.");var n=e.error||e[0]&&e[0].error;if(n){o(Bn,"WebChannel received error:",n);var r=n.status,i=X(r),a=n.message;void 0===i&&(i=ie.INTERNAL,a="Unknown error status: "+r+" with message "+n.message),l=!0,h.callOnClose(new oe(i,a)),s.close()}else o(Bn,"WebChannel received:",e),h.callOnMessage(e)}}),setTimeout(function(){h.callOnOpen()},0),h},t.prototype.makeUrl=function(t){var e=Vn[t];c(void 0!==e,"Unknown REST mapping for: "+t);var n=[this.baseUrl,"/","v1beta1"];return n.push("/projects/"),n.push(this.databaseId.projectId),n.push("/databases/"),n.push(this.databaseId.database),n.push("/documents"),n.push(":"),n.push(e),n.join("")},t}(),Gn=function(){function t(){this.emptyByteString="",this.base64Available="undefined"!==typeof atob}return t.prototype.loadConnection=function(t){return Promise.resolve(new Hn(t))},t.prototype.newSerializer=function(t){return new Un(t,{useProto3Json:!0})},t.prototype.formatJSON=function(t){return JSON.stringify(t)},t.prototype.atob=function(t){return atob(t)},t.prototype.btoa=function(t){return btoa(t)},t}();re.setPlatform(new Gn);var zn,Wn=function(){function t(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];w("FieldPath",t,"fieldNames",1);for(var n=0;n<t.length;++n)if(E("FieldPath","string",n,t[n]),0===t[n].length)throw new oe(ie.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new ve(t)}return t.documentId=function(){return t._DOCUMENT_ID},t.prototype.isEqual=function(e){if(!(e instanceof t))throw O("isEqual","FieldPath",1,e);return this._internalPath.isEqual(e._internalPath)},t._DOCUMENT_ID=new t(ve.keyField().canonicalString()),t}(),qn=new RegExp("[~\\*/\\[\\]]");!function(t){t[t.Unknown=0]="Unknown",t[t.Online=1]="Online",t[t.Offline=2]="Offline"}(zn||(zn={}));var Yn;!function(t){t[t.Added=0]="Added",t[t.Removed=1]="Removed",t[t.Modified=2]="Modified",t[t.Metadata=3]="Metadata"}(Yn||(Yn={}));var Kn;!function(t){t[t.Local=0]="Local",t[t.Synced=1]="Synced"}(Kn||(Kn={}));var Qn,Xn=function(){function t(){this.changeMap=new we(ye.comparator)}return t.prototype.track=function(t){var e=t.doc.key,n=this.changeMap.get(e);if(!n)return void(this.changeMap=this.changeMap.insert(e,t));t.type!==Yn.Added&&n.type===Yn.Metadata?this.changeMap=this.changeMap.insert(e,t):t.type===Yn.Metadata&&n.type!==Yn.Removed?this.changeMap=this.changeMap.insert(e,{type:n.type,doc:t.doc}):t.type===Yn.Modified&&n.type===Yn.Modified?this.changeMap=this.changeMap.insert(e,{type:Yn.Modified,doc:t.doc}):t.type===Yn.Modified&&n.type===Yn.Added?this.changeMap=this.changeMap.insert(e,{type:Yn.Added,doc:t.doc}):t.type===Yn.Removed&&n.type===Yn.Added?this.changeMap=this.changeMap.remove(e):t.type===Yn.Removed&&n.type===Yn.Modified?this.changeMap=this.changeMap.insert(e,{type:Yn.Removed,doc:n.doc}):t.type===Yn.Added&&n.type===Yn.Removed?this.changeMap=this.changeMap.insert(e,{type:Yn.Modified,doc:t.doc}):u("unsupported combination of changes: "+JSON.stringify(t)+" after "+JSON.stringify(n))},t.prototype.getChanges=function(){var t=[];return this.changeMap.inorderTraversal(function(e,n){t.push(n)}),t},t}(),Jn=function(){function t(t,e,n,r,i,o,a){this.query=t,this.docs=e,this.oldDocs=n,this.docChanges=r,this.fromCache=i,this.hasPendingWrites=o,this.syncStateChanged=a}return t.prototype.isEqual=function(t){if(this.fromCache!==t.fromCache||this.hasPendingWrites!==t.hasPendingWrites||this.syncStateChanged!==t.syncStateChanged||!this.query.isEqual(t.query)||!this.docs.isEqual(t.docs)||!this.oldDocs.isEqual(t.oldDocs))return!1;var e=this.docChanges,n=t.docChanges;if(e.length!==n.length)return!1;for(var r=0;r<e.length;r++)if(e[r].type!==n[r].type||!e[r].doc.isEqual(n[r].doc))return!1;return!0},t}(),Zn=function(){function t(t){this.comparator=t?function(e,n){return t(e,n)||ye.comparator(e.key,n.key)}:function(t,e){return ye.comparator(t.key,e.key)},this.keyedMap=et(),this.sortedSet=new we(this.comparator)}return t.emptySet=function(e){return new t(e.comparator)},t.prototype.has=function(t){return null!=this.keyedMap.get(t)},t.prototype.get=function(t){return this.keyedMap.get(t)},t.prototype.first=function(){return this.sortedSet.minKey()},t.prototype.last=function(){return this.sortedSet.maxKey()},t.prototype.isEmpty=function(){return this.sortedSet.isEmpty()},t.prototype.indexOf=function(t){var e=this.keyedMap.get(t);return e?this.sortedSet.indexOf(e):-1},Object.defineProperty(t.prototype,"size",{get:function(){return this.sortedSet.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t){this.sortedSet.inorderTraversal(function(e,n){return t(e),!1})},t.prototype.add=function(t){var e=this.delete(t.key);return e.copy(e.keyedMap.insert(t.key,t),e.sortedSet.insert(t,null))},t.prototype.delete=function(t){var e=this.get(t);return e?this.copy(this.keyedMap.remove(t),this.sortedSet.remove(e)):this},t.prototype.isEqual=function(e){if(!(e instanceof t))return!1;if(this.size!==e.size)return!1;for(var n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();n.hasNext();){var i=n.getNext().key,o=r.getNext().key;if(!i.isEqual(o))return!1}return!0},t.prototype.toString=function(){var t=[];return this.forEach(function(e){t.push(e.toString())}),0===t.length?"DocumentSet ()":"DocumentSet (\n  "+t.join("  \n")+"\n)"},t.prototype.copy=function(e,n){var r=new t;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r},t}(),$n=function(){function t(t){this.mapKeyFn=t,this.inner={}}return t.prototype.get=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0!==n)for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];if(a.isEqual(t))return s}},t.prototype.has=function(t){return void 0!==this.get(t)},t.prototype.set=function(t,e){var n=this.mapKeyFn(t),r=this.inner[n];if(void 0===r)return void(this.inner[n]=[[t,e]]);for(var i=0;i<r.length;i++)if(r[i][0].isEqual(t))return void(r[i]=[t,e]);r.push([t,e])},t.prototype.delete=function(t){var e=this.mapKeyFn(t),n=this.inner[e];if(void 0===n)return!1;for(var r=0;r<n.length;r++)if(n[r][0].isEqual(t))return 1===n.length?delete this.inner[e]:n.splice(r,1),!0;return!1},t.prototype.forEach=function(t){m(this.inner,function(e,n){for(var r=0,i=n;r<i.length;r++){var o=i[r],a=o[0],s=o[1];t(a,s)}})},t.prototype.isEmpty=function(){return g(this.inner)},t}(),tr=function(){function t(){this.listeners=[]}return t}(),er=function(){function t(t){this.syncEngine=t,this.queries=new $n(function(t){return t.canonicalId()}),this.onlineState=zn.Unknown,this.syncEngine.subscribe(this.onChange.bind(this),this.onError.bind(this))}return t.prototype.listen=function(t){var e=t.query,n=!1,r=this.queries.get(e);return r||(n=!0,r=new tr,this.queries.set(e,r)),r.listeners.push(t),t.applyOnlineStateChange(this.onlineState),r.viewSnap&&t.onViewSnapshot(r.viewSnap),n?this.syncEngine.listen(e).then(function(t){return r.targetId=t,t}):Promise.resolve(r.targetId)},t.prototype.unlisten=function(t){return $t.__awaiter(this,void 0,void 0,function(){var e,n,r,i;return $t.__generator(this,function(o){return e=t.query,n=!1,r=this.queries.get(e),r&&(i=r.listeners.indexOf(t))>=0&&(r.listeners.splice(i,1),n=0===r.listeners.length),n?(this.queries.delete(e),[2,this.syncEngine.unlisten(e)]):[2]})})},t.prototype.onChange=function(t){for(var e=0,n=t;e<n.length;e++){var r=n[e],i=r.query,o=this.queries.get(i);if(o){for(var a=0,s=o.listeners;a<s.length;a++){s[a].onViewSnapshot(r)}o.viewSnap=r}}},t.prototype.onError=function(t,e){var n=this.queries.get(t);if(n)for(var r=0,i=n.listeners;r<i.length;r++){var o=i[r];o.onError(e)}this.queries.delete(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t,this.queries.forEach(function(e,n){for(var r=0,i=n.listeners;r<i.length;r++){i[r].applyOnlineStateChange(t)}})},t}(),nr=function(){function t(t,e,n){this.query=t,this.queryObserver=e,this.raisedInitialEvent=!1,this.onlineState=zn.Unknown,this.options=n||{}}return t.prototype.onViewSnapshot=function(t){if(c(t.docChanges.length>0||t.syncStateChanged,"We got a new snapshot with no changes?"),!this.options.includeDocumentMetadataChanges){for(var e=[],n=0,r=t.docChanges;n<r.length;n++){var i=r[n];i.type!==Yn.Metadata&&e.push(i)}t=new Jn(t.query,t.docs,t.oldDocs,e,t.fromCache,t.hasPendingWrites,t.syncStateChanged)}this.raisedInitialEvent?this.shouldRaiseEvent(t)&&this.queryObserver.next(t):this.shouldRaiseInitialEvent(t,this.onlineState)&&this.raiseInitialEvent(t),this.snap=t},t.prototype.onError=function(t){this.queryObserver.error(t)},t.prototype.applyOnlineStateChange=function(t){this.onlineState=t,this.snap&&!this.raisedInitialEvent&&this.shouldRaiseInitialEvent(this.snap,t)&&this.raiseInitialEvent(this.snap)},t.prototype.shouldRaiseInitialEvent=function(t,e){if(c(!this.raisedInitialEvent,"Determining whether to raise first event but already had first event"),!t.fromCache)return!0;var n=e!==zn.Offline;return this.options.waitForSyncWhenOnline&&n?(c(t.fromCache,"Waiting for sync, but snapshot is not from cache"),!1):!t.docs.isEmpty()||e===zn.Offline},t.prototype.shouldRaiseEvent=function(t){if(t.docChanges.length>0)return!0;var e=this.snap&&this.snap.hasPendingWrites!==t.hasPendingWrites;return!(!t.syncStateChanged&&!e)&&!0===this.options.includeQueryMetadataChanges},t.prototype.raiseInitialEvent=function(e){c(!this.raisedInitialEvent,"Trying to raise initial events for second time"),e=new Jn(e.query,e.docs,Zn.emptySet(e.docs),t.getInitialViewChanges(e),e.fromCache,e.hasPendingWrites,!0),this.raisedInitialEvent=!0,this.queryObserver.next(e)},t.getInitialViewChanges=function(t){var e=[];return t.docs.forEach(function(t){e.push({type:Yn.Added,doc:t})}),e},t}(),rr=function(){function t(t){var e=this;this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,t(function(t){e.isDone=!0,e.result=t,e.nextCallback&&e.nextCallback(t)},function(t){e.isDone=!0,e.error=t,e.catchCallback&&e.catchCallback(t)})}return t.prototype.catch=function(t){return this.next(void 0,t)},t.prototype.next=function(e,n){var r=this;return this.callbackAttached&&u("Called next() or catch() twice for PersistencePromise"),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new t(function(t,i){r.nextCallback=function(n){r.wrapSuccess(e,n).next(t,i)},r.catchCallback=function(e){r.wrapFailure(n,e).next(t,i)}})},t.prototype.toPromise=function(){var t=this;return new Promise(function(e,n){t.next(e,n)})},t.prototype.wrapUserFunction=function(e){try{var n=e();return n instanceof t?n:t.resolve(n)}catch(e){return t.reject(e)}},t.prototype.wrapSuccess=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.resolve(n)},t.prototype.wrapFailure=function(e,n){return e?this.wrapUserFunction(function(){return e(n)}):t.reject(n)},t.resolve=function(e){return new t(function(t,n){t(e)})},t.reject=function(e){return new t(function(t,n){n(e)})},t.waitFor=function(e){return e.reduce(function(t,e,n){return t.next(function(){return e})},t.resolve())},t.map=function(e){var n=[],r=!0,i=t.resolve(null);return e.reduce(function(t,e){return t.next(function(t){return r||n.push(t),r=!1,e})},i).next(function(t){return n.push(t),n})},t}(),ir=function(){function t(){this.isEager=!0,this.sources=[],this.potentialGarbage=rt()}return t.prototype.addGarbageSource=function(t){this.sources.push(t),t.setGarbageCollector(this)},t.prototype.removeGarbageSource=function(t){this.sources.splice(this.sources.indexOf(t),1),t.setGarbageCollector(null)},t.prototype.addPotentialGarbageKey=function(t){this.potentialGarbage=this.potentialGarbage.add(t)},t.prototype.collectGarbage=function(t){var e=this,n=[],r=rt();return this.potentialGarbage.forEach(function(i){var o=e.documentHasAnyReferences(t,i);n.push(o.next(function(t){return t||(r=r.add(i)),rr.resolve()}))}),this.potentialGarbage=rt(),rr.waitFor(n).next(function(){return r})},t.prototype.documentHasAnyReferences=function(t,e){var n=rr.resolve(!1);return this.sources.map(function(n){return function(){return n.containsKey(t,e)}}).reduce(function(t,e){return t.next(function(t){return t?rr.resolve(!0):e()})},n)},t}(),or=function(){function t(t,e,n){this.query=t,this.addedKeys=e,this.removedKeys=n}return t.fromSnapshot=function(e){for(var n=rt(),r=rt(),i=0,o=e.docChanges;i<o.length;i++){var a=o[i];switch(a.type){case Yn.Added:n=n.add(a.doc.key);break;case Yn.Removed:r=r.add(a.doc.key)}}return new t(e.query,n,r)},t}(),ar=function(){function t(){this.refsByKey=new bn(sr.compareByKey),this.refsByTarget=new bn(sr.compareByTargetId),this.garbageCollector=null}return t.prototype.isEmpty=function(){return this.refsByKey.isEmpty()},t.prototype.addReference=function(t,e){var n=new sr(t,e);this.refsByKey=this.refsByKey.add(n),this.refsByTarget=this.refsByTarget.add(n)},t.prototype.addReferences=function(t,e){var n=this;t.forEach(function(t){return n.addReference(t,e)})},t.prototype.removeReference=function(t,e){this.removeRef(new sr(t,e))},t.prototype.removeReferences=function(t,e){var n=this;t.forEach(function(t){return n.removeReference(t,e)})},t.prototype.removeReferencesForId=function(t){var e=this,n=ye.EMPTY,r=new sr(n,t),i=new sr(n,t+1);this.refsByTarget.forEachInRange([r,i],function(t){e.removeRef(t)})},t.prototype.removeAllReferences=function(){var t=this;this.refsByKey.forEach(function(e){return t.removeRef(e)})},t.prototype.removeRef=function(t){this.refsByKey=this.refsByKey.delete(t),this.refsByTarget=this.refsByTarget.delete(t),null!==this.garbageCollector&&this.garbageCollector.addPotentialGarbageKey(t.key)},t.prototype.referencesForId=function(t){var e=ye.EMPTY,n=new sr(e,t),r=new sr(e,t+1),i=rt();return this.refsByTarget.forEachInRange([n,r],function(t){i=i.add(t.key)}),i},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=new sr(e,0),r=this.refsByKey.firstAfterOrEqual(n);return rr.resolve(null!==r&&e.isEqual(r.key))},t}(),sr=function(){function t(t,e){this.key=t,this.targetOrBatchId=e}return t.compareByKey=function(t,e){return ye.comparator(t.key,e.key)||U(t.targetOrBatchId,e.targetOrBatchId)},t.compareByTargetId=function(t,e){return U(t.targetOrBatchId,e.targetOrBatchId)||ye.comparator(t.key,e.key)},t}(),ur=1;!function(t){t[t.LocalStore=0]="LocalStore",t[t.SyncEngine=1]="SyncEngine"}(Qn||(Qn={}));var cr,lr=function(){function t(t,e){void 0===e&&(e=0),this.generatorId=t;var n=e>>ur<<ur,r=e-n;this.previousId=r>=t?n|this.generatorId:(n|this.generatorId)-(1<<ur)}return t.prototype.next=function(){return this.previousId+=1<<ur,this.previousId},t.forLocalStore=function(e){return void 0===e&&(e=0),new t(Qn.LocalStore,e)},t.forSyncEngine=function(){return new t(Qn.SyncEngine)},t}(),hr=function(){function t(t){this.key=t}return t}(),fr=function(){function t(t){this.key=t}return t}(),dr=function(){function t(t,e){this.query=t,this.syncedDocuments=e,this.syncState=null,this.current=!1,this.limboDocuments=rt(),this.mutatedKeys=rt(),this.documentSet=new Zn(t.docComparator.bind(t))}return t.prototype.computeDocChanges=function(t,e){var n=this,r=e?e.changeSet:new Xn,i=e?e.documentSet:this.documentSet,o=e?e.mutatedKeys:this.mutatedKeys,a=i,s=!1,u=this.query.hasLimit()&&i.size===this.query.limit?i.last():null;if(t.inorderTraversal(function(t,e){var l=i.get(t),h=e instanceof _e?e:null;if(h&&(c(t.isEqual(h.key),"Mismatching keys found in document changes: "+t+" != "+h.key),h=n.query.matches(h)?h:null),h?(a=a.add(h),o=h.hasLocalMutations?o.add(t):o.delete(t)):(a=a.delete(t),o=o.delete(t)),l&&h){var f=l.data.isEqual(h.data);f&&l.hasLocalMutations===h.hasLocalMutations||(f?r.track({type:Yn.Metadata,doc:h}):r.track({type:Yn.Modified,doc:h}),u&&n.query.docComparator(h,u)>0&&(s=!0))}else!l&&h?r.track({type:Yn.Added,doc:h}):l&&!h&&(r.track({type:Yn.Removed,doc:l}),u&&(s=!0))}),this.query.hasLimit())for(;a.size>this.query.limit;){var l=a.last();a=a.delete(l.key),r.track({type:Yn.Removed,doc:l})}return c(!s||!e,"View was refilled using docs that themselves needed refilling."),{documentSet:a,changeSet:r,needsRefill:s,mutatedKeys:o}},t.prototype.applyChanges=function(t,e){var n=this;c(!t.needsRefill,"Cannot apply changes that need a refill");var r=this.documentSet;this.documentSet=t.documentSet,this.mutatedKeys=t.mutatedKeys;var i=t.changeSet.getChanges();i.sort(function(t,e){return ct(t.type,e.type)||n.query.docComparator(t.doc,e.doc)}),this.applyTargetChange(e);var o=this.updateLimboDocuments(),a=0===this.limboDocuments.size&&this.current,s=a?Kn.Synced:Kn.Local,u=s!==this.syncState;if(this.syncState=s,0!==i.length||u){return{snapshot:new Jn(this.query,t.documentSet,r,i,s===Kn.Local,!t.mutatedKeys.isEmpty(),u),limboChanges:o}}return{limboChanges:o}},t.prototype.applyOnlineStateChange=function(t){return this.current&&t===zn.Offline?(this.current=!1,this.applyChanges({documentSet:this.documentSet,changeSet:new Xn,mutatedKeys:this.mutatedKeys,needsRefill:!1})):{limboChanges:[]}},t.prototype.shouldBeInLimbo=function(t){return!this.syncedDocuments.has(t)&&(!!this.documentSet.has(t)&&!this.documentSet.get(t).hasLocalMutations)},t.prototype.applyTargetChange=function(t){if(t){var e=t.mapping;switch(e instanceof An?this.syncedDocuments=e.documents:e instanceof In&&(this.syncedDocuments=e.applyToKeySet(this.syncedDocuments)),t.currentStatusUpdate){case _n.MarkCurrent:this.current=!0;break;case _n.MarkNotCurrent:this.current=!1;break;case _n.None:break;default:u("Unknown current status update: "+t.currentStatusUpdate)}}},t.prototype.updateLimboDocuments=function(){var t=this;if(!this.current)return[];var e=this.limboDocuments;this.limboDocuments=rt(),this.documentSet.forEach(function(e){t.shouldBeInLimbo(e.key)&&(t.limboDocuments=t.limboDocuments.add(e.key))});var n=[];return e.forEach(function(e){t.limboDocuments.has(e)||n.push(new fr(e))}),this.limboDocuments.forEach(function(t){e.has(t)||n.push(new hr(t))}),n},t}(),pr=function(){function t(t,e,n,r){this.query=t,this.targetId=e,this.resumeToken=n,this.view=r}return t}(),mr=function(){function t(t,e,n){this.localStore=t,this.remoteStore=e,this.currentUser=n,this.viewHandler=null,this.errorHandler=null,this.queryViewsByQuery=new $n(function(t){return t.canonicalId()}),this.queryViewsByTarget={},this.limboTargetsByKey=new we(ye.comparator),this.limboKeysByTarget={},this.limboDocumentRefs=new ar,this.limboCollector=new ir,this.mutationUserCallbacks={},this.targetIdGenerator=lr.forSyncEngine()}return t.prototype.subscribe=function(t,e){c(null!==t&&null!==e,"View and error handlers cannot be null"),c(null===this.viewHandler&&null===this.errorHandler,"SyncEngine already has a subscriber."),this.viewHandler=t,this.errorHandler=e,this.limboCollector.addGarbageSource(this.limboDocumentRefs)},t.prototype.listen=function(t){var e=this;return this.assertSubscribed("listen()"),c(!this.queryViewsByQuery.has(t),"We already listen to the query: "+t),this.localStore.allocateQuery(t).then(function(n){return e.localStore.executeQuery(t).then(function(r){return e.localStore.remoteDocumentKeys(n.targetId).then(function(i){var o=new dr(t,i),a=o.computeDocChanges(r),s=o.applyChanges(a);c(0===s.limboChanges.length,"View returned limbo docs before target ack from the server."),c(!!s.snapshot,"applyChanges for new view should always return a snapshot");var u=new pr(t,n.targetId,n.resumeToken,o);e.queryViewsByQuery.set(t,u),e.queryViewsByTarget[n.targetId]=u,e.viewHandler([s.snapshot]),e.remoteStore.listen(n)})}).then(function(){return n.targetId})})},t.prototype.unlisten=function(t){var e=this;this.assertSubscribed("unlisten()");var n=this.queryViewsByQuery.get(t);return c(!!n,"Trying to unlisten on query not found:"+t),this.localStore.releaseQuery(t).then(function(){return e.remoteStore.unlisten(n.targetId),e.removeAndCleanupQuery(n).then(function(){return e.localStore.collectGarbage()})})},t.prototype.write=function(t,e){var n=this;return this.assertSubscribed("write()"),this.localStore.localWrite(t).then(function(t){return n.addMutationCallback(t.batchId,e),n.emitNewSnapsAndNotifyLocalStore(t.changes)}).then(function(){return n.remoteStore.fillWritePipeline()})},t.prototype.wrapUpdateFunctionError=function(t){return t},t.prototype.runTransaction=function(t,e){var n=this;void 0===e&&(e=5),c(e>=0,"Got negative number of retries for transaction.");var r=this.remoteStore.createTransaction();return function(){try{var e=t(r);return!q(e)&&e.catch&&e.then?e.catch(function(t){return Promise.reject(n.wrapUpdateFunctionError(t))}):Promise.reject(Error("Transaction callback must return a Promise"))}catch(t){return Promise.reject(n.wrapUpdateFunctionError(t))}}().then(function(i){return r.commit().then(function(){return i}).catch(function(r){return 0===e?Promise.reject(r):n.runTransaction(t,e-1)})})},t.prototype.applyRemoteEvent=function(t){var e=this;return this.assertSubscribed("applyRemoteEvent()"),p(t.targetChanges,function(n,r){var i=e.limboKeysByTarget[n];i&&r.currentStatusUpdate===_n.MarkCurrent&&!t.documentUpdates.get(i)&&t.addDocumentUpdate(new be(i,t.snapshotVersion))}),this.localStore.applyRemoteEvent(t).then(function(n){return e.emitNewSnapsAndNotifyLocalStore(n,t)})},t.prototype.applyOnlineStateChange=function(t){var e=[];this.queryViewsByQuery.forEach(function(n,r){var i=r.view.applyOnlineStateChange(t);c(0===i.limboChanges.length,"OnlineState should not affect limbo documents."),i.snapshot&&e.push(i.snapshot)}),this.viewHandler(e)},t.prototype.rejectListen=function(t,e){var n=this;this.assertSubscribed("rejectListens()");var r=this.limboKeysByTarget[t];if(r){this.limboTargetsByKey=this.limboTargetsByKey.remove(r),delete this.limboKeysByTarget[t];var i=new we(ye.comparator);i=i.insert(r,new be(r,rn.forDeletedDoc()));var o=new Sn(rn.MIN,{},i);return this.applyRemoteEvent(o)}var a=this.queryViewsByTarget[t];return c(!!a,"Unknown targetId: "+t),this.localStore.releaseQuery(a.query).then(function(){return n.removeAndCleanupQuery(a).then(function(){n.errorHandler(a.query,e)})})},t.prototype.applySuccessfulWrite=function(t){var e=this;return this.assertSubscribed("applySuccessfulWrite()"),this.processUserCallback(t.batch.batchId,null),this.localStore.acknowledgeBatch(t).then(function(t){return e.emitNewSnapsAndNotifyLocalStore(t)})},t.prototype.rejectFailedWrite=function(t,e){var n=this;return this.assertSubscribed("rejectFailedWrite()"),this.processUserCallback(t,e),this.localStore.rejectBatch(t).then(function(t){return n.emitNewSnapsAndNotifyLocalStore(t)})},t.prototype.addMutationCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];n||(n=new we(U)),n=n.insert(t,e),this.mutationUserCallbacks[this.currentUser.toKey()]=n},t.prototype.processUserCallback=function(t,e){var n=this.mutationUserCallbacks[this.currentUser.toKey()];if(n){var r=n.get(t);r&&(c(t===n.minKey(),"Mutation callbacks processed out-of-order?"),e?r.reject(e):r.resolve(),n=n.remove(t)),this.mutationUserCallbacks[this.currentUser.toKey()]=n}},t.prototype.removeAndCleanupQuery=function(t){return this.queryViewsByQuery.delete(t.query),delete this.queryViewsByTarget[t.targetId],this.limboDocumentRefs.removeReferencesForId(t.targetId),this.gcLimboDocuments()},t.prototype.updateTrackedLimbos=function(t,e){for(var n=0,r=e;n<r.length;n++){var i=r[n];i instanceof hr?(this.limboDocumentRefs.addReference(i.key,t),this.trackLimboChange(i)):i instanceof fr?(o("SyncEngine","Document no longer in limbo: "+i.key),this.limboDocumentRefs.removeReference(i.key,t)):u("Unknown limbo change: "+JSON.stringify(i))}return this.gcLimboDocuments()},t.prototype.trackLimboChange=function(t){var e=t.key;if(!this.limboTargetsByKey.get(e)){o("SyncEngine","New document in limbo: "+e);var n=this.targetIdGenerator.next(),r=Ye.atPath(e.path);this.limboKeysByTarget[n]=e,this.remoteStore.listen(new an(r,n,Me.Listen)),this.limboTargetsByKey=this.limboTargetsByKey.insert(e,n)}},t.prototype.gcLimboDocuments=function(){var t=this;return this.limboCollector.collectGarbage(null).next(function(e){e.forEach(function(e){var n=t.limboTargetsByKey.get(e);null!==n&&(t.remoteStore.unlisten(n),t.limboTargetsByKey=t.limboTargetsByKey.remove(e),delete t.limboKeysByTarget[n])})}).toPromise()},t.prototype.currentLimboDocs=function(){return this.limboTargetsByKey},t.prototype.emitNewSnapsAndNotifyLocalStore=function(t,e){var n=this,r=[],i=[],o=[];return this.queryViewsByQuery.forEach(function(a,s){o.push(Promise.resolve().then(function(){var e=s.view.computeDocChanges(t);return e.needsRefill?n.localStore.executeQuery(s.query).then(function(t){return s.view.computeDocChanges(t,e)}):e}).then(function(t){var o=e&&e.targetChanges[s.targetId],a=s.view.applyChanges(t,o);return n.updateTrackedLimbos(s.targetId,a.limboChanges).then(function(){if(a.snapshot){r.push(a.snapshot);var t=or.fromSnapshot(a.snapshot);i.push(t)}})}))}),Promise.all(o).then(function(){return n.viewHandler(r),n.localStore.notifyLocalViewChanges(i)}).then(function(){return n.localStore.collectGarbage()})},t.prototype.assertSubscribed=function(t){c(null!==this.viewHandler&&null!==this.errorHandler,"Trying to call "+t+" before calling subscribe().")},t.prototype.handleUserChange=function(t){var e=this;return this.currentUser=t,this.localStore.handleUserChange(t).then(function(t){return e.emitNewSnapsAndNotifyLocalStore(t)}).then(function(){return e.remoteStore.handleUserChange(t)})},t}(),gr=-1,vr=function(){function t(t,e,n){this.batchId=t,this.localWriteTime=e,this.mutations=n}return t.prototype.applyToRemoteDocument=function(t,e,n){e&&c(e.key.isEqual(t),"applyToRemoteDocument: key "+t+" should match maybeDoc key\n        "+e.key);var r=n.mutationResults;c(r.length===this.mutations.length,"Mismatch between mutations length\n      ("+this.mutations.length+") and mutation results length\n      ("+r.length+").");for(var i=0;i<this.mutations.length;i++){var o=this.mutations[i];if(o.key.isEqual(t)){var a=r[i];e=o.applyToRemoteDocument(e,a)}}return e},t.prototype.applyToLocalView=function(t,e){e&&c(e.key.isEqual(t),"applyToLocalDocument: key "+t+" should match maybeDoc key\n        "+e.key);for(var n=e,r=0;r<this.mutations.length;r++){var i=this.mutations[r];i.key.isEqual(t)&&(e=i.applyToLocalView(e,n,this.localWriteTime))}return e},t.prototype.keys=function(){for(var t=rt(),e=0,n=this.mutations;e<n.length;e++){var r=n[e];t=t.add(r.key)}return t},t.prototype.isEqual=function(t){return this.batchId===t.batchId&&B(this.mutations,t.mutations)},t.prototype.isTombstone=function(){return 0===this.mutations.length},t.prototype.toTombstone=function(){return new t(this.batchId,this.localWriteTime,[])},t}(),yr=function(){function t(t,e,n,r,i){this.batch=t,this.commitVersion=e,this.mutationResults=n,this.streamToken=r,this.docVersions=i}return t.from=function(e,n,r,i){c(e.mutations.length===r.length,"Mutations sent "+e.mutations.length+" must equal results received "+r.length);for(var o=nt(),a=e.mutations,s=0;s<a.length;s++){var u=r[s].version;null===u&&(u=n),o=o.insert(a[s].key,u)}return new t(e,n,r,i,o)},t}(),_r="\x01",br="\x01",wr="\x10",Er="\x11",xr=function(){function t(t,e){this.seconds=t,this.nanoseconds=e}return t}(),Tr=function(){function t(t,e){this.ownerId=t,this.leaseTimestampMs=e}return t.store="owner",t}(),Sr=function(){function t(t,e,n){this.userId=t,this.lastAcknowledgedBatchId=e,this.lastStreamToken=n}return t.store="mutationQueues",t.keyPath="userId",t}(),Cr=function(){function t(t,e,n,r){this.userId=t,this.batchId=e,this.localWriteTimeMs=n,this.mutations=r}return t.store="mutations",t.keyPath=["userId","batchId"],t}(),Mr=function(){function t(){}return t.prefixForUser=function(t){return[t]},t.prefixForPath=function(t,e){return[t,lt(e)]},t.key=function(t,e,n){return[t,lt(e),n]},t.store="documentMutations",t.PLACEHOLDER=new t,t}(),Ar=function(){function t(t,e){this.path=t,this.readTime=e}return t}(),Ir=function(){function t(t,e){this.noDocument=t,this.document=e}return t.store="remoteDocuments",t}(),Rr=function(){function t(t,e,n,r,i,o){this.targetId=t,this.canonicalId=e,this.readTime=n,this.resumeToken=r,this.lastListenSequenceNumber=i,this.query=o}return t.store="targets",t.keyPath="targetId",t.queryTargetsIndexName="queryTargetsIndex",t.queryTargetsKeyPath=["canonicalId","targetId"],t}(),Pr=function(){function t(t,e){this.targetId=t,this.path=e}return t.store="targetDocuments",t.keyPath=["targetId","path"],t.documentTargetsIndex="documentTargetsIndex",t.documentTargetsKeyPath=["path","targetId"],t}(),Nr=function(){function t(t,e,n,r){this.highestTargetId=t,this.highestListenSequenceNumber=e,this.lastRemoteSnapshotVersion=n,this.targetCount=r}return t.key="targetGlobalKey",t.store="targetGlobal",t}(),Dr=[Sr.store,Cr.store,Mr.store,Ir.store,Rr.store,Tr.store,Nr.store,Pr.store],Or=function(){function t(t){this.db=t}return t.openOrCreate=function(e,n,r){return c(t.isAvailable(),"IndexedDB not supported in current environment."),o("SimpleDb","Opening database:",e),new rr(function(i,a){var s=window.indexedDB.open(e,n);s.onsuccess=function(e){var n=e.target.result;i(new t(n))},s.onerror=function(t){a(t.target.error)},s.onupgradeneeded=function(t){o("SimpleDb",'Database "'+e+'" requires upgrade from version:',t.oldVersion);var n=t.target.result,i=new Lr(s.transaction);r(n,i,t.oldVersion,2).next(function(){o("SimpleDb","Database upgrade to version 2 complete")})}}).toPromise()},t.delete=function(t){return o("SimpleDb","Removing database:",t),wt(window.indexedDB.deleteDatabase(t)).toPromise()},t.isAvailable=function(){if("undefined"===typeof window||null==window.indexedDB)return!1;var t=window.navigator.userAgent;return!(t.indexOf("MSIE ")>0||t.indexOf("Trident/")>0||t.indexOf("Edge/")>0)},t.prototype.runTransaction=function(t,e,n){var r=Lr.open(this.db,t,e),i=n(r).catch(function(t){return r.abort(),rr.reject(t)}).toPromise();return r.completionPromise.then(function(){return i})},t.prototype.close=function(){this.db.close()},t}(),kr=function(){function t(t){this.dbCursor=t,this.shouldStop=!1,this.nextKey=null}return Object.defineProperty(t.prototype,"isDone",{get:function(){return this.shouldStop},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"skipToKey",{get:function(){return this.nextKey},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"cursor",{set:function(t){this.dbCursor=t},enumerable:!0,configurable:!0}),t.prototype.done=function(){this.shouldStop=!0},t.prototype.skip=function(t){this.nextKey=t},t.prototype.delete=function(){return wt(this.dbCursor.delete())},t}(),Lr=function(){function t(t){var e=this;this.transaction=t,this.aborted=!1,this.completionPromise=new Promise(function(t,n){e.transaction.onabort=e.transaction.oncomplete=function(e){t()},e.transaction.onerror=function(t){n(t.target.error)}})}return t.open=function(e,n,r){return new t(e.transaction(r,n))},t.prototype.abort=function(){this.aborted||(o("SimpleDb","Aborting transaction."),this.aborted=!0,this.transaction.abort())},t.prototype.store=function(t){var e=this.transaction.objectStore(t);return c(!!e,"Object store not part of transaction: "+t),new Ur(e)},t}(),Ur=function(){function t(t){this.store=t}return t.prototype.put=function(t,e){var n;return void 0!==e?(o("SimpleDb","PUT",this.store.name,t,e),n=this.store.put(e,t)):(o("SimpleDb","PUT",this.store.name,"<auto-key>",t),n=this.store.put(t)),wt(n)},t.prototype.get=function(t){var e=this;return wt(this.store.get(t)).next(function(n){return void 0===n&&(n=null),o("SimpleDb","GET",e.store.name,t,n),n})},t.prototype.delete=function(t){return o("SimpleDb","DELETE",this.store.name,t),wt(this.store.delete(t))},t.prototype.count=function(){return o("SimpleDb","COUNT",this.store.name),wt(this.store.count())},t.prototype.loadAll=function(t,e){var n=this.cursor(this.options(t,e)),r=[];return this.iterateCursor(n,function(t,e){r.push(e)}).next(function(){return r})},t.prototype.deleteAll=function(t,e){o("SimpleDb","DELETE ALL",this.store.name);var n=this.options(t,e);n.keysOnly=!1;var r=this.cursor(n);return this.iterateCursor(r,function(t,e,n){return n.delete()})},t.prototype.iterate=function(t,e){var n;e?n=t:(n={},e=t);var r=this.cursor(n);return this.iterateCursor(r,e)},t.prototype.iterateCursor=function(t,e){var n=[];return new rr(function(r,i){t.onerror=function(t){i(t.target.error)},t.onsuccess=function(t){var i=t.target.result;if(!i)return void r();var o=new kr(i),a=e(i.primaryKey,i.value,o);a instanceof rr&&n.push(a),o.isDone?r():null===o.skipToKey?i.continue():i.continue(o.skipToKey)}}).next(function(){return rr.waitFor(n)})},t.prototype.options=function(t,e){var n=void 0;return void 0!==t&&("string"===typeof t?n=t:(c(void 0===e,"3rd argument must not be defined if 2nd is a range."),e=t)),{index:n,range:e}},t.prototype.cursor=function(t){var e="next";if(t.reverse&&(e="prev"),t.index){var n=this.store.index(t.index);return t.keysOnly?n.openKeyCursor(t.range,e):n.openCursor(t.range,e)}return this.store.openCursor(t.range,e)},t}(),Fr=function(){function t(t,e){this.userId=t,this.serializer=e,this.garbageCollector=null}return t.forUser=function(e,n){return c(""!==e.uid,"UserID must not be an empty string."),new t(e.isAuthenticated()?e.uid:"",n)},t.prototype.start=function(e){var n=this;return t.loadNextBatchIdFromDb(e).next(function(t){return n.nextBatchId=t,St(e).get(n.userId)}).next(function(t){return t||(t=new Sr(n.userId,gr,"")),n.metadata=t,n.metadata.lastAcknowledgedBatchId>=n.nextBatchId?n.checkEmpty(e).next(function(t){return c(t,"Reset nextBatchID is only possible when the queue is empty"),n.metadata.lastAcknowledgedBatchId=gr,St(e).put(n.metadata)}):rr.resolve()})},t.loadNextBatchIdFromDb=function(t){var e=gr;return xt(t).iterate({reverse:!0},function(t,n,r){var i=t[0];if(t[1]>e&&(e=n.batchId),""===i)r.done();else{var o=V(i);r.skip([o])}}).next(function(){return e+1})},t.prototype.checkEmpty=function(t){var e=!0,n=IDBKeyRange.bound(this.keyForBatchId(Number.NEGATIVE_INFINITY),this.keyForBatchId(Number.POSITIVE_INFINITY));return xt(t).iterate({range:n},function(t,n,r){e=!1,r.done()}).next(function(){return e})},t.prototype.getNextBatchId=function(t){return rr.resolve(this.nextBatchId)},t.prototype.getHighestAcknowledgedBatchId=function(t){return rr.resolve(this.metadata.lastAcknowledgedBatchId)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId;return c(r>this.metadata.lastAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order"),this.metadata.lastAcknowledgedBatchId=r,this.metadata.lastStreamToken=Et(n),St(t).put(this.metadata)},t.prototype.getLastStreamToken=function(t){return rr.resolve(this.metadata.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.metadata.lastStreamToken=Et(e),St(t).put(this.metadata)},t.prototype.addMutationBatch=function(t,e,n){var r=this,i=this.nextBatchId;this.nextBatchId++;var o=new vr(i,e,n),a=this.serializer.toDbMutationBatch(this.userId,o);return xt(t).put(a).next(function(){for(var e=[],o=0,a=n;o<a.length;o++){var s=a[o],u=Mr.key(r.userId,s.key.path,i);e.push(Tt(t).put(u,Mr.PLACEHOLDER))}return rr.waitFor(e)}).next(function(){return o})},t.prototype.lookupMutationBatch=function(t,e){var n=this;return xt(t).get(this.keyForBatchId(e)).next(function(t){return t?n.serializer.fromDbMutationBatch(t):null})},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){var n=this,r=Math.max(e,this.metadata.lastAcknowledgedBatchId)+1,i=IDBKeyRange.lowerBound(this.keyForBatchId(r)),o=null;return xt(t).iterate({range:i},function(t,e,i){e.userId===n.userId&&(c(e.batchId>=r,"Should have found mutation after "+r),o=n.serializer.fromDbMutationBatch(e)),i.done()}).next(function(){return o})},t.prototype.getAllMutationBatches=function(t){var e=this,n=IDBKeyRange.bound(this.keyForBatchId(gr),this.keyForBatchId(Number.POSITIVE_INFINITY));return xt(t).loadAll(n).next(function(t){return t.map(function(t){return e.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesThroughBatchId=function(t,e){var n=this,r=IDBKeyRange.bound(this.keyForBatchId(gr),this.keyForBatchId(e));return xt(t).loadAll(r).next(function(t){return t.map(function(t){return n.serializer.fromDbMutationBatch(t)})})},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=Mr.prefixForPath(this.userId,e.path),i=IDBKeyRange.lowerBound(r),o=[];return Tt(t).iterate({range:i},function(r,i,a){var s=r[0],c=r[1],l=r[2],h=dt(c);if(s!==n.userId||!e.path.isEqual(h))return void a.done();var f=n.keyForBatchId(l);return xt(t).get(f).next(function(t){null===t&&u("Dangling document-mutation reference found: "+r+" which points to "+f),o.push(n.serializer.fromDbMutationBatch(t))})}).next(function(){return o})},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this;c(!e.isDocumentQuery(),"Document queries shouldn't go down this path");var r=e.path,i=r.length+1,o=Mr.prefixForPath(this.userId,r),a=IDBKeyRange.lowerBound(o),s=new bn(U);return Tt(t).iterate({range:a},function(t,e,o){var a=t[0],u=t[1],c=t[2],l=dt(u);if(a!==n.userId||!r.isPrefixOf(l))return void o.done();l.length===i&&(s=s.add(c))}).next(function(){var e=[],r=[];return s.forEach(function(i){var o=n.keyForBatchId(i);r.push(xt(t).get(o).next(function(t){null===t&&u("Dangling document-mutation reference found, which points to "+o),e.push(n.serializer.fromDbMutationBatch(t))}))}),rr.waitFor(r).next(function(){return e})})},t.prototype.removeMutationBatches=function(t,e){for(var n=xt(t),r=Tt(t),i=[],o=this,a=0,s=e;a<s.length;a++){var u=s[a];!function(t){var e=IDBKeyRange.only(o.keyForBatchId(t.batchId)),a=0,s=n.iterate({range:e},function(t,e,n){return a++,n.delete()});i.push(s.next(function(){c(1===a,"Dangling document-mutation reference found: Missing batch "+t.batchId)}));for(var u=0,l=t.mutations;u<l.length;u++){var h=l[u],f=Mr.key(o.userId,h.key.path,t.batchId);i.push(r.delete(f)),null!==o.garbageCollector&&o.garbageCollector.addPotentialGarbageKey(h.key)}}(u)}return rr.waitFor(i)},t.prototype.performConsistencyCheck=function(t){var e=this;return this.checkEmpty(t).next(function(n){if(!n)return rr.resolve();var r=IDBKeyRange.lowerBound(Mr.prefixForUser(e.userId)),i=[];return Tt(t).iterate({range:r},function(t,n,r){if(t[0]!==e.userId)return void r.done();var o=dt(t[1]);i.push(o)}).next(function(){c(0===i.length,"Document leak -- detected dangling mutation references when queue is empty. Dangling keys: "+i.map(function(t){return t.canonicalString()}))})})},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=this,r=Mr.prefixForPath(this.userId,e.path),i=r[1],o=IDBKeyRange.lowerBound(r),a=!1;return Tt(t).iterate({range:o,keysOnly:!0},function(t,e,r){var o=t[0],s=t[1];t[2];o===n.userId&&s===i&&(a=!0),r.done()}).next(function(){return a})},t.prototype.keyForBatchId=function(t){return[this.userId,t]},t}(),Br=function(){function t(t){this.serializer=t,this.lastRemoteSnapshotVersion=rn.MIN,this.metadata=null,this.garbageCollector=null}return t.prototype.start=function(t){var e=this;return At(t).get(Nr.key).next(function(t){c(null!==t,"Missing metadata row that should be added by schema migration."),e.metadata=t;var n=t.lastRemoteSnapshotVersion;return e.lastRemoteSnapshotVersion=rn.fromTimestamp(new le(n.seconds,n.nanoseconds)),rr.resolve()})},t.prototype.getHighestTargetId=function(){return this.metadata.highestTargetId},t.prototype.getLastRemoteSnapshotVersion=function(){return this.lastRemoteSnapshotVersion},t.prototype.setLastRemoteSnapshotVersion=function(t,e){return this.lastRemoteSnapshotVersion=e,this.metadata.lastRemoteSnapshotVersion=e.toTimestamp(),At(t).put(Nr.key,this.metadata)},t.prototype.addQueryData=function(t,e){var n=this;return this.saveQueryData(t,e).next(function(){return n.metadata.targetCount+=1,n.updateMetadataFromQueryData(e),n.saveMetadata(t)})},t.prototype.updateQueryData=function(t,e){var n=this;return this.saveQueryData(t,e).next(function(){return n.updateMetadataFromQueryData(e)?n.saveMetadata(t):rr.resolve()})},t.prototype.removeQueryData=function(t,e){var n=this;return c(this.metadata.targetCount>0,"Removing from an empty query cache"),this.removeMatchingKeysForTargetId(t,e.targetId).next(function(){return Mt(t).delete(e.targetId)}).next(function(){return n.metadata.targetCount-=1,n.saveMetadata(t)})},t.prototype.saveMetadata=function(t){return At(t).put(Nr.key,this.metadata)},t.prototype.saveQueryData=function(t,e){return Mt(t).put(this.serializer.toDbTarget(e))},t.prototype.updateMetadataFromQueryData=function(t){var e=!1;return t.targetId>this.metadata.highestTargetId&&(this.metadata.highestTargetId=t.targetId,e=!0),e},Object.defineProperty(t.prototype,"count",{get:function(){return this.metadata.targetCount},enumerable:!0,configurable:!0}),t.prototype.getQueryData=function(t,e){var n=this,r=e.canonicalId(),i=IDBKeyRange.bound([r,Number.NEGATIVE_INFINITY],[r,Number.POSITIVE_INFINITY]),o=null;return Mt(t).iterate({range:i,index:Rr.queryTargetsIndexName},function(t,r,i){var a=n.serializer.fromDbTarget(r);e.isEqual(a.query)&&(o=a,i.done())}).next(function(){return o})},t.prototype.addMatchingKeys=function(t,e,n){var r=[],i=It(t);return e.forEach(function(t){var e=lt(t.path);r.push(i.put(new Pr(n,e)))}),rr.waitFor(r)},t.prototype.removeMatchingKeys=function(t,e,n){var r=this,i=[],o=It(t);return e.forEach(function(t){var e=lt(t.path);i.push(o.delete([n,e])),null!==r.garbageCollector&&r.garbageCollector.addPotentialGarbageKey(t)}),rr.waitFor(i)},t.prototype.removeMatchingKeysForTargetId=function(t,e){var n=It(t),r=IDBKeyRange.bound([e],[e+1],!1,!0);return this.notifyGCForRemovedKeys(t,r).next(function(){return n.delete(r)})},t.prototype.notifyGCForRemovedKeys=function(t,e){var n=this,r=It(t);return null!==this.garbageCollector&&this.garbageCollector.isEager?r.iterate({range:e,keysOnly:!0},function(t,e,r){var i=dt(t[1]),o=new ye(i);c(null!==n.garbageCollector,"GarbageCollector for query cache set to null during key removal."),n.garbageCollector.addPotentialGarbageKey(o)}):rr.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=IDBKeyRange.bound([e],[e+1],!1,!0),r=It(t),i=rt();return r.iterate({range:n,keysOnly:!0},function(t,e,n){var r=dt(t[1]),o=new ye(r);i=i.add(o)}).next(function(){return i})},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){c(null!==t,"Persistence Transaction cannot be null for query cache containsKey");var n=lt(e.path),r=IDBKeyRange.bound([n],[j(n)],!1,!0),i=0;return It(t).iterate({index:Pr.documentTargetsIndex,keysOnly:!0,range:r},function(t,e,n){i++,n.done()}).next(function(){return i>0})},t}(),Vr=function(){function t(t){this.serializer=t}return t.prototype.addEntry=function(t,e){return Pt(t).put(Nt(e.key),this.serializer.toDbRemoteDocument(e))},t.prototype.removeEntry=function(t,e){return Pt(t).delete(Nt(e))},t.prototype.getEntry=function(t,e){var n=this;return Pt(t).get(Nt(e)).next(function(t){return t?n.serializer.fromDbRemoteDocument(t):null})},t.prototype.getDocumentsMatchingQuery=function(t,e){var n=this,r=et(),i=e.path.toArray(),o=IDBKeyRange.lowerBound(i);return Pt(t).iterate({range:o},function(t,i,o){var a=n.serializer.fromDbRemoteDocument(i);e.path.isPrefixOf(a.key.path)?a instanceof _e&&e.matches(a)&&(r=r.insert(a.key,a)):o.done()}).next(function(){return r})},t}(),jr=function(){function t(t){this.remoteSerializer=t}return t.prototype.fromDbRemoteDocument=function(t){if(t.document)return this.remoteSerializer.fromDocument(t.document);if(t.noDocument){var e=ye.fromSegments(t.noDocument.path),n=t.noDocument.readTime,r=new le(n.seconds,n.nanoseconds);return new be(e,rn.fromTimestamp(r))}return u("Unexpected DbRemoteDocument")},t.prototype.toDbRemoteDocument=function(t){if(t instanceof _e){var e=this.remoteSerializer.toDocument(t);return new Ir(null,e)}var n=t.key.path.toArray(),r=t.version.toTimestamp(),i=new xr(r.seconds,r.nanoseconds);return new Ir(new Ar(n,i),null)},t.prototype.toDbMutationBatch=function(t,e){var n=this,r=e.mutations.map(function(t){return n.remoteSerializer.toMutation(t)});return new Cr(t,e.batchId,e.localWriteTime.toMillis(),r)},t.prototype.fromDbMutationBatch=function(t){var e=this,n=t.mutations.map(function(t){return e.remoteSerializer.fromMutation(t)}),r=le.fromMillis(t.localWriteTimeMs);return new vr(t.batchId,r,n)},t.prototype.fromDbTarget=function(t){var e,n=new le(t.readTime.seconds,t.readTime.nanoseconds),r=rn.fromTimestamp(n);return e=Dt(t.query)?this.remoteSerializer.fromDocumentsTarget(t.query):this.remoteSerializer.fromQueryTarget(t.query),new an(e,t.targetId,Me.Listen,r,t.resumeToken)},t.prototype.toDbTarget=function(t){c(Me.Listen===t.purpose,"Only queries with purpose "+Me.Listen+" may be stored, got "+t.purpose);var e,n=t.snapshotVersion.toTimestamp(),r=new xr(n.seconds,n.nanoseconds);e=t.query.isDocumentQuery()?this.remoteSerializer.toDocumentsTarget(t.query):this.remoteSerializer.toQueryTarget(t.query),c("string"===typeof t.resumeToken,"Persisting non-string resume token not supported.");var i=t.resumeToken;return new Rr(t.targetId,t.query.canonicalId(),r,i,0,e)},t}(),Hr="IndexedDbPersistence",Gr="There is another tab open with offline persistence enabled. Only one such tab is allowed at a time. The other tab must be closed or persistence must be disabled.",zr=function(){function t(e,n){this.ownerId=this.generateOwnerId(),this.dbName=e+t.MAIN_DATABASE,this.serializer=new jr(n),this.localStoragePrefix=e}return t.prototype.start=function(){var e=this;return t.isAvailable()?(c(!this.started,"IndexedDbPersistence double-started!"),this.started=!0,Or.openOrCreate(this.dbName,2,pt).then(function(t){e.simpleDb=t}).then(function(){return e.tryAcquireOwnerLease()}).then(function(){e.scheduleOwnerLeaseRefreshes(),e.attachWindowUnloadHook()})):(this.persistenceError=new oe(ie.UNIMPLEMENTED,"This platform is either missing IndexedDB or is known to have an incomplete implementation. Offline persistence has been disabled."),Promise.reject(this.persistenceError))},t.prototype.shutdown=function(){var t=this;return c(this.started,"IndexedDbPersistence shutdown without start!"),this.started=!1,this.detachWindowUnloadHook(),this.stopOwnerLeaseRefreshes(),this.releaseOwnerLease().then(function(){t.simpleDb.close()})},t.prototype.getMutationQueue=function(t){return Fr.forUser(t,this.serializer)},t.prototype.getQueryCache=function(){return new Br(this.serializer)},t.prototype.getRemoteDocumentCache=function(){return new Vr(this.serializer)},t.prototype.runTransaction=function(t,e){var n=this;return this.persistenceError?Promise.reject(this.persistenceError):(o(Hr,"Starting transaction:",t),this.simpleDb.runTransaction("readwrite",Dr,function(t){return n.ensureOwnerLease(t).next(function(){return e(t)})}))},t.isAvailable=function(){return Or.isAvailable()},t.buildStoragePrefix=function(t){var e=t.databaseId.projectId;return t.databaseId.isDefaultDatabase||(e+="."+t.databaseId.database),"firestore/"+t.persistenceKey+"/"+e+"/"},t.prototype.tryAcquireOwnerLease=function(){var t=this;return this.simpleDb.runTransaction("readwrite",[Tr.store],function(e){var n=e.store(Tr.store);return n.get("owner").next(function(e){if(t.validOwner(e))return o(Hr,"Valid owner already. Failing. Current owner:",e),t.persistenceError=new oe(ie.FAILED_PRECONDITION,Gr),rr.reject(t.persistenceError);var r=new Tr(t.ownerId,Date.now());return o(Hr,"No valid owner. Acquiring owner lease. Current owner:",e,"New owner:",r),n.put("owner",r)})})},t.prototype.releaseOwnerLease=function(){var t=this;return this.simpleDb.runTransaction("readwrite",[Tr.store],function(e){var n=e.store(Tr.store);return n.get("owner").next(function(e){return null!==e&&e.ownerId===t.ownerId?(o(Hr,"Releasing owner lease."),n.delete("owner")):rr.resolve()})})},t.prototype.ensureOwnerLease=function(t){var e=this;return t.store(Tr.store).get("owner").next(function(t){return null===t||t.ownerId!==e.ownerId?(e.persistenceError=new oe(ie.FAILED_PRECONDITION,Gr),rr.reject(e.persistenceError)):rr.resolve()})},t.prototype.validOwner=function(t){var e=Date.now(),n=e-5e3,r=e;return null!==t&&(!(t.leaseTimestampMs<n)&&(t.leaseTimestampMs>r?(a("Persistence owner-lease is in the future. Discarding.",t),!1):t.ownerId!==this.getZombiedOwnerId()))},t.prototype.scheduleOwnerLeaseRefreshes=function(){var t=this;this.ownerLeaseRefreshHandle=setInterval(function(){t.runTransaction("Refresh owner timestamp",function(e){return e.store(Tr.store).put("owner",new Tr(t.ownerId,Date.now()))}).catch(function(e){a(e),t.stopOwnerLeaseRefreshes()})},4e3)},t.prototype.stopOwnerLeaseRefreshes=function(){this.ownerLeaseRefreshHandle&&(clearInterval(this.ownerLeaseRefreshHandle),this.ownerLeaseRefreshHandle=null)},t.prototype.attachWindowUnloadHook=function(){var t=this;this.windowUnloadHandler=function(){t.setZombiedOwnerId(t.ownerId),t.shutdown()},window.addEventListener("unload",this.windowUnloadHandler)},t.prototype.detachWindowUnloadHook=function(){this.windowUnloadHandler&&(window.removeEventListener("unload",this.windowUnloadHandler),this.windowUnloadHandler=null)},t.prototype.getZombiedOwnerId=function(){try{var t=window.localStorage.getItem(this.zombiedOwnerLocalStorageKey());return o(Hr,"Zombied ownerID from LocalStorage:",t),t}catch(t){return a("Failed to get zombie owner id.",t),null}},t.prototype.setZombiedOwnerId=function(t){try{null===t?window.localStorage.removeItem(this.zombiedOwnerLocalStorageKey()):window.localStorage.setItem(this.zombiedOwnerLocalStorageKey(),t)}catch(t){a("Failed to set zombie owner id.",t)}},t.prototype.zombiedOwnerLocalStorageKey=function(){return this.localStoragePrefix+"zombiedOwnerId"},t.prototype.generateOwnerId=function(){return ae.newId()},t.MAIN_DATABASE="main",t}(),Wr=function(){function t(t,e){this.remoteDocumentCache=t,this.mutationQueue=e}return t.prototype.getDocument=function(t,e){var n=this;return this.remoteDocumentCache.getEntry(t,e).next(function(r){return n.computeLocalDocument(t,e,r)})},t.prototype.getDocuments=function(t,e){var n=this,r=[],i=tt();return e.forEach(function(e){r.push(n.getDocument(t,e).next(function(t){t||(t=new be(e,rn.forDeletedDoc())),i=i.insert(e,t)}))}),rr.waitFor(r).next(function(){return i})},t.prototype.getDocumentsMatchingQuery=function(t,e){return ye.isDocumentKey(e.path)?this.getDocumentsMatchingDocumentQuery(t,e.path):this.getDocumentsMatchingCollectionQuery(t,e)},t.prototype.getDocumentsMatchingDocumentQuery=function(t,e){return this.getDocument(t,new ye(e)).next(function(t){var e=et();return t instanceof _e&&(e=e.insert(t.key,t)),e})},t.prototype.getDocumentsMatchingCollectionQuery=function(t,e){var n,r=this;return this.remoteDocumentCache.getDocumentsMatchingQuery(t,e).next(function(e){return r.computeLocalDocuments(t,e)}).next(function(i){return n=i,r.mutationQueue.getAllMutationBatchesAffectingQuery(t,e)}).next(function(e){for(var i=rt(),o=0,a=e;o<a.length;o++)for(var s=a[o],u=0,c=s.mutations;u<c.length;u++){var l=c[u];n.get(l.key)||(i=i.add(l.key))}var h=[];return i.forEach(function(e){h.push(r.getDocument(t,e).next(function(t){t instanceof _e&&(n=n.insert(t.key,t))}))}),rr.waitFor(h)}).next(function(){return n.forEach(function(t,r){e.matches(r)||(n=n.remove(t))}),n})},t.prototype.computeLocalDocument=function(t,e,n){return this.mutationQueue.getAllMutationBatchesAffectingDocumentKey(t,e).next(function(t){for(var r=0,i=t;r<i.length;r++){var o=i[r];n=o.applyToLocalView(e,n)}return n})},t.prototype.computeLocalDocuments=function(t,e){var n=this,r=[];return e.forEach(function(i,o){r.push(n.computeLocalDocument(t,i,o).next(function(t){t instanceof _e?e=e.insert(t.key,t):t instanceof be?e=e.remove(t.key):u("Unknown MaybeDocument: "+t)}))}),rr.waitFor(r).next(function(){return e})},t}(),qr=function(){function t(t){this.remoteDocumentCache=t,this.changes=tt()}return t.prototype.addEntry=function(t){var e=this.assertChanges();this.changes=e.insert(t.key,t)},t.prototype.getEntry=function(t,e){var n=this.assertChanges(),r=n.get(e);return r?rr.resolve(r):this.remoteDocumentCache.getEntry(t,e)},t.prototype.apply=function(t){var e=this,n=this.assertChanges(),r=[];return n.forEach(function(n,i){r.push(e.remoteDocumentCache.addEntry(t,i))}),this.changes=null,rr.waitFor(r)},t.prototype.assertChanges=function(){return c(null!==this.changes,"Changes have already been applied."),this.changes},t}(),Yr=function(){function t(t,e,n){this.persistence=t,this.garbageCollector=n,this.localViewReferences=new ar,this.targetIds={},this.targetIdGenerator=lr.forLocalStore(),this.heldBatchResults=[],this.mutationQueue=t.getMutationQueue(e),this.remoteDocuments=t.getRemoteDocumentCache(),this.queryCache=t.getQueryCache(),this.localDocuments=new Wr(this.remoteDocuments,this.mutationQueue),this.garbageCollector.addGarbageSource(this.localViewReferences),this.garbageCollector.addGarbageSource(this.queryCache),this.garbageCollector.addGarbageSource(this.mutationQueue)}return t.prototype.start=function(){var t=this;return this.persistence.runTransaction("Start LocalStore",function(e){return t.startMutationQueue(e).next(function(){return t.startQueryCache(e)})})},t.prototype.handleUserChange=function(t){var e=this;return this.persistence.runTransaction("Handle user change",function(n){var r;return e.mutationQueue.getAllMutationBatches(n).next(function(i){return r=i,e.garbageCollector.removeGarbageSource(e.mutationQueue),e.mutationQueue=e.persistence.getMutationQueue(t),e.garbageCollector.addGarbageSource(e.mutationQueue),e.startMutationQueue(n)}).next(function(){return e.localDocuments=new Wr(e.remoteDocuments,e.mutationQueue),e.mutationQueue.getAllMutationBatches(n)}).next(function(t){for(var i=rt(),o=0,a=[r,t];o<a.length;o++)for(var s=a[o],u=0,c=s;u<c.length;u++)for(var l=c[u],h=0,f=l.mutations;h<f.length;h++){var d=f[h];i=i.add(d.key)}return e.localDocuments.getDocuments(n,i)})})},t.prototype.startQueryCache=function(t){var e=this;return this.queryCache.start(t).next(function(){var t=e.queryCache.getHighestTargetId();e.targetIdGenerator=lr.forLocalStore(t)})},t.prototype.startMutationQueue=function(t){var e=this;return this.mutationQueue.start(t).next(function(){return e.heldBatchResults=[],e.mutationQueue.getHighestAcknowledgedBatchId(t)}).next(function(n){return n!==gr?e.mutationQueue.getAllMutationBatchesThroughBatchId(t,n):rr.resolve([])}).next(function(n){return n.length>0?e.mutationQueue.removeMutationBatches(t,n):rr.resolve()})},t.prototype.localWrite=function(t){var e=this;return this.persistence.runTransaction("Locally write mutations",function(n){var r,i=le.now();return e.mutationQueue.addMutationBatch(n,i,t).next(function(t){r=t;var i=r.keys();return e.localDocuments.getDocuments(n,i)}).next(function(t){return{batchId:r.batchId,changes:t}})})},t.prototype.acknowledgeBatch=function(t){var e=this;return this.persistence.runTransaction("Acknowledge batch",function(n){var r;return e.mutationQueue.acknowledgeBatch(n,t.batch,t.streamToken).next(function(){if(e.shouldHoldBatchResult(t.commitVersion))return e.heldBatchResults.push(t),r=rt(),rr.resolve();var i=new qr(e.remoteDocuments);return e.releaseBatchResults(n,[t],i).next(function(t){return r=t,i.apply(n)})}).next(function(){return e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,r)})})},t.prototype.rejectBatch=function(t){var e=this;return this.persistence.runTransaction("Reject batch",function(n){var r,i;return e.mutationQueue.lookupMutationBatch(n,t).next(function(i){return c(null!=i,"Attempt to reject nonexistent batch!"),r=i,e.mutationQueue.getHighestAcknowledgedBatchId(n).next(function(e){return c(t>e,"Acknowledged batches can't be rejected."),r})}).next(function(){return e.removeMutationBatch(n,r)}).next(function(t){return i=t,e.mutationQueue.performConsistencyCheck(n)}).next(function(){return e.localDocuments.getDocuments(n,i)})})},t.prototype.getLastStreamToken=function(){var t=this;return this.persistence.runTransaction("Get last stream token",function(e){return t.mutationQueue.getLastStreamToken(e)})},t.prototype.setLastStreamToken=function(t){var e=this;return this.persistence.runTransaction("Set last stream token",function(n){return e.mutationQueue.setLastStreamToken(n,t)})},t.prototype.getLastRemoteSnapshotVersion=function(){return this.queryCache.getLastRemoteSnapshotVersion()},t.prototype.applyRemoteEvent=function(t){var e=this,n=new qr(this.remoteDocuments);return this.persistence.runTransaction("Apply remote event",function(r){var i=[];p(t.targetChanges,function(t,n){var o=e.targetIds[t];if(o){var a=n.mapping;if(a)if(a instanceof An)i.push(e.queryCache.removeMatchingKeysForTargetId(r,t).next(function(){return e.queryCache.addMatchingKeys(r,a.documents,t)}));else{if(!(a instanceof In))return u("Unknown mapping type: "+JSON.stringify(a));i.push(e.queryCache.removeMatchingKeys(r,a.removedDocuments,t).next(function(){return e.queryCache.addMatchingKeys(r,a.addedDocuments,t)}))}var s=n.resumeToken;s.length>0&&(o=o.update({resumeToken:s,snapshotVersion:n.snapshotVersion}),e.targetIds[t]=o,i.push(e.queryCache.updateQueryData(r,o)))}});var a=rt();t.documentUpdates.forEach(function(t,s){a=a.add(t),i.push(n.getEntry(r,t).next(function(r){null==r||s.version.isEqual(rn.MIN)||s.version.compareTo(r.version)>=0?n.addEntry(s):o("LocalStore","Ignoring outdated watch update for ",t,". Current version:",r.version," Watch version:",s.version),e.garbageCollector.addPotentialGarbageKey(t)}))});var s=e.queryCache.getLastRemoteSnapshotVersion(),l=t.snapshotVersion;l.isEqual(rn.MIN)||(c(l.compareTo(s)>=0,"Watch stream reverted to previous snapshot?? "+l+" < "+s),i.push(e.queryCache.setLastRemoteSnapshotVersion(r,l)));var h;return rr.waitFor(i).next(function(){return e.releaseHeldBatchResults(r,n)}).next(function(t){return h=t,n.apply(r)}).next(function(){return e.localDocuments.getDocuments(r,a.unionWith(h))})})},t.prototype.notifyLocalViewChanges=function(t){var e=this;return this.persistence.runTransaction("Notify local view changes",function(n){for(var r=[],i=0,o=t;i<o.length;i++){var a=o[i];!function(t){r.push(e.queryCache.getQueryData(n,t.query).next(function(n){c(null!==n,"Local view changes contain unallocated query.");var r=n.targetId;e.localViewReferences.addReferences(t.addedKeys,r),e.localViewReferences.removeReferences(t.removedKeys,r)}))}(a)}return rr.waitFor(r)})},t.prototype.nextMutationBatch=function(t){var e=this;return this.persistence.runTransaction("Get next mutation batch",function(n){return void 0===t&&(t=gr),e.mutationQueue.getNextMutationBatchAfterBatchId(n,t)})},t.prototype.readDocument=function(t){var e=this;return this.persistence.runTransaction("read document",function(n){return e.localDocuments.getDocument(n,t)})},t.prototype.allocateQuery=function(t){var e=this;return this.persistence.runTransaction("Allocate query",function(n){var r;return e.queryCache.getQueryData(n,t).next(function(i){if(i)return r=i,rr.resolve();var o=e.targetIdGenerator.next();return r=new an(t,o,Me.Listen),e.queryCache.addQueryData(n,r)}).next(function(){return c(!e.targetIds[r.targetId],"Tried to allocate an already allocated query: "+t),e.targetIds[r.targetId]=r,r})})},t.prototype.releaseQuery=function(t){var e=this;return this.persistence.runTransaction("Release query",function(n){return e.queryCache.getQueryData(n,t).next(function(r){return c(null!=r,"Tried to release nonexistent query: "+t),e.localViewReferences.removeReferencesForId(r.targetId),delete e.targetIds[r.targetId],e.garbageCollector.isEager?e.queryCache.removeQueryData(n,r):rr.resolve()}).next(function(){if(g(e.targetIds)){var t=new qr(e.remoteDocuments);return e.releaseHeldBatchResults(n,t).next(function(){t.apply(n)})}return rr.resolve()})})},t.prototype.executeQuery=function(t){var e=this;return this.persistence.runTransaction("Execute query",function(n){return e.localDocuments.getDocumentsMatchingQuery(n,t)})},t.prototype.remoteDocumentKeys=function(t){var e=this;return this.persistence.runTransaction("Remote document keys",function(n){return e.queryCache.getMatchingKeysForTargetId(n,t)})},t.prototype.collectGarbage=function(){var t=this;return this.persistence.runTransaction("Garbage collection",function(e){return t.garbageCollector.collectGarbage(e).next(function(n){var r=[];return n.forEach(function(n){r.push(t.remoteDocuments.removeEntry(e,n))}),rr.waitFor(r)})})},t.prototype.releaseHeldBatchResults=function(t,e){for(var n=[],r=0,i=this.heldBatchResults;r<i.length;r++){var o=i[r];if(!this.isRemoteUpToVersion(o.commitVersion))break;n.push(o)}return 0===n.length?rr.resolve(rt()):(this.heldBatchResults.splice(0,n.length),this.releaseBatchResults(t,n,e))},t.prototype.isRemoteUpToVersion=function(t){var e=this.queryCache.getLastRemoteSnapshotVersion();return t.compareTo(e)<=0||g(this.targetIds)},t.prototype.shouldHoldBatchResult=function(t){return!this.isRemoteUpToVersion(t)||this.heldBatchResults.length>0},t.prototype.releaseBatchResults=function(t,e,n){for(var r=this,i=rr.resolve(),o=0,a=e;o<a.length;o++){var s=a[o];!function(e){i=i.next(function(){return r.applyWriteToRemoteDocuments(t,e,n)})}(s)}return i.next(function(){return r.removeMutationBatches(t,e.map(function(t){return t.batch}))})},t.prototype.removeMutationBatch=function(t,e){return this.removeMutationBatches(t,[e])},t.prototype.removeMutationBatches=function(t,e){for(var n=rt(),r=0,i=e;r<i.length;r++)for(var o=i[r],a=0,s=o.mutations;a<s.length;a++){var u=s[a],c=u.key;n=n.add(c)}return this.mutationQueue.removeMutationBatches(t,e).next(function(){return n})},t.prototype.applyWriteToRemoteDocuments=function(t,e,n){var r=e.batch,i=r.keys(),o=rr.resolve();return i.forEach(function(i){o=o.next(function(){return n.getEntry(t,i)}).next(function(t){var o=t,a=e.docVersions.get(i);c(null!==a,"ackVersions should contain every doc in the write."),(!o||o.version.compareTo(a)<0)&&(o=r.applyToRemoteDocument(i,o,e),o?n.addEntry(o):c(!t,"Mutation batch "+r+" applied to document "+t+" resulted in null"))})}),o},t}(),Kr=function(){function t(){this.mutationQueue=[],this.nextBatchId=1,this.highestAcknowledgedBatchId=gr,this.lastStreamToken=l(),this.garbageCollector=null,this.batchesByDocumentKey=new bn(sr.compareByKey)}return t.prototype.start=function(t){return 0===this.mutationQueue.length&&(this.nextBatchId=1,this.highestAcknowledgedBatchId=gr),c(this.highestAcknowledgedBatchId<this.nextBatchId,"highestAcknowledgedBatchId must be less than the nextBatchId"),rr.resolve()},t.prototype.checkEmpty=function(t){return rr.resolve(0===this.mutationQueue.length)},t.prototype.getNextBatchId=function(t){return rr.resolve(this.nextBatchId)},t.prototype.getHighestAcknowledgedBatchId=function(t){return rr.resolve(this.highestAcknowledgedBatchId)},t.prototype.acknowledgeBatch=function(t,e,n){var r=e.batchId;c(r>this.highestAcknowledgedBatchId,"Mutation batchIDs must be acknowledged in order");var i=this.indexOfExistingBatchId(r,"acknowledged"),o=this.mutationQueue[i];return c(r===o.batchId,"Queue ordering failure: expected batch "+r+", got batch "+o.batchId),c(!o.isTombstone(),"Can't acknowledge a previously removed batch"),this.highestAcknowledgedBatchId=r,this.lastStreamToken=n,rr.resolve()},t.prototype.getLastStreamToken=function(t){return rr.resolve(this.lastStreamToken)},t.prototype.setLastStreamToken=function(t,e){return this.lastStreamToken=e,rr.resolve()},t.prototype.addMutationBatch=function(t,e,n){c(0!==n.length,"Mutation batches should not be empty");var r=this.nextBatchId;if(this.nextBatchId++,this.mutationQueue.length>0){c(this.mutationQueue[this.mutationQueue.length-1].batchId<r,"Mutation batchIDs must be monotonically increasing order")}var i=new vr(r,e,n);this.mutationQueue.push(i);for(var o=0,a=n;o<a.length;o++){var s=a[o];this.batchesByDocumentKey=this.batchesByDocumentKey.add(new sr(s.key,r))}return rr.resolve(i)},t.prototype.lookupMutationBatch=function(t,e){return rr.resolve(this.findMutationBatch(e))},t.prototype.getNextMutationBatchAfterBatchId=function(t,e){for(var n=this.mutationQueue.length,r=Math.max(e,this.highestAcknowledgedBatchId)+1,i=this.indexOfBatchId(r),o=i<0?0:i;o<n;o++){var a=this.mutationQueue[o];if(!a.isTombstone())return rr.resolve(a)}return rr.resolve(null)},t.prototype.getAllMutationBatches=function(t){return rr.resolve(this.getAllLiveMutationBatchesBeforeIndex(this.mutationQueue.length))},t.prototype.getAllMutationBatchesThroughBatchId=function(t,e){var n=this.mutationQueue.length,r=this.indexOfBatchId(e);return r<0?r=0:r>=n?r=n:r++,rr.resolve(this.getAllLiveMutationBatchesBeforeIndex(r))},t.prototype.getAllMutationBatchesAffectingDocumentKey=function(t,e){var n=this,r=new sr(e,0),i=new sr(e,Number.POSITIVE_INFINITY),o=[];return this.batchesByDocumentKey.forEachInRange([r,i],function(t){c(e.isEqual(t.key),"Should only iterate over a single key's batches");var r=n.findMutationBatch(t.targetOrBatchId);c(null!==r,"Batches in the index must exist in the main table"),o.push(r)}),rr.resolve(o)},t.prototype.getAllMutationBatchesAffectingQuery=function(t,e){var n=this,r=e.path,i=r.length+1,o=r;ye.isDocumentKey(o)||(o=o.child(""));var a=new sr(new ye(o),0),s=new bn(U);this.batchesByDocumentKey.forEachWhile(function(t){var e=t.key.path;return!!r.isPrefixOf(e)&&(e.length===i&&(s=s.add(t.targetOrBatchId)),!0)},a);var u=[];return s.forEach(function(t){var e=n.findMutationBatch(t);null!==e&&u.push(e)}),rr.resolve(u)},t.prototype.removeMutationBatches=function(t,e){var n=e.length;c(n>0,"Should not remove mutations when none exist.");var r=e[0].batchId,i=this.mutationQueue.length,o=this.indexOfExistingBatchId(r,"removed");c(this.mutationQueue[o].batchId===r,"Removed batches must exist in the queue");for(var a=1,s=o+1;a<n&&s<i;){var u=this.mutationQueue[s];u.isTombstone()?s++:(c(u.batchId===e[a].batchId,"Removed batches must be contiguous in the queue"),a++,s++)}if(0===o){for(;s<i;s++){var u=this.mutationQueue[s];if(!u.isTombstone())break}var l=s-o;this.mutationQueue.splice(o,l)}else for(var h=o;h<s;h++)this.mutationQueue[h]=this.mutationQueue[h].toTombstone();for(var f=this.batchesByDocumentKey,d=0,p=e;d<p.length;d++)for(var u=p[d],m=u.batchId,g=0,v=u.mutations;g<v.length;g++){var y=v[g],_=y.key;null!==this.garbageCollector&&this.garbageCollector.addPotentialGarbageKey(_);var b=new sr(_,m);f=f.delete(b)}return this.batchesByDocumentKey=f,rr.resolve()},t.prototype.setGarbageCollector=function(t){this.garbageCollector=t},t.prototype.containsKey=function(t,e){var n=new sr(e,0),r=this.batchesByDocumentKey.firstAfterOrEqual(n);return rr.resolve(e.isEqual(r&&r.key))},t.prototype.performConsistencyCheck=function(t){return 0===this.mutationQueue.length&&c(this.batchesByDocumentKey.isEmpty(),"Document leak -- detected dangling mutation references when queue is empty."),rr.resolve()},t.prototype.getAllLiveMutationBatchesBeforeIndex=function(t){for(var e=[],n=0;n<t;n++){var r=this.mutationQueue[n];r.isTombstone()||e.push(r)}return e},t.prototype.indexOfExistingBatchId=function(t,e){var n=this.indexOfBatchId(t);return c(n>=0&&n<this.mutationQueue.length,"Batches must exist to be "+e),n},t.prototype.indexOfBatchId=function(t){return 0===this.mutationQueue.length?0:t-this.mutationQueue[0].batchId},t.prototype.findMutationBatch=function(t){var e=this.indexOfBatchId(t);if(e<0||e>=this.mutationQueue.length)return null;var n=this.mutationQueue[e];return c(n.batchId===t,"If found batch must match"),n.isTombstone()?null:n},t}(),Qr=function(){function t(){this.queries=new $n(function(t){return t.canonicalId()}),this.lastRemoteSnapshotVersion=rn.MIN,this.highestTargetId=0,this.references=new ar,this.targetCount=0}return t.prototype.start=function(t){return rr.resolve()},t.prototype.getLastRemoteSnapshotVersion=function(){return this.lastRemoteSnapshotVersion},t.prototype.getHighestTargetId=function(){return this.highestTargetId},t.prototype.setLastRemoteSnapshotVersion=function(t,e){return this.lastRemoteSnapshotVersion=e,rr.resolve()},t.prototype.saveQueryData=function(t){this.queries.set(t.query,t);var e=t.targetId;e>this.highestTargetId&&(this.highestTargetId=e)},t.prototype.addQueryData=function(t,e){return c(!this.queries.has(e.query),"Adding a query that already exists"),this.saveQueryData(e),this.targetCount+=1,rr.resolve()},t.prototype.updateQueryData=function(t,e){return c(this.queries.has(e.query),"Updating a non-existent query"),this.saveQueryData(e),rr.resolve()},t.prototype.removeQueryData=function(t,e){return c(this.targetCount>0,"Removing a target from an empty cache"),c(this.queries.has(e.query),"Removing a non-existent target from the cache"),this.queries.delete(e.query),this.references.removeReferencesForId(e.targetId),this.targetCount-=1,rr.resolve()},Object.defineProperty(t.prototype,"count",{get:function(){return this.targetCount},enumerable:!0,configurable:!0}),t.prototype.getQueryData=function(t,e){var n=this.queries.get(e)||null;return rr.resolve(n)},t.prototype.addMatchingKeys=function(t,e,n){return this.references.addReferences(e,n),rr.resolve()},t.prototype.removeMatchingKeys=function(t,e,n){return this.references.removeReferences(e,n),rr.resolve()},t.prototype.removeMatchingKeysForTargetId=function(t,e){return this.references.removeReferencesForId(e),rr.resolve()},t.prototype.getMatchingKeysForTargetId=function(t,e){var n=this.references.referencesForId(e);return rr.resolve(n)},t.prototype.setGarbageCollector=function(t){this.references.setGarbageCollector(t)},t.prototype.containsKey=function(t,e){return this.references.containsKey(t,e)},t}(),Xr=function(){function t(){this.docs=tt()}return t.prototype.addEntry=function(t,e){return this.docs=this.docs.insert(e.key,e),rr.resolve()},t.prototype.removeEntry=function(t,e){return this.docs=this.docs.remove(e),rr.resolve()},t.prototype.getEntry=function(t,e){return rr.resolve(this.docs.get(e))},t.prototype.getDocumentsMatchingQuery=function(t,e){for(var n=et(),r=new ye(e.path.child("")),i=this.docs.getIteratorFrom(r);i.hasNext();){var o=i.getNext(),a=o.key,s=o.value;if(!e.path.isPrefixOf(a.path))break;s instanceof _e&&e.matches(s)&&(n=n.insert(s.key,s))}return rr.resolve(n)},t}(),Jr=function(){function t(){this.mutationQueues={},this.remoteDocumentCache=new Xr,this.queryCache=new Qr,this.started=!1}return t.prototype.start=function(){return $t.__awaiter(this,void 0,void 0,function(){return $t.__generator(this,function(t){return c(!this.started,"MemoryPersistence double-started!"),this.started=!0,[2]})})},t.prototype.shutdown=function(){return $t.__awaiter(this,void 0,void 0,function(){return $t.__generator(this,function(t){return c(this.started,"MemoryPersistence shutdown without start!"),this.started=!1,[2]})})},t.prototype.getMutationQueue=function(t){var e=this.mutationQueues[t.toKey()];return e||(e=new Kr,this.mutationQueues[t.toKey()]=e),e},t.prototype.getQueryCache=function(){return this.queryCache},t.prototype.getRemoteDocumentCache=function(){return this.remoteDocumentCache},t.prototype.runTransaction=function(t,e){return o("MemoryPersistence","Starting transaction:",t),e(new Zr).toPromise()},t}(),Zr=function(){function t(){}return t}(),$r=function(){function t(){this.isEager=!1}return t.prototype.addGarbageSource=function(t){},t.prototype.removeGarbageSource=function(t){},t.prototype.addPotentialGarbageKey=function(t){},t.prototype.collectGarbage=function(t){return rr.resolve(rt())},t}(),ti=function(){function t(){var t=this;this.promise=new Promise(function(e,n){t.resolve=e,t.reject=n})}return t}();!function(t){t.All="all",t.ListenStreamIdle="listen_stream_idle",t.ListenStreamConnectionBackoff="listen_stream_connection_backoff",t.WriteStreamIdle="write_stream_idle",t.WriteStreamConnectionBackoff="write_stream_connection_backoff",t.OnlineStateTimeout="online_state_timeout"}(cr||(cr={}));var ei,ni=function(){function t(t,e,n,r,i){this.asyncQueue=t,this.timerId=e,this.targetTimeMs=n,this.op=r,this.removalCallback=i,this.deferred=new ti,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.catch=this.deferred.promise.catch.bind(this.deferred.promise),this.deferred.promise.catch(function(t){})}return t.createAndSchedule=function(e,n,r,i,o){var a=Date.now()+r,s=new t(e,n,a,i,o);return s.start(r),s},t.prototype.start=function(t){var e=this;this.timerHandle=setTimeout(function(){return e.handleDelayElapsed()},t)},t.prototype.skipDelay=function(){return this.handleDelayElapsed()},t.prototype.cancel=function(t){null!==this.timerHandle&&(this.clearTimeout(),this.deferred.reject(new oe(ie.CANCELLED,"Operation cancelled"+(t?": "+t:""))))},t.prototype.handleDelayElapsed=function(){var t=this;this.asyncQueue.enqueue(function(){return null!==t.timerHandle?(t.clearTimeout(),t.op().then(function(e){return t.deferred.resolve(e)})):Promise.resolve()})},t.prototype.clearTimeout=function(){null!==this.timerHandle&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)},t}(),ri=function(){function t(){this.tail=Promise.resolve(),this.delayedOperations=[],this.operationInProgress=!1}return t.prototype.enqueue=function(t){var e=this;this.verifyNotFailed();var n=this.tail.then(function(){return e.operationInProgress=!0,t().catch(function(t){e.failure=t,e.operationInProgress=!1;var n=t.stack||t.message||"";throw a("INTERNAL UNHANDLED ERROR: ",n),n.indexOf("Firestore Test Simulated Error")<0&&setTimeout(function(){throw t},0),t}).then(function(t){return e.operationInProgress=!1,t})});return this.tail=n,n},t.prototype.enqueueAfterDelay=function(t,e,n){var r=this;this.verifyNotFailed(),c(!this.containsDelayedOperation(t),"Attempted to schedule multiple operations with timer id "+t+".");var i=ni.createAndSchedule(this,t,e,n,function(t){return r.removeDelayedOperation(t)});return this.delayedOperations.push(i),i},t.prototype.verifyNotFailed=function(){this.failure&&u("AsyncQueue is already failed: "+(this.failure.stack||this.failure.message))},t.prototype.verifyOperationInProgress=function(){c(this.operationInProgress,"verifyOpInProgress() called when no op in progress on this queue.")},t.prototype.drain=function(){return this.enqueue(function(){return Promise.resolve()})},t.prototype.containsDelayedOperation=function(t){return this.delayedOperations.findIndex(function(e){return e.timerId===t})>=0},t.prototype.runDelayedOperationsEarly=function(t){var e=this;return this.drain().then(function(){c(t===cr.All||e.containsDelayedOperation(t),"Attempted to drain to missing operation "+t),e.delayedOperations.sort(function(t,e){return t.targetTimeMs-e.targetTimeMs});for(var n=0,r=e.delayedOperations;n<r.length;n++){var i=r[n];if(i.skipDelay(),t!==cr.All&&i.timerId===t)break}return e.drain()})},t.prototype.removeDelayedOperation=function(t){var e=this.delayedOperations.indexOf(t);c(e>=0,"Delayed operation not found."),this.delayedOperations.splice(e,1)},t}(),ii=function(){function t(t,e,n,r,i){this.queue=t,this.timerId=e,this.initialDelayMs=n,this.backoffFactor=r,this.maxDelayMs=i,this.timerPromise=null,this.reset()}return t.prototype.reset=function(){this.currentBaseMs=0},t.prototype.resetToMax=function(){this.currentBaseMs=this.maxDelayMs},t.prototype.backoffAndRun=function(t){this.cancel();var e=this.currentBaseMs+this.jitterDelayMs();this.currentBaseMs>0&&o("ExponentialBackoff","Backing off for "+e+" ms (base delay: "+this.currentBaseMs+" ms)"),this.timerPromise=this.queue.enqueueAfterDelay(this.timerId,e,t),this.currentBaseMs*=this.backoffFactor,this.currentBaseMs<this.initialDelayMs&&(this.currentBaseMs=this.initialDelayMs),this.currentBaseMs>this.maxDelayMs&&(this.currentBaseMs=this.maxDelayMs)},t.prototype.cancel=function(){null!==this.timerPromise&&(this.timerPromise.cancel(),this.timerPromise=null)},t.prototype.jitterDelayMs=function(){return(Math.random()-.5)*this.currentBaseMs},t}();!function(t){t[t.Initial=0]="Initial",t[t.Auth=1]="Auth",t[t.Open=2]="Open",t[t.Error=3]="Error",t[t.Backoff=4]="Backoff",t[t.Stopped=5]="Stopped"}(ei||(ei={}));var oi,ai=1e3,si=6e4,ui=1.5,ci=function(){function t(t,e,n,r,i){this.queue=t,this.idleTimerId=n,this.connection=r,this.credentialsProvider=i,this.inactivityTimerPromise=null,this.stream=null,this.listener=null,this.backoff=new ii(t,e,ai,ui,si),this.state=ei.Initial}return t.prototype.isStarted=function(){return this.state===ei.Backoff||this.state===ei.Auth||this.state===ei.Open},t.prototype.isOpen=function(){return this.state===ei.Open},t.prototype.start=function(t){if(this.state===ei.Error)return void this.performBackoff(t);c(this.state===ei.Initial,"Already started"),this.listener=t,this.auth()},t.prototype.stop=function(){this.isStarted()&&this.close(ei.Stopped)},t.prototype.inhibitBackoff=function(){c(!this.isStarted(),"Can only inhibit backoff in a stopped state"),this.state=ei.Initial,this.backoff.reset()},t.prototype.markIdle=function(){var t=this;this.isOpen()&&null===this.inactivityTimerPromise&&(this.inactivityTimerPromise=this.queue.enqueueAfterDelay(this.idleTimerId,6e4,function(){return t.handleIdleCloseTimer()}))},t.prototype.sendRequest=function(t){this.cancelIdleCheck(),this.stream.send(t)},t.prototype.handleIdleCloseTimer=function(){return $t.__awaiter(this,void 0,void 0,function(){return $t.__generator(this,function(t){return this.isOpen()?[2,this.close(ei.Initial)]:[2]})})},t.prototype.cancelIdleCheck=function(){this.inactivityTimerPromise&&(this.inactivityTimerPromise.cancel(),this.inactivityTimerPromise=null)},t.prototype.close=function(t,e){return $t.__awaiter(this,void 0,void 0,function(){var n;return $t.__generator(this,function(r){return c(t===ei.Error||q(e),"Can't provide an error when not in an error state."),this.cancelIdleCheck(),this.backoff.cancel(),t!==ei.Error?this.backoff.reset():e&&e.code===ie.RESOURCE_EXHAUSTED&&(a(e.toString()),a("Using maximum backoff delay to prevent overloading the backend."),this.backoff.resetToMax()),null!==this.stream&&(this.tearDown(),this.stream.close(),this.stream=null),this.state=t,n=this.listener,this.listener=null,t!==ei.Stopped?[2,n.onClose(e)]:[2]})})},t.prototype.tearDown=function(){},t.prototype.auth=function(){var t=this;c(this.state===ei.Initial,"Must be in initial state to auth"),this.state=ei.Auth,this.credentialsProvider.getToken(!1).then(function(e){t.startStream(e)},function(e){t.queue.enqueue(function(){return $t.__awaiter(t,void 0,void 0,function(){var t;return $t.__generator(this,function(n){return this.state!==ei.Stopped?(t=new oe(ie.UNKNOWN,"Fetching auth token failed: "+e.message),[2,this.handleStreamClose(t)]):[2]})})})})},t.prototype.startStream=function(t){var e=this;if(this.state!==ei.Stopped){c(this.state===ei.Auth,"Trying to start stream in a non-auth state");var n=function(t,n){e.queue.enqueue(function(){return $t.__awaiter(e,void 0,void 0,function(){return $t.__generator(this,function(e){return this.stream===t?[2,n()]:[2]})})})};if(null!==this.listener){var r=this.startRpc(t);this.stream=r,this.stream.onOpen(function(){n(r,function(){return c(e.state===ei.Auth,"Expected stream to be in state auth, but was "+e.state),e.state=ei.Open,e.listener.onOpen()})}),this.stream.onClose(function(t){n(r,function(){return e.handleStreamClose(t)})}),this.stream.onMessage(function(t){n(r,function(){return e.onMessage(t)})})}}},t.prototype.performBackoff=function(t){var e=this;c(this.state===ei.Error,"Should only perform backoff in an error case"),this.state=ei.Backoff,this.backoff.backoffAndRun(function(){return $t.__awaiter(e,void 0,void 0,function(){return $t.__generator(this,function(e){return this.state===ei.Stopped?[2]:(this.state=ei.Initial,this.start(t),c(this.isStarted(),"PersistentStream should have started"),[2])})})})},t.prototype.handleStreamClose=function(t){return c(this.isStarted(),"Can't handle server close on non-started stream"),o("PersistentStream","close with error: "+t),this.stream=null,this.close(ei.Error,t)},t}(),li=function(t){function e(e,n,r,i){var o=t.call(this,e,cr.ListenStreamConnectionBackoff,cr.ListenStreamIdle,n,r)||this;return o.serializer=i,o}return $t.__extends(e,t),e.prototype.startRpc=function(t){return this.connection.openStream("Listen",t)},e.prototype.onMessage=function(t){this.backoff.reset();var e=this.serializer.fromWatchChange(t),n=this.serializer.versionFromListenResponse(t);return this.listener.onWatchChange(e,n)},e.prototype.watch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.addTarget=this.serializer.toTarget(t);var n=this.serializer.toListenRequestLabels(t);n&&(e.labels=n),this.sendRequest(e)},e.prototype.unwatch=function(t){var e={};e.database=this.serializer.encodedDatabaseId,e.removeTarget=t,this.sendRequest(e)},e}(ci),hi=function(t){function e(e,n,r,i){var o=t.call(this,e,cr.WriteStreamConnectionBackoff,cr.WriteStreamIdle,n,r)||this;return o.serializer=i,o.handshakeComplete_=!1,o}return $t.__extends(e,t),Object.defineProperty(e.prototype,"handshakeComplete",{get:function(){return this.handshakeComplete_},enumerable:!0,configurable:!0}),e.prototype.start=function(e){this.handshakeComplete_=!1,t.prototype.start.call(this,e)},e.prototype.tearDown=function(){this.handshakeComplete_&&this.writeMutations([])},e.prototype.startRpc=function(t){return this.connection.openStream("Write",t)},e.prototype.onMessage=function(t){if(c(!!t.streamToken,"Got a write response without a stream token"),this.lastStreamToken=t.streamToken,this.handshakeComplete_){this.backoff.reset();var e=this.serializer.fromWriteResults(t.writeResults),n=this.serializer.fromVersion(t.commitTime);return this.listener.onMutationResult(n,e)}return c(!t.writeResults||0===t.writeResults.length,"Got mutation results for handshake"),this.handshakeComplete_=!0,this.listener.onHandshakeComplete()},e.prototype.writeHandshake=function(){c(this.isOpen(),"Writing handshake requires an opened stream"),c(!this.handshakeComplete_,"Handshake already completed");var t={};t.database=this.serializer.encodedDatabaseId,this.sendRequest(t)},e.prototype.writeMutations=function(t){var e=this;c(this.isOpen(),"Writing mutations requires an opened stream"),c(this.handshakeComplete_,"Handshake must be complete before writing mutations"),c(this.lastStreamToken.length>0,"Trying to write mutation without a token");var n={streamToken:this.lastStreamToken,writes:t.map(function(t){return e.serializer.toMutation(t)})};this.sendRequest(n)},e}(ci),fi=function(){function t(t,e,n,r){this.queue=t,this.connection=e,this.credentials=n,this.serializer=r}return t.prototype.newPersistentWriteStream=function(){return new hi(this.queue,this.connection,this.credentials,this.serializer)},t.prototype.newPersistentWatchStream=function(){return new li(this.queue,this.connection,this.credentials,this.serializer)},t.prototype.commit=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,writes:t.map(function(t){return e.serializer.toMutation(t)})};return this.invokeRPC("Commit",n).then(function(t){return e.serializer.fromWriteResults(t.writeResults)})},t.prototype.lookup=function(t){var e=this,n={database:this.serializer.encodedDatabaseId,documents:t.map(function(t){return e.serializer.toName(t)})};return this.invokeStreamingRPC("BatchGetDocuments",n).then(function(n){var r=tt();n.forEach(function(t){var n=e.serializer.fromMaybeDocument(t);r=r.insert(n.key,n)});var i=[];return t.forEach(function(t){var e=r.get(t);c(!!e,"Missing entity in write response for "+t),i.push(e)}),i})},t.prototype.invokeRPC=function(t,e){var n=this;return this.credentials.getToken(!1).then(function(r){return n.connection.invokeRPC(t,e,r)})},t.prototype.invokeStreamingRPC=function(t,e){var n=this;return this.credentials.getToken(!1).then(function(r){return n.connection.invokeStreamingRPC(t,e,r)})},t}(),di=function(){function t(t){this.datastore=t,this.readVersions=nt(),this.mutations=[],this.committed=!1}return t.prototype.recordVersion=function(t){var e=t.version;t instanceof be&&(e=rn.forDeletedDoc());var n=this.readVersions.get(t.key);if(null!==n){if(!e.isEqual(n))throw new oe(ie.ABORTED,"Document version changed between two reads.")}else this.readVersions=this.readVersions.insert(t.key,e)},t.prototype.lookup=function(t){var e=this;return this.committed?Promise.reject("Transaction has already completed."):this.mutations.length>0?Promise.reject("Transactions lookups are invalid after writes."):this.datastore.lookup(t).then(function(t){return t.forEach(function(t){return e.recordVersion(t)}),t})},t.prototype.write=function(t){if(this.committed)throw new oe(ie.FAILED_PRECONDITION,"Transaction has already completed.");this.mutations=this.mutations.concat(t)},t.prototype.precondition=function(t){var e=this.readVersions.get(t);return e?fn.updateTime(e):fn.NONE},t.prototype.preconditionForUpdate=function(t){var e=this.readVersions.get(t);if(e&&e.isEqual(rn.forDeletedDoc()))throw new oe(ie.FAILED_PRECONDITION,"Can't update a document that doesn't exist.");return e?fn.updateTime(e):fn.exists(!0)},t.prototype.set=function(t,e){this.write(e.toMutations(t,this.precondition(t)))},t.prototype.update=function(t,e){this.write(e.toMutations(t,this.preconditionForUpdate(t)))},t.prototype.delete=function(t){this.write([new vn(t,this.precondition(t))]),this.readVersions=this.readVersions.insert(t,rn.forDeletedDoc())},t.prototype.commit=function(){var t=this,e=this.readVersions;return this.mutations.forEach(function(t){e=e.remove(t.key)}),e.isEmpty()?this.datastore.commit(this.mutations).then(function(){t.committed=!0}):Promise.reject(Error("Every document read in a transaction must also be written."))},t}(),pi=function(){function t(t,e){this.asyncQueue=t,this.onlineStateHandler=e,this.state=zn.Unknown,this.watchStreamFailures=0,this.onlineStateTimer=null,this.shouldWarnClientIsOffline=!0}return t.prototype.handleWatchStreamStart=function(){var t=this;0===this.watchStreamFailures&&(this.setAndBroadcast(zn.Unknown),c(null===this.onlineStateTimer,"onlineStateTimer shouldn't be started yet"),this.onlineStateTimer=this.asyncQueue.enqueueAfterDelay(cr.OnlineStateTimeout,1e4,function(){return t.onlineStateTimer=null,c(t.state===zn.Unknown,"Timer should be canceled if we transitioned to a different state."),o("OnlineStateTracker","Watch stream didn't reach online or offline within 10000ms. Considering client offline."),t.logClientOfflineWarningIfNecessary(),t.setAndBroadcast(zn.Offline),Promise.resolve()}))},t.prototype.handleWatchStreamFailure=function(){this.state===zn.Online?(this.setAndBroadcast(zn.Unknown),c(0===this.watchStreamFailures,"watchStreamFailures must be 0"),c(null===this.onlineStateTimer,"onlineStateTimer must be null")):++this.watchStreamFailures>=2&&(this.clearOnlineStateTimer(),this.logClientOfflineWarningIfNecessary(),this.setAndBroadcast(zn.Offline))},t.prototype.set=function(t){this.clearOnlineStateTimer(),this.watchStreamFailures=0,t===zn.Online&&(this.shouldWarnClientIsOffline=!1),this.setAndBroadcast(t)},t.prototype.setAndBroadcast=function(t){t!==this.state&&(this.state=t,this.onlineStateHandler(t))},t.prototype.logClientOfflineWarningIfNecessary=function(){this.shouldWarnClientIsOffline&&(a("Could not reach Firestore backend."),this.shouldWarnClientIsOffline=!1)},t.prototype.clearOnlineStateTimer=function(){null!==this.onlineStateTimer&&(this.onlineStateTimer.cancel(),this.onlineStateTimer=null)},t}(),mi=function(){function t(t,e,n,r){this.localStore=t,this.datastore=e,this.pendingWrites=[],this.lastBatchSeen=gr,this.listenTargets={},this.pendingTargetResponses={},this.accumulatedWatchChanges=[],this.watchStream=null,this.writeStream=null,this.onlineStateTracker=new pi(n,r)}return t.prototype.start=function(){return this.enableNetwork()},t.prototype.isNetworkEnabled=function(){return c(null==this.watchStream===(null==this.writeStream),"WatchStream and WriteStream should both be null or non-null"),null!=this.watchStream},t.prototype.enableNetwork=function(){var t=this;return this.isNetworkEnabled()?Promise.resolve():(this.watchStream=this.datastore.newPersistentWatchStream(),this.writeStream=this.datastore.newPersistentWriteStream(),this.localStore.getLastStreamToken().then(function(e){return t.writeStream.lastStreamToken=e,t.shouldStartWatchStream()?t.startWatchStream():t.onlineStateTracker.set(zn.Unknown),t.fillWritePipeline()}))},t.prototype.disableNetwork=function(){return $t.__awaiter(this,void 0,void 0,function(){return $t.__generator(this,function(t){return this.disableNetworkInternal(),this.onlineStateTracker.set(zn.Offline),[2]})})},t.prototype.disableNetworkInternal=function(){this.isNetworkEnabled()&&(this.watchStream.stop(),this.writeStream.stop(),this.cleanUpWatchStreamState(),this.cleanUpWriteStreamState(),this.writeStream=null,this.watchStream=null)},t.prototype.shutdown=function(){return o("RemoteStore","RemoteStore shutting down."),this.disableNetworkInternal(),this.onlineStateTracker.set(zn.Unknown),Promise.resolve()},t.prototype.listen=function(t){c(!f(this.listenTargets,t.targetId),"listen called with duplicate targetId!"),this.listenTargets[t.targetId]=t,this.shouldStartWatchStream()?this.startWatchStream():this.isNetworkEnabled()&&this.watchStream.isOpen()&&this.sendWatchRequest(t)},t.prototype.unlisten=function(t){c(f(this.listenTargets,t),"unlisten called without assigned target ID!"),delete this.listenTargets[t],this.isNetworkEnabled()&&this.watchStream.isOpen()&&(this.sendUnwatchRequest(t),g(this.listenTargets)&&this.watchStream.markIdle())},t.prototype.sendWatchRequest=function(t){this.recordPendingTargetRequest(t.targetId),this.watchStream.watch(t)},t.prototype.sendUnwatchRequest=function(t){this.recordPendingTargetRequest(t),this.watchStream.unwatch(t)},t.prototype.recordPendingTargetRequest=function(t){this.pendingTargetResponses[t]=(this.pendingTargetResponses[t]||0)+1},t.prototype.startWatchStream=function(){c(this.shouldStartWatchStream(),"startWriteStream() called when shouldStartWatchStream() is false."),this.watchStream.start({onOpen:this.onWatchStreamOpen.bind(this),onClose:this.onWatchStreamClose.bind(this),onWatchChange:this.onWatchStreamChange.bind(this)}),this.onlineStateTracker.handleWatchStreamStart()},t.prototype.shouldStartWatchStream=function(){return this.isNetworkEnabled()&&!this.watchStream.isStarted()&&!g(this.listenTargets)},t.prototype.cleanUpWatchStreamState=function(){this.accumulatedWatchChanges=[],this.pendingTargetResponses={}},t.prototype.onWatchStreamOpen=function(){return $t.__awaiter(this,void 0,void 0,function(){var t=this;return $t.__generator(this,function(e){return p(this.listenTargets,function(e,n){t.sendWatchRequest(n)}),[2]})})},t.prototype.onWatchStreamClose=function(t){return $t.__awaiter(this,void 0,void 0,function(){return $t.__generator(this,function(t){return c(this.isNetworkEnabled(),"onWatchStreamClose() should only be called when the network is enabled"),this.cleanUpWatchStreamState(),this.onlineStateTracker.handleWatchStreamFailure(),this.shouldStartWatchStream()?this.startWatchStream():this.onlineStateTracker.set(zn.Unknown),[2]})})},t.prototype.onWatchStreamChange=function(t,e){return $t.__awaiter(this,void 0,void 0,function(){var n;return $t.__generator(this,function(r){return this.onlineStateTracker.set(zn.Online),t instanceof Nn&&t.state===Cn.Removed&&t.cause?[2,this.handleTargetError(t)]:(this.accumulatedWatchChanges.push(t),!e.isEqual(rn.MIN)&&e.compareTo(this.localStore.getLastRemoteSnapshotVersion())>=0?(n=this.accumulatedWatchChanges,this.accumulatedWatchChanges=[],[2,this.handleWatchChangeBatch(e,n)]):[2])})})},t.prototype.handleWatchChangeBatch=function(t,e){var n=this,r=new Dn(t,this.listenTargets,this.pendingTargetResponses);r.addChanges(e);var i=r.createRemoteEvent();this.pendingTargetResponses=r.pendingTargetResponses;var o=[];return p(r.existenceFilters,function(e,r){var a=n.listenTargets[e];if(a){var s=a.query;if(s.isDocumentQuery())if(0===r.count){var u=new ye(s.path),l=new be(u,t);i.addDocumentUpdate(l)}else c(1===r.count,"Single document existence filter with count: "+r.count);else{var h=n.localStore.remoteDocumentKeys(e).then(function(t){if(i.targetChanges[e]){var o=i.targetChanges[e].mapping;null!==o&&(o instanceof In?t=o.applyToKeySet(t):(c(o instanceof An,"Expected either reset or update mapping but got something else: "+o),t=o.documents))}if(t.size!==r.count){i.handleExistenceFilterMismatch(e);var u=new an(s,e,a.purpose);n.listenTargets[e]=u,n.sendUnwatchRequest(e);var l=new an(s,e,Me.ExistenceFilterMismatch);n.sendWatchRequest(l)}});o.push(h)}}}),Promise.all(o).then(function(){return p(i.targetChanges,function(t,e){if(e.resumeToken.length>0){var r=n.listenTargets[t];r&&(n.listenTargets[t]=r.update({resumeToken:e.resumeToken,snapshotVersion:e.snapshotVersion}))}}),n.syncEngine.applyRemoteEvent(i)})},t.prototype.handleTargetError=function(t){var e=this;c(!!t.cause,"Handling target error without a cause");var n=t.cause,r=Promise.resolve();return t.targetIds.forEach(function(t){r=r.then(function(){return $t.__awaiter(e,void 0,void 0,function(){return $t.__generator(this,function(e){return f(this.listenTargets,t)?(delete this.listenTargets[t],[2,this.syncEngine.rejectListen(t,n)]):[2]})})})}),r},t.prototype.cleanUpWriteStreamState=function(){this.lastBatchSeen=gr,o("RemoteStore","Stopping write stream with "+this.pendingWrites.length+" pending writes"),this.pendingWrites=[]},t.prototype.fillWritePipeline=function(){return $t.__awaiter(this,void 0,void 0,function(){var t=this;return $t.__generator(this,function(e){return this.canWriteMutations()?[2,this.localStore.nextMutationBatch(this.lastBatchSeen).then(function(e){if(null!==e)return t.commit(e),t.fillWritePipeline();0===t.pendingWrites.length&&t.writeStream.markIdle()})]:[2]})})},t.prototype.canWriteMutations=function(){return this.isNetworkEnabled()&&this.pendingWrites.length<10},t.prototype.outstandingWrites=function(){return this.pendingWrites.length},t.prototype.commit=function(t){c(this.canWriteMutations(),"commit called when batches can't be written"),this.lastBatchSeen=t.batchId,this.pendingWrites.push(t),this.shouldStartWriteStream()?this.startWriteStream():this.isNetworkEnabled()&&this.writeStream.handshakeComplete&&this.writeStream.writeMutations(t.mutations)},t.prototype.shouldStartWriteStream=function(){return this.isNetworkEnabled()&&!this.writeStream.isStarted()&&this.pendingWrites.length>0},t.prototype.startWriteStream=function(){c(this.shouldStartWriteStream(),"startWriteStream() called when shouldStartWriteStream() is false."),this.writeStream.start({onOpen:this.onWriteStreamOpen.bind(this),onClose:this.onWriteStreamClose.bind(this),onHandshakeComplete:this.onWriteHandshakeComplete.bind(this),onMutationResult:this.onMutationResult.bind(this)})},t.prototype.onWriteStreamOpen=function(){return $t.__awaiter(this,void 0,void 0,function(){return $t.__generator(this,function(t){return this.writeStream.writeHandshake(),[2]})})},t.prototype.onWriteHandshakeComplete=function(){var t=this;return this.localStore.setLastStreamToken(this.writeStream.lastStreamToken).then(function(){for(var e=0,n=t.pendingWrites;e<n.length;e++){var r=n[e];t.writeStream.writeMutations(r.mutations)}})},t.prototype.onMutationResult=function(t,e){var n=this;c(this.pendingWrites.length>0,"Got result for empty pending writes");var r=this.pendingWrites.shift(),i=yr.from(r,t,e,this.writeStream.lastStreamToken);return this.syncEngine.applySuccessfulWrite(i).then(function(){return n.fillWritePipeline()})},t.prototype.onWriteStreamClose=function(t){return $t.__awaiter(this,void 0,void 0,function(){var e,n=this;return $t.__generator(this,function(r){return c(this.isNetworkEnabled(),"onWriteStreamClose() should only be called when the network is enabled"),t&&this.pendingWrites.length>0?(c(!!t,"We have pending writes, but the write stream closed without an error"),e=void 0,e=this.writeStream.handshakeComplete?this.handleWriteError(t):this.handleHandshakeError(t),[2,e.then(function(){n.shouldStartWriteStream()&&n.startWriteStream()})]):[2]})})},t.prototype.handleHandshakeError=function(t){return $t.__awaiter(this,void 0,void 0,function(){return $t.__generator(this,function(e){return Q(t.code)||t.code===ie.ABORTED?(o("RemoteStore","RemoteStore error before completed handshake; resetting stream token: ",this.writeStream.lastStreamToken),this.writeStream.lastStreamToken=l(),[2,this.localStore.setLastStreamToken(l())]):[2]})})},t.prototype.handleWriteError=function(t){return $t.__awaiter(this,void 0,void 0,function(){var e,n=this;return $t.__generator(this,function(r){return Q(t.code)?(e=this.pendingWrites.shift(),this.writeStream.inhibitBackoff(),[2,this.syncEngine.rejectFailedWrite(e.batchId,t).then(function(){return n.fillWritePipeline()})]):[2]})})},t.prototype.createTransaction=function(){return new di(this.datastore)},t.prototype.handleUserChange=function(t){if(o("RemoteStore","RemoteStore changing users: uid=",t.uid),this.isNetworkEnabled())return this.disableNetworkInternal(),this.onlineStateTracker.set(zn.Unknown),this.enableNetwork()},t}(),gi=function(){function t(t,e,n,r){this.platform=t,this.databaseInfo=e,this.credentials=n,this.asyncQueue=r}return t.prototype.start=function(t){var e=this,n=new ti,r=new ti,i=!1;return this.credentials.setUserChangeListener(function(o){i?e.asyncQueue.enqueue(function(){return e.handleUserChange(o)}):(i=!0,e.initializePersistence(t,r).then(function(){return e.initializeRest(o)}).then(n.resolve,n.reject))}),this.asyncQueue.enqueue(function(){return n.promise}),r.promise},t.prototype.enableNetwork=function(){var t=this;return this.asyncQueue.enqueue(function(){return t.remoteStore.enableNetwork()})},t.prototype.initializePersistence=function(t,e){var n=this;return t?this.startIndexedDbPersistence().then(e.resolve).catch(function(t){return e.reject(t),n.canFallback(t)?(console.warn("Error enabling offline storage. Falling back to storage disabled: "+t),n.startMemoryPersistence()):Promise.reject(t)}):(e.resolve(),this.startMemoryPersistence())},t.prototype.canFallback=function(t){return t.code===ie.FAILED_PRECONDITION||t.code===ie.UNIMPLEMENTED},t.prototype.startIndexedDbPersistence=function(){this.garbageCollector=new $r;var t=zr.buildStoragePrefix(this.databaseInfo),e=new Un(this.databaseInfo.databaseId,{useProto3Json:!0});return this.persistence=new zr(t,e),this.persistence.start()},t.prototype.startMemoryPersistence=function(){return this.garbageCollector=new ir,this.persistence=new Jr,this.persistence.start()},t.prototype.initializeRest=function(t){var e=this;return this.platform.loadConnection(this.databaseInfo).then(function(n){e.localStore=new Yr(e.persistence,t,e.garbageCollector);var r=e.platform.newSerializer(e.databaseInfo.databaseId),i=new fi(e.asyncQueue,n,e.credentials,r),o=function(t){e.syncEngine.applyOnlineStateChange(t),e.eventMgr.applyOnlineStateChange(t)};return e.remoteStore=new mi(e.localStore,i,e.asyncQueue,o),e.syncEngine=new mr(e.localStore,e.remoteStore,t),e.remoteStore.syncEngine=e.syncEngine,e.eventMgr=new er(e.syncEngine),e.localStore.start()}).then(function(){return e.remoteStore.start()})},t.prototype.handleUserChange=function(t){return this.asyncQueue.verifyOperationInProgress(),o("FirestoreClient","User Changed: "+t.uid),this.syncEngine.handleUserChange(t)},t.prototype.disableNetwork=function(){var t=this;return this.asyncQueue.enqueue(function(){return t.remoteStore.disableNetwork()})},t.prototype.shutdown=function(){var t=this;return this.asyncQueue.enqueue(function(){return t.credentials.removeUserChangeListener(),t.remoteStore.shutdown()}).then(function(){return t.persistence.shutdown()})},t.prototype.listen=function(t,e,n){var r=this,i=new nr(t,e,n);return this.asyncQueue.enqueue(function(){return r.eventMgr.listen(i)}),i},t.prototype.unlisten=function(t){var e=this;this.asyncQueue.enqueue(function(){return e.eventMgr.unlisten(t)})},t.prototype.getDocumentFromLocalCache=function(t){var e=this;return this.asyncQueue.enqueue(function(){return e.localStore.readDocument(t)}).then(function(t){if(t instanceof _e)return t;throw new oe(ie.UNAVAILABLE,"Failed to get document from cache. (However, this document may exist on the server. Run again without setting 'source' in the GetOptions to attempt to retrieve the document from the server.)")})},t.prototype.getDocumentsFromLocalCache=function(t){var e=this;return this.asyncQueue.enqueue(function(){return e.localStore.executeQuery(t)}).then(function(e){var n=rt(),r=new dr(t,n),i=r.computeDocChanges(e);return r.applyChanges(i).snapshot})},t.prototype.write=function(t){var e=this,n=new ti;return this.asyncQueue.enqueue(function(){return e.syncEngine.write(t,n)}),n.promise},t.prototype.databaseId=function(){return this.databaseInfo.databaseId},t.prototype.transaction=function(t){var e=this;return this.asyncQueue.enqueue(function(){return $t.__awaiter(e,void 0,void 0,function(){return $t.__generator(this,function(t){return[2]})})}).then(function(){return e.syncEngine.runTransaction(t)})},t}(),vi=function(){function t(t){this.observer=t,this.muted=!1}return t.prototype.next=function(t){this.scheduleEvent(this.observer.next,t)},t.prototype.error=function(t){this.scheduleEvent(this.observer.error,t)},t.prototype.mute=function(){this.muted=!0},t.prototype.scheduleEvent=function(t,e){var n=this;this.muted||setTimeout(function(){n.muted||t(e)},0)},t}(),yi=function(){function t(t){this.uid=t}return t.prototype.isAuthenticated=function(){return null!=this.uid},t.prototype.toKey=function(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"},t.prototype.isEqual=function(t){return t.uid===this.uid},t.UNAUTHENTICATED=new t(null),t.GOOGLE_CREDENTIALS=new t("google-credentials-uid"),t.FIRST_PARTY=new t("first-party-uid"),t}(),_i=function(){function t(t,e){this.user=e,this.type="OAuth",this.authHeaders={Authorization:"Bearer "+t}}return t}(),bi=function(){function t(){this.userListener=null}return t.prototype.getToken=function(t){return Promise.resolve(null)},t.prototype.setUserChangeListener=function(t){c(!this.userListener,"Can only call setUserChangeListener() once."),this.userListener=t,t(yi.UNAUTHENTICATED)},t.prototype.removeUserChangeListener=function(){c(null!==this.userListener,"removeUserChangeListener() when no listener registered"),this.userListener=null},t}(),wi=function(){function t(t){var e=this;this.app=t,this.tokenListener=null,this.userCounter=0,this.userListener=null,this.tokenListener=function(){var t=e.getUser();e.currentUser&&t.isEqual(e.currentUser)||(e.currentUser=t,e.userCounter++,e.userListener&&e.userListener(e.currentUser))},this.userCounter=0,this.app.INTERNAL.addAuthTokenListener(this.tokenListener)}return t.prototype.getToken=function(t){var e=this;c(null!=this.tokenListener,"getToken cannot be called after listener removed.");var n=this.userCounter;return this.app.INTERNAL.getToken(t).then(function(t){if(e.userCounter!==n)throw new oe(ie.ABORTED,"getToken aborted due to uid change.");return t?(c("string"===typeof t.accessToken,"Invalid tokenData returned from getToken():"+t),new _i(t.accessToken,e.currentUser)):null})},t.prototype.setUserChangeListener=function(t){c(!this.userListener,"Can only call setUserChangeListener() once."),this.userListener=t,this.currentUser&&t(this.currentUser)},t.prototype.removeUserChangeListener=function(){c(null!=this.tokenListener,"removeUserChangeListener() called twice"),c(null!==this.userListener,"removeUserChangeListener() called when no listener registered"),this.app.INTERNAL.removeAuthTokenListener(this.tokenListener),this.tokenListener=null,this.userListener=null},t.prototype.getUser=function(){"function"!==typeof this.app.INTERNAL.getUid&&u("This version of the Firestore SDK requires at least version 3.7.0 of firebase.js.");var t=this.app.INTERNAL.getUid();return c(null===t||"string"===typeof t,"Received invalid UID: "+t),new yi(t)},t}(),Ei=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,this.type="FirstParty",this.user=yi.FIRST_PARTY,c(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return Object.defineProperty(t.prototype,"authHeaders",{get:function(){return{Authorization:this.gapi.auth.getAuthHeaderValueForFirstParty([]),"X-Goog-AuthUser":this.sessionIndex}},enumerable:!0,configurable:!0}),t}(),xi=function(){function t(t,e){this.gapi=t,this.sessionIndex=e,c(this.gapi&&this.gapi.auth&&this.gapi.auth.getAuthHeaderValueForFirstParty,"unexpected gapi interface")}return t.prototype.getToken=function(t){return Promise.resolve(new Ei(this.gapi,this.sessionIndex))},t.prototype.setUserChangeListener=function(t){t(yi.FIRST_PARTY)},t.prototype.removeUserChangeListener=function(){},t}(),Ti=function(){function t(t){this.methodName=t}return t.delete=function(){return Si.instance},t.serverTimestamp=function(){return Ci.instance},t.prototype.isEqual=function(t){return this===t},t}(),Si=function(t){function e(){return t.call(this,"FieldValue.delete()")||this}return $t.__extends(e,t),e.instance=new e,e}(Ti),Ci=function(t){function e(){return t.call(this,"FieldValue.serverTimestamp()")||this}return $t.__extends(e,t),e.instance=new e,e}(Ti),Mi=h(Ti,"Use FieldValue.<field>() instead."),Ai=/^__.*__$/,Ii=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[];return null!==this.fieldMask?n.push(new mn(t,this.data,this.fieldMask,e)):n.push(new pn(t,this.data,e)),this.fieldTransforms.length>0&&n.push(new gn(t,this.fieldTransforms)),n},t}(),Ri=function(){function t(t,e,n){this.data=t,this.fieldMask=e,this.fieldTransforms=n}return t.prototype.toMutations=function(t,e){var n=[new mn(t,this.data,this.fieldMask,e)];return this.fieldTransforms.length>0&&n.push(new gn(t,this.fieldTransforms)),n},t}();!function(t){t[t.Set=0]="Set",t[t.Update=1]="Update",t[t.MergeSet=2]="MergeSet",t[t.QueryValue=3]="QueryValue"}(oi||(oi={}));var Pi=function(){function t(t,e,n,r,i,o){this.dataSource=t,this.methodName=e,this.path=n,this.arrayElement=r,void 0===i&&this.validatePath(),this.arrayElement=void 0!==r&&r,this.fieldTransforms=i||[],this.fieldMask=o||[]}return t.prototype.childContextForField=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePathSegment(e),r},t.prototype.childContextForFieldPath=function(e){var n=null==this.path?null:this.path.child(e),r=new t(this.dataSource,this.methodName,n,!1,this.fieldTransforms,this.fieldMask);return r.validatePath(),r},t.prototype.childContextForArray=function(e){return new t(this.dataSource,this.methodName,null,!0,this.fieldTransforms,this.fieldMask)},t.prototype.createError=function(t){var e=null===this.path||this.path.isEmpty()?"":" (found in field "+this.path.toString()+")";return new oe(ie.INVALID_ARGUMENT,"Function "+this.methodName+"() called with invalid data. "+t+e)},t.prototype.validatePath=function(){if(null!==this.path)for(var t=0;t<this.path.length;t++)this.validatePathSegment(this.path.get(t))},t.prototype.validatePathSegment=function(t){if(Ut(this.dataSource)&&Ai.test(t))throw this.createError("Document fields cannot begin and end with __")},t}(),Ni=function(){function t(t,e){this.databaseId=t,this.key=e}return t}(),Di=function(){function t(t){this.preConverter=t}return t.prototype.parseSetData=function(t,e){var n=new Pi(oi.Set,t,ve.EMPTY_PATH);Bt("Data must be an object, but it was:",n,e);var r=this.parseData(e,n);return new Ii(r,null,n.fieldTransforms)},t.prototype.parseMergeData=function(t,e){var n=new Pi(oi.MergeSet,t,ve.EMPTY_PATH);Bt("Data must be an object, but it was:",n,e);var r=this.parseData(e,n),i=new sn(n.fieldMask);return new Ii(r,i,n.fieldTransforms)},t.prototype.parseUpdateData=function(t,e){var n=this,r=new Pi(oi.Update,t,ve.EMPTY_PATH);Bt("Data must be an object, but it was:",r,e);var i=[],o=je.EMPTY;m(e,function(e,a){var s=jt(t,e),u=r.childContextForFieldPath(s);if((a=n.runPreConverter(a,u))instanceof Si)i.push(s);else{var c=n.parseData(a,u);null!=c&&(i.push(s),o=o.set(s,c))}});var a=new sn(i);return new Ri(o,a,r.fieldTransforms)},t.prototype.parseUpdateVarargs=function(t,e,n,r){var i=new Pi(oi.Update,t,ve.EMPTY_PATH),o=[Vt(t,e)],a=[n];if(r.length%2!==0)throw new oe(ie.INVALID_ARGUMENT,"Function "+t+"() needs to be called with an even number of arguments that alternate between field names and values.");for(var s=0;s<r.length;s+=2)o.push(Vt(t,r[s])),a.push(r[s+1]);for(var u=[],c=je.EMPTY,s=0;s<o.length;++s){var l=o[s],h=i.childContextForFieldPath(l),f=this.runPreConverter(a[s],h);if(f instanceof Si)u.push(l);else{var d=this.parseData(f,h);null!=d&&(u.push(l),c=c.set(l,d))}}var p=new sn(u);return new Ri(c,p,i.fieldTransforms)},t.prototype.parseQueryValue=function(t,e){var n=new Pi(oi.QueryValue,t,ve.EMPTY_PATH),r=this.parseData(e,n);return c(null!=r,"Parsed data should not be null."),c(0===n.fieldTransforms.length,"Field transforms should have been disallowed."),r},t.prototype.runPreConverter=function(t,e){try{return this.preConverter(t)}catch(t){var n=Ht(t);throw e.createError(n)}},t.prototype.parseData=function(t,e){if(t=this.runPreConverter(t,e),Ft(t))return Bt("Unsupported field value:",e,t),this.parseObject(t,e);if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.arrayElement)throw e.createError("Nested arrays are not supported");return this.parseArray(t,e)}return t instanceof Ti?(this.parseSentinelFieldValue(t,e),null):this.parseScalarValue(t,e)},t.prototype.parseObject=function(t,e){var n=this,r=new we(U);return m(t,function(t,i){var o=n.parseData(i,e.childContextForField(t));null!=o&&(r=r.insert(t,o))}),new je(r)},t.prototype.parseArray=function(t,e){for(var n=[],r=0,i=0,o=t;i<o.length;i++){var a=o[i],s=this.parseData(a,e.childContextForArray(r));null==s&&(s=Re.INSTANCE),n.push(s),r++}return new He(n)},t.prototype.parseSentinelFieldValue=function(t,e){if(!Ut(e.dataSource))throw e.createError(t.methodName+" can only be used with update() and set()");if(null===e.path)throw e.createError(t.methodName+" is not currently supported inside arrays");if(t instanceof Si){if(e.dataSource!==oi.MergeSet)throw e.dataSource===oi.Update?(c(e.path.length>0,"FieldValue.delete() at the top level should have already been handled."),e.createError("FieldValue.delete() can only appear at the top level of your update data")):e.createError("FieldValue.delete() cannot be used with set() unless you pass {merge:true}")}else t instanceof Ci?e.fieldTransforms.push(new cn(e.path,un.instance)):u("Unknown FieldValue type: "+t)},t.prototype.parseScalarValue=function(t,e){if(null===t)return Re.INSTANCE;if("number"===typeof t)return Y(t)?new De(t):new Oe(t);if("boolean"===typeof t)return Pe.of(t);if("string"===typeof t)return new ke(t);if(t instanceof Date)return new Le(le.fromDate(t));if(t instanceof le)return new Le(new le(t.seconds,1e3*Math.floor(t.nanoseconds/1e3)));if(t instanceof ce)return new Ve(t);if(t instanceof se)return new Fe(t);if(t instanceof Ni)return new Be(t.databaseId,t.key);throw e.createError("Unsupported field value: "+R(t))},t}(),Oi="firestore.googleapis.com",ki=!0,Li=!1,Ui=function(){function t(t){if(void 0===t.host){if(void 0!==t.ssl)throw new oe(ie.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=Oi,this.ssl=ki}else T("settings","string","host",t.host),this.host=t.host,S("settings","boolean","ssl",t.ssl),this.ssl=d(t.ssl,ki);D("settings",t,["host","ssl","credentials","timestampsInSnapshots"]),S("settings","object","credentials",t.credentials),this.credentials=t.credentials,S("settings","boolean","timestampsInSnapshots",t.timestampsInSnapshots),this.timestampsInSnapshots=d(t.timestampsInSnapshots,Li)}return t.prototype.isEqual=function(t){return this.host===t.host&&this.ssl===t.ssl&&this.timestampsInSnapshots===t.timestampsInSnapshots&&this.credentials===t.credentials},t}(),Fi=function(){function t(){}return t}(),Bi=function(){function t(e){var n=this;this._queue=new ri,this.INTERNAL={delete:function(){return $t.__awaiter(n,void 0,void 0,function(){return $t.__generator(this,function(t){return this._firestoreClient?[2,this._firestoreClient.shutdown()]:[2]})})}};var r=new Fi;if("object"===typeof e.options){var i=e;r.firebaseApp=i,r.databaseId=t.databaseIdFromApp(i),r.persistenceKey=r.firebaseApp.name,r.credentials=new wi(i)}else{var o=e;if(!o.projectId)throw new oe(ie.INVALID_ARGUMENT,"Must provide projectId");r.databaseId=new de(o.projectId,o.database),r.persistenceKey="[DEFAULT]",r.credentials=new bi}r.settings=new Ui({}),this._config=r,this._databaseId=r.databaseId}return t.prototype.settings=function(t){if(y("Firestore.settings",arguments,1),E("Firestore.settings","object",1,t),f(t,"persistence"))throw new oe(ie.INVALID_ARGUMENT,'"persistence" is now specified with a separate call to firestore.enablePersistence().');var e=new Ui(t);if(this._firestoreClient&&!this._config.settings.isEqual(e))throw new oe(ie.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only call settings() before calling any other methods on a Firestore object.");this._config.settings=e,void 0!==e.credentials&&(this._config.credentials=Ot(e.credentials))},t.prototype.enableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.enableNetwork()},t.prototype.disableNetwork=function(){return this.ensureClientConfigured(),this._firestoreClient.disableNetwork()},t.prototype.enablePersistence=function(){if(this._firestoreClient)throw new oe(ie.FAILED_PRECONDITION,"Firestore has already been started and persistence can no longer be enabled. You can only call enablePersistence() before calling any other methods on a Firestore object.");return this.configureClient(!0)},t.prototype.ensureClientConfigured=function(){return this._firestoreClient||this.configureClient(!1),this._firestoreClient},t.prototype.configureClient=function(t){var e=this;c(!!this._config.settings.host,"FirestoreSettings.host cannot be falsey"),this._config.settings.timestampsInSnapshots||a("\nThe behavior for Date objects stored in Firestore is going to change\nAND YOUR APP MAY BREAK.\nTo hide this warning and ensure your app does not break, you need to add the\nfollowing code to your app before calling any other Cloud Firestore methods:\n\n  const firestore = firebase.firestore();\n  const settings = {/* your settings... */ timestampsInSnapshots: true};\n  firestore.settings(settings);\n\nWith this change, timestamps stored in Cloud Firestore will be read back as\nFirebase Timestamp objects instead of as system Date objects. So you will also\nneed to update code expecting a Date to instead expect a Timestamp. For example:\n\n  // Old:\n  const date = snapshot.get('created_at');\n  // New:\n  const timestamp = snapshot.get('created_at');\n  const date = timestamp.toDate();\n\nPlease audit all existing usages of Date when you enable the new behavior. In a\nfuture release, the behavior will change to the new behavior, so if you do not\nfollow these steps, YOUR APP MAY BREAK."),c(!this._firestoreClient,"configureClient() called multiple times");var n=new he(this._config.databaseId,this._config.persistenceKey,this._config.settings.host,this._config.settings.ssl),r=function(t){if(t instanceof Hi){var n=e._config.databaseId,r=t.firestore._config.databaseId;if(!r.isEqual(n))throw new oe(ie.INVALID_ARGUMENT,"Document reference is for database "+r.projectId+"/"+r.database+" but should be for database "+n.projectId+"/"+n.database);return new Ni(e._config.databaseId,t._key)}return t};return this._dataConverter=new Di(r),this._firestoreClient=new gi(re.getPlatform(),n,this._config.credentials,this._queue),this._firestoreClient.start(t)},t.databaseIdFromApp=function(t){var e=t.options;if(!f(e,"projectId")){if(f(e,"firestoreId"))throw new oe(ie.INVALID_ARGUMENT,'"firestoreId" is now specified as "projectId" in firebase.initializeApp.');throw new oe(ie.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.')}if(f(e,"firestoreOptions"))throw new oe(ie.INVALID_ARGUMENT,'"firestoreOptions" values are now specified with Firestore.settings()');var n=e.projectId;if(!n||"string"!==typeof n)throw new oe(ie.INVALID_ARGUMENT,"projectId must be a string in FirebaseApp.options");return new de(n)},Object.defineProperty(t.prototype,"app",{get:function(){if(!this._config.firebaseApp)throw new oe(ie.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._config.firebaseApp},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(y("Firestore.collection",arguments,1),E("Firestore.collection","string",1,t),!t)throw new oe(ie.INVALID_ARGUMENT,"Must provide a non-empty collection path to collection()");return this.ensureClientConfigured(),new Ki(me.fromString(t),this)},t.prototype.doc=function(t){if(y("Firestore.doc",arguments,1),E("Firestore.doc","string",1,t),!t)throw new oe(ie.INVALID_ARGUMENT,"Must provide a non-empty document path to doc()");return this.ensureClientConfigured(),Hi.forPath(me.fromString(t),this)},t.prototype.runTransaction=function(t){var e=this;return y("Firestore.runTransaction",arguments,1),E("Firestore.runTransaction","function",1,t),this.ensureClientConfigured().transaction(function(n){return t(new Vi(e,n))})},t.prototype.batch=function(){return this.ensureClientConfigured(),new ji(this)},Object.defineProperty(t,"logLevel",{get:function(){switch(r()){case Xt.DEBUG:return"debug";case Xt.ERROR:return"error";case Xt.SILENT:return"silent";default:return u("Unknown log level: "+r())}},enumerable:!0,configurable:!0}),t.setLogLevel=function(t){switch(y("Firestore.setLogLevel",arguments,1),E("Firestore.setLogLevel","string",1,t),t){case"debug":i(Xt.DEBUG);break;case"error":i(Xt.ERROR);break;case"silent":i(Xt.SILENT);break;default:throw new oe(ie.INVALID_ARGUMENT,"Invalid log level: "+t)}},t.prototype._areTimestampsInSnapshotsEnabled=function(){return this._config.settings.timestampsInSnapshots},t}(),Vi=function(){function t(t,e){this._firestore=t,this._transaction=e}return t.prototype.get=function(t){var e=this;y("Transaction.get",arguments,1);var n=Wt("Transaction.get",t,this._firestore);return this._transaction.lookup([n._key]).then(function(t){if(!t||1!==t.length)return u("Mismatch in docs returned from document lookup.");var r=t[0];return r instanceof be?new zi(e._firestore,n._key,null,!1):new zi(e._firestore,n._key,r,!1)})},t.prototype.set=function(t,e,n){b("Transaction.set",arguments,2,3);var r=Wt("Transaction.set",t,this._firestore);n=Gt("Transaction.set",n);var i=n.merge?this._firestore._dataConverter.parseMergeData("Transaction.set",e):this._firestore._dataConverter.parseSetData("Transaction.set",e);return this._transaction.set(r._key,i),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];var o,a;return"string"===typeof e||e instanceof Wn?(_("Transaction.update",arguments,3),o=Wt("Transaction.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateVarargs("Transaction.update",e,n,r)):(y("Transaction.update",arguments,2),o=Wt("Transaction.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateData("Transaction.update",e)),this._transaction.update(o._key,a),this},t.prototype.delete=function(t){y("Transaction.delete",arguments,1);var e=Wt("Transaction.delete",t,this._firestore);return this._transaction.delete(e._key),this},t}(),ji=function(){function t(t){this._firestore=t,this._mutations=[],this._committed=!1}return t.prototype.set=function(t,e,n){b("WriteBatch.set",arguments,2,3),this.verifyNotCommitted();var r=Wt("WriteBatch.set",t,this._firestore);n=Gt("WriteBatch.set",n);var i=n.merge?this._firestore._dataConverter.parseMergeData("WriteBatch.set",e):this._firestore._dataConverter.parseSetData("WriteBatch.set",e);return this._mutations=this._mutations.concat(i.toMutations(r._key,fn.NONE)),this},t.prototype.update=function(t,e,n){for(var r=[],i=3;i<arguments.length;i++)r[i-3]=arguments[i];this.verifyNotCommitted();var o,a;return"string"===typeof e||e instanceof Wn?(_("WriteBatch.update",arguments,3),o=Wt("WriteBatch.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateVarargs("WriteBatch.update",e,n,r)):(y("WriteBatch.update",arguments,2),o=Wt("WriteBatch.update",t,this._firestore),a=this._firestore._dataConverter.parseUpdateData("WriteBatch.update",e)),this._mutations=this._mutations.concat(a.toMutations(o._key,fn.exists(!0))),this},t.prototype.delete=function(t){y("WriteBatch.delete",arguments,1),this.verifyNotCommitted();var e=Wt("WriteBatch.delete",t,this._firestore);return this._mutations=this._mutations.concat(new vn(e._key,fn.NONE)),this},t.prototype.commit=function(){return $t.__awaiter(this,void 0,void 0,function(){return $t.__generator(this,function(t){return this.verifyNotCommitted(),this._committed=!0,this._mutations.length>0?[2,this._firestore.ensureClientConfigured().write(this._mutations)]:[2]})})},t.prototype.verifyNotCommitted=function(){if(this._committed)throw new oe(ie.FAILED_PRECONDITION,"A write batch can no longer be used after commit() has been called.")},t}(),Hi=function(){function t(t,e){this._key=t,this.firestore=e,this._firestoreClient=this.firestore.ensureClientConfigured()}return t.forPath=function(e,n){if(e.length%2!==0)throw new oe(ie.INVALID_ARGUMENT,"Invalid document reference. Document references must have an even number of segments, but "+e.canonicalString()+" has "+e.length);return new t(new ye(e),n)},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"parent",{get:function(){return new Ki(this._key.path.popLast(),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"path",{get:function(){return this._key.path.canonicalString()},enumerable:!0,configurable:!0}),t.prototype.collection=function(t){if(y("DocumentReference.collection",arguments,1),E("DocumentReference.collection","string",1,t),!t)throw new oe(ie.INVALID_ARGUMENT,"Must provide a non-empty collection name to collection()");var e=me.fromString(t);return new Ki(this._key.path.child(e),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw O("isEqual","DocumentReference",1,e);return this.firestore===e.firestore&&this._key.isEqual(e._key)},t.prototype.set=function(t,e){b("DocumentReference.set",arguments,1,2),e=Gt("DocumentReference.set",e);var n=e.merge?this.firestore._dataConverter.parseMergeData("DocumentReference.set",t):this.firestore._dataConverter.parseSetData("DocumentReference.set",t);return this._firestoreClient.write(n.toMutations(this._key,fn.NONE))},t.prototype.update=function(t,e){for(var n=[],r=2;r<arguments.length;r++)n[r-2]=arguments[r];var i;return"string"===typeof t||t instanceof Wn?(_("DocumentReference.update",arguments,2),i=this.firestore._dataConverter.parseUpdateVarargs("DocumentReference.update",t,e,n)):(y("DocumentReference.update",arguments,1),i=this.firestore._dataConverter.parseUpdateData("DocumentReference.update",t)),this._firestoreClient.write(i.toMutations(this._key,fn.exists(!0)))},t.prototype.delete=function(){return y("DocumentReference.delete",arguments,0),this._firestoreClient.write([new vn(this._key,fn.NONE)])},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];b("DocumentReference.onSnapshot",arguments,1,4);var n,r={includeMetadataChanges:!1},i=0;"object"!==typeof t[i]||kt(t[i])||(r=t[i],D("DocumentReference.onSnapshot",r,["includeMetadataChanges"]),S("DocumentReference.onSnapshot","boolean","includeMetadataChanges",r.includeMetadataChanges),i++);var o={includeDocumentMetadataChanges:r.includeMetadataChanges,includeQueryMetadataChanges:r.includeMetadataChanges};return kt(t[i])?n=t[i]:(E("DocumentReference.onSnapshot","function",i,t[i]),x("DocumentReference.onSnapshot","function",i+1,t[i+1]),x("DocumentReference.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(o,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new vi({next:function(t){if(e.next){c(t.docs.size<=1,"Too many documents returned on a document query");var r=t.docs.get(n._key);e.next(new zi(n.firestore,n._key,r,t.fromCache))}},error:r}),o=this._firestoreClient.listen(Ye.atPath(this._key.path),i,t);return function(){i.mute(),n._firestoreClient.unlisten(o)}},t.prototype.get=function(t){var e=this;return D("DocumentReference.get",t,["source"]),t&&M("DocumentReference.get","options","source",t.source,["default","server","cache"]),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentFromLocalCache(e._key).then(function(t){n(new zi(e.firestore,e._key,t,!0))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeQueryMetadataChanges:!0,includeDocumentMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),!i.exists&&i.metadata.fromCache?e(new oe(ie.UNAVAILABLE,"Failed to get document because the client is offline.")):i.exists&&i.metadata.fromCache&&n&&"server"===n.source?e(new oe(ie.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):t(i)},error:e})},t}(),Gi=function(){function t(t,e){this.hasPendingWrites=t,this.fromCache=e}return t.prototype.isEqual=function(t){return this.hasPendingWrites===t.hasPendingWrites&&this.fromCache===t.fromCache},t}(),zi=function(){function t(t,e,n,r){this._firestore=t,this._key=e,this._document=n,this._fromCache=r}return t.prototype.data=function(t){return b("DocumentSnapshot.data",arguments,0,1),t=zt("DocumentSnapshot.data",t),this._document?this.convertObject(this._document.data,Ae.fromSnapshotOptions(t,this._firestore._areTimestampsInSnapshotsEnabled())):void 0},t.prototype.get=function(t,e){if(b("DocumentSnapshot.get",arguments,1,2),e=zt("DocumentSnapshot.get",e),this._document){var n=this._document.data.field(Vt("DocumentSnapshot.get",t));if(void 0!==n)return this.convertValue(n,Ae.fromSnapshotOptions(e,this._firestore._areTimestampsInSnapshotsEnabled()))}},Object.defineProperty(t.prototype,"id",{get:function(){return this._key.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"ref",{get:function(){return new Hi(this._key,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"exists",{get:function(){return null!==this._document},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"metadata",{get:function(){return new Gi(null!==this._document&&this._document.hasLocalMutations,this._fromCache)},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw O("isEqual","DocumentSnapshot",1,e);return this._firestore===e._firestore&&this._fromCache===e._fromCache&&this._key.isEqual(e._key)&&(null===this._document?null===e._document:this._document.isEqual(e._document))},t.prototype.convertObject=function(t,e){var n=this,r={};return t.forEach(function(t,i){r[t]=n.convertValue(i,e)}),r},t.prototype.convertValue=function(t,e){if(t instanceof je)return this.convertObject(t,e);if(t instanceof He)return this.convertArray(t,e);if(t instanceof Be){var n=t.value(e),r=this._firestore.ensureClientConfigured().databaseId();return t.databaseId.isEqual(r)||a("Document "+this._key.path+" contains a document reference within a different database ("+t.databaseId.projectId+"/"+t.databaseId.database+") which is not supported. It will be treated as a reference in the current database ("+r.projectId+"/"+r.database+") instead."),new Hi(n,this._firestore)}return t.value(e)},t.prototype.convertArray=function(t,e){var n=this;return t.internalValue.map(function(t){return n.convertValue(t,e)})},t}(),Wi=function(t){function e(e,n,r,i){return t.call(this,e,n,r,i)||this}return $t.__extends(e,t),e.prototype.data=function(e){var n=t.prototype.data.call(this,e);return c("object"===typeof n,"Document in a QueryDocumentSnapshot should exist"),n},e}(zi),qi=function(){function t(t,e){this._query=t,this.firestore=e}return t.prototype.where=function(e,n,r){y("Query.where",arguments,3),E("Query.where","string",2,n),N("Query.where",3,r);var i,o=Vt("Query.where",e);if(o.isKeyField())if("string"===typeof r){if(-1!==r.indexOf("/"))throw new oe(ie.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it contains a slash.");if(""===r)throw new oe(ie.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a valid document ID if the first parameter is FieldPath.documentId(), but it was an empty string.");var a=this._query.path.child(new me([r]));c(a.length%2===0,"Path should be a document key"),i=new Be(this.firestore._databaseId,new ye(a))}else{if(!(r instanceof Hi))throw new oe(ie.INVALID_ARGUMENT,"Function Query.where() requires its third parameter to be a string or a DocumentReference if the first parameter is FieldPath.documentId(), but it was: "+R(r)+".");var s=r;i=new Be(this.firestore._databaseId,s._key)}else i=this.firestore._dataConverter.parseQueryValue("Query.where",r);var u=K(o,Ke.fromString(n),i);return this.validateNewFilter(u),new t(this._query.addFilter(u),this.firestore)},t.prototype.orderBy=function(e,n){b("Query.orderBy",arguments,1,2),x("Query.orderBy","string",2,n);var r;if(void 0===n||"asc"===n)r=Ze.ASCENDING;else{if("desc"!==n)throw new oe(ie.INVALID_ARGUMENT,"Function Query.orderBy() has unknown direction '"+n+"', expected 'asc' or 'desc'.");r=Ze.DESCENDING}if(null!==this._query.startAt)throw new oe(ie.INVALID_ARGUMENT,"Invalid query. You must not call Query.startAt() or Query.startAfter() before calling Query.orderBy().");if(null!==this._query.endAt)throw new oe(ie.INVALID_ARGUMENT,"Invalid query. You must not call Query.endAt() or Query.endBefore() before calling Query.orderBy().");var i=Vt("Query.orderBy",e),o=new tn(i,r);return this.validateNewOrderBy(o),new t(this._query.addOrderBy(o),this.firestore)},t.prototype.limit=function(e){if(y("Query.limit",arguments,1),E("Query.limit","number",1,e),e<=0)throw new oe(ie.INVALID_ARGUMENT,"Invalid Query. Query limit ("+e+") is invalid. Limit must be positive.");return new t(this._query.withLimit(e),this.firestore)},t.prototype.startAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_("Query.startAt",arguments,1);var i=this.boundFromDocOrFields("Query.startAt",e,n,!0);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.startAfter=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_("Query.startAfter",arguments,1);var i=this.boundFromDocOrFields("Query.startAfter",e,n,!1);return new t(this._query.withStartAt(i),this.firestore)},t.prototype.endBefore=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_("Query.endBefore",arguments,1);var i=this.boundFromDocOrFields("Query.endBefore",e,n,!0);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.endAt=function(e){for(var n=[],r=1;r<arguments.length;r++)n[r-1]=arguments[r];_("Query.endAt",arguments,1);var i=this.boundFromDocOrFields("Query.endAt",e,n,!1);return new t(this._query.withEndAt(i),this.firestore)},t.prototype.isEqual=function(e){if(!(e instanceof t))throw O("isEqual","Query",1,e);return this.firestore===e.firestore&&this._query.isEqual(e._query)},t.prototype.boundFromDocOrFields=function(t,e,n,r){if(N(t,1,e),e instanceof zi){if(n.length>0)throw new oe(ie.INVALID_ARGUMENT,"Too many arguments provided to "+t+"().");var i=e;if(!i.exists)throw new oe(ie.NOT_FOUND,"Can't use a DocumentSnapshot that doesn't exist for "+t+"().");return this.boundFromDocument(t,i._document,r)}var o=[e].concat(n);return this.boundFromFields(t,o,r)},t.prototype.boundFromDocument=function(t,e,n){for(var r=[],i=0,o=this._query.orderBy;i<o.length;i++){var a=o[i];if(a.field.isKeyField())r.push(new Be(this.firestore._databaseId,e.key));else{var s=e.field(a.field);if(void 0===s){var u=a.field.canonicalString();throw new oe(ie.INVALID_ARGUMENT,"Invalid query. You are trying to start or end a query using a document for which the field '"+u+"' (used as the orderBy) does not exist.")}r.push(s)}}return new $e(r,n)},t.prototype.boundFromFields=function(t,e,n){var r=this._query.explicitOrderBy;if(e.length>r.length)throw new oe(ie.INVALID_ARGUMENT,"Too many arguments provided to "+t+"(). The number of arguments must be less than or equal to the number of Query.orderBy() clauses");for(var i=[],o=0;o<e.length;o++){var a=e[o];if(r[o].field.isKeyField()){if("string"!==typeof a)throw new oe(ie.INVALID_ARGUMENT,"Invalid query. Expected a string for document ID in "+t+"(), but got a "+typeof a);if(-1!==a.indexOf("/"))throw new oe(ie.INVALID_ARGUMENT,"Invalid query. Document ID '"+a+"' contains a slash in "+t+"()");var s=new ye(this._query.path.child(a));i.push(new Be(this.firestore._databaseId,s))}else{var u=this.firestore._dataConverter.parseQueryValue(t,a);i.push(u)}}return new $e(i,n)},t.prototype.onSnapshot=function(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];b("Query.onSnapshot",arguments,1,4);var n,r={},i=0;return"object"!==typeof t[i]||kt(t[i])||(r=t[i],D("Query.onSnapshot",r,["includeQueryMetadataChanges","includeDocumentMetadataChanges"]),S("Query.onSnapshot","boolean","includeDocumentMetadataChanges",r.includeDocumentMetadataChanges),S("Query.onSnapshot","boolean","includeQueryMetadataChanges",r.includeQueryMetadataChanges),i++),kt(t[i])?n=t[i]:(E("Query.onSnapshot","function",i,t[i]),x("Query.onSnapshot","function",i+1,t[i+1]),x("Query.onSnapshot","function",i+2,t[i+2]),n={next:t[i],error:t[i+1],complete:t[i+2]}),this.onSnapshotInternal(r,n)},t.prototype.onSnapshotInternal=function(t,e){var n=this,r=function(t){console.error("Uncaught Error in onSnapshot:",t)};e.error&&(r=e.error.bind(e));var i=new vi({next:function(t){e.next&&e.next(new Yi(n.firestore,n._query,t))},error:r}),o=this.firestore.ensureClientConfigured(),a=o.listen(this._query,i,t);return function(){i.mute(),o.unlisten(a)}},t.prototype.get=function(t){var e=this;return b("Query.get",arguments,0,1),new Promise(function(n,r){t&&"cache"===t.source?e.firestore.ensureClientConfigured().getDocumentsFromLocalCache(e._query).then(function(t){n(new Yi(e.firestore,e._query,t))},r):e.getViaSnapshotListener(n,r,t)})},t.prototype.getViaSnapshotListener=function(t,e,n){var r=this.onSnapshotInternal({includeDocumentMetadataChanges:!1,includeQueryMetadataChanges:!0,waitForSyncWhenOnline:!0},{next:function(i){r(),i.metadata.fromCache&&n&&"server"===n.source?e(new oe(ie.UNAVAILABLE,'Failed to get documents from server. (However, these documents may exist in the local cache. Run again without setting source to "server" to retrieve the cached documents.)')):t(i)},error:e})},t.prototype.validateNewFilter=function(t){if(t instanceof Qe&&t.isInequality()){var e=this._query.getInequalityFilterField();if(null!==e&&!e.isEqual(t.field))throw new oe(ie.INVALID_ARGUMENT,"Invalid query. All where filters with an inequality (<, <=, >, or >=) must be on the same field. But you have inequality filters on '"+e.toString()+"' and '"+t.field.toString()+"'");var n=this._query.getFirstOrderByField();null!==n&&this.validateOrderByAndInequalityMatch(t.field,n)}},t.prototype.validateNewOrderBy=function(t){if(null===this._query.getFirstOrderByField()){var e=this._query.getInequalityFilterField();null!==e&&this.validateOrderByAndInequalityMatch(e,t.field)}},t.prototype.validateOrderByAndInequalityMatch=function(t,e){if(!e.isEqual(t))throw new oe(ie.INVALID_ARGUMENT,"Invalid query. You have a where filter with an inequality (<, <=, >, or >=) on field '"+t.toString()+"' and so you must also use '"+t.toString()+"' as your first Query.orderBy(), but your first Query.orderBy() is on field '"+e.toString()+"' instead.")},t}(),Yi=function(){function t(t,e,n){this._firestore=t,this._originalQuery=e,this._snapshot=n,this._cachedChanges=null,this.metadata=new Gi(n.hasPendingWrites,n.fromCache)}return Object.defineProperty(t.prototype,"docs",{get:function(){var t=[];return this.forEach(function(e){return t.push(e)}),t},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"empty",{get:function(){return this._snapshot.docs.isEmpty()},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"size",{get:function(){return this._snapshot.docs.size},enumerable:!0,configurable:!0}),t.prototype.forEach=function(t,e){var n=this;b("QuerySnapshot.forEach",arguments,1,2),E("QuerySnapshot.forEach","function",1,t),this._snapshot.docs.forEach(function(r){t.call(e,n.convertToDocumentImpl(r))})},Object.defineProperty(t.prototype,"query",{get:function(){return new qi(this._originalQuery,this._firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"docChanges",{get:function(){return this._cachedChanges||(this._cachedChanges=qt(this._firestore,this._snapshot)),this._cachedChanges},enumerable:!0,configurable:!0}),t.prototype.isEqual=function(e){if(!(e instanceof t))throw O("isEqual","QuerySnapshot",1,e);return this._firestore===e._firestore&&this._originalQuery.isEqual(e._originalQuery)&&this._snapshot.isEqual(e._snapshot)},t.prototype.convertToDocumentImpl=function(t){return new Wi(this._firestore,t.key,t,this.metadata.fromCache)},t}(),Ki=function(t){function e(e,n){var r=t.call(this,Ye.atPath(e),n)||this;if(e.length%2!==1)throw new oe(ie.INVALID_ARGUMENT,"Invalid collection reference. Collection references must have an odd number of segments, but "+e.canonicalString()+" has "+e.length);return r}return $t.__extends(e,t),Object.defineProperty(e.prototype,"id",{get:function(){return this._query.path.lastSegment()},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"parent",{get:function(){var t=this._query.path.popLast();return t.isEmpty()?null:new Hi(new ye(t),this.firestore)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"path",{get:function(){return this._query.path.canonicalString()},enumerable:!0,configurable:!0}),e.prototype.doc=function(t){if(b("CollectionReference.doc",arguments,0,1),0===arguments.length&&(t=ae.newId()),E("CollectionReference.doc","string",1,t),""===t)throw new oe(ie.INVALID_ARGUMENT,"Document path must be a non-empty string");var e=me.fromString(t);return Hi.forPath(this._query.path.child(e),this.firestore)},e.prototype.add=function(t){y("CollectionReference.add",arguments,1),E("CollectionReference.add","object",1,t);var e=this.doc();return e.set(t).then(function(){return e})},e}(qi),Qi=h(Bi,"Use firebase.firestore() instead."),Xi=h(Vi,"Use firebase.firestore().runTransaction() instead."),Ji=h(ji,"Use firebase.firestore().batch() instead."),Zi=h(Hi,"Use firebase.firestore().doc() instead."),$i=h(zi),to=h(Wi),eo=h(qi),no=h(Yi),ro=h(Ki,"Use firebase.firestore().collection() instead."),io={Firestore:Qi,GeoPoint:ce,Timestamp:le,Blob:ue,Transaction:Xi,WriteBatch:Ji,DocumentReference:Zi,DocumentSnapshot:$i,Query:eo,QueryDocumentSnapshot:to,QuerySnapshot:no,CollectionReference:ro,FieldPath:Wn,FieldValue:Mi,setLogLevel:Bi.setLogLevel};Qt(Jt),e.registerFirestore=Qt},function(module,exports,__webpack_require__){(function(global){(function(){function l(t){return"string"==typeof t}function n(t,e){t=t.split("."),e=e||k;for(var n=0;n<t.length;n++)if(null==(e=e[t[n]]))return null;return e}function aa(){}function ba(t){var e=typeof t;if("object"==e){if(!t)return"null";if(t instanceof Array)return"array";if(t instanceof Object)return e;var n=Object.prototype.toString.call(t);if("[object Window]"==n)return"object";if("[object Array]"==n||"number"==typeof t.length&&"undefined"!=typeof t.splice&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("splice"))return"array";if("[object Function]"==n||"undefined"!=typeof t.call&&"undefined"!=typeof t.propertyIsEnumerable&&!t.propertyIsEnumerable("call"))return"function"}else if("function"==e&&"undefined"==typeof t.call)return"object";return e}function p(t){return"array"==ba(t)}function ca(t){var e=ba(t);return"array"==e||"object"==e&&"number"==typeof t.length}function da(t){return"function"==ba(t)}function ea(t){var e=typeof t;return"object"==e&&null!=t||"function"==e}function ha(t,e,n){return t.call.apply(t.bind,arguments)}function ia(t,e,n){if(!t)throw Error();if(2<arguments.length){var r=Array.prototype.slice.call(arguments,2);return function(){var n=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(n,r),t.apply(e,n)}}return function(){return t.apply(e,arguments)}}function r(t,e,n){return r=Function.prototype.bind&&-1!=Function.prototype.bind.toString().indexOf("native code")?ha:ia,r.apply(null,arguments)}function ja(t,e){var n=Array.prototype.slice.call(arguments,1);return function(){var e=n.slice();return e.push.apply(e,arguments),t.apply(this,e)}}function u(t,e){function n(){}n.prototype=e.prototype,t.H=e.prototype,t.prototype=new n,t.prototype.constructor=t,t.Ib=function(t,n,r){for(var i=Array(arguments.length-2),o=2;o<arguments.length;o++)i[o-2]=arguments[o];return e.prototype[n].apply(t,i)}}function ka(t){if(Error.captureStackTrace)Error.captureStackTrace(this,ka);else{var e=Error().stack;e&&(this.stack=e)}t&&(this.message=String(t))}function la(t,e){t=t.split("%s");for(var n="",r=t.length-1,i=0;i<r;i++)n+=t[i]+(i<e.length?e[i]:"%s");ka.call(this,n+t[r])}function ma(t,e){throw new la("Failure"+(t?": "+t:""),Array.prototype.slice.call(arguments,1))}function w(){0!=na&&(pa[this[q]||(this[q]=++fa)]=this),this.i=this.i,this.m=this.m}function sa(t){t:{for(var e=ta,n=t.length,r=l(t)?t.split(""):t,i=0;i<n;i++)if(i in r&&e.call(void 0,r[i],i,t)){e=i;break t}e=-1}return 0>e?null:l(t)?t.charAt(e):t[e]}function ua(t){if(!p(t))for(var e=t.length-1;0<=e;e--)delete t[e];t.length=0}function va(t){return Array.prototype.concat.apply([],arguments)}function wa(t){var e=t.length;if(0<e){for(var n=Array(e),r=0;r<e;r++)n[r]=t[r];return n}return[]}function xa(t){return/^[\s\xa0]*$/.test(t)}function za(t,e){return t<e?-1:t>e?1:0}function y(t){return-1!=x.indexOf(t)}function Ca(t,e,n){for(var r in t)e.call(n,t[r],r,t)}function Da(t){var e,n=[],r=0;for(e in t)n[r++]=t[e];return n}function Ea(t){var e,n=[],r=0;for(e in t)n[r++]=e;return n}function Fa(t){var e,n={};for(e in t)n[e]=t[e];return n}function Ha(t,e){for(var n,r,i=1;i<arguments.length;i++){r=arguments[i];for(n in r)t[n]=r[n];for(var o=0;o<Ga.length;o++)n=Ga[o],Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}}function Ia(t){return Ia[" "](t),t}function Ja(t,e){var n=Ka;return Object.prototype.hasOwnProperty.call(n,t)?n[t]:n[t]=e(t)}function Qa(){var t=k.document;return t?t.documentMode:void 0}function Va(t){return Ja(t,function(){for(var e=0,n=ya(String(Ra)).split("."),r=ya(String(t)).split("."),i=Math.max(n.length,r.length),o=0;0==e&&o<i;o++){var a=n[o]||"",s=r[o]||"";do{if(a=/(\d*)(\D*)(.*)/.exec(a)||["","","",""],s=/(\d*)(\D*)(.*)/.exec(s)||["","","",""],0==a[0].length&&0==s[0].length)break;e=za(0==a[1].length?0:parseInt(a[1],10),0==s[1].length?0:parseInt(s[1],10))||za(0==a[2].length,0==s[2].length)||za(a[2],s[2]),a=a[3],s=s[3]}while(0==e)}return 0<=e})}function A(t,e){this.type=t,this.a=this.target=e,this.Ra=!0}function bb(t,e){if(A.call(this,t?t.type:""),this.relatedTarget=this.a=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.pointerId=0,this.pointerType="",this.c=null,t){var n=this.type=t.type,r=t.changedTouches?t.changedTouches[0]:null;if(this.target=t.target||t.srcElement,this.a=e,e=t.relatedTarget){if(Oa){t:{try{Ia(e.nodeName);var i=!0;break t}catch(t){}i=!1}i||(e=null)}}else"mouseover"==n?e=t.fromElement:"mouseout"==n&&(e=t.toElement);this.relatedTarget=e,null===r?(this.clientX=void 0!==t.clientX?t.clientX:t.pageX,this.clientY=void 0!==t.clientY?t.clientY:t.pageY,this.screenX=t.screenX||0,this.screenY=t.screenY||0):(this.clientX=void 0!==r.clientX?r.clientX:r.pageX,this.clientY=void 0!==r.clientY?r.clientY:r.pageY,this.screenX=r.screenX||0,this.screenY=r.screenY||0),this.button=t.button,this.key=t.key||"",this.ctrlKey=t.ctrlKey,this.altKey=t.altKey,this.shiftKey=t.shiftKey,this.metaKey=t.metaKey,this.pointerId=t.pointerId||0,this.pointerType=l(t.pointerType)?t.pointerType:cb[t.pointerType]||"",this.c=t,t.defaultPrevented&&this.b()}}function fb(t,e,n,r,i){this.listener=t,this.proxy=null,this.src=e,this.type=n,this.capture=!!r,this.ga=i,this.key=++eb,this.Z=this.ba=!1}function gb(t){t.Z=!0,t.listener=null,t.proxy=null,t.src=null,t.ga=null}function hb(t){this.src=t,this.a={},this.b=0}function jb(t,e){var n=e.type;if(n in t.a){var r,i=t.a[n],o=qa(i,e);(r=0<=o)&&Array.prototype.splice.call(i,o,1),r&&(gb(e),0==t.a[n].length&&(delete t.a[n],t.b--))}}function ib(t,e,n,r){for(var i=0;i<t.length;++i){var o=t[i];if(!o.Z&&o.listener==e&&o.capture==!!n&&o.ga==r)return i}return-1}function nb(t,e,n,r,i){if(r&&r.once)return ob(t,e,n,r,i);if(p(e)){for(var o=0;o<e.length;o++)nb(t,e[o],n,r,i);return null}return n=pb(n),t&&t[db]?t.Ia(e,n,ea(r)?!!r.capture:!!r,i):qb(t,e,n,!1,r,i)}function qb(t,e,n,r,i,o){if(!e)throw Error("Invalid event type");var a=ea(i)?!!i.capture:!!i,s=rb(t);if(s||(t[kb]=s=new hb(t)),n=s.add(e,n,r,a,o),n.proxy)return n;if(r=sb(),n.proxy=r,r.src=t,r.listener=n,t.addEventListener)ab||(i=a),void 0===i&&(i=!1),t.addEventListener(e.toString(),r,i);else if(t.attachEvent)t.attachEvent(tb(e.toString()),r);else{if(!t.addListener||!t.removeListener)throw Error("addEventListener and attachEvent are unavailable.");t.addListener(r)}return mb++,n}function sb(){var t=ub,e=Za?function(n){return t.call(e.src,e.listener,n)}:function(n){if(!(n=t.call(e.src,e.listener,n)))return n};return e}function ob(t,e,n,r,i){if(p(e)){for(var o=0;o<e.length;o++)ob(t,e[o],n,r,i);return null}return n=pb(n),t&&t[db]?t.Ja(e,n,ea(r)?!!r.capture:!!r,i):qb(t,e,n,!0,r,i)}function vb(t,e,n,r,i){if(p(e))for(var o=0;o<e.length;o++)vb(t,e[o],n,r,i);else r=ea(r)?!!r.capture:!!r,n=pb(n),t&&t[db]?(t=t.f,(e=String(e).toString())in t.a&&(o=t.a[e],-1<(n=ib(o,n,r,i))&&(gb(o[n]),Array.prototype.splice.call(o,n,1),0==o.length&&(delete t.a[e],t.b--)))):t&&(t=rb(t))&&(e=t.a[e.toString()],t=-1,e&&(t=ib(e,n,r,i)),(n=-1<t?e[t]:null)&&wb(n))}function wb(t){if("number"!=typeof t&&t&&!t.Z){var e=t.src;if(e&&e[db])jb(e.f,t);else{var n=t.type,r=t.proxy;e.removeEventListener?e.removeEventListener(n,r,t.capture):e.detachEvent?e.detachEvent(tb(n),r):e.addListener&&e.removeListener&&e.removeListener(r),mb--,(n=rb(e))?(jb(n,t),0==n.b&&(n.src=null,e[kb]=null)):gb(t)}}}function tb(t){return t in lb?lb[t]:lb[t]="on"+t}function xb(t,e,n,r){var i=!0;if((t=rb(t))&&(e=t.a[e.toString()]))for(e=e.concat(),t=0;t<e.length;t++){var o=e[t];o&&o.capture==n&&!o.Z&&(o=yb(o,r),i=i&&!1!==o)}return i}function yb(t,e){var n=t.listener,r=t.ga||t.src;return t.ba&&wb(t),n.call(r,e)}function ub(t,e){if(t.Z)return!0;if(!Za){var r=e||n("window.event");e=new bb(r,this);var i=!0;if(!(0>r.keyCode||void 0!=r.returnValue)){t:{var o=!1;if(0==r.keyCode)try{r.keyCode=-1;break t}catch(t){o=!0}(o||void 0==r.returnValue)&&(r.returnValue=!0)}for(r=[],o=e.a;o;o=o.parentNode)r.push(o);for(t=t.type,o=r.length-1;0<=o;o--){e.a=r[o];var a=xb(r[o],t,!0,e);i=i&&a}for(o=0;o<r.length;o++)e.a=r[o],a=xb(r[o],t,!1,e),i=i&&a}return i}return yb(t,new bb(e,this))}function rb(t){return t=t[kb],t instanceof hb?t:null}function pb(t){return da(t)?t:(t[zb]||(t[zb]=function(e){return t.handleEvent(e)}),t[zb])}function B(){w.call(this),this.f=new hb(this),this.N=this,this.J=null}function Ab(t,e,n,r){if(!(e=t.f.a[String(e)]))return!0;e=e.concat();for(var i=!0,o=0;o<e.length;++o){var a=e[o];if(a&&!a.Z&&a.capture==n){var s=a.listener,u=a.ga||a.src;a.ba&&jb(t.f,a),i=!1!==s.call(u,r)&&i}}return i&&0!=r.Ra}function Bb(t){return!/^\s*$/.test(t)&&/^[\],:{}\s\u2028\u2029]*$/.test(t.replace(/\\["\\\/bfnrtu]/g,"@").replace(/(?:"[^"\\\n\r\u2028\u2029\x00-\x08\x0a-\x1f]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?)[\s\u2028\u2029]*(?=:|,|]|}|$)/g,"]").replace(/(?:^|:|,)(?:[\s\u2028\u2029]*\[)+/g,""))}function Cb(a){if(a=String(a),Bb(a))try{return eval("("+a+")")}catch(t){}throw Error("Invalid JSON string: "+a)}function Db(t){var e=[];return Eb(new Fb,t,e),e.join("")}function Fb(){}function Eb(t,e,n){if(null==e)n.push("null");else{if("object"==typeof e){if(p(e)){var r=e;e=r.length,n.push("[");for(var i="",o=0;o<e;o++)n.push(i),Eb(t,r[o],n),i=",";return void n.push("]")}if(!(e instanceof String||e instanceof Number||e instanceof Boolean)){n.push("{"),i="";for(r in e)Object.prototype.hasOwnProperty.call(e,r)&&"function"!=typeof(o=e[r])&&(n.push(i),Gb(r,n),n.push(":"),Eb(t,o,n),i=",");return void n.push("}")}e=e.valueOf()}switch(typeof e){case"string":Gb(e,n);break;case"number":n.push(isFinite(e)&&!isNaN(e)?String(e):"null");break;case"boolean":n.push(String(e));break;case"function":n.push("null");break;default:throw Error("Unknown type: "+typeof e)}}}function Gb(t,e){e.push('"',t.replace(Ib,function(t){var e=Hb[t];return e||(e="\\u"+(65536|t.charCodeAt(0)).toString(16).substr(1),Hb[t]=e),e}),'"')}function Jb(t,e){this.c=t,this.f=e,this.b=0,this.a=null}function Kb(){this.b=this.a=null}function Ob(){var t=Pb,e=null;return t.a&&(e=t.a,t.a=t.a.next,t.a||(t.b=null),e.next=null),e}function Lb(){this.next=this.b=this.a=null}function Qb(t){k.setTimeout(function(){throw t},0)}function Sb(){var t=k.MessageChannel;if("undefined"===typeof t&&"undefined"!==typeof window&&window.postMessage&&window.addEventListener&&!y("Presto")&&(t=function(){var t=document.createElement("IFRAME");t.style.display="none",t.src="",document.documentElement.appendChild(t);var e=t.contentWindow;t=e.document,t.open(),t.write(""),t.close();var n="callImmediate"+Math.random(),i="file:"==e.location.protocol?"*":e.location.protocol+"//"+e.location.host;t=r(function(t){"*"!=i&&t.origin!=i||t.data!=n||this.port1.onmessage()},this),e.addEventListener("message",t,!1),this.port1={},this.port2={postMessage:function(){e.postMessage(n,i)}}}),"undefined"!==typeof t&&!y("Trident")&&!y("MSIE")){var e=new t,n={},i=n;return e.port1.onmessage=function(){if(void 0!==n.next){n=n.next;var t=n.za;n.za=null,t()}},function(t){i.next={za:t},i=i.next,e.port2.postMessage(0)}}return"undefined"!==typeof document&&"onreadystatechange"in document.createElement("SCRIPT")?function(t){var e=document.createElement("SCRIPT");e.onreadystatechange=function(){e.onreadystatechange=null,e.parentNode.removeChild(e),e=null,t(),t=null},document.documentElement.appendChild(e)}:function(t){k.setTimeout(t,0)}}function Ub(){if(-1!=String(k.Promise).indexOf("[native code]")){var t=k.Promise.resolve(void 0);Tb=function(){t.then(Vb)}}else Tb=function(){var t=Vb;!da(k.setImmediate)||k.Window&&k.Window.prototype&&!y("Edge")&&k.Window.prototype.setImmediate==k.setImmediate?(Rb||(Rb=Sb()),Rb(t)):k.setImmediate(t)}}function Vb(){for(var t;t=Ob();){try{t.a.call(t.b)}catch(t){Qb(t)}var e=Nb;e.f(t),100>e.b&&(e.b++,t.next=e.a,e.a=t)}Wb=!1}function Xb(e,n){B.call(this),this.b=e||1,this.a=n||k,this.c=r(this.qb,this),this.g=t()}function Yb(t){t.ea=!1,t.O&&(t.a.clearTimeout(t.O),t.O=null)}function Zb(t,e,n){if(da(t))n&&(t=r(t,n));else{if(!t||"function"!=typeof t.handleEvent)throw Error("Invalid listener argument");t=r(t.handleEvent,t)}return 2147483647<Number(e)?-1:k.setTimeout(t,e||0)}function $b(t,e,n){w.call(this),this.f=null!=n?r(t,n):t,this.c=e,this.b=r(this.kb,this),this.a=[]}function ac(t){t.Y=Zb(t.b,t.c),t.f.apply(null,t.a)}function bc(t){w.call(this),this.b=t,this.a={}}function dc(t,e,n,r){p(n)||(n&&(cc[0]=n.toString()),n=cc);for(var i=0;i<n.length;i++){var o=nb(e,n[i],r||t.handleEvent,!1,t.b||t);if(!o)break;t.a[o.key]=o}}function ec(t){Ca(t.a,function(t,e){this.a.hasOwnProperty(e)&&wb(t)},t),t.a={}}function fc(t,e,n){this.reset(t,e,n,void 0,void 0)}function hc(t){this.f=t,this.b=this.c=this.a=null}function C(t,e){this.name=t,this.value=e}function nc(t){return t.c?t.c:t.a?nc(t.a):(ma("Root logger has no level set."),null)}function qc(t){pc||(pc=new hc(""),oc[""]=pc,pc.c=lc);var e;if(!(e=oc[t])){e=new hc(t);var n=t.lastIndexOf("."),r=t.substr(n+1);n=qc(t.substr(0,n)),n.b||(n.b={}),n.b[r]=e,e.a=n,oc[t]=e}return e}function D(t,e){t&&t.log(jc,e,void 0)}function rc(t,e){t&&t.log(kc,e,void 0)}function E(t,e){t&&t.log(mc,e,void 0)}function sc(){this.a=qc("goog.labs.net.webChannel.WebChannelDebug"),this.b=!0}function tc(t,e,n,r,i,o){F(t,function(){if(t.b)if(o)for(var a="",s=o.split("&"),u=0;u<s.length;u++){var c=s[u].split("=");if(1<c.length){var l=c[0];c=c[1];var h=l.split("_");a=2<=h.length&&"type"==h[1]?a+(l+"=")+c+"&":a+(l+"=redacted&")}}else a=null;else a=o;return"XMLHTTP REQ ("+r+") [attempt "+i+"]: "+e+"\n"+n+"\n"+a})}function uc(t,e,n,r,i,o,a){F(t,function(){return"XMLHTTP RESP ("+r+") [ attempt "+i+"]: "+e+"\n"+n+"\n"+o+" "+a})}function G(t,e,n,r){F(t,function(){return"XMLHTTP TEXT ("+e+"): "+vc(t,n)+(r?" "+r:"")})}function wc(t,e){F(t,function(){return"TIMEOUT: "+e})}function H(t,e){E(t.a,e)}function xc(t,e,n){(t=t.a)&&t.log(ic,n||"Exception",e)}function F(t,e){rc(t.a,e)}function J(t,e){(t=t.a)&&t.log(ic,e,void 0)}function vc(t,e){if(!t.b)return e;if(!e)return null;try{var n=JSON.parse(e);if(n)for(var r=0;r<n.length;r++)if(p(n[r])){var i=n[r];if(!(2>i.length)){var o=i[1];if(p(o)&&!(1>o.length)){var a=o[0];if("noop"!=a&&"stop"!=a&&"close"!=a)for(var s=1;s<o.length;s++)o[s]=""}}}return Db(n)}catch(n){return H(t,"Exception parsing expected JS array - probably was not JS"),e}}function zc(t){A.call(this,"serverreachability",t)}function Ac(t){yc.dispatchEvent(new zc(yc,t))}function Bc(t){A.call(this,"statevent",t)}function K(t){yc.dispatchEvent(new Bc(yc,t))}function Cc(t){A.call(this,"timingevent",t)}function Dc(t,e,n){yc.dispatchEvent(new Cc(yc,t,e,n))}function Ec(t,e){if(!da(t))throw Error("Fn must not be null and must be a function");return k.setTimeout(function(){t()},e)}function Hc(){}function Ic(t){var e;return(e=t.a)||(e={},Jc(t)&&(e[0]=!0,e[1]=!0),e=t.a=e),e}function Kc(){}function Mc(){A.call(this,"d")}function Nc(){A.call(this,"c")}function Pc(){}function Qc(t){return(t=Jc(t))?new ActiveXObject(t):new XMLHttpRequest}function Jc(t){if(!t.b&&"undefined"==typeof XMLHttpRequest&&"undefined"!=typeof ActiveXObject){for(var e=["MSXML2.XMLHTTP.6.0","MSXML2.XMLHTTP.3.0","MSXML2.XMLHTTP","Microsoft.XMLHTTP"],n=0;n<e.length;n++){var r=e[n];try{return new ActiveXObject(r),t.b=r}catch(t){}}throw Error("Could not create ActiveXObject. ActiveX might be disabled, or MSXML might not be installed")}return t.b}function L(t,e,n,r){this.i=t,this.b=e,this.c=n,this.T=r||1,this.L=new bc(this),this.R=Rc,t=Na?125:void 0,this.S=new Xb(t),this.j=null,this.f=!1,this.l=this.g=this.h=this.J=this.D=this.U=this.s=null,this.u=[],this.a=null,this.G=0,this.m=this.o=null,this.C=-1,this.B=!1,this.N=0,this.I=null,this.v=this.X=this.K=!1}function Sc(t,e){switch(t){case 0:return"Non-200 return code ("+e+")";case 1:return"XMLHTTP failure (no data)";case 2:return"HttpConnection timeout";default:return"Unknown error"}}function Vc(t,e,n){t.J=1,t.h=Wc(M(e)),t.l=n,t.K=!0,Xc(t,null)}function Yc(t,e,n,r){t.J=1,t.h=Wc(M(e)),t.l=null,t.K=n,Xc(t,r)}function Xc(e,n){e.D=t(),Zc(e),e.g=M(e.h),$c(e.g,"t",e.T),e.G=0,e.a=e.i.ca(e.i.ia()?n:null),0<e.N&&(e.I=new $b(r(e.Sa,e,e.a),e.N)),dc(e.L,e.a,"readystatechange",e.nb),n=e.j?Fa(e.j):{},e.l?(e.o||(e.o="POST"),n["Content-Type"]="application/x-www-form-urlencoded",e.a.fa(e.g,e.o,e.l,n)):(e.o="GET",e.a.fa(e.g,e.o,null,n)),Ac(1),tc(e.b,e.o,e.g,e.c,e.T,e.l)}function ad(t){var e=N(t.a),n=t.a.Ga(),r=t.a.W();if(!(3>e||3==e&&!Na&&!t.a.V())){t.B||4!=e||7==n||Ac(8==n||0>=r?3:2),bd(t);var i=t.a.W();t.C=i,(n=t.a.V())||H(t.b,function(){return"No response text for uri "+t.g+" status "+i}),t.f=200==i,uc(t.b,t.o,t.g,t.c,t.T,e,i),t.f?((r=cd(t))&&(G(t.b,t.c,r,"Initial handshake response via X-HTTP-Initial-Response"),t.v=!0,dd(t,r)),t.K?(ed(t,e,n),Na&&t.f&&3==e&&fd(t)):(G(t.b,t.c,n,null),dd(t,n)),4==e&&gd(t),t.f&&!t.B&&(4==e?t.i.ta(t):(t.f=!1,Zc(t)))):(400==i&&0<n.indexOf("Unknown SID")?(t.m=3,K(12),D(t.b.a,"XMLHTTP Unknown SID ("+t.c+")")):(t.m=0,K(13),D(t.b.a,"XMLHTTP Bad status "+i+" ("+t.c+")")),gd(t),hd(t))}}function cd(t){return!t.X||t.v?null:t.a&&(t=id(t.a,"X-HTTP-Initial-Response"))&&!xa(t)?t:null}function ed(t,e,n){for(var r=!0;!t.B&&t.G<n.length;){var i=jd(t,n);if(i==Uc){4==e&&(t.m=4,K(14),r=!1),G(t.b,t.c,null,"[Incomplete Response]");break}if(i==Tc){t.m=4,K(15),G(t.b,t.c,n,"[Invalid Chunk]"),r=!1;break}G(t.b,t.c,i,null),dd(t,i)}4==e&&0==n.length&&(t.m=1,K(16),r=!1),t.f=t.f&&r,r||(G(t.b,t.c,n,"[Invalid Chunked Response]"),gd(t),hd(t))}function fd(t){dc(t.L,t.S,"tick",t.mb),t.S.start()}function jd(t,e){var n=t.G,r=e.indexOf("\n",n);return-1==r?Uc:(n=Number(e.substring(n,r)),isNaN(n)?Tc:(r+=1)+n>e.length?Uc:(e=e.substr(r,n),t.G=r+n,e))}function Zc(e){e.U=t()+e.R,kd(e,e.R)}function kd(t,e){if(null!=t.s)throw Error("WatchDog timer not null");t.s=Ec(r(t.lb,t),e)}function bd(t){t.s&&(k.clearTimeout(t.s),t.s=null)}function hd(t){t.i.La()||t.B||t.i.ta(t)}function gd(t){bd(t);var e=t.I;e&&"function"==typeof e.$&&e.$(),t.I=null,Yb(t.S),ec(t.L),t.a&&(e=t.a,t.a=null,e.abort(),e.$())}function dd(t,e){try{t.i.Oa(t,e),Ac(4)}catch(e){xc(t.b,e,"Error in httprequest callback")}}function ld(t){if(t.A&&"function"==typeof t.A)return t.A();if(l(t))return t.split("");if(ca(t)){for(var e=[],n=t.length,r=0;r<n;r++)e.push(t[r]);return e}return Da(t)}function md(t,e){if(t.forEach&&"function"==typeof t.forEach)t.forEach(e,void 0);else if(ca(t)||l(t))ra(t,e,void 0);else{if(t.M&&"function"==typeof t.M)var n=t.M();else if(t.A&&"function"==typeof t.A)n=void 0;else if(ca(t)||l(t)){n=[];for(var r=t.length,i=0;i<r;i++)n.push(i)}else n=Ea(t);r=ld(t),i=r.length;for(var o=0;o<i;o++)e.call(void 0,r[o],n&&n[o],t)}}function O(t,e){this.b={},this.a=[],this.c=0;var n=arguments.length;if(1<n){if(n%2)throw Error("Uneven number of arguments");for(var r=0;r<n;r+=2)this.set(arguments[r],arguments[r+1])}else if(t)if(t instanceof O)for(n=t.M(),r=0;r<n.length;r++)this.set(n[r],t.get(n[r]));else for(r in t)this.set(r,t[r])}function od(t){t.b={},t.a.length=0,t.c=0}function pd(t,e){return!!P(t.b,e)&&(delete t.b[e],t.c--,t.a.length>2*t.c&&nd(t),!0)}function nd(t){if(t.c!=t.a.length){for(var e=0,n=0;e<t.a.length;){var r=t.a[e];P(t.b,r)&&(t.a[n++]=r),e++}t.a.length=n}if(t.c!=t.a.length){var i={};for(n=e=0;e<t.a.length;)r=t.a[e],P(i,r)||(t.a[n++]=r,i[r]=1),e++;t.a.length=n}}function P(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function rd(t,e){if(t){t=t.split("&");for(var n=0;n<t.length;n++){var r=t[n].indexOf("="),i=null;if(0<=r){var o=t[n].substring(0,r);i=t[n].substring(r+1)}else o=t[n];e(o,i?decodeURIComponent(i.replace(/\+/g," ")):"")}}}function Q(t,e){this.b=this.j=this.f="",this.i=null,this.g=this.a="",this.h=!1;var n;t instanceof Q?(this.h=void 0!==e?e:t.h,sd(this,t.f),this.j=t.j,td(this,t.b),ud(this,t.i),this.a=t.a,vd(this,wd(t.c)),this.g=t.g):t&&(n=String(t).match(qd))?(this.h=!!e,sd(this,n[1]||"",!0),this.j=xd(n[2]||""),td(this,n[3]||"",!0),ud(this,n[4]),this.a=xd(n[5]||"",!0),vd(this,n[6]||"",!0),this.g=xd(n[7]||"")):(this.h=!!e,this.c=new yd(null,this.h))}function M(t){return new Q(t)}function sd(t,e,n){t.f=n?xd(e,!0):e,t.f&&(t.f=t.f.replace(/:$/,""))}function td(t,e,n){t.b=n?xd(e,!0):e}function ud(t,e){if(e){if(e=Number(e),isNaN(e)||0>e)throw Error("Bad port number "+e);t.i=e}else t.i=null}function vd(t,e,n){e instanceof yd?(t.c=e,Ed(t.c,t.h)):(n||(e=zd(e,Fd)),t.c=new yd(e,t.h))}function R(t,e,n){t.c.set(e,n)}function $c(t,e,n){p(n)||(n=[String(n)]),Gd(t.c,e,n)}function Wc(e){return R(e,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^t()).toString(36)),e}function Hd(t){return t instanceof Q?M(t):new Q(t,void 0)}function Id(t,e,n,r){var i=new Q(null,void 0);return t&&sd(i,t),e&&td(i,e),n&&ud(i,n),r&&(i.a=r),i}function xd(t,e){return t?e?decodeURI(t.replace(/%25/g,"%2525")):decodeURIComponent(t):""}function zd(t,e,n){return l(t)?(t=encodeURI(t).replace(e,Jd),n&&(t=t.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),t):null}function Jd(t){return t=t.charCodeAt(0),"%"+(t>>4&15).toString(16)+(15&t).toString(16)}function yd(t,e){this.b=this.a=null,this.c=t||null,this.f=!!e}function S(t){t.a||(t.a=new O,t.b=0,t.c&&rd(t.c,function(e,n){t.add(decodeURIComponent(e.replace(/\+/g," ")),n)}))}function Ld(t,e){S(t),e=Kd(t,e),P(t.a.b,e)&&(t.c=null,t.b-=t.a.get(e).length,pd(t.a,e))}function Md(t,e){return S(t),e=Kd(t,e),P(t.a.b,e)}function Gd(t,e,n){Ld(t,e),0<n.length&&(t.c=null,t.a.set(Kd(t,e),wa(n)),t.b+=n.length)}function wd(t){var e=new yd;return e.c=t.c,t.a&&(e.a=new O(t.a),e.b=t.b),e}function Kd(t,e){return e=String(e),t.f&&(e=e.toLowerCase()),e}function Ed(t,e){e&&!t.f&&(S(t),t.c=null,t.a.forEach(function(t,e){var n=e.toLowerCase();e!=n&&(Ld(this,e),Gd(this,n,t))},t)),t.f=e}function Nd(){this.a=t()}function Pd(){Od||(Od=new Nd)}function Qd(){Od||(Od=new Nd)}function Rd(t,e){this.a=t,this.b=e,this.c=this.i=null,this.h=!1,this.m=null,this.f=-1,this.l=this.g=null}function Sd(t){H(t.b,"TestConnection: starting stage 2");var e=t.a.I.a;if(null!=e)H(t.b,function(){return"Buffered"}),K(4),e?(K(10),Td(t.a,t,!1)):(K(11),Td(t.a,t,!0));else{t.c=new L(t,t.b,void 0,void 0),t.c.j=t.i;var n=Ud(t.a,t.g,t.m);K(4),$c(n,"TYPE","xmlhttp");var r=t.a.j,i=t.a.K;r&&i&&R(n,r,i),Yc(t.c,n,!1,t.g)}}function Wd(){this.a=this.b=null}function Xd(){this.a=new O}function Yd(t){var e=typeof t;return"object"==e&&t||"function"==e?"o"+(t[q]||(t[q]=++fa)):e.charAt(0)+t}function Zd(t,e){this.a=t,this.b=e}function $d(t){this.g=t||ae,k.PerformanceNavigationTiming?(t=k.performance.getEntriesByType("navigation"),t=0<t.length&&("hq"==t[0].nextHopProtocol||"h2"==t[0].nextHopProtocol)):t=!!(k.oa&&k.oa.Ma&&k.oa.Ma()&&k.oa.Ma().Jb),this.f=t?this.g:1,this.a=null,1<this.f&&(this.a=new Xd),this.b=null,this.c=[]}function be(t,e){t.a||-1==e.indexOf("spdy")&&-1==e.indexOf("quic")&&-1==e.indexOf("h2")||(t.f=t.g,t.a=new Xd,t.b&&(ce(t,t.b),t.b=null))}function de(t){return!!t.b||!!t.a&&t.a.a.c>=t.f}function ee(t,e){return t.b?t=t.b==e:t.a?(e=Yd(e),t=P(t.a.a.b,e)):t=!1,t}function ce(t,e){t.a?t.a.add(e):t.b=e}function fe(t,e){if(t.b&&t.b==e)t.b=null;else{var n;(n=t.a)&&(n=Yd(e),n=P(t.a.a.b,n)),n&&pd(t.a.a,Yd(e))}}function ge(t){if(null!=t.b)return t.c.concat(t.b.u);if(null!=t.a&&0!=t.a.a.c){var e=t.c;return ra(t.a.A(),function(t){e=e.concat(t.u)}),e}return wa(t.c)}function he(t,e){t.c=t.c.concat(e)}function ie(){}function je(){this.a=new ie}function ke(t,e,n){var r=n||"";try{md(t,function(t,n){var i=t;ea(t)&&(i=Db(t)),e.push(r+n+"="+encodeURIComponent(i))})}catch(t){throw e.push(r+"type="+encodeURIComponent("_badmap")),t}}function le(t,e){var n=new sc;H(n,"TestLoadImage: loading "+t);var r=new Image;r.onload=ja(me,n,r,"TestLoadImage: loaded",!0,e),r.onerror=ja(me,n,r,"TestLoadImage: error",!1,e),r.onabort=ja(me,n,r,"TestLoadImage: abort",!1,e),r.ontimeout=ja(me,n,r,"TestLoadImage: timeout",!1,e),k.setTimeout(function(){r.ontimeout&&r.ontimeout()},1e4),r.src=t}function me(t,e,n,r,i){try{H(t,n),e.onload=null,e.onerror=null,e.onabort=null,e.ontimeout=null,i(r)}catch(e){xc(t,e)}}function T(t){B.call(this),this.headers=new O,this.s=t||null,this.c=!1,this.D=this.a=null,this.K=this.B="",this.j=0,this.g="",this.h=this.I=this.u=this.G=!1,this.l=0,this.C=null,this.L=ne,this.v=this.o=!1}function se(t){return z&&Va(9)&&"number"==typeof t.timeout&&void 0!==t.ontimeout}function ta(t){return"content-type"==t.toLowerCase()}function qe(t,e){t.c=!1,t.a&&(t.h=!0,t.a.abort(),t.h=!1),t.g=e,t.j=5,te(t),ue(t)}function te(t){t.G||(t.G=!0,t.dispatchEvent("complete"),t.dispatchEvent("error"))}function ve(t){if(t.c&&"undefined"!=typeof goog)if(t.D[1]&&4==N(t)&&2==t.W())E(t.b,U(t,"Local request error detected and ignored"));else if(t.u&&4==N(t))Zb(t.Na,0,t);else if(t.dispatchEvent("readystatechange"),4==N(t)){E(t.b,U(t,"Request complete")),t.c=!1;try{var e=t.W();t:switch(e){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var n=!0;break t;default:n=!1}var r;if(!(r=n)){var i;if(i=0===e){var o=String(t.B).match(qd)[1]||null;if(!o&&k.self&&k.self.location){var a=k.self.location.protocol;o=a.substr(0,a.length-1)}i=!oe.test(o?o.toLowerCase():"")}r=i}r?(t.dispatchEvent("complete"),t.dispatchEvent("success")):(t.j=6,t.g=t.Ha()+" ["+t.W()+"]",te(t))}finally{ue(t)}}}function ue(t,e){if(t.a){re(t);var n=t.a,r=t.D[0]?aa:null;t.a=null,t.D=null,e||t.dispatchEvent("ready");try{n.onreadystatechange=r}catch(e){(t=t.b)&&t.log(ic,"Problem encountered resetting onreadystatechange: "+e.message,void 0)}}}function re(t){t.a&&t.v&&(t.a.ontimeout=null),t.C&&(k.clearTimeout(t.C),t.C=null)}function N(t){return t.a?t.a.readyState:0}function id(t,e){return t.a?t.a.getResponseHeader(e):null}function U(t,e){return e+" ["+t.K+" "+t.B+" "+t.W()+"]"}function we(t){var e="";return Ca(t,function(t,n){e+=n,e+=":",e+=t,e+="\r\n"}),e}function xe(t,e,n){t:{for(r in n){var r=!1;break t}r=!0}if(r)return t;if(n=we(n),l(t)){if(e=encodeURIComponent(String(e)),n=null!=n?"="+encodeURIComponent(String(n)):"",e+=n){if(n=t.indexOf("#"),0>n&&(n=t.length),0>(r=t.indexOf("?"))||r>n){r=n;var i=""}else i=t.substring(r+1,n);t=[t.substr(0,r),i,t.substr(n)],n=t[1],t[1]=e?n?n+"&"+e:e:n,t=t[0]+(t[1]?"?"+t[1]:"")+t[2]}return t}return R(t,e,n),t}function ye(t){this.ya=0,this.g=[],this.a=new sc,this.I=new Wd,this.X=this.ua=this.D=this.ja=this.b=this.K=this.j=this.U=this.h=this.L=this.i=null,this.Za=this.R=0,this.Xa=!!n("internalChannelParams.failFast",t),this.ka=this.C=this.s=this.l=this.m=this.f=null,this.u=this.xa=this.N=-1,this.T=this.B=this.v=0,this.Wa=n("internalChannelParams.baseRetryDelayMs",t)||5e3,this.$a=n("internalChannelParams.retryDelaySeedMs",t)||1e4,this.Ya=n("internalChannelParams.forwardChannelMaxRetries",t)||2,this.wa=n("internalChannelParams.forwardChannelRequestTimeoutMs",t)||2e4,this.Ta=t&&t.Kb||void 0,this.G=void 0,this.S=t&&t.supportsCrossDomainXhr||!1,this.J="",this.c=new $d(t&&t.concurrentRequestLimit),this.la=new je,this.o=!t||void 0===t.backgroundChannelTest||t.backgroundChannelTest,(this.va=t&&t.fastHandshake||!1)&&!this.o&&(D(this.a.a,"Force backgroundChannelTest when fastHandshake is enabled."),this.o=!0),t&&t.Fa&&this.a.Fa()}function ze(e){if(H(e.a,"disconnect()"),Ae(e),3==e.F){var n=e.R++,r=M(e.D);R(r,"SID",e.J),R(r,"RID",n),R(r,"TYPE","terminate"),Be(e,r),n=new L(e,e.a,n,void 0),n.J=2,n.h=Wc(M(r)),r=!1,k.navigator&&k.navigator.sendBeacon&&(r=k.navigator.sendBeacon(n.h.toString(),"")),!r&&k.Image&&((new Image).src=n.h,r=!0),r||(n.a=n.i.ca(null),n.a.fa(n.h)),n.D=t(),Zc(n)}Ce(e)}function Ae(t){t.C&&(t.C.abort(),t.C=null),t.b&&(t.b.cancel(),t.b=null),t.l&&(k.clearTimeout(t.l),t.l=null),De(t),t.c.cancel(),t.m&&(k.clearTimeout(t.m),t.m=null)}function Ee(t,e){1e3==t.g.length&&J(t.a,function(){return"Already have 1000 queued maps upon queueing "+Db(e)}),t.g.push(new Zd(t.Za++,e)),3==t.F&&Fe(t)}function Fe(t){de(t.c)||t.m||(t.m=Ec(r(t.Qa,t),0),t.v=0)}function Ge(t,e){var n=t.c;return(n.b?1:n.a?n.a.a.c:0)>=t.c.f-(t.m?1:0)?(J(t.a,"Unexpected retry request is scheduled."),!1):t.m?(H(t.a,"Use the retry request that is already scheduled."),t.g=e.u.concat(t.g),!0):!(1==t.F||2==t.F||t.v>=(t.Xa?0:t.Ya))&&(H(t.a,"Going to retry POST"),t.m=Ec(r(t.Qa,t,e),He(t,t.v)),t.v++,!0)}function Je(t,e){var n;n=e?e.c:t.R++;var r=M(t.D);R(r,"SID",t.J),R(r,"RID",n),R(r,"AID",t.N),Be(t,r),t.h&&t.i&&xe(r,t.h,t.i),n=new L(t,t.a,n,t.v+1),null===t.h&&(n.j=t.i),e&&(t.g=e.u.concat(t.g)),e=Ie(t,n),n.setTimeout(Math.round(.5*t.wa)+Math.round(.5*t.wa*Math.random())),ce(t.c,n),Vc(n,r,e)}function Be(t,e){t.f&&md({},function(t,n){R(e,n,t)})}function Ie(t,e){var n=Math.min(t.g.length,1e3),i=t.f?r(t.f.ab,t.f,t):null;t:for(var o=t.g,a=-1;;){var s=["count="+n];-1==a?0<n?(a=o[0].a,s.push("ofs="+a)):a=0:s.push("ofs="+a);for(var u=!0,c=0;c<n;c++){var l=o[c].a,h=o[c].b;if(0>(l-=a))a=Math.max(0,o[c].a-100),u=!1;else try{ke(h,s,"req"+l+"_")}catch(t){i&&i(h)}}if(u){i=s.join("&");break t}}return t=t.g.splice(0,n),e.u=t,i}function Ke(t){if(!t.b&&!t.l){t.T=1;var e=t.Pa;Tb||Ub(),Wb||(Tb(),Wb=!0),Pb.add(e,t),t.B=0}}function Le(t){return t.b||t.l?(J(t.a,"Request already in progress"),!1):!(3<=t.B)&&(H(t.a,"Going to retry GET"),t.T++,t.l=Ec(r(t.Pa,t),He(t,t.B)),t.B++,!0)}function Td(t,e,n){H(t.a,"Test Connection Finished");var r=e.l;r&&be(t.c,r),t.ka=n,t.u=e.f,H(t.a,"connectChannel_()"),t.D=Me(t,t.ja),Fe(t)}function Vd(t,e){H(t.a,"Test Connection Failed"),t.u=e.f,V(t,2)}function De(t){null!=t.s&&(k.clearTimeout(t.s),t.s=null)}function He(t,e){var n=t.Wa+Math.floor(Math.random()*t.$a);return t.qa()||(H(t.a,"Inactive channel"),n*=2),n*e}function V(t,e){if(F(t.a,"Error code "+e),2==e){var n=null;t.f&&(n=null);var i=r(t.pb,t);n||(n=new Q("//www.google.com/images/cleardot.gif"),k.location&&"http"==k.location.protocol||sd(n,"https"),Wc(n)),le(n.toString(),i)}else K(2);H(t.a,"HttpChannel: error - "+e),t.F=0,t.f&&t.f.Ba(e),Ce(t),Ae(t)}function Ce(t){if(t.F=0,t.u=-1,t.f){var e=ge(t.c);0==e.length&&0==t.g.length||(H(t.a,function(){return"Number of undelivered maps, pending: "+e.length+", outgoing: "+t.g.length}),t.c.c.length=0,wa(t.g),t.g.length=0),t.f.Aa()}}function Me(t,e){return e=Ne(t,null,e),H(t.a,"GetForwardChannelUri: "+e),e}function Ud(t,e,n){return e=Ne(t,t.ia()?e:null,n),H(t.a,"GetBackChannelUri: "+e),e}function Ne(t,e,n){var r=Hd(n);if(""!=r.b)e&&td(r,e+"."+r.b),ud(r,r.i);else{var i,o=k.location;i=e?e+"."+o.hostname:o.hostname,r=Id(o.protocol,i,o.port,n)}return t.U&&Ca(t.U,function(t,e){R(r,e,t)}),e=t.j,n=t.K,e&&n&&R(r,e,n),R(r,"VER",t.na),Be(t,r),r}function Oe(){}function Pe(t){for(var e=arguments[0],n=1;n<arguments.length;n++){var r=arguments[n];if(0==r.lastIndexOf("/",0))e=r;else{var i;(i=""==e)||(i=e.length-1,i=0<=i&&e.indexOf("/",i)==i),e+=i?r:"/"+r}}return e}function Qe(){if(z&&!(10<=Number(Wa)))throw Error("Environmental error: no available transport.")}function W(t,e){B.call(this),this.a=new ye(e),this.b=t,this.o=e&&e.testUrl?e.testUrl:Pe(this.b,"test"),this.c=qc("goog.labs.net.webChannel.WebChannelBaseTransport"),this.g=e&&e.messageUrlParams||null,t=e&&e.messageHeaders||null,e&&e.clientProtocolHeaderRequired&&(t?t["X-Client-Protocol"]="webchannel":t={"X-Client-Protocol":"webchannel"}),this.a.i=t,t=e&&e.initMessageHeaders||null,e&&e.messageContentType&&(t?t["X-WebChannel-Content-Type"]=e.messageContentType:t={"X-WebChannel-Content-Type":e.messageContentType}),e&&e.Ea&&(t?t["X-WebChannel-Client-Profile"]=e.Ea:t={"X-WebChannel-Client-Profile":e.Ea}),this.a.L=t,(t=e&&e.httpHeadersOverwriteParam)&&!xa(t)&&(this.a.h=t),this.l=e&&e.supportsCrossDomainXhr||!1,this.j=e&&e.sendRawJson||!1,(e=e&&e.httpSessionIdParam)&&!xa(e)&&(this.a.j=e,null!==(t=this.g)&&e in t&&(t=this.g,e in t&&delete t[e],D(this.c,"Ignore httpSessionIdParam also specified with messageUrlParams: "+e))),this.h=new Re(this)}function Se(t){Mc.call(this);var e=t.__sm__;if(e){t:{for(var n in e){t=n;break t}t=void 0}(this.c=t)?(t=this.c,this.data=null!==e&&t in e?e[t]:void 0):this.data=e}else this.data=t}function Te(){Nc.call(this),this.status=1}function Re(t){this.a=t}function Ve(){this.b=[],this.a=[]}function We(t){return 0==t.b.length&&(t.b=t.a,t.b.reverse(),t.a=[]),t.b.pop()}function Xe(t){return t.b.length+t.a.length}function Ye(t,e){if(w.call(this),this.h=t||0,this.c=e||10,this.h>this.c)throw Error(Ze);this.a=new Ve,this.b=new Xd,this.g=null,this.aa()}function af(t){if("function"==typeof t.$)t.$();else for(var e in t)t[e]=null}function $e(t){return Xe(t.a)+t.b.a.c}function bf(t,e){this.a=t,this.b=e}function cf(t){if(this.a=[],t)t:{if(t instanceof cf){var e=t.M();if(t=t.A(),0>=this.a.length){for(var n=this.a,r=0;r<e.length;r++)n.push(new bf(e[r],t[r]));break t}}else e=Ea(t),t=Da(t);for(r=0;r<e.length;r++)df(this,e[r],t[r])}}function df(t,e,n){var r=t.a;for(r.push(new bf(e,n)),e=r.length-1,t=t.a,n=t[e];0<e&&(r=e-1>>1,t[r].a>n.a);)t[e]=t[r],e=r;t[e]=n}function ef(){cf.call(this)}function Y(t,e){this.f=new ef,Ye.call(this,t,e)}function Z(t,e,n,r){this.l=t,this.j=!!r,Y.call(this,e,n)}var g,goog=goog||{},k=this,q="closure_uid_"+(1e9*Math.random()>>>0),fa=0,t=Date.now||function(){return+new Date};u(ka,Error),ka.prototype.name="CustomError",u(la,ka),la.prototype.name="AssertionError";var na=0,pa={};w.prototype.i=!1,w.prototype.$=function(){if(!this.i&&(this.i=!0,this.w(),0!=na)){var t=this[q]||(this[q]=++fa);if(0!=na&&this.m&&0<this.m.length)throw Error(this+" did not empty its onDisposeCallbacks queue. This probably means it overrode dispose() or disposeInternal() without calling the superclass' method.");delete pa[t]}},w.prototype.w=function(){if(this.m)for(;this.m.length;)this.m.shift()()};var qa=Array.prototype.indexOf?function(t,e){return Array.prototype.indexOf.call(t,e,void 0)}:function(t,e){if(l(t))return l(e)&&1==e.length?t.indexOf(e,0):-1;for(var n=0;n<t.length;n++)if(n in t&&t[n]===e)return n;return-1},ra=Array.prototype.forEach?function(t,e,n){Array.prototype.forEach.call(t,e,n)}:function(t,e,n){for(var r=t.length,i=l(t)?t.split(""):t,o=0;o<r;o++)o in i&&e.call(n,i[o],o,t)},ya=String.prototype.trim?function(t){return t.trim()}:function(t){return/^[\s\xa0]*([\s\S]*?)[\s\xa0]*$/.exec(t)[1]},x;t:{var Aa=k.navigator;if(Aa){var Ba=Aa.userAgent;if(Ba){x=Ba;break t}}x=""}var Ga="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");Ia[" "]=aa;var La=y("Opera"),z=y("Trident")||y("MSIE"),Ma=y("Edge"),Na=Ma||z,Oa=y("Gecko")&&!(-1!=x.toLowerCase().indexOf("webkit")&&!y("Edge"))&&!(y("Trident")||y("MSIE"))&&!y("Edge"),Pa=-1!=x.toLowerCase().indexOf("webkit")&&!y("Edge"),Ra;t:{var Sa="",Ta=function(){var t=x;return Oa?/rv:([^\);]+)(\)|;)/.exec(t):Ma?/Edge\/([\d\.]+)/.exec(t):z?/\b(?:MSIE|rv)[: ]([^\);]+)(\)|;)/.exec(t):Pa?/WebKit\/(\S+)/.exec(t):La?/(?:Version)[ \/]?(\S+)/.exec(t):void 0}();if(Ta&&(Sa=Ta?Ta[1]:""),z){var Ua=Qa();if(null!=Ua&&Ua>parseFloat(Sa)){Ra=String(Ua);break t}}Ra=Sa}var Ka={},Wa,Xa=k.document;Wa=Xa&&z?Qa()||("CSS1Compat"==Xa.compatMode?parseInt(Ra,10):5):void 0;var Ya=Object.freeze||function(t){return t},Za=!z||9<=Number(Wa),$a=z&&!Va("9"),ab=function(){if(!k.addEventListener||!Object.defineProperty)return!1;var t=!1,e=Object.defineProperty({},"passive",{get:function(){t=!0}});return k.addEventListener("test",aa,e),k.removeEventListener("test",aa,e),t}();A.prototype.b=function(){this.Ra=!1},u(bb,A);var cb=Ya({2:"touch",3:"pen",4:"mouse"});bb.prototype.b=function(){bb.H.b.call(this);var t=this.c;if(t.preventDefault)t.preventDefault();else if(t.returnValue=!1,$a)try{(t.ctrlKey||112<=t.keyCode&&123>=t.keyCode)&&(t.keyCode=-1)}catch(t){}};var db="closure_listenable_"+(1e6*Math.random()|0),eb=0;hb.prototype.add=function(t,e,n,r,i){var o=t.toString();(t=this.a[o])||(t=this.a[o]=[],this.b++);var a=ib(t,e,r,i);return-1<a?(e=t[a],n||(e.ba=!1)):(e=new fb(e,this.src,o,!!r,i),e.ba=n,t.push(e)),e};var kb="closure_lm_"+(1e6*Math.random()|0),lb={},mb=0,zb="__closure_events_fn_"+(1e9*Math.random()>>>0);u(B,w),B.prototype[db]=!0,g=B.prototype,g.addEventListener=function(t,e,n,r){nb(this,t,e,n,r)},g.removeEventListener=function(t,e,n,r){vb(this,t,e,n,r)},g.dispatchEvent=function(t){var e,n=this.J;if(n)for(e=[];n;n=n.J)e.push(n);n=this.N;var r=t.type||t;if(l(t))t=new A(t,n);else if(t instanceof A)t.target=t.target||n;else{var i=t;t=new A(r,n),Ha(t,i)}if(i=!0,e)for(var o=e.length-1;0<=o;o--){var a=t.a=e[o];i=Ab(a,r,!0,t)&&i}if(a=t.a=n,i=Ab(a,r,!0,t)&&i,i=Ab(a,r,!1,t)&&i,e)for(o=0;o<e.length;o++)a=t.a=e[o],i=Ab(a,r,!1,t)&&i;return i},g.w=function(){if(B.H.w.call(this),this.f){var t,e=this.f,n=0;for(t in e.a){for(var r=e.a[t],i=0;i<r.length;i++)++n,gb(r[i]);delete e.a[t],e.b--}}this.J=null},g.Ia=function(t,e,n,r){return this.f.add(String(t),e,!1,n,r)},g.Ja=function(t,e,n,r){return this.f.add(String(t),e,!0,n,r)};var Hb={'"':'\\"',"\\":"\\\\","/":"\\/","\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t","\v":"\\u000b"},Ib=/\uffff/.test("\uffff")?/[\\"\x00-\x1f\x7f-\uffff]/g:/[\\"\x00-\x1f\x7f-\xff]/g;Jb.prototype.get=function(){if(0<this.b){this.b--;var t=this.a;this.a=t.next,t.next=null}else t=this.c();return t};var Nb=new Jb(function(){return new Lb},function(t){t.reset()});Kb.prototype.add=function(t,e){var n=Nb.get();n.set(t,e),this.b?this.b.next=n:this.a=n,this.b=n},Lb.prototype.set=function(t,e){this.a=t,this.b=e,this.next=null},Lb.prototype.reset=function(){this.next=this.b=this.a=null};var Rb,Tb,Wb=!1,Pb=new Kb;u(Xb,B),g=Xb.prototype,g.ea=!1,g.O=null,g.qb=function(){if(this.ea){var e=t()-this.g;0<e&&e<.8*this.b?this.O=this.a.setTimeout(this.c,this.b-e):(this.O&&(this.a.clearTimeout(this.O),this.O=null),this.dispatchEvent("tick"),this.ea&&(this.O=this.a.setTimeout(this.c,this.b),this.g=t()))}},g.start=function(){this.ea=!0,this.O||(this.O=this.a.setTimeout(this.c,this.b),this.g=t())},g.w=function(){Xb.H.w.call(this),Yb(this),delete this.a},u($b,w),g=$b.prototype,g.ha=!1,g.Y=null,g.cb=function(t){this.a=arguments,this.Y?this.ha=!0:ac(this)},g.w=function(){$b.H.w.call(this),this.Y&&(k.clearTimeout(this.Y),this.Y=null,this.ha=!1,this.a=[])},g.kb=function(){this.Y=null,this.ha&&(this.ha=!1,ac(this))},u(bc,w);var cc=[];bc.prototype.w=function(){bc.H.w.call(this),ec(this)},bc.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")},fc.prototype.a=null;var gc=0;fc.prototype.reset=function(e,n,r,i,o){"number"==typeof o||gc++,i||t(),delete this.a},C.prototype.toString=function(){return this.name};var ic=new C("SEVERE",1e3),jc=new C("WARNING",900),kc=new C("INFO",800),lc=new C("CONFIG",700),mc=new C("FINE",500);hc.prototype.log=function(t,e,n){if(t.value>=nc(this).value)for(da(e)&&(e=e()),t=new fc(t,String(e),this.f),n&&(t.a=n),n=this;n;)n=n.a};var oc={},pc=null;sc.prototype.Fa=function(){this.b=!1};var yc=new B;u(zc,A),u(Bc,A),u(Cc,A);var Fc={NO_ERROR:0,rb:1,yb:2,xb:3,ub:4,wb:5,zb:6,Ua:7,TIMEOUT:8,Cb:9},Gc={tb:"complete",Gb:"success",Va:"error",Ua:"abort",Eb:"ready",Fb:"readystatechange",TIMEOUT:"timeout",Ab:"incrementaldata",Db:"progress",vb:"downloadprogress",Hb:"uploadprogress"};Hc.prototype.a=null;var Lc={OPEN:"a",sb:"b",Va:"c",Bb:"d"};u(Mc,A),u(Nc,A);var Oc;u(Pc,Hc),Oc=new Pc;var Rc=45e3,Tc={},Uc={};g=L.prototype,g.setTimeout=function(t){this.R=t},g.nb=function(t){t=t.target;var e=this.I;e&&3==N(t)?(H(this.b,"Throttling readystatechange."),e.cb()):this.Sa(t)},g.Sa=function(t){try{t==this.a?ad(this):D(this.b.a,"Called back with an unexpected xmlhttp")}catch(t){if(H(this.b,"Failed call to OnXmlHttpReadyStateChanged_"),this.a&&this.a.V()){var e=this;xc(this.b,t,function(){return"ResponseText: "+e.a.V()})}else xc(this.b,t,"No response text")}},g.mb=function(){if(this.a){var t=N(this.a),e=this.a.V();this.G<e.length&&(bd(this),ed(this,t,e),this.f&&4!=t&&Zc(this))}},g.cancel=function(){this.B=!0,gd(this)},g.lb=function(){this.s=null;var e=t();0<=e-this.U?(this.f&&J(this.b,"Received watchdog timeout even though request loaded successfully"),wc(this.b,this.g),2!=this.J&&(Ac(3),K(17)),gd(this),this.m=2,hd(this)):(D(this.b.a,"WatchDog timer called too early"),kd(this,this.U-e))},g=O.prototype,g.A=function(){nd(this);for(var t=[],e=0;e<this.a.length;e++)t.push(this.b[this.a[e]]);return t},g.M=function(){return nd(this),this.a.concat()},g.get=function(t,e){return P(this.b,t)?this.b[t]:e},g.set=function(t,e){P(this.b,t)||(this.c++,this.a.push(t)),this.b[t]=e},g.forEach=function(t,e){for(var n=this.M(),r=0;r<n.length;r++){var i=n[r],o=this.get(i);t.call(e,o,i,this)}};var qd=/^(?:([^:\/?#.]+):)?(?:\/\/(?:([^\/?#]*)@)?([^\/#?]*?)(?::([0-9]+))?(?=[\/#?]|$))?([^?#]+)?(?:\?([^#]*))?(?:#([\s\S]*))?$/;Q.prototype.toString=function(){var t=[],e=this.f;e&&t.push(zd(e,Ad,!0),":");var n=this.b;return(n||"file"==e)&&(t.push("//"),(e=this.j)&&t.push(zd(e,Ad,!0),"@"),t.push(encodeURIComponent(String(n)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),null!=(n=this.i)&&t.push(":",String(n))),(n=this.a)&&(this.b&&"/"!=n.charAt(0)&&t.push("/"),t.push(zd(n,"/"==n.charAt(0)?Bd:Cd,!0))),(n=this.c.toString())&&t.push("?",n),(n=this.g)&&t.push("#",zd(n,Dd)),t.join("")},Q.prototype.resolve=function(t){var e=M(this),n=!!t.f;n?sd(e,t.f):n=!!t.j,n?e.j=t.j:n=!!t.b,n?td(e,t.b):n=null!=t.i;var r=t.a;if(n)ud(e,t.i);else if(n=!!t.a){if("/"!=r.charAt(0))if(this.b&&!this.a)r="/"+r;else{var i=e.a.lastIndexOf("/");-1!=i&&(r=e.a.substr(0,i+1)+r)}if(".."==(i=r)||"."==i)r="";else if(-1!=i.indexOf("./")||-1!=i.indexOf("/.")){r=0==i.lastIndexOf("/",0),i=i.split("/");for(var o=[],a=0;a<i.length;){var s=i[a++];"."==s?r&&a==i.length&&o.push(""):".."==s?((1<o.length||1==o.length&&""!=o[0])&&o.pop(),r&&a==i.length&&o.push("")):(o.push(s),r=!0)}r=o.join("/")}else r=i}return n?e.a=r:n=""!==t.c.toString(),n?vd(e,wd(t.c)):n=!!t.g,n&&(e.g=t.g),e};var Ad=/[#\/\?@]/g,Cd=/[#\?:]/g,Bd=/[#\?]/g,Fd=/[#\?@]/g,Dd=/#/g;g=yd.prototype,g.add=function(t,e){S(this),this.c=null,t=Kd(this,t);var n=this.a.get(t);return n||this.a.set(t,n=[]),n.push(e),this.b+=1,this},g.forEach=function(t,e){S(this),this.a.forEach(function(n,r){ra(n,function(n){t.call(e,n,r,this)},this)},this)},g.M=function(){S(this);for(var t=this.a.A(),e=this.a.M(),n=[],r=0;r<e.length;r++)for(var i=t[r],o=0;o<i.length;o++)n.push(e[r]);return n},g.A=function(t){S(this);var e=[];if(l(t))Md(this,t)&&(e=va(e,this.a.get(Kd(this,t))));else{t=this.a.A();for(var n=0;n<t.length;n++)e=va(e,t[n])}return e},g.set=function(t,e){return S(this),this.c=null,t=Kd(this,t),Md(this,t)&&(this.b-=this.a.get(t).length),this.a.set(t,[e]),this.b+=1,this},g.get=function(t,e){return t=t?this.A(t):[],0<t.length?String(t[0]):e},g.toString=function(){if(this.c)return this.c;if(!this.a)return"";for(var t=[],e=this.a.M(),n=0;n<e.length;n++){var r=e[n],i=encodeURIComponent(String(r));r=this.A(r);for(var o=0;o<r.length;o++){var a=i;""!==r[o]&&(a+="="+encodeURIComponent(String(r[o]))),t.push(a)}}return this.c=t.join("&")};var Od=null;Nd.prototype.set=function(t){this.a=t},Nd.prototype.reset=function(){this.set(t())},Nd.prototype.get=function(){return this.a},u(Qd,Pd),g=Rd.prototype,g.P=null,g.ca=function(t){return this.a.ca(t)},g.abort=function(){this.c&&(this.c.cancel(),this.c=null),this.f=-1},g.La=function(){return!1},g.Oa=function(t,e){if(this.f=t.C,0==this.P){if(H(this.b,"TestConnection: Got data for stage 1"),!this.a.o&&(t=t.a)){var n=id(t,"X-Client-Wire-Protocol");this.l=n||null,this.a.j&&((t=id(t,"X-HTTP-Session-Id"))?this.a.K=t:D(this.b.a,"Missing X_HTTP_SESSION_ID in the handshake response"))}if(e){try{var r=this.a.la.a.parse(e)}catch(t){return xc(this.b,t),void Vd(this.a,this)}this.g=r[0]}else H(this.b,"TestConnection: Null responseText"),Vd(this.a,this)}else 1==this.P&&(this.h?K(6):"11111"==e?(K(5),this.h=!0,(!z||10<=Number(Wa))&&(this.f=200,this.c.cancel(),H(this.b,"Test connection succeeded; using streaming connection"),K(11),Td(this.a,this,!0))):(K(7),this.h=!1))},g.ta=function(){this.f=this.c.C,this.c.f?0==this.P?(this.P=1,H(this.b,"TestConnection: request complete for initial check"),Sd(this)):1==this.P&&(H(this.b,"TestConnection: request complete for stage 2"),this.h?(H(this.b,"Test connection succeeded; using streaming connection"),K(11),Td(this.a,this,!0)):(H(this.b,"Test connection failed; not using streaming"),K(10),Td(this.a,this,!1))):(H(this.b,"TestConnection: request failed, in state "+this.P),0==this.P?K(8):1==this.P&&K(9),Vd(this.a,this))},g.ia=function(){return this.a.ia()},g.qa=function(){return this.a.qa()},Xd.prototype.add=function(t){this.a.set(Yd(t),t)},Xd.prototype.A=function(){return this.a.A()};var ae=10;$d.prototype.cancel=function(){this.c=ge(this),this.b?(this.b.cancel(),this.b=null):this.a&&0!=this.a.a.c&&(ra(this.a.A(),function(t){t.cancel()}),od(this.a.a))},ie.prototype.stringify=function(t){return k.JSON.stringify(t,void 0)},ie.prototype.parse=function(t){return k.JSON.parse(t,void 0)},u(T,B);var ne="";T.prototype.b=qc("goog.net.XhrIo");var oe=/^https?$/i,pe=["POST","PUT"];g=T.prototype,g.fa=function(t,e,n,i){if(this.a)throw Error("[goog.net.XhrIo] Object is active with another request="+this.B+"; newUri="+t);e=e?e.toUpperCase():"GET",this.B=t,this.g="",this.j=0,this.K=e,this.G=!1,this.c=!0,this.a=Qc(this.s?this.s:Oc),this.D=Ic(this.s?this.s:Oc),this.a.onreadystatechange=r(this.Na,this);try{E(this.b,U(this,"Opening Xhr")),this.I=!0,this.a.open(e,String(t),!0),this.I=!1}catch(t){return E(this.b,U(this,"Error opening Xhr: "+t.message)),void qe(this,t)}t=n||"";var o=new O(this.headers);i&&md(i,function(t,e){o.set(e,t)}),i=sa(o.M()),n=k.FormData&&t instanceof k.FormData,!(0<=qa(pe,e))||i||n||o.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8"),o.forEach(function(t,e){this.a.setRequestHeader(e,t)},this),this.L&&(this.a.responseType=this.L),"withCredentials"in this.a&&this.a.withCredentials!==this.o&&(this.a.withCredentials=this.o);try{re(this),0<this.l&&(this.v=se(this.a),E(this.b,U(this,"Will abort after "+this.l+"ms if incomplete, xhr2 "+this.v)),this.v?(this.a.timeout=this.l,this.a.ontimeout=r(this.Ka,this)):this.C=Zb(this.Ka,this.l,this)),E(this.b,U(this,"Sending request")),this.u=!0,this.a.send(t),this.u=!1}catch(t){E(this.b,U(this,"Send error: "+t.message)),qe(this,t)}},g.Ka=function(){"undefined"!=typeof goog&&this.a&&(this.g="Timed out after "+this.l+"ms, aborting",this.j=8,E(this.b,U(this,this.g)),this.dispatchEvent("timeout"),this.abort(8))},g.abort=function(t){this.a&&this.c&&(E(this.b,U(this,"Aborting")),this.c=!1,this.h=!0,this.a.abort(),this.h=!1,this.j=t||7,this.dispatchEvent("complete"),this.dispatchEvent("abort"),ue(this))},g.w=function(){this.a&&(this.c&&(this.c=!1,this.h=!0,this.a.abort(),this.h=!1),ue(this,!0)),T.H.w.call(this)},g.Na=function(){this.i||(this.I||this.u||this.h?ve(this):this.jb())},g.jb=function(){ve(this)},g.W=function(){try{return 2<N(this)?this.a.status:-1}catch(t){return-1}},g.Ha=function(){try{return 2<N(this)?this.a.statusText:""}catch(t){return E(this.b,"Can not get status: "+t.message),""}},g.V=function(){try{return this.a?this.a.responseText:""}catch(t){return E(this.b,"Can not get responseText: "+t.message),""}},g.eb=function(t){if(this.a){var e=this.a.responseText;t&&0==e.indexOf(t)&&(e=e.substring(t.length));t:{if(t=e,k.JSON)try{var n=k.JSON.parse(t);break t}catch(t){}n=Cb(t)}return n}},g.Ga=function(){return this.j},g.hb=function(){return l(this.g)?this.g:String(this.g)},g=ye.prototype,g.na=8,g.F=1,g.La=function(){return 0==this.F},g.Qa=function(t){if(this.m=null,H(this.a,"startForwardChannel_"),1==this.F)if(t)J(this.a,"Not supposed to retry the open");else{H(this.a,"open_()"),this.R=Math.floor(1e5*Math.random()),t=this.R++;var e=new L(this,this.a,t,void 0),n=this.i;this.L&&(n?(n=Fa(n),Ha(n,this.L)):n=this.L),null===this.h&&(e.j=n);var r=Ie(this,e),i=M(this.D);R(i,"RID",t),R(i,"CVER",22),this.o&&this.j&&R(i,"X-HTTP-Session-Id",this.j),Be(this,i),this.h&&n&&xe(i,this.h,n),ce(this.c,e),this.va?(R(i,"$req",r),R(i,"SID","null"),e.X=!0,Vc(e,i,null)):Vc(e,i,r),this.F=2}else 3==this.F&&(t?Je(this,t):0==this.g.length?H(this.a,"startForwardChannel_ returned: nothing to send"):de(this.c)?J(this.a,"startForwardChannel_ returned: connection already in progress"):(Je(this),H(this.a,"startForwardChannel_ finished, sent request")))},g.Pa=function(){this.l=null,H(this.a,"Creating new HttpRequest"),this.b=new L(this,this.a,"rpc",this.T),null===this.h&&(this.b.j=this.i),this.b.N=0;var t=M(this.ua);R(t,"RID","rpc"),R(t,"SID",this.J),R(t,"CI",this.ka?"0":"1"),R(t,"AID",this.N),Be(this,t),R(t,"TYPE","xmlhttp"),this.h&&this.i&&xe(t,this.h,this.i),this.G&&this.b.setTimeout(this.G),Yc(this.b,t,!0,this.X),H(this.a,"New Request created")},g.Oa=function(t,e){if(0!=this.F&&(this.b==t||ee(this.c,t)))if(this.u=t.C,!t.v&&ee(this.c,t)&&3==this.F){try{var n=this.la.a.parse(e)}catch(t){n=null}if(p(n)&&3==n.length)if(e=n,0==e[0])t:if(H(this.a,"Server claims our backchannel is missing."),this.l)H(this.a,"But we are currently starting the request.");else{if(this.b){if(!(this.b.D+3e3<t.D))break t;De(this),this.b.cancel(),this.b=null}else D(this.a.a,"We do not have a BackChannel established");Le(this),K(18)}else this.xa=e[1],0<(t=this.xa-this.N)&&(e=e[2],H(this.a,e+" bytes (in "+t+" arrays) are outstanding on the BackChannel"),37500>e&&this.ka&&0==this.B&&!this.s&&(this.s=Ec(r(this.ib,this),6e3)));else H(this.a,"Bad POST response data returned"),V(this,11)}else if((t.v||this.b==t)&&De(this),!xa(e))for(e=n=this.la.a.parse(e),n=0;n<e.length;n++){var i=e[n];if(this.N=i[0],i=i[1],2==this.F)if("c"==i[0]){this.J=i[1],this.X=i[2];var o=i[3];null!=o&&(this.na=o,F(this.a,"VER="+this.na)),o=i[4],null!=o&&(this.ya=o,F(this.a,"SVER="+this.ya)),i=i[5],null!=i&&"number"==typeof i&&0<i&&(this.G=i*=1.5,F(this.a,"backChannelRequestTimeoutMs_="+i)),this.o&&(i=t.a)&&((o=id(i,"X-Client-Wire-Protocol"))&&be(this.c,o),this.j&&((i=id(i,"X-HTTP-Session-Id"))?(this.K=i,R(this.D,this.j,i)):D(this.a.a,"Missing X_HTTP_SESSION_ID in the handshake response"))),this.F=3,this.f&&this.f.Da(),i=t,this.ua=Ud(this,this.X,this.ja),i.v?(H(this.a,"Upgrade the handshake request to a backchannel."),fe(this.c,i),(o=this.G)&&i.setTimeout(o),i.s&&(bd(i),Zc(i)),this.b=i):Ke(this)}else"stop"!=i[0]&&"close"!=i[0]||V(this,7);else 3==this.F&&("stop"==i[0]||"close"==i[0]?"stop"==i[0]?V(this,7):ze(this):"noop"!=i[0]&&this.f&&this.f.Ca(i),this.B=0)}},g.ib=function(){null!=this.s&&(this.s=null,this.b.cancel(),this.b=null,Le(this),K(19))},g.ta=function(e){H(this.a,"Request complete");var n=null;if(this.b==e){De(this),this.b=null;var r=2}else{if(!ee(this.c,e))return;n=e.u,fe(this.c,e),r=1}if(this.u=e.C,0!=this.F)if(e.f)1==r?(Dc(e.l?e.l.length:0,t()-e.D,this.v),Fe(this)):Ke(this);else{var i=e.m;if(3==i||0==i&&0<this.u)H(this.a,"Not retrying due to error type");else{var o=this;if(H(this.a,function(){return"Maybe retrying, last error: "+Sc(i,o.u)}),1==r&&Ge(this,e)||2==r&&Le(this))return;H(this.a,"Exceeded max number of retries")}switch(n&&0<n.length&&he(this.c,n),H(this.a,"Error: HTTP request failed"),i){case 1:V(this,5);break;case 4:V(this,10);break;case 3:V(this,6);break;default:V(this,2)}}},g.pb=function(t){t?(F(this.a,"Successfully pinged google.com"),K(2)):(F(this.a,"Failed to ping google.com"),K(1))},g.ca=function(t){if(t&&!this.S)throw Error("Can't create secondary domain capable XhrIo object.");return t=new T(this.Ta),t.o=this.S,t},g.qa=function(){return!!this.f&&!0},g.ia=function(){return this.S},new Qd,g=Oe.prototype,g.Da=function(){},g.Ca=function(){},g.Ba=function(){},g.Aa=function(){},g.ab=function(){},Qe.prototype.a=function(t,e){return new W(t,e)},u(W,B),g=W.prototype,g.addEventListener=function(t,e,n,r){W.H.addEventListener.call(this,t,e,n,r)},g.removeEventListener=function(t,e,n,r){W.H.removeEventListener.call(this,t,e,n,r)},g.fb=function(){this.a.f=this.h,this.l&&(this.a.S=!0);var t=this.a,e=this.o,n=this.b,r=this.g||void 0;H(t.a,"connect()"),K(0),t.ja=n,t.U=r||{},t.o&&(H(t.a,"connect() bypassed channel-test."),t.I.b=[],t.I.a=!1),H(t.a,"connectTest_()"),t.C=new Rd(t,t.a),null===t.h&&(t.C.i=t.i),n=e,t.h&&t.i&&(n=xe(e,t.h,t.i)),t=t.C,t.m=n,e=Me(t.a,t.m),K(3),n=t.a.I.b,null!=n?(t.g=n[0],t.P=1,Sd(t)):($c(e,"MODE","init"),!t.a.o&&t.a.j&&$c(e,"X-HTTP-Session-Id",t.a.j),t.c=new L(t,t.b,void 0,void 0),t.c.j=t.i,Yc(t.c,e,!1,null),t.P=0)},g.close=function(){ze(this.a)},g.gb=function(t){if(l(t)){var e={};e.__data__=t,Ee(this.a,e)}else this.j?(e={},e.__data__=Db(t),Ee(this.a,e)):Ee(this.a,t)},g.w=function(){this.a.f=null,delete this.h,ze(this.a),delete this.a,W.H.w.call(this)},u(Se,Mc),u(Te,Nc),u(Re,Oe),Re.prototype.Da=function(){rc(this.a.c,"WebChannel opened on "+this.a.b),this.a.dispatchEvent("a")},Re.prototype.Ca=function(t){this.a.dispatchEvent(new Se(t))},Re.prototype.Ba=function(t){rc(this.a.c,"WebChannel aborted on "+this.a.b+" due to channel error: "+t),this.a.dispatchEvent(new Te(t))},Re.prototype.Aa=function(){rc(this.a.c,"WebChannel closed on "+this.a.b),this.a.dispatchEvent("b")};var Ue=ja(function(t,e){function n(){}n.prototype=t.prototype;var r=new n;return t.apply(r,Array.prototype.slice.call(arguments,1)),r},Qe);Ve.prototype.A=function(){for(var t=[],e=this.b.length-1;0<=e;--e)t.push(this.b[e]);var n=this.a.length;for(e=0;e<n;++e)t.push(this.a[e]);return t},u(Ye,w);var Ze="[goog.structs.Pool] Min can not be greater than max";g=Ye.prototype,g.da=function(){var e=t();if(!(null!=this.g&&0>e-this.g)){for(var n;0<Xe(this.a)&&(n=We(this.a),!this.sa(n));)this.aa();return!n&&$e(this)<this.c&&(n=this.pa()),n&&(this.g=e,this.b.add(n)),n}},g.ob=function(t){return!!pd(this.b.a,Yd(t))&&(this.ma(t),!0)},g.ma=function(t){pd(this.b.a,Yd(t)),this.sa(t)&&$e(this)<this.c?this.a.a.push(t):af(t)},g.aa=function(){for(var t=this.a;$e(this)<this.h;){var e=this.pa();t.a.push(e)}for(;$e(this)>this.c&&0<Xe(this.a);)af(We(t))},g.pa=function(){return{}},g.sa=function(t){return"function"!=typeof t.bb||t.bb()},g.w=function(){if(Ye.H.w.call(this),0<this.b.a.c)throw Error("[goog.structs.Pool] Objects not released");delete this.b;for(var t=this.a;0!=t.b.length||0!=t.a.length;)af(We(t));delete this.a},cf.prototype.A=function(){for(var t=this.a,e=[],n=t.length,r=0;r<n;r++)e.push(t[r].b);return e},cf.prototype.M=function(){for(var t=this.a,e=[],n=t.length,r=0;r<n;r++)e.push(t[r].a);return e},u(ef,cf),u(Y,Ye),g=Y.prototype,g.da=function(t,e){if(!t)return Y.H.da.call(this);df(this.f,void 0!==e?e:100,t),this.ra()},g.ra=function(){for(var t=this.f;0<t.a.length;){var e=this.da();if(!e)break;var n=t,r=n.a,i=r.length,o=r[0];if(0>=i)o=void 0;else{if(1==i)ua(r);else{r[0]=r.pop(),r=0,n=n.a,i=n.length;for(var a=n[r];r<i>>1;){var s=2*r+1,u=2*r+2;if(s=u<i&&n[u].a<n[s].a?u:s,n[s].a>a.a)break;n[r]=n[s],r=s}n[r]=a}o=o.b}o.apply(this,[e])}},g.ma=function(t){Y.H.ma.call(this,t),this.ra()},g.aa=function(){Y.H.aa.call(this),this.ra()},g.w=function(){Y.H.w.call(this),k.clearTimeout(void 0),ua(this.f.a),this.f=null},u(Z,Y),Z.prototype.pa=function(){var t=new T,e=this.l;return e&&e.forEach(function(e,n){t.headers.set(n,e)}),this.j&&(t.o=!0),t},Z.prototype.sa=function(t){return!t.i&&!t.a},Qe.prototype.createWebChannel=Qe.prototype.a,W.prototype.send=W.prototype.gb,W.prototype.open=W.prototype.fb,W.prototype.close=W.prototype.close,Fc.NO_ERROR=0,Fc.TIMEOUT=8,Fc.HTTP_ERROR=6,Gc.COMPLETE="complete",Kc.EventType=Lc,Lc.OPEN="a",Lc.CLOSE="b",Lc.ERROR="c",Lc.MESSAGE="d",B.prototype.listen=B.prototype.Ia,Z.prototype.getObject=Z.prototype.da,Z.prototype.releaseObject=Z.prototype.ob,T.prototype.listenOnce=T.prototype.Ja,T.prototype.getLastError=T.prototype.hb,T.prototype.getLastErrorCode=T.prototype.Ga,T.prototype.getStatus=T.prototype.W,T.prototype.getStatusText=T.prototype.Ha,T.prototype.getResponseJson=T.prototype.eb,T.prototype.getResponseText=T.prototype.V,T.prototype.getResponseText=T.prototype.V,T.prototype.send=T.prototype.fa,module.exports={createWebChannelTransport:Ue,ErrorCode:Fc,EventType:Gc,WebChannel:Kc,XhrIoPool:Z}}).call("undefined"!==typeof global?global:"undefined"!==typeof self?self:"undefined"!==typeof window?window:{})}).call(exports,__webpack_require__(1))},function(t,e,n){"use strict";function r(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",function(){var t="/service-worker.js";a?(o(t),navigator.serviceWorker.ready.then(function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")})):i(t)})}}function i(t){navigator.serviceWorker.register(t).then(function(t){t.onupdatefound=function(){var e=t.installing;e.onstatechange=function(){"installed"===e.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}}).catch(function(t){console.error("Error during service worker registration:",t)})}function o(t){fetch(t).then(function(e){404===e.status||-1===e.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then(function(t){t.unregister().then(function(){window.location.reload()})}):i(t)}).catch(function(){console.log("No internet connection found. App is running in offline mode.")})}e.a=r;var a=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/))}]);
//# sourceMappingURL=gource.main.js.map